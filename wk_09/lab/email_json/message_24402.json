{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "derrell@samba.org", "subject": "svn commit: samba r22731 - in branches/SAMBA_3_0/source: . tests", "body": "Author: derrell\nDate: 2007-05-07 03:02:24 +0000 (Mon, 07 May 2007)\nNew Revision: 22731\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22731\n\nLog:\n\n- Fix bug #4594.\n  \n  configure.in determines if -Werror-implicit-function-declaration is\n  available, and if so it enables that flag if --enable-developer is\n  specified.  Since the configure tests themselves did not use that flag, it\n  was possible for a configure test to succeed, followed by a failed\n  compilation due to a facility being available but not having a proper\n  declaration in a header file.  (This bit me with readahead().)  This patch\n  ensures that if implicit function declarations will kill the build, the\n  feature being tested is deselected so the build will succeed.\n\n  The autoconf manual suggests using return instead of exit in configure\n  tests because the declaration for exit is often missing.  We require this\n  now, since we error if prototypes are missing.  See section 5.5.1 of\n  http://www.gnu.org/software/autoconf/manual/autoconf.html.  This patch makes\n  these changes, because in fact, an external declaration for exit is missing\n  here (and likely elsewhere).\n\n  I've verified that the features selected (here) with the original\n  configure.in and the new one are the same except for, in my case,\n  readahead.  I've also confirmed that the generated Makefile is identical.\n\n  These changes are not being applied to the 3.0.26 branch because it does not\n  exhibit the initial problem this patch is supposed to solve since it doesn't\n  attempt to use -Werror-implicit-function-declaration.\n\nModified:\n   branches/SAMBA_3_0/source/configure.in\n   branches/SAMBA_3_0/source/tests/crypttest.c\n   branches/SAMBA_3_0/source/tests/fcntl_lock.c\n   branches/SAMBA_3_0/source/tests/fcntl_lock64.c\n   branches/SAMBA_3_0/source/tests/ftruncate.c\n   branches/SAMBA_3_0/source/tests/getgroups.c\n   branches/SAMBA_3_0/source/tests/shared_mmap.c\n   branches/SAMBA_3_0/source/tests/summary.c\n   branches/SAMBA_3_0/source/tests/trivial.c\n   branches/SAMBA_3_0/source/tests/unixsock.c\n\n\nChangeset:\nSorry, the patch is too large (858 lines) to include; please use WebSVN to see it!\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22731\n\n"}