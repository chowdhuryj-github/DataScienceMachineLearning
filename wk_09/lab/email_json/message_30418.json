{"category": "ham", "to_address": "\"Bruno Schroeder\" <bschroeder@brq.com>", "from_address": "\"Tom Phoenix\" <tom@stonehenge.com>", "subject": "Re: File Handling. Reading and Writting.", "body": "On 5/15/07, Bruno Schroeder  wrote:\n\n> I tryed to use seek but it did not work. Can you help me on that, please? I\n> am using Windows XP. The following example writes at the end of the file.\n>\n> use strict;\n> my $file = \"teste_rw.txt\";\n> open (FILE, \"+<\", $file) or die \"Can not open $file: $!.\";\n> for my $line () {\n>     print $line;\n>     seek(FILE, 0, 1);\n>     print FILE \"b\\n\";\n>     seek(FILE, 0, 1);\n> }\n> my $a_while = 2;\n> sleep($a_while);\n> seek(FILE, tell(FILE), 0);\n> close FILE;\n\nHere's some untested code that may do something resembling what you want:\n\n  my $file = \"teste_rw.txt\";\n  open (FILE, \"+<\", $file) or die \"Can not open '$file' r/w: $!\";\n\n  # $next_loc is the location of the next line to process\n  my $next_loc = tell FILE;  # probably 0\n\n  while (1) {\n\n    my $current_loc = $next_loc;\n    # seek before each read or write\n    seek(FILE, $current_loc, 0) or die;\n    my $line = ;\n    last if not defined $line;  # undef at eof\n    $next_loc = tell FILE;\n\n    print $line;\n\n    # Get the replacement string (somehow).\n    my $repl = &replacement_for($line);\n\n    die \"Can't replace '$line' with '$repl'\"\n      unless length($line) == length($repl);\n\n    # seek before each read or write\n    seek(FILE, $current_loc, 0) or die;\n    print FILE $repl;\n  }\n\n  close FILE;\n\nI'm not sure why your code used sleep, so I omitted it. Cheers!\n\n--Tom Phoenix\nStonehenge Perl Training\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}