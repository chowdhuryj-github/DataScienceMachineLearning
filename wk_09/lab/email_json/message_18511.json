{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 211: allow ctdbd_allocate_pkt to be used in client code in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 211\nrevision-id: tridge@samba.org-20070428100146-vc86b04jx6za7v7h\nparent: tridge@samba.org-20070428093549-hn7t2tsfo8e3ru1m\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Sat 2007-04-28 12:01:46 +0200\nmessage:\n  allow ctdbd_allocate_pkt to be used in client code\nmodified:\n  common/ctdb_daemon.c           ctdb_daemon.c-20070409200331-3el1kqgdb9m4ib0g-1\n=== modified file 'common/ctdb_daemon.c'\n--- a/common/ctdb_daemon.c\t2007-04-28 09:35:49 +0000\n+++ b/common/ctdb_daemon.c\t2007-04-28 10:01:46 +0000\n@@ -695,7 +695,9 @@\n \thdr->length       = length;\n \thdr->ctdb_magic   = CTDB_MAGIC;\n \thdr->ctdb_version = CTDB_VERSION;\n-\thdr->generation   = ctdb->vnn_map->generation;\n+\tif (ctdb->vnn_map) {\n+\t\thdr->generation = ctdb->vnn_map->generation;\n+\t}\n \n \treturn hdr;\n }\n\n"}