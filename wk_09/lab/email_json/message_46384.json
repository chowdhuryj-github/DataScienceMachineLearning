{"category": "ham", "to_address": "Michael B Allen <mba2000@ioplex.com>", "from_address": "\"Christopher R. Hertel\" <crh@ubiqx.mn.org>", "subject": "Re: [SMB] NTCreateANDX quesiotn", "body": "below...\n\nMichael B Allen wrote:\n> Hi Chris,\n> \n> It looks to me like the WordCount is too big but Jeremy said 42 was\n> right so I'm not sure.\n> \n> If you can decipher the output of my 'hexd' tool the packet I'm looking\n> at is:\n> \n> $ hexd Frame457.bin -r \"0x36:Frame457,4:NetBIOS Header,32:SMB \\\n>    Header,1:WordCount,84:Words,256:Unknown\"\n> Frame457\n> 00000:  00 07 e9 09 b2 cb 00 07 e9 09 ba 5c 08 00 45 00  |...........\\..E.|\n> 00010:  00 b3 d0 57 40 00 80 06 a2 9a c0 a8 03 80 c0 a8  |...W@...........|\n> 00020:  02 82 01 bd 04 25 8b d0 b0 41 87 14 5f 2d 50 18  |.....%...A.._-P.|\n> 00030:  fa 88 27 a5 00 00                                |..'...          |\n> NetBIOS Header\n> 00000:  00 00 00 87                                      |....            |\n> SMB Header\n> 00000:  ff 53 4d 42 a2 00 00 00 00 98 07 c8 00 00 44 77  |.SMB..........Dw|\n> 00010:  28 30 80 f2 a4 3d 00 00 07 08 d0 03 01 10 c0 18  |(0...=..........|\n> WordCount\n> 00000:  2a                                               |*               |\n> Words\n> 00000:  ff 00 87 00 03 00 c0 01 00 00 00 80 65 7a c2 f5  |............ez..|\n> 00010:  77 c3 01 5e 1b 3e 77 91 6c c6 01 80 65 7a c2 f5  |w..^.>w.l...ez..|\n> 00020:  77 c3 01 28 34 0f 62 2d 21 c4 01 20 00 00 00 00  |w..(4.b-!.. ....|\n> 00030:  f0 00 00 00 00 00 00 00 e8 00 00 00 00 00 00 00  |................|\n> 00040:  00 07 00 00 00 00 00 70 00 2e 00 65 00 78 00 65  |.......p...e.x.e|\n> 00050:  00 00 00 00                                      |....            |\n> Unknown\n> 00000:  00 03 81 d8 bf 03 81 20 ff 01 1f 00 00 00 00 00  |....... ........|\n> 00010:  00 00                                            |..              |\n> \n> So I see 'p.exe' in the Words and Wireshark doesn't decode those bytes\n> so it looks like there's just garbage at the end. Meaning the WordCount\n> and the NetBIOS header payload size are incorrect (too large).\n\nSo... my next question.  Is the WordCount value 42 (0x2a) correct (for this\npacket)?  If so, then the \"p.exe\" string really is part of the Words.\n\n...but you said earlier that you thought the correct value should be closer\nto 34 (0x22).  If that were the case, the bytecount would be zero and\n'p.exe' would not be part of the packet at all.\n\nI am curious as to how this packet should be read.\n\nThanks!\n\nChris -)-----\n\n-- \n\"Implementing CIFS - the Common Internet FileSystem\"    ISBN: 013047116X\nSamba Team -- http://www.samba.org/    -)-----     Christopher R. Hertel\njCIFS Team -- http://jcifs.samba.org/  -)-----  ubiqx development, uninq\nubiqx Team -- http://www.ubiqx.org/    -)-----          crh@ubiqx.mn.org\nOnLineBook -- http://ubiqx.org/cifs/   -)-----             crh@ubiqx.org\n\n"}