{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 304: fixed a fd close error on reconnect in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 304\nrevision-id: tridge@samba.org-20070515003328-ogsyrb3gnoyicfud\nparent: tridge@samba.org-20070515001716-tndy0z6bafkvdc3v\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Tue 2007-05-15 10:33:28 +1000\nmessage:\n  fixed a fd close error on reconnect\nmodified:\n  tcp/tcp_connect.c              tcp_connect.c-20061128004937-x70q1cu5xzg5g2tm-1\n=== modified file 'tcp/tcp_connect.c'\n--- a/tcp/tcp_connect.c\t2007-05-14 23:42:52 +0000\n+++ b/tcp/tcp_connect.c\t2007-05-15 00:33:28 +0000\n@@ -168,16 +168,6 @@\n }\n \n /*\n-  destroy a ctdb_incoming structure \n-*/\n-static int ctdb_incoming_destructor(struct ctdb_incoming *in)\n-{\n-\tclose(in->fd);\n-\tin->fd = -1;\n-\treturn 0;\n-}\n-\n-/*\n   called when we get contacted by another node\n   currently makes no attempt to check if the connection is really from a ctdb\n   node in our cluster\n@@ -207,8 +197,6 @@\n \n \tin->queue = ctdb_queue_setup(ctdb, in, in->fd, CTDB_TCP_ALIGNMENT, \n \t\t\t\t     ctdb_tcp_read_cb, in);\n-\n-\ttalloc_set_destructor(in, ctdb_incoming_destructor);\n }\n \n \n\n"}