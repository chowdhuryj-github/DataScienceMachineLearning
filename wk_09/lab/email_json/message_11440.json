{"category": "ham", "to_address": "gecko951 <ben.lairson@gmail.com>", "from_address": "Duncan Murdoch <murdoch@stats.uwo.ca>", "subject": "Re: [R] Using R to create pdf's from each file in a directory", "body": "On 4/20/2007 9:40 PM, gecko951 wrote:\n> The Platform I am using R on is RHEL3.  I run a bash script that collects\n> data into many CSV files and have been processing them one at a time on my\n> local machine with an excel macro.  I would like to use R to take data\n> points from each of the CSV files and create line graphs in PDF format\n> because it will save me ALOT of time.  I am able to successfully do this\n> when I call the file name directly...however my script bombs when I try to\n> do multiple files.  I would like the created pdf's to have the same filename\n> as the original csv files.  I have looked quite a bit and not found much\n> help on \"batch processing\" an entire directory.  My current code is as\n> follows:\n> \n> list <- dir(\"/tmp/data\")\n> for(x in list){\n> d <- read.table(x, sep=\"\\t\", header=TRUE) # read data\n> pdf(\"/tmp/graph/x.pdf\")                              # file for graph\n> plot(d$BlockSeqNum, d$MBs,                              # Blocks as x, MB/s\n> as y     \n>      type=\"l\",                                     # plot lines, not points\n>      xlab=\"Blocks\",                                  # label x axis\n>      ylab=\"MB/s\",                                  # label y axis\n>      main=x)          # add title\n> dev.off()                                          # close file\n> q()                                                # quit\n> \n> ERROR: Error in plot.window(xlim, ylim, log, asp, ...) :\n>         need finite 'xlim' values\n> In addition: Warning messages:\n> 1: no non-missing arguments to min; returning Inf\n> 2: no non-missing arguments to max; returning -Inf\n> 3: no non-missing arguments to min; returning Inf\n> 4: no non-missing arguments to max; returning -Inf\n\nWhat you're doing appears to be a reasonable approach; all you need are \nsome checks that the data is reasonable before calling plot and possibly \nbombing.\n\nI'd suggest adding a \"print(x); print(str(d))\" statements after you read \nd; then you'll be able to see when it is that sometimes d doesn't \ncontain plotable data.\n\nOne other problem you'll find:  you're writing all plots to \"x.pdf\".  I \nthink you really want to construct that name differently for each x. \nI'd suggest using paste() and basename() (and perhaps some regular \nexpressions and gsub()) to construct the output filename.\n\nDuncan Murdoch\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}