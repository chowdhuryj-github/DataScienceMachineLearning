{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "svn commit: samba r23180 - in\n\tbranches/SAMBA_4_0/source/torture/raw: .", "body": "Author: tridge\nDate: 2007-05-29 07:32:28 +0000 (Tue, 29 May 2007)\nNew Revision: 23180\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23180\n\nLog:\n\nauto-reconnect on both NT_STATUS_END_OF_FILE and NT_STATUS_LOCAL_DISCONNECT\n\nModified:\n   branches/SAMBA_4_0/source/torture/raw/lockbench.c\n   branches/SAMBA_4_0/source/torture/raw/openbench.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/torture/raw/lockbench.c\n===================================================================\n--- branches/SAMBA_4_0/source/torture/raw/lockbench.c\t2007-05-29 06:33:55 UTC (rev 23179)\n+++ branches/SAMBA_4_0/source/torture/raw/lockbench.c\t2007-05-29 07:32:28 UTC (rev 23180)\n@@ -212,7 +212,8 @@\n \tNTSTATUS status = smbcli_request_simple_recv(req);\n \tstate->req = NULL;\n \tif (!NT_STATUS_IS_OK(status)) {\n-\t\tif (NT_STATUS_EQUAL(status, NT_STATUS_END_OF_FILE)) {\n+\t\tif (NT_STATUS_EQUAL(status, NT_STATUS_END_OF_FILE) ||\n+\t\t    NT_STATUS_EQUAL(status, NT_STATUS_LOCAL_DISCONNECT)) {\n \t\t\ttalloc_free(state->tree);\n \t\t\tstate->tree = NULL;\n \t\t\tnum_connected--;\t\n@@ -249,7 +250,8 @@\n \tstruct benchlock_state *state = talloc_get_type(req->async.private, \n \t\t\t\t\t\t\tstruct benchlock_state);\n \tNTSTATUS status = smbcli_request_simple_recv(req);\n-\tif (NT_STATUS_EQUAL(status, NT_STATUS_END_OF_FILE)) {\n+\tif (NT_STATUS_EQUAL(status, NT_STATUS_END_OF_FILE) ||\n+\t    NT_STATUS_EQUAL(status, NT_STATUS_LOCAL_DISCONNECT)) {\n \t\ttalloc_free(state->tree);\n \t\tstate->tree = NULL;\n \t\tnum_connected--;\t\n\nModified: branches/SAMBA_4_0/source/torture/raw/openbench.c\n===================================================================\n--- branches/SAMBA_4_0/source/torture/raw/openbench.c\t2007-05-29 06:33:55 UTC (rev 23179)\n+++ branches/SAMBA_4_0/source/torture/raw/openbench.c\t2007-05-29 07:32:28 UTC (rev 23180)\n@@ -283,7 +283,8 @@\n \tstruct benchopen_state *state = talloc_get_type(req->async.private, \n \t\t\t\t\t\t\tstruct benchopen_state);\n \tNTSTATUS status = smbcli_request_simple_recv(req);\n-\tif (NT_STATUS_EQUAL(status, NT_STATUS_END_OF_FILE)) {\n+\tif (NT_STATUS_EQUAL(status, NT_STATUS_END_OF_FILE) ||\n+\t    NT_STATUS_EQUAL(status, NT_STATUS_LOCAL_DISCONNECT)) {\n \t\ttalloc_free(state->tree);\n \t\tstate->tree = NULL;\n \t\tnum_connected--;\t\n\n"}