{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "James Peach <jpeach@apple.com>", "subject": "Re: svn commit: samba r22509 - in branches:\n\tSAMBA_3_0/source/groupdb SAMBA_3_0_25/source/groupdb", "body": "On 25/04/2007, at 2:32 AM, jerry@samba.org wrote:\n\n> Author: jerry\n> Date: 2007-04-25 09:32:03 +0000 (Wed, 25 Apr 2007)\n> New Revision: 22509\n>\n> WebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22509\n>\n> Log:\n> Fix some memory corruption caused by calling free()\n> on talloc()'d memory when adding/removing members\n> from Local Groups.\n\nHow about changing SAFE_FREE to prevent this sort of thing? eg.\n\n#define SAFE_FREE(x) do { if ((x) != NULL) { \\\n\tSMB_ASSERT(!talloc_is_talloc_pointer(free)); free(x); x=NULL;} }  \nwhile(0)\n\n\n--\nJames Peach | jpeach@apple.com\n\n\n\n"}