{"category": "ham", "to_address": "perl6-internals@perl.org, Jonathan Worthington <jonathan@jnthn.net>", "from_address": "James E Keenan <jkeen_via_google@yahoo.com>", "subject": "Re: src/pmc/classobject.h:  Why is it in this directory?", "body": "Jonathan Worthington wrote:\n\n> Oops, forgot to Reply To All...\n> \n> ------------------------------------------------------------------------\n> \n> Subject:\n> Re: src/pmc/classobject.h: Why is it in this directory?\n> From:\n> Jonathan Worthington \n> Date:\n> Mon, 23 Apr 2007 16:55:32 +0100\n> To:\n> James E Keenan \n> \n> To:\n> James E Keenan \n> \n> \n> James E Keenan wrote:\n> \n>> I stumbled across it because I was re-running the build tools tests in \n>> t/tools/pmc2cutils/*.t.\n>>\n>> [parrot] 502 $ prove -v t/tools/pmc2cutils/00-qualify.t\n>> t/tools/pmc2cutils/00-qualify....1..9\n>> ok 1 - use Parrot::Pmc2c::Utils;\n>> ok 2 - Makefile located\n>> ok 3 - myconfig located\n>> ok 4 - lib/Parrot/PMC.pm located\n>> not ok 5 - only 2 file suffixes in src/pmc\n>>\n>> #   Failed test 'only 2 file suffixes in src/pmc'\n>> #   at t/tools/pmc2cutils/00-qualify.t line 26.\n>> #          got: '3'\n>> #     expected: '2'\n>> ...\n>> # Looks like you failed 1 test of 9.\n>> dubious\n>>         Test returned status 1 (wstat 256, 0x100)\n>> DIED. FAILED test 5\n>>         Failed 1/9 tests, 88.89% okay\n>> Failed Test                     Stat Wstat Total Fail  List of Failed\n>> ------------------------------------------------------------------------------- \n>>\n>> t/tools/pmc2cutils/00-qualify.t    1   256     9    1  5\n>> Failed 1/1 test scripts. 1/9 subtests failed.\n>> Files=1, Tests=9,  2 wallclock secs ( 0.25 cusr +  0.13 csys =  0.38 CPU)\n>> Failed 1/1 test programs. 1/9 subtests failed.\n> \n> Aha, sorry. I've tried to get myself into the habit of running those \n> tests when I change pmc2c, though this change didn't do that, so I never \n> spotted it.\n> \n>> Now, granted, the test that failed may have been written in a too \n>> restrictive manner.  But I was trying to determine which files in \n>> src/pmc/ I needed to copy to a temporary directory for the purpose of \n>> running tests later in the test suite.\n>>\n>> Since I use src/pmc/class.pmc later in the test suite, I may have to \n>> reformulate a test there as well:\n>>\n>> [parrot] 506 $ grep -n 'src/pmc/class' t/tools/pmc2cutils/*.t\n>> t/tools/pmc2cutils/05-gen_c.t:286:    my @pmcfiles = ( \n>> \"$main::topdir/src/pmc/default.pmc\", \n>> \"$main::topdir/src/pmc/class.pmc\", );\n> \n> Couldn't you could just allow there to be .h files in there, provided \n> they don't start with \"pmc_\" (and therefore we know they ain't leftovers \n> from an uncleaned tree)?\n> \n\nOkay, I've hacked up t/tools/pmc2cutils/00-qualify.t and committed in to \ntrunk.  Jonathan, can you take a look at it and the 05 test in the same \ndirectory (which makes reference to the Class PMC)?  Thanks.\n\n"}