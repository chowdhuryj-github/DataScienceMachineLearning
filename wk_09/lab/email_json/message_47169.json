{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r23461 - in\n\tbranches/SAMBA_3_0_26/source/registry: .", "body": "Author: obnox\nDate: 2007-06-13 10:15:48 +0000 (Wed, 13 Jun 2007)\nNew Revision: 23461\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23461\n\nLog:\nMore or less merge r21977 from 3_0:\n\nlittle cosmetic change to remove a local var that's not really needed\n\nMichael\n\n\nModified:\n   branches/SAMBA_3_0_26/source/registry/reg_db.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0_26/source/registry/reg_db.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/registry/reg_db.c\t2007-06-13 10:12:33 UTC (rev 23460)\n+++ branches/SAMBA_3_0_26/source/registry/reg_db.c\t2007-06-13 10:15:48 UTC (rev 23461)\n@@ -741,7 +741,6 @@\n \tTALLOC_CTX *mem_ctx;\n \tchar *tdbkey;\n \tWERROR err = WERR_NOMEM;\n-\tuint8 *data;\n \tTDB_DATA tdbdata;\n \n \tif (!(mem_ctx = talloc_init(\"regdb_set_secdesc\"))) {\n@@ -756,14 +755,13 @@\n \t}\n \tnormalize_dbkey(tdbkey);\n \n-\terr = ntstatus_to_werror(marshall_sec_desc(mem_ctx, secdesc, &data,\n+\terr = ntstatus_to_werror(marshall_sec_desc(mem_ctx, secdesc,\n+\t\t\t\t\t\t   &tdbdata.dptr,\n \t\t\t\t\t\t   &tdbdata.dsize));\n \tif (!W_ERROR_IS_OK(err)) {\n \t\tgoto done;\n \t}\n \n-\ttdbdata.dptr = data;\n-\n \tif (tdb_trans_store_bystring(tdb_reg, tdbkey, tdbdata, 0) == -1) {\n \t\terr = ntstatus_to_werror(map_nt_error_from_unix(errno));\n \t\tgoto done;\n\n"}