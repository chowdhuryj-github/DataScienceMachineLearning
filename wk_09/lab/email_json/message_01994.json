{"category": "ham", "to_address": "Perl Beginners <beginners@perl.org>", "from_address": "Stanislav Nedelchev <stanislav.nedelchev@gmail.com>", "subject": "Re: Data Mungling - Address Book;", "body": "Chas Owens wrote:\n> On 4/10/07, Stanislav Nedelchev  wrote:\n>> Hi to all\n>> Here is my problem . I'm trying to export this data to SQL database .\n>> Here is example data.Don't pay attention on encoding. Every new record\n>> is starting --=NewRecord=--\n>> delimiter between fields and data is = .\n>> Contact=\u001b$B'!'$'1'1'.'1\u001b(B-\u001b$B'3'<'/'*'.'&'%\u001b(B-\u001b$B'0'0'%\u001b(B\n>> Manager=\n>> Region=\u001b$B'2')'0',\u001b(B \u001b$B'\"'e'b'T'Q'c\u001b(B\n>> Municipality= \u001b$B'/'&'3'&'\"'<'2\u001b(B\n>> Settlement=\u001b$B'$'2\u001b(B.\u001b$B'/'&'3'&'\"'<'2\u001b(B\n>> Address=\u001b$B'e']\u001b(B.\u001b$B'2'Z'R'Q'b'c'\\'Q\u001b(B 11 \u001b$B'\\'Q'R\u001b(B.1-2\n>> Phone=43058\n>> Name=\u001b$B'-'p'U'^'Z']\u001b(B \u001b$B'/'Z'\\'`']'`'S\u001b(B \u001b$B'3'd'Q'^'V'_'`'S\u001b(B - \u001b$B'0'R'k'`'a'b'Q'\\'d'Z'\\'e'S'Q'k\u001b(B \u001b$B']'V'\\'Q'b\u001b(B\n>> --=NewRecord=--\n>> Contact=\u001b$B'!'*'1'1'.'1\u001b(B \u001b$B'U\u001b(B-\u001b$B'b\u001b(B \u001b$B'2\u001b(B.\u001b$B'%'Z'^'Z'd'b'`'S'&'0'0'%\u001b(B\n>> Manager=\n>> Region=\u001b$B'2')'0',\u001b(B \u001b$B'\"'e'b'T'Q'c\u001b(B\n>> Municipality= \u001b$B'\"'5'2'$'!'3\u001b(B\n>> Settlement=\u001b$B'$'2\u001b(B.\u001b$B'\"'5'2'$'!'3\u001b(B\n>> Address=\u001b$B'e']\u001b(B.\u001b$B'7'Q'_\u001b(B \u001b$B','b'e'^\u001b(B \u001b$B-b\u001b(B28 \u001b$B'V'd\u001b(B.2 \u001b$B'c'd\u001b(B.209\n>> Phone=\n>> Name=\u001b$B'2'e'^'V'_\u001b(B \u001b$B'/'Z'\\'`']'Q'V'S\u001b(B \u001b$B'%'Z'^'Z'd'b'`'S\u001b(B - \u001b$B'0'R'k'`'a'b'Q'\\'d'Z'\\'e'S'Q'k\u001b(B \u001b$B']'V'\\'Q'b\u001b(B\n>>\n>>\n>>\n>> I was try to adapt some code that i see here and some people are helped\n>> me with other things.\n>>\n>> Here is my code . It's seems that %hashrecord is not after firs asaing\n>> to array is not changing anymore .\n>> If i try to iniatilze the hash it's seem that i initialize the reference\n>> and everything becomes empty.\n>> Can anybody give advice how to fill this array of hashes and generate\n>> SQL.\n>>\n>> use strict;\n>> use warnings;\n>> open FILE,\"> open OUT,\">insert.sql\" or die $!;\n>> my @data;\n>> my $sql;\n>> my %hashrecord;\n>> my %columns;\n>> while(){\n>>\n>> if(! /--=NewRecord=--/){\n>> my ($fname,$fvalue) = split/=/;\n>> $hashrecord{$fname} = $fvalue;\n>>\n>> }\n>> if (/--=NewRecord=--/){push @data, \\%hashrecord};\n>> }\n>>\n>> foreach my $rec (@data) {\n>> $columns{$_}++ foreach keys %$rec;\n>> }\n>> foreach my $rec (@data) {\n>> $sql = sprintf \"insert into doctors (%s)\\nvalues(%s)\",\n>> join(\",\", map qq( $_), keys %$rec),\n>> join(\",\", map qq( '$_'), values %$rec);\n>> print OUT $sql, \"\\n\";\n>> }\n>>\n>\n> I certainly hope your code has indentation and that it was lost in the\n> copy&paste into the email. The short answer is you can't reuse\n> %hashrecord; you need a new one each time. To do this you will either\n> need to restructure your code heavily or make this less than optimal\n> change:\n>\n> if (/--=NewRecord=--/) {\n> push @data, { %hashrecord }; #push a copy of %hashrecord onto the array\n> %hashrecord = (); #clear %hashrecord for the next record\n> }\n>\nThanks a lot.\nI'm not a programmer and I just want to help to one friend to save him a\nlot of manual work .\nBut in any case i will sit down and learn how to make some simple things\nby myself not asking for everything\nin mail list.\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}