{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22369 - in branches/SAMBA_4_0/source/lib/util: .", "body": "Author: metze\nDate: 2007-04-19 12:51:04 +0000 (Thu, 19 Apr 2007)\nNew Revision: 22369\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22369\n\nLog:\nadd ZERO_STRUCT() ... macros to lib/util/util.h again\nto fix the openchange build...\n\nwe need to remove them from libreplace, but I'll think about that\nnext week.\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/lib/util/util.h\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/lib/util/util.h\n===================================================================\n--- branches/SAMBA_4_0/source/lib/util/util.h\t2007-04-19 09:26:03 UTC (rev 22368)\n+++ branches/SAMBA_4_0/source/lib/util/util.h\t2007-04-19 12:51:04 UTC (rev 22369)\n@@ -82,4 +82,45 @@\n #define strlen(x) valgrind_strlen(x)\n #endif\n \n+/** \n+ * zero a structure \n+ */\n+#ifndef ZERO_STRUCT\n+#define ZERO_STRUCT(x) memset((char *)&(x), 0, sizeof(x))\n+#endif\n+\n+/** \n+ * zero a structure given a pointer to the structure \n+ */\n+#ifndef ZERO_STRUCTP\n+#define ZERO_STRUCTP(x) do { if ((x) != NULL) memset((char *)(x), 0, sizeof(*(x))); } while(0)\n+#endif\n+\n+/** \n+ * zero a structure given a pointer to the structure - no zero check \n+ */\n+#ifndef ZERO_STRUCTPN\n+#define ZERO_STRUCTPN(x) memset((char *)(x), 0, sizeof(*(x)))\n+#endif\n+\n+/* zero an array - note that sizeof(array) must work - ie. it must not be a\n+   pointer */\n+#ifndef ZERO_ARRAY\n+#define ZERO_ARRAY(x) memset((char *)(x), 0, sizeof(x))\n+#endif\n+\n+/**\n+ * work out how many elements there are in a static array \n+ */\n+#ifndef ARRAY_SIZE\n+#define ARRAY_SIZE(a) (sizeof(a)/sizeof(a[0]))\n+#endif\n+\n+/** \n+ * pointer difference macro \n+ */\n+#ifndef PTR_DIFF\n+#define PTR_DIFF(p1,p2) ((ptrdiff_t)(((const char *)(p1)) - (const char *)(p2)))\n+#endif\n+\n #endif /* _SAMBA_UTIL_H_ */\n\n"}