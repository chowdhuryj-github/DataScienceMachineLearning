{"category": "ham", "to_address": "perl6-internals@perl.org", "from_address": "James E Keenan <jkeen@verizon.net>", "subject": "Re: [perl #43031] [PATCH] Move instance variable initialization to\n new()", "body": "Steve Peters wrote:\n> # New Ticket Created by  Steve Peters \n> # Please include the string:  [perl #43031]\n> # in the subject line of all future correspondence about this issue. \n> # \n> \n> \n> Creating new instance variables after a new is never good.  The attached\n> patch is needed before things can start to be moved around.\n> \n> Steve Peters\n> steve@fisharerojo.org\n> \n> Index: lib/Parrot/Ops2c/Utils.pm\n> ===================================================================\n> --- lib/Parrot/Ops2c/Utils.pm   (revision 18619)\n> +++ lib/Parrot/Ops2c/Utils.pm   (working copy)\n> @@ -194,6 +194,8 @@\n> \n>      $argsref->{preamble}  = $preamble;\n>      $argsref->{init_func} = $init_func;\n> +    $argsref->{bs}   = \"$argsref->{base}$argsref->{suffix}_\";\n> +    $argsref->{opsarraytype} = $argsref->{trans}->opsarraytype();\n> \n>      $argsref->{flag} = $flagref;\n>      return bless $argsref, $class;\n> @@ -421,8 +423,6 @@\n>  sub print_c_source_top {\n>      my $self = shift;\n>      $self->{defines}      = $self->{trans}->defines();          # Invoked as:  ${defines}\n> -    $self->{bs}           = \"$self->{base}$self->{suffix}_\";    # Also invoked as ${bs}\n> -    $self->{opsarraytype} = $self->{trans}->opsarraytype();\n> \n>      ##### BEGIN printing to $SOURCE #####\n>      open my $SOURCE, '>', $self->{source}\n> \n\nFortunately, this had no negative impact on test coverage:\n\nhttp://thenceforward.net/parrot/coverage/configure-build/lib-Parrot-Ops2c-Utils-pm.html\n\n"}