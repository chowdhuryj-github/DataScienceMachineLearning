{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "toby909@gmail.com", "subject": "[R] gls() error", "body": "Hi All\n\nHow can I fit a repeated measures analysis using gls? I want to start with a \nunstructured correlation structure, as if the the measures at the occations are \nnot longitudinal (no AR) but plainly multivariate (corSymm).\n\nMy data (ignore the prox_pup and gender, occ means occasion):\n > head(dta,12)\n    teacher occ prox_self prox_pup gender\n1        1   0      0.76     0.41      1\n2        1   1      1.00     1.05      1\n3        1   3      0.81     0.91      1\n4        2   0      0.96     0.64      0\n5        3   0      1.12     1.13      1\n6        3   2      1.34     1.35      1\n7        4   1      0.35    -0.40      0\n8        4   2      0.25     0.27      0\n9        4   3      0.54     0.26      0\n10       5   0      0.65     1.02      1\n11       5   1      0.68     0.87      1\n12       5   2      1.04     0.98      1\n\n\nx=factor(dta$occ)\n\nFollowing gives me an error message:\n\ngls(prox_pup~x-1, dta, corSymm(, ~x-1|teacher))\n > gls(prox_pup~x-1, dta, corSymm(, ~x-1|teacher))\nError in Initialize.corSymm(X[[1]], ...) :\n         Covariate must have unique values within groups for corSymm objects\nIn addition: There were 50 or more warnings (use warnings() to see the first 50)\n\nI checked that the covariate, occ, has unique values within each of the teachers.\n\nAside, lme actually gives me what I want, except that the residual variance is \nnot where I want to have it. I want the residuals being part of the covariance \nmatrix to be estimated rather than in the 'level one' residual, ie the residuals \nincluded on the diagonal of \"G\" displayed below.\n\n > a4 = lme(prox_pup~x-1, dta, ~x-1|teacher)\nLinear mixed-effects model fit by REML\n   Data: dta\n   Log-restricted-likelihood: -53.91059\n   Fixed: prox_pup ~ x - 1\n        x0        x1        x2        x3\n0.5739072 0.7169963 0.6503699 0.6567064\n\nRandom effects:\n  Formula: ~x - 1 | teacher\n  Structure: General positive-definite, Log-Cholesky parametrization\n          StdDev    Corr\nx0       0.5424187 x0    x1    x2\nx1       0.4326164 0.739\nx2       0.3343281 0.611 0.681\nx3       0.3638630 0.569 0.752 0.900\nResidual 0.0929820\n\nNumber of Observations: 153\nNumber of Groups: 51\n\n > G = lapply(pdMatrix(a4$modelStruct$reStruct), \"*\", a4$sigma^2)\n$teacher\n           x0         x1         x2        x3\nx0 0.2942180 0.17330375 0.11089028 0.1123597\nx1 0.1733037 0.18715693 0.09847681 0.1183089\nx2 0.1108903 0.09847681 0.11177526 0.1094374\nx3 0.1123597 0.11830892 0.10943738 0.1323963\n\n\n\nThanks for your help on this.\n\nToby\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}