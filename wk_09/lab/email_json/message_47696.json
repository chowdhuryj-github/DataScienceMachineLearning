{"category": "ham", "to_address": "James Peach <jpeach@samba.org>", "from_address": "Andrew Bartlett <abartlet@samba.org>", "subject": "Re: kerberos auth account restrictions", "body": "On Wed, 2007-06-13 at 12:27 -0700, James Peach wrote:\n> On Jun 13, 2007, at 11:06 AM, Volker Lendecke wrote:\n> \n> > On Wed, Jun 13, 2007 at 11:04:03AM -0700, James Peach wrote:\n> >> Is there a good reason that we don't do this for Kerberos auth in\n> >> reply_spnego_kerberos()?\n> >\n> > Others (the DC) decide over that. When we look at the SAM,\n> > we're the boss. For Kerberos or sec=domain we don't even\n> > have that info.\n> \n> Hmmm. In both these cases, smbd manually creates a struct samu from  \n> the auth information without hitting the passdb backend. In the  \n> Kerberos case, it only does this if PAC information was included.\n> \n> The context of this is that I have a local account lockout mechanism  \n> that I need to support and it needs to work for all auth types. If the  \n> Kerberos auth path did a pdb_getsampwnam and checked ACB_AUTOLOCK,  \n> then I could hide this all in my passdb module.\n> \n> Do you have any suggestions how I could do this? I'd rather not add a  \n> system-specific check into the main code path if I don't have to.\n\nWrite a PAM module? :-)\n\nAndrew Bartlett\n-- \nAndrew Bartlett\nhttp://samba.org/~abartlet/\nAuthentication Developer, Samba Team           http://samba.org\nSamba Developer, Red Hat Inc.\n\n"}