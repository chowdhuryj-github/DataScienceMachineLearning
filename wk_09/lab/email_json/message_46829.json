{"category": "ham", "to_address": "\"'Patrick Wang'\" <pwang@berkeley.edu>,\n   \"'Bert Gunter'\" <gunter.berton@gene.com>", "from_address": "\"Ravi Varadhan\" <rvaradhan@jhmi.edu>", "subject": "Re: [R] how to find how many modes in 2 dimensions case", "body": "Hi Patrick,\n\nHere is a simple R code for locating ALL the local maximum of a bivariate\nfunction, which is known on a rectangular grid.  I have illustrated it with\na function called the Branin function, which is commonly used as a test\nfunction in the global optimization literature.  It has 6 local maxima, two\nof which are global.  \n\nbranin <- function(x1,x2,p) {\np[1] * x1^2 + p[2]*x1^4 + p[3]*x1^6 - x1*x2 + p[4]*x2^2 + p[5]*x2^4\n}\n\nx <- seq(-2, 2, length=100)\ny <- seq(-1, 1, length=100)\np <- c(-4, 2.1, -1/3, 4, -4)\nz <- outer(x, y, branin,p=p)\npersp(x, y, z, theta=30, phi=30, col=\"lightblue\")\n\n#  here is a brute-force algorithm to locate ALL the local maxima\nfor (i in 2:(nrow(z)-1) ) {\nfor (j in 2:(ncol(z)-1) ) {\nlmax <- (z[i,j] > z[i-1,j]) & (z[i,j] > z[i+1,j]) & (z[i,j] > z[i,j-1]) &\n(z[i,j] > z[i,j+1])\nif(lmax) cat(\"x: \",x[i], \"y: \", y[j], \"function: \", z[i,j], \"\\n\")\n} \n}\n\nx:  -1.72 y:  0.798 function:  0.214 \nx:  -1.60 y:  -0.576 function:  -2.10 \nx:  -0.101 y:  0.717 function:  1.03 \nx:  0.101 y:  -0.717 function:  1.03 \nx:  1.60 y:  0.576 function:  -2.10 \nx:  1.72 y:  -0.798 function:  0.214\n\nOf course, this brute-force grid search is highly inefficient for dimensions\ngreater than 2.\n\nHope this is helpful,\nRavi.\n\n\n----------------------------------------------------------------------------\n-------\n\nRavi Varadhan, Ph.D.\n\nAssistant Professor, The Center on Aging and Health\n\nDivision of Geriatric Medicine and Gerontology \n\nJohns Hopkins University\n\nPh: (410) 502-2619\n\nFax: (410) 614-9625\n\nEmail: rvaradhan@jhmi.edu\n\nWebpage:  http://www.jhsph.edu/agingandhealth/People/Faculty/Varadhan.html\n\n \n\n----------------------------------------------------------------------------\n--------\n\n-----Original Message-----\nFrom: r-help-bounces@stat.math.ethz.ch\n[mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Patrick Wang\nSent: Friday, June 08, 2007 3:35 PM\nTo: Bert Gunter\nCc: r-help@stat.math.ethz.ch\nSubject: Re: [R] how to find how many modes in 2 dimensions case\n\nThanks for the reply,\n\nmaybe I shall say bumps, I can use persp to show a density on a X Y\ndimensions.\none peak is one mode I think. I try to find an automatic way to detect how\nmany peaks of the densities.\n\nPat\n> Note that \"the number of modes\" (local maxima??)  is a function of the\n> bandwidth, so I'm not sure your question is even meaningful.\n>\n> Bert Gunter\n> Genentech Nonclinical Statistics\n> South San Francisco, CA 94404\n> 650-467-7374\n>\n> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch\n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Patrick Wang\n> Sent: Friday, June 08, 2007 11:54 AM\n> To: R-help@stat.math.ethz.ch\n> Subject: [R] how to find how many modes in 2 dimensions case\n>\n> Hi,\n>\n> Does anyone know how to count the number of modes in 2 dimensions using\n> kde2d function?\n>\n> Thanks\n> Pat\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}