{"category": "ham", "to_address": "samba-tech <samba-technical@lists.samba.org>", "from_address": "Ignacio Coupeau <icoupeau@unav.es>", "subject": "[CTDB and GFS] some troubles joining domain", "body": "I'm building a cluster with CTDB and GFS/SAN/LB with three RH5 IBM \nxSeries ~346\n\tcman-2.0.64-1.el5\n\t2.6.18-8.1.6.el5\n\tkmod-gfs-0.1.16-5.2.6.18_8.el5\n\nThe filesystems are gfs1 because we encountered some troubles with the \ngfs2 in our scenario.\n\nThe installation was fine (from Jun 26 10:45 CEST)\n\trsync -avz samba.org::ftp/unpacked/samba_3_0_ctdb .\n\trsync -avz samba.org::ftp/unpacked/ctdb .\n\t\nOur plan is test the shares with users in the domain, so the smb.conf:\n\t...\n\tnetbios name = [piedra|papel|tijera]\n\tworkgroup = UNAV-PDC-01\n\t...\n\tsecurity = domain\n\tpassword server = pdc10\n\t...\n\tclustering = yes\n\tidmap backend = tdb2\n\tprivate dir = /usr/local/etc/users_1/clu\n\t...\n\nThe three nodes have an new freshly account in the PDC (as matter of \nfact, we have about 3500 machines in the domain with LDAP so, this not \nthe point).\n\nThe problem is that:\n\tbin/net rpc join\nreturns always, in all three machines: \"Segmentation fault\".\nHowever, I think the account in the LDAP/PDC side are wrote well \n(sambaSamAccount, sambaNTPassword, sambaPwdLastSet, sambaSID et al).\n\nSome help/idea/point/track?\nThanks in advance,\n\nIgnacio\n\n--------------------------------------------\na tail (sorry, long) of the --debug=4 output:\n--------------------------------------------\n[2007/06/26 19:03:18, 4] libsmb/nmblib.c:debug_nmb_packet(112)\n   nmb packet from 159.237.12.52(137) header: id=9373 opcode=Query(0) \nresponse=Yes\n       header: flags: bcast=No rec_avail=Yes rec_des=Yes trunc=No auth=Yes\n       header: rcode=0 qdcount=0 ancount=1 nscount=0 arcount=0\n       answers: nmb_name=UNAV-PDC-01<1b> rr_type=32 rr_class=1 ttl=0\n       answers   0 char `.....   hex 60009FED0C8C\n[2007/06/26 19:03:18, 2] libsmb/namequery.c:name_query(604)\n   Got a positive name query response from 159.237.12.52 ( 159.237.12.140 )\n[2007/06/26 19:03:18, 4] libsmb/nmblib.c:debug_nmb_packet(112)\n   nmb packet from 159.237.12.140(137) header: id=26280 opcode=Query(0) \nresponse=Yes\n       header: flags: bcast=No rec_avail=No rec_des=No trunc=No auth=Yes\n       header: rcode=0 qdcount=0 ancount=1 nscount=0 arcount=0\n       answers: nmb_name=UNAV-PDC-01<1b> rr_type=33 rr_class=1 ttl=0\n       answers   0 char .PDC10             hex \n09504443313020202020202020202020\n       answers  10 char .d.PDC10           hex \n00640050444331302020202020202020\n       answers  20 char   .d.PDC10         hex \n20200364005044433130202020202020\n       answers  30 char      d...__MSBRO   hex \n2020202020640001025F5F4D5342524F\n       answers  40 char WSE__....UNAV-PD   hex \n5753455F5F0201E400554E41562D5044\n       answers  50 char C-01    .d.UNAV-   hex \n432D3031202020201D6400554E41562D\n       answers  60 char PDC-01    .d.UNA   hex \n5044432D3031202020201B6400554E41\n       answers  70 char V-PDC-01    ...U   hex \n562D5044432D3031202020201CE40055\n       answers  80 char NAV-PDC-01    ..   hex \n4E41562D5044432D3031202020201EE4\n       answers  90 char .UNAV-PDC-01       hex \n00554E41562D5044432D303120202020\n       answers  a0 char ................   hex \n00E40000000000000000000000000000\n       answers  b0 char ................   hex \n00000000000000000000000000000000\n       answers  c0 char ................   hex \n00000000000000000000000000000000\n       answers  d0 char .   hex 00\n[2007/06/26 19:03:18, 3] libsmb/cliconnect.c:cli_start_connection(1502)\n   Connecting to host=PDC10\n[2007/06/26 19:03:18, 3] lib/util_sock.c:open_socket_out(920)\n   Connecting to 159.237.12.140 at port 445\n[2007/06/26 19:03:18, 3] rpc_client/cli_pipe.c:rpc_pipe_bind(2081)\n   rpc_pipe_bind: Remote machine PDC10 pipe \\lsarpc fnum 0x75f6 bind \nrequest returned ok.\n[2007/06/26 19:03:18, 3] rpc_client/cli_pipe.c:rpc_pipe_bind(2081)\n   rpc_pipe_bind: Remote machine PDC10 pipe \\NETLOGON fnum 0x75f7 bind \nrequest returned ok.\n[2007/06/26 19:03:18, 4] rpc_client/cli_netlogon.c:rpccli_net_req_chal(46)\n   cli_net_req_chal: LSA Request Challenge from PIEDRA to \\\\PDC10\n[2007/06/26 19:03:18, 4] rpc_client/cli_netlogon.c:rpccli_net_auth2(170)\n   cli_net_auth2: srv:\\\\PDC10 acct:PIEDRA$ sc:2 mc: PIEDRA neg: 701ff\n[2007/06/26 19:03:18, 4] \nrpc_client/cli_netlogon.c:rpccli_net_srv_pwset(1059)\n   cli_net_srv_pwset: srv:\\\\PDC10 acct:PIEDRA$ sc: 2 mc: PIEDRA\n[2007/06/26 19:03:18, 3] \nlibsmb/trusts_util.c:trust_pw_change_and_store_it(102)\n   2007/06/26 19:03:18 : trust_pw_change_and_store_it: Changed password.\nSegmentation fault\n\n\n\n-- \n________________________________________________________\nDr. Ignacio Coupeau\nSystems and Network Services Director\nIT Services\nUniversity of Navarra           http://www.unav.edu/\nPamplona, SPAIN                 http://www.unav.es/SI/\n\n"}