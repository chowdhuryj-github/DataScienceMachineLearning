{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Steven McKinney\" <smckinney@bccrc.ca>", "subject": "[R] Design matrix question", "body": "\nHi useRs,\n\nPerhaps I am having a senior moment?\n\nI have a nested variable situation to model,\n\ntoy example:\n\n\n> df <- data.frame(A = factor(c(\"a\", \"a\", \"x\", \"x\"), levels = c(\"x\", \"a\")),\n+                  B = factor(c(\"b\", \"x\", \"x\", \"x\"), levels = c(\"x\", \"b\")))\n> \n> df\n  A B\n1 a b\n2 a x\n3 x x\n4 x x\n\nSo of course the full design matrix is singular\n\n> model.matrix(~ A * B, df)\n  (Intercept) Aa Bb Aa:Bb\n1           1  1  1     1\n2           1  1  0     0\n3           1  0  0     0\n4           1  0  0     0\nattr(,\"assign\")\n[1] 0 1 2 3\nattr(,\"contrasts\")\nattr(,\"contrasts\")$A\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$B\n[1] \"contr.treatment\"\n\n\nI'd like not to have the B term main effect in the model\n\n> model.matrix(~ A * B - B, df)\n  (Intercept) Aa Ax:Bb Aa:Bb\n1           1  1     0     1\n2           1  1     0     0\n3           1  0     0     0\n4           1  0     0     0\nattr(,\"assign\")\n[1] 0 1 2 2\nattr(,\"contrasts\")\nattr(,\"contrasts\")$A\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$B\n[1] \"contr.treatment\"\n\n> \n\nHow do I get model.matrix to not add that\ncolumn of zeroes?\n\nWhy does model.matrix add that column of zeroes?\n\nIs this a bug, or a senior moment?\n\n\n\n\n\nSteven McKinney\n\nStatistician\nMolecular Oncology and Breast Cancer Program\nBritish Columbia Cancer Research Centre\n\nemail: smckinney@bccrc.ca\n\ntel: 604-675-8000 x7561\n\nBCCRC\nMolecular Oncology\n675 West 10th Ave, Floor 4\nVancouver B.C. \nV5Z 1L3\nCanada\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}