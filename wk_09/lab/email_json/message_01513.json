{"category": "ham", "to_address": "John Fox <jfox@mcmaster.ca>", "from_address": "John Smith <ld7631@yahoo.com>", "subject": "Re: [R] sem vs. LISREL: sem fails", "body": "Dear Scott, thanks a lot - all your comments are extremely valuable!\nOne quick follow-up question - the thing is, I was really trying to compare sem and LISREL solutions, which is why I was trying to specify exactly the same model. Hence, I'd prefer to stick to the Var-Covar matrix, rather than Correlation matrix. Also, I really like fixing the metric for latent variables along the metric of one of the observed variables - just for practical and didactical reasons (although I'll try to run your suggestion as well - in both sem and LISREL).\nAny advice/guidance on picking the starting values for sem if I still want to estimate my original model or run into a similar problem in the future? I know how to do it (in terms of entering something else but NA in the last column) - but what starting values should I pick?\nThanks a lot again for your help!\nDimitri\n\n\n----- Original Message ----\nFrom: John Fox \nTo: John Smith \nCc: r-help@stat.math.ethz.ch\nSent: Monday, April 9, 2007 9:46:03 PM\nSubject: RE: [R] sem vs. LISREL: sem fails\n\n\nDear Dimitri,\n\nYou haven't done anything wrong: Your model is a straightforward\nconfirmatory factor analysis and it is correctly specified. I suspect that\nsem() is picking poor start values.\n\nI can get a solution by specifying two alternative models that are\nequivalent to yours:\n\n(1) Rescaling the problem by using correlation-matrix input:\n\nsem.anxiety <- sem(model, KM, N=150)\n\n(2) Fixing the variances of the factors (latent variables) rather than using\nreference indicators:\n\nmodel.2 <- specify.model()\nANXIETY -> a1,      lam_anx_1,  NA\nANXIETY -> a2,      lam_anx_2,  NA\nANXIETY -> a3,      lam_anx_3,  NA\nDEPRESS -> d1,      lam_dep_1,  NA\nDEPRESS -> d2,      lam_dep_2,  NA\nDEPRESS -> d3,      lam_dep_3,  NA\nFEAR -> f1,         lam_fear_1, NA\nFEAR -> f2,         lam_fear_2, NA\nFEAR -> f3,         lam_fear_3, NA\na1 <-> a1,          theta_a1,   NA\na2 <-> a2,          theta_a2,   NA\na3 <-> a3,          theta_a3,   NA\nd1 <-> d1,          theta_d1,   NA\nd2 <-> d2,          theta_d2,   NA\nd3 <-> d3,          theta_d3,   NA\nf1 <-> f1,          theta_f1,   NA\nf2 <-> f2,          theta_f2,   NA\nf3 <-> f3,          theta_f3,   NA\nANXIETY <-> ANXIETY,NA,         1\nDEPRESS <-> DEPRESS,NA,         1\nFEAR <-> FEAR,      NA,         1\nANXIETY <-> FEAR,   phi_AF,     NA\nANXIETY <-> DEPRESS,phi_AD,     NA\nDEPRESS <-> FEAR,   phi_DF,     NA\n\n# Running the estimation using sem:\nsem.anxiety.2 <- sem(model.2, COVAR, N=150)\n\n\nA couple of small points unrelated to the problem you experienced: (1) You\ndidn't need to load the MASS package, since you didn't appear to use\nanything in it; (2) comments in R are prefixed by #, not !.\n\nI hope this helps,\nJohn\n\n--------------------------------\nJohn Fox\nDepartment of Sociology\nMcMaster University\nHamilton, Ontario\nCanada L8S 4M4\n905-525-9140x23604\nhttp://socserv.mcmaster.ca/jfox \n-------------------------------- \n\n> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch \n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of John Smith\n> Sent: Monday, April 09, 2007 5:28 PM\n> To: r-help@stat.math.ethz.ch\n> Subject: [R] sem vs. LISREL: sem fails\n> \n> I am new to R. \n> I just tried to recreate in R (using sem package and the \n> identical input data) a solution for a simple measurment \n> model I have found before in LISREL. LISREL had no problems \n> and converged in just 3 iterations. \n> In sem, I got no solution, just the warning message:\n> \n> \"Could not compute QR decomposition of Hessian.\n> Optimization probably did not converge.\n>  in: sem.default(ram = ram, S = S, N = N, param.names = pars, \n> var.names = vars, \"\n> \n> What does it mean? Maybe I am doing something wrong?\n> \n> I have 3 latent factors (Anxiety, Depression, and Fear) - \n> each of them has 3 observed indicators (a1, a2, a3; d1, d2, \n> d3, and f1, f2, f3) Below is my script in R:\n> \n> ! ANALYSIS OF ANXIETY, DEPRESSION, AND FEAR - LISREL P.31\n> \n> ! Creating the ANXIETY, DEPRESSION, AND FEAR intercorrelation \n> matrix (KM):\n> KM<-matrix(\n> c(1,.8,.83,.2,.21,.19,.18,.18,.18,\n> 0,1,.81,.22,.24,.18,.19,.19,.21,\n> 0,0,1,.22,.19,.2,.2,.2,.22,\n> 0,0,0,1,.84,.82,.22,.22,.21,\n> 0,0,0,0,1,.84,.19,.18,.19,\n> 0,0,0,0,0,1,.18,.18,.18,\n> 0,0,0,0,0,0,1,.84,.82,\n> 0,0,0,0,0,0,0,1,.81,\n> 0,0,0,0,0,0,0,0,1), 9, 9)\n> \n> ! Creating the ANXIETY, DEPRESSION, AND FEAR Standard \n> Deviations vector (SD):\n> SD<-c(1.5, 2.4, 3.2, 2.3, 2.3, 2.6, 4.5, 4.7, 5.6)\n> \n> ! Calculating the Var-Covar matrix based on correlations and SDs:\n> library(MASS)\n> COVAR<-outer(SD, SD) * KM\n> \n> ! Creating variable names\n> rownames(COVAR)<-colnames(COVAR)<-c('a1','a2','a3','d1','d2','\n> d3','f1','f2','f3')\n> \n> ! Specifying the measurement model to estimate:\n> model<-specify.model()\n> ANXIETY -> a1,     NA, 1\n> ANXIETY -> a2,     lam_anx_2, NA \n> ANXIETY -> a3,     lam_anx_3, NA\n> DEPRESS -> d1,     NA, 1\n> DEPRESS -> d2,     lam_dep_2, NA\n> DEPRESS -> d3,     lam_dep_3, NA\n> FEAR -> f1,             NA, 1\n> FEAR -> f2,             lam_fear_2, NA\n> FEAR -> f3,             lam_fear_3, NA\n> a1 <-> a1,                theta_a1, NA\n> a2 <-> a2,                theta_a2, NA\n> a3 <-> a3,                theta_a3, NA\n> d1 <-> d1,               theta_d1, NA\n> d2 <-> d2,               theta_d2, NA\n> d3 <-> d3,               theta_d3, NA\n> f1 <-> f1,                 theta_f1, NA\n> f2 <-> f2,                 theta_f2, NA\n> f3 <-> f3,                 theta_f3, NA\n> ANXIETY <-> ANXIETY,   phi_AA, NA\n> DEPRESS <-> DEPRESS,     phi_DD, NA\n> FEAR <-> FEAR,                  phi_FF, NA\n> ANXIETY <-> FEAR,           phi_AF, NA\n> ANXIETY <-> DEPRESS,    phi_AD, NA\n> DEPRESS <-> FEAR,            phi_DF, NA\n> \n> ! Running the estimation using sem:\n> sem.anxiety<-sem(model, COVAR, N=150)\n> \n> Thank you very much for your advice!\n> Dimitri\n> \n> \n>  \n> ______________________________________________________________\n> ______________________\n> \n> \n> \n>     [[alternative HTML version deleted]]\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide \n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n\n\n \n____________________________________________________________________________________\n\n\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}