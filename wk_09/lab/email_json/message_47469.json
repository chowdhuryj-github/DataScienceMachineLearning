{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jpeach@samba.org", "subject": "svn commit: samba r23473 - in branches/SAMBA_3_0_26/source/lib: .", "body": "Author: jpeach\nDate: 2007-06-13 20:45:55 +0000 (Wed, 13 Jun 2007)\nNew Revision: 23473\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23473\n\nLog:\nMerge Merge branches/SAMBA_3_0@23470\n\nFix supplementary group list truncation for *BSD. We need to pass\nthe correct group list length and only truncate to NGROUPS_MAX if\nit is too long.\n\nModified:\n   branches/SAMBA_3_0_26/source/lib/system.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0_26/source/lib/system.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/lib/system.c\t2007-06-13 20:43:49 UTC (rev 23472)\n+++ branches/SAMBA_3_0_26/source/lib/system.c\t2007-06-13 20:45:55 UTC (rev 23473)\n@@ -1018,10 +1018,16 @@\n \t\tsetlen++;\n \t}\n \n+\tif (setlen > max) {\n+\t\tDEBUG(10, (\"forced to truncate group list from %d to %d\\n\",\n+\t\t\tsetlen, max));\n+\t\tsetlen = max;\n+\t}\n+\n #if defined(BROKEN_GETGROUPS)\n-\tret = sys_broken_setgroups(max, new_gidset ? new_gidset : gidset);\n+\tret = sys_broken_setgroups(setlen, new_gidset ? new_gidset : gidset);\n #else\n-\tret = setgroups(max, new_gidset ? new_gidset : gidset);\n+\tret = setgroups(setlen, new_gidset ? new_gidset : gidset);\n #endif\n \n \tif (new_gidset) {\n\n"}