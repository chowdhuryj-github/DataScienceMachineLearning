{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r23344 - in branches: SAMBA_3_0/source/lib\n\tSAMBA_3_0_26/source/lib", "body": "Author: vlendec\nDate: 2007-06-04 19:50:30 +0000 (Mon, 04 Jun 2007)\nNew Revision: 23344\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23344\n\nLog:\nBetter error message\n\nModified:\n   branches/SAMBA_3_0/source/lib/messages_local.c\n   branches/SAMBA_3_0_26/source/lib/messages_local.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/lib/messages_local.c\n===================================================================\n--- branches/SAMBA_3_0/source/lib/messages_local.c\t2007-06-04 19:45:41 UTC (rev 23343)\n+++ branches/SAMBA_3_0/source/lib/messages_local.c\t2007-06-04 19:50:30 UTC (rev 23344)\n@@ -93,9 +93,11 @@\n \t\t\t   O_RDWR|O_CREAT,0600);\n \n \tif (!tdb) {\n-\t\tDEBUG(0,(\"ERROR: Failed to initialise messages database\\n\"));\n+\t\tNTSTATUS status = map_nt_error_from_unix(errno);\n+\t\tDEBUG(0, (\"ERROR: Failed to initialise messages database: \"\n+\t\t\t  \"%s\\n\", strerror(errno)));\n \t\tTALLOC_FREE(result);\n-\t\treturn NT_STATUS_INTERNAL_DB_CORRUPTION;\n+\t\treturn status;\n \t}\n \n \tsec_init();\n\nModified: branches/SAMBA_3_0_26/source/lib/messages_local.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/lib/messages_local.c\t2007-06-04 19:45:41 UTC (rev 23343)\n+++ branches/SAMBA_3_0_26/source/lib/messages_local.c\t2007-06-04 19:50:30 UTC (rev 23344)\n@@ -93,9 +93,11 @@\n \t\t\t   O_RDWR|O_CREAT,0600);\n \n \tif (!tdb) {\n-\t\tDEBUG(0,(\"ERROR: Failed to initialise messages database\\n\"));\n+\t\tNTSTATUS status = map_nt_error_from_unix(errno);\n+\t\tDEBUG(0, (\"ERROR: Failed to initialise messages database: \"\n+\t\t\t  \"%s\\n\", strerror(errno)));\n \t\tTALLOC_FREE(result);\n-\t\treturn NT_STATUS_INTERNAL_DB_CORRUPTION;\n+\t\treturn status;\n \t}\n \n \tsec_init();\n\n"}