{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "gd@samba.org", "subject": "svn commit: samba r22798 - in branches: SAMBA_3_0/source/include\n\tSAMBA_3_0/source/libads SAMBA_3_0_26/source/include\n\tSAMBA_3_0_26/source/libads", "body": "Author: gd\nDate: 2007-05-11 12:59:16 +0000 (Fri, 11 May 2007)\nNew Revision: 22798\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22798\n\nLog:\nAdd the \"apply group policy\" access bit (as seen in type 0x05 ALLOWED OBJECT\nACEs).\n\nGuenther\n\nModified:\n   branches/SAMBA_3_0/source/include/rpc_secdes.h\n   branches/SAMBA_3_0/source/libads/disp_sec.c\n   branches/SAMBA_3_0_26/source/include/rpc_secdes.h\n   branches/SAMBA_3_0_26/source/libads/disp_sec.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/include/rpc_secdes.h\n===================================================================\n--- branches/SAMBA_3_0/source/include/rpc_secdes.h\t2007-05-11 12:52:48 UTC (rev 22797)\n+++ branches/SAMBA_3_0/source/include/rpc_secdes.h\t2007-05-11 12:59:16 UTC (rev 22798)\n@@ -38,6 +38,7 @@\n #define SEC_RIGHTS_EXTENDED\t\t0x100 /* change/reset password, receive/send as*/\n #define\tSEC_RIGHTS_CHANGE_PASSWD\tSEC_RIGHTS_EXTENDED\n #define\tSEC_RIGHTS_RESET_PASSWD\t\tSEC_RIGHTS_EXTENDED\n+#define SEC_RIGHTS_APPLY_GROUP_POLICY\tSEC_RIGHTS_EXTENDED\n #define SEC_RIGHTS_FULL_CTRL\t\t0xf01ff\n \n #define SEC_ACE_OBJECT_PRESENT           0x00000001 /* thanks for Jim McDonough  */\n\nModified: branches/SAMBA_3_0/source/libads/disp_sec.c\n===================================================================\n--- branches/SAMBA_3_0/source/libads/disp_sec.c\t2007-05-11 12:52:48 UTC (rev 22797)\n+++ branches/SAMBA_3_0/source/libads/disp_sec.c\t2007-05-11 12:59:16 UTC (rev 22798)\n@@ -46,6 +46,9 @@\n \n \t{SEC_RIGHTS_CHANGE_PASSWD,\t\"[Change Password]\"},\t\n \t{SEC_RIGHTS_RESET_PASSWD,\t\"[Reset Password]\"},\n+\n+\t{SEC_RIGHTS_APPLY_GROUP_POLICY,\t\"[Apply Group Policy]\"},\n+\n \t{0,\t\t\t\t0}\n };\n \n@@ -66,7 +69,7 @@\n \t\tif (type & (1 << i)) {\n \t\t\tfor (j = 1; perms[j].str; j ++) {\n \t\t\t\tif (perms[j].mask == (((unsigned) 1) << i)) {\n-\t\t\t\t\tprintf(\"\\n\\t%s\", perms[j].str);\n+\t\t\t\t\tprintf(\"\\n\\t%s (0x%08x)\", perms[j].str, perms[j].mask);\n \t\t\t\t}\t\n \t\t\t}\n \t\t\ttype &= ~(1 << i);\n\nModified: branches/SAMBA_3_0_26/source/include/rpc_secdes.h\n===================================================================\n--- branches/SAMBA_3_0_26/source/include/rpc_secdes.h\t2007-05-11 12:52:48 UTC (rev 22797)\n+++ branches/SAMBA_3_0_26/source/include/rpc_secdes.h\t2007-05-11 12:59:16 UTC (rev 22798)\n@@ -38,6 +38,7 @@\n #define SEC_RIGHTS_EXTENDED\t\t0x100 /* change/reset password, receive/send as*/\n #define\tSEC_RIGHTS_CHANGE_PASSWD\tSEC_RIGHTS_EXTENDED\n #define\tSEC_RIGHTS_RESET_PASSWD\t\tSEC_RIGHTS_EXTENDED\n+#define SEC_RIGHTS_APPLY_GROUP_POLICY\tSEC_RIGHTS_EXTENDED\n #define SEC_RIGHTS_FULL_CTRL\t\t0xf01ff\n \n #define SEC_ACE_OBJECT_PRESENT           0x00000001 /* thanks for Jim McDonough  */\n\nModified: branches/SAMBA_3_0_26/source/libads/disp_sec.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/libads/disp_sec.c\t2007-05-11 12:52:48 UTC (rev 22797)\n+++ branches/SAMBA_3_0_26/source/libads/disp_sec.c\t2007-05-11 12:59:16 UTC (rev 22798)\n@@ -46,6 +46,9 @@\n \n \t{SEC_RIGHTS_CHANGE_PASSWD,\t\"[Change Password]\"},\t\n \t{SEC_RIGHTS_RESET_PASSWD,\t\"[Reset Password]\"},\n+\n+\t{SEC_RIGHTS_APPLY_GROUP_POLICY,\t\"[Apply Group Policy]\"},\n+\n \t{0,\t\t\t\t0}\n };\n \n@@ -66,7 +69,7 @@\n \t\tif (type & (1 << i)) {\n \t\t\tfor (j = 1; perms[j].str; j ++) {\n \t\t\t\tif (perms[j].mask == (((unsigned) 1) << i)) {\n-\t\t\t\t\tprintf(\"\\n\\t%s\", perms[j].str);\n+\t\t\t\t\tprintf(\"\\n\\t%s (0x%08x)\", perms[j].str, perms[j].mask);\n \t\t\t\t}\t\n \t\t\t}\n \t\t\ttype &= ~(1 << i);\n\n"}