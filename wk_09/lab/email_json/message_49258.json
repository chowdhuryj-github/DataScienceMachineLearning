{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Jiao Yang <yj316@gwu.edu>", "subject": "[R] mardia's test", "body": "In the R code of Mardia's test, what does the line \" x1 = x[x[, p] == i, -p]\" mean?  Thanks a lot!\n\nfunction (x) \n{\n    p = dim(x)[2]\n    f = p - 1\n    clases = length(table(x[, p]))\n    for (i in 1:clases) {\n        x1 = x[x[, p] == i, -p]\n\n\n\n        ndat = dim(x1)[1]\n        mo3 = mo3(x1)\n        mard1 = ndat * mo3/6\n        cat(\"Mardia's test for class\", i, \"\\n\")\n        cat(\"mard1=\", mard1, \"\\n\")\n        p1 = 1 - pchisq(mard1, df = f * (f + 1) * (f + 2)/6)\n        cat(\"pvalue for m3=\", p1, \"\\n\")\n        mo4 = mo4(x1)\n        mard2 = (mo4 - f * (f + 2))/sqrt(8 * f * (f + 2)/ndat)\n        cat(\"mard2=\", mard2, \"\\n\")\n        p2 = 2 * (1 - pnorm(abs(mard2)))\n        cat(\"p-value for m4=\", p2, \"\\n\")\n        if (p1 < 0.05 || p2 < 0.05) \n            cat(\"There is not statistical evidence for normality in class\", \n                i, \"\\n\")\n        else cat(\"There is statistical evidence for normality\", \n            \"\\n\")\n    }\n}\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}