{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22758 - in branches/SAMBA_4_0/source/lib/talloc:\n\t.", "body": "Author: metze\nDate: 2007-05-08 09:54:01 +0000 (Tue, 08 May 2007)\nNew Revision: 22758\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22758\n\nLog:\n- add missing _talloc_set_name_const(ret, ret); to talloc_append_string()\n- update manpage and add comments about _talloc_set_name_const(ret, ret);\n  in all places which use them\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/lib/talloc/talloc.3.xml\n   branches/SAMBA_4_0/source/lib/talloc/talloc.c\n   branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/lib/talloc/talloc.3.xml\n===================================================================\n--- branches/SAMBA_4_0/source/lib/talloc/talloc.3.xml\t2007-05-08 08:49:52 UTC (rev 22757)\n+++ branches/SAMBA_4_0/source/lib/talloc/talloc.3.xml\t2007-05-08 09:54:01 UTC (rev 22758)\n@@ -583,11 +583,27 @@\n         \ntalloc_set_name_const(ptr, ptr)\n\n+    char *talloc_append_string(const void *t, char *orig, const char *append);\n+        \n+\t  The talloc_append_string() function appends the given formatted\n+\t  string to the given string.\n+        \n+        \n+\t  This function sets the name of the new pointer to the new\n+\t  string. This is equivalent to:\n+        \n+        talloc_set_name_const(ptr, ptr)\n+    \nchar *talloc_vasprintf(const void *t, const char *fmt, va_list ap);\n\n \t  The talloc_vasprintf() function is the talloc equivalent of the C\n \t  library function vasprintf(3).\n         \n+        \n+\t  This function sets the name of the new pointer to the new\n+\t  string. This is equivalent to:\n+        \n+        talloc_set_name_const(ptr, ptr)\n\nchar *talloc_asprintf(const void *t, const char *fmt, ...);\n\n@@ -605,6 +621,11 @@\n \t  The talloc_asprintf_append() function appends the given formatted\n \t  string to the given string.\n         \n+        \n+\t  This function sets the name of the new pointer to the new\n+\t  string. This is equivalent to:\n+        \n+        talloc_set_name_const(ptr, ptr)\n\n(type *)talloc_array(const void *ctx, type, uint_t count);\n\n\nModified: branches/SAMBA_4_0/source/lib/talloc/talloc.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/talloc/talloc.c\t2007-05-08 08:49:52 UTC (rev 22757)\n+++ branches/SAMBA_4_0/source/lib/talloc/talloc.c\t2007-05-08 09:54:01 UTC (rev 22758)\n@@ -1137,6 +1137,8 @@\n \t/* append the string with the trailing \\0 */\n \tmemcpy(&ret[olen], append, alenz);\n \n+\t_talloc_set_name_const(ret, ret);\n+\n \treturn ret;\n }\n \n\nModified: branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\n===================================================================\n--- branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\t2007-05-08 08:49:52 UTC (rev 22757)\n+++ branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\t2007-05-08 09:54:01 UTC (rev 22758)\n@@ -533,21 +533,34 @@\n string. This is equivalent to:\n    talloc_set_name_const(ptr, ptr)\n \n+=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n+char *talloc_append_string(const void *t, char *orig, const char *append);\n \n+The talloc_append_string() function appends the given formatted\n+string to the given string.\n+\n+This function sets the name of the new pointer to the new\n+string. This is equivalent to:\n+   talloc_set_name_const(ptr, ptr)\n+\n =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n char *talloc_vasprintf(const void *t, const char *fmt, va_list ap);\n \n The talloc_vasprintf() function is the talloc equivalent of the C\n library function vasprintf()\n \n+This functions sets the name of the new pointer to the new\n+string. This is equivalent to:\n+   talloc_set_name_const(ptr, ptr)\n \n+\n =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n char *talloc_asprintf(const void *t, const char *fmt, ...);\n \n The talloc_asprintf() function is the talloc equivalent of the C\n library function asprintf()\n \n-This functions sets the name of the new pointer to the passed\n+This functions sets the name of the new pointer to the new\n string. This is equivalent to:\n    talloc_set_name_const(ptr, ptr)\n \n@@ -558,7 +571,11 @@\n The talloc_asprintf_append() function appends the given formatted \n string to the given string. \n \n+This functions sets the name of the new pointer to the new\n+string. This is equivalent to:\n+   talloc_set_name_const(ptr, ptr)\n \n+\n =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-\n (type *)talloc_array(const void *ctx, type, uint_t count);\n \n\n"}