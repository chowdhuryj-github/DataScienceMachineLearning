{"category": "ham", "to_address": "Volker.Lendecke@SerNet.DE", "from_address": "James Peach <jpeach@samba.org>", "subject": "Re: kerberos auth account restrictions", "body": "On Jun 13, 2007, at 11:06 AM, Volker Lendecke wrote:\n\n> On Wed, Jun 13, 2007 at 11:04:03AM -0700, James Peach wrote:\n>> Is there a good reason that we don't do this for Kerberos auth in\n>> reply_spnego_kerberos()?\n>\n> Others (the DC) decide over that. When we look at the SAM,\n> we're the boss. For Kerberos or sec=domain we don't even\n> have that info.\n\nHmmm. In both these cases, smbd manually creates a struct samu from  \nthe auth information without hitting the passdb backend. In the  \nKerberos case, it only does this if PAC information was included.\n\nThe context of this is that I have a local account lockout mechanism  \nthat I need to support and it needs to work for all auth types. If the  \nKerberos auth path did a pdb_getsampwnam and checked ACB_AUTOLOCK,  \nthen I could hide this all in my passdb module.\n\nDo you have any suggestions how I could do this? I'd rather not add a  \nsystem-specific check into the main code path if I don't have to.\n\n--\nJames Peach | jpeach@samba.org\n\n"}