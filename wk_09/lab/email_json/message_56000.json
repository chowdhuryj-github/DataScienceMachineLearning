{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Robert Wilkins\" <irishhacker@gmail.com>", "subject": "[R] A really simple data manipulation example", "body": "In response to those who asked for a better explanation of what the\nVilno software does, here's a simple example that gives some idea of\nwhat it does.\n\nLABRESULTS is a dataset with multiple rows per patient , with lab\nsodium measurements. It has columns: PATIENT_ID, VISIT_NUM, and\nSODIUM.\n\nDEMO is a dataset with one row per patient, with demographic data.\nIt has columns: PATIENT_ID, GENDER.\n\nHere's a simple example, the following paragraph of code is a\ndata processing function (dpf) :\n\n\ninlist LABRESULTS DEMO ;\nmergeby PATIENT_ID ;\nif (SODIUM == -9) SODIUM = NULL ;\nif (VISIT_NUM != 2) deleterow ;\nselect AVERAGE_SODIUM = avg(SODIUM) by GENDER ;\nsendoff(RESULTS_DATASET)  GENDER AVERAGE_SODIUM ;\nturnoff;     // just means end-of-paragraph , version 1.0 won't need this.\n\nCan you guess what it does? The lab result rows are merged with the\ndemographic rows, just to get the gender information merged in.\nObviously, they are merged by patient. The code -9 is used to denote\n\"missing\", so convert that to NULL. I'm about to take a statistic for\nvisit 2, so rows with visit 0 or 1 must be deleted. I'm assuming, for\nvisit 2, each patient has at most one row. Now, for each sex group,\ntake the average sodium level. After the select statement, I have just\ntwo rows, for male and female, with the average sodium level in the\nAVERAGE_SODIUM column. Now the sendoff statement just stores the\ncurrent data table into a datafile, called RESULTS_DATASET.\n\nSo you have a sequence of data tables, each calculation reading in the\ncurrent table , and leaving a new data table for the next calculation.\n\nSo you have input datasets, a bunch of intermediate calculations, and\none or more output datasets. Pretty simple idea.\n\n*****************************************\n\nSome caveats:\n\nLABRESULTS and DEMO are binary datasets. The asciitobinary and\nbinarytoascii statements are used to convert between binary datasets\nand comma-separated ascii data files. (You can use any delimiter:\ncomma, vertical bar , etc). An asciitobinary statement is typically\njust two lines of code.\n\nThe dpf begins with the inlist statement , and , for the moment ,\nneeds \"turnoff ;\" as the last line. Version 1.0 won't require the use\nof \"turnoff;\", but version 0.85 does. It only means this paragraph of\ncode ends here ( a program can , of course , contain many paragraphs:\ndata processing functions, print statements, asciitobinary statements,\netc.).\n\nIf you've worked with lab data, you know lab data does not look so\nsimplistic. I need a simple example.\n\nVilno has a lot of functionality, many-to-many joins, adding columns,\nfirstrow() and lastrow() flags, and so forth. A fair amount of complex\ndata manipulations have already been tested with test programs ( in\nthe tarball ). Of course a simple example cannot show you that, it's\njust a small taste.\n\n*********************************************\n\nIf you've never used SPSS or SAS before, you won't care, but this\nprogramming language falls in the same family as the SPSS and SAS\nprogramming languages. All three programming languages have a fair\namount in common, but are quite different from the S programming\nlanguage. The vilno data processing function can replace the SAS\ndatastep. (It can also replace PROC TRANSPOSE and much of PROC MEANS,\nexcept standard deviation calculations still need to be included in\nthe select statement).\n\n********************************************\n\nI hope that helps.\n\nhttp://code.google.com/p/vilno\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}