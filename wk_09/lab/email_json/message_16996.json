{"category": "ham", "to_address": "\"Deepayan Sarkar\" <deepayan.sarkar@gmail.com>", "from_address": "\"Waichler, Scott R\" <Scott.Waichler@pnl.gov>", "subject": "Re: [R] levelplot and unequal cell sizes", "body": "> my.panel.levelplot <-\n>     function (x, y, z, subscripts, at = pretty(z),\n>               col.regions = regions$col, ...,\n>               w, h)\n> {\n>     regions <- trellis.par.get(\"regions\")\n>     numcol <- length(at) - 1\n>     numcol.r <- length(col.regions)\n>     col.regions <- if (numcol.r <= numcol)\n>         rep(col.regions, length = numcol)\n>     else col.regions[floor(1+(1:numcol-1) * (numcol.r-1)/(numcol-1))]\n>     zcol <- findInterval(z, at, rightmost.closed = TRUE)\n>     x <- as.numeric(x[subscripts])\n>     y <- as.numeric(y[subscripts])\n>     z <- as.numeric(z[subscripts])\n>     w <- as.numeric(w[subscripts])\n>     h <- as.numeric(h[subscripts])\n>     zcol <- as.numeric(zcol[subscripts])\n>     print(data.frame(z, x.node, y.node, w.node, h.node, \n> col.regions[zcol]))\n>     panel.rect(x = x, y = y, width = w, height = h,\n>                col = col.regions[zcol], ...) }\n> \n\nAnother note on this panel function to use with levelplot()---the cut()\nfunction may be better than findInterval() for applications where you\nwant NA returned for values outside the supplied interval ranges.  So\nintead of using \n  zcol <- findInterval(z, at, rightmost.closed = TRUE)\nabove, I use\n  zcol <- as.integer(cut(z, at, labels=F))\nIntervals here are closed on the right, open on the left (b1, bd].  So,\nfor at = (1,2,3) and z = (1,1.01,3,3.01), then zcol = (NA,1,2,NA).  I\nrepresent NA with \"transparent\" in the final color contour plot.  \n\nScott Waichler\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}