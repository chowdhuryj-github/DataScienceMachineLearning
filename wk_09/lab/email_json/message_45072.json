{"category": "ham", "to_address": "r-help@r-project.org", "from_address": "\"Zack Weinberg\" <zackw@panix.com>", "subject": "[R] wrapping lattice xyplot", "body": "This is an expanded version of the question I tried to ask last night\n- I thought I had it this morning, but it's still not working and I\njust do not understand what is going wrong.\n\nWhat I am trying to do is write a wrapper for lattice xyplot() that\npasses a whole bunch of its secondary arguments, so that I can produce\nsimilarly formatted graphs for several different data sets.  This is\nwhat I've got:\n\ngraph <- function (x, data, groups, xlab) {\n  g <- eval(substitute(groups), data, parent.frame())\n\n  pg <- function(x, y, group.number, ...) {\n    panel.xyplot(x, y, ..., group.number=group.number)\n    panel.text(2, unique(y[x==2]),\n               levels(g)[group.number],\n               pos=4, cex=0.5)\n  }\n\n  xyplot(x, data=data, groups=substitute(g),\n              type='l',\n              ylab=list(cex=1.1, label='Mean RT (ms)'),\n              xlab=list(cex=1.1, label=xlab),\n              scales=list(\n                x=list(alternating=c(1,1), tck=c(1,0)),\n                y=list(alternating=c(1,0))\n                ),\n              panel=panel.superpose,\n              panel.groups=pg\n              )\n}\n\n\"pg\" is supposed to pick \"g\" up from the lexical enclosure. I have no\nidea whether that actually works, because it never gets that far.  A\ntypical call to this function looks like so:\n\n> graph(est ~ pro | hemi, sm, obs, \"Probe type\")\n\n(where 'sm' is a data frame that really does contain all four columns\n'est', 'pro', 'hemi', and 'obs', pinky swear) and, as it stands above,\ninvariably gives me this error:\n\nError in eval(expr, envir, enclos) : object \"est\" not found\n\nI tried substitute(x) (as that seems to have cured a similar problem\nwith \"g\") but then x is not a formula and method dispatch fails.\n\nHelp?\nzw\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}