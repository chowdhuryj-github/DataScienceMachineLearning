{"category": "ham", "to_address": "\"'Chuck Cleland'\" <ccleland@optonline.net>, <asb@mail.nih.gov>", "from_address": "Bert Gunter <gunter.berton@gene.com>", "subject": "Re: [R] rlm results on trellis plot", "body": "I don't think the code below does what's requested, as it assumes a single\noverall fit for all panels, and I think the requester wanted separate fits\nby panel. This can be easily done, of course, by a minor modification:\n\nxyplot( y ~ x | z,\n     panel = function(x,y,...){\n\t   panel.xyplot(x,y,...)\n\t   panel.abline(lm(y~x),col=\"blue\",lwd=2)\n\t   panel.abline(rlm(y~x),col = \"red\",lwd=2)\n\t})\n\nNote that the coefficients do not need to be explicitly extracted by coef(),\nas panel.abline will do this automatically.\n\nBert Gunter\nGenentech Nonclinical Statistics\nSouth San Francisco, CA 94404\n650-467-7374\n\n\n\nAlan S Barnett wrote:\n> How do I add to a trellis plot the best fit line from a robust fit? I\n> can use panel.lm to add a least squares fit, but there is no panel.rlm\n> function.\n\n  How about using panel.abline() instead of panel.lmline()?\n\nfit1 <- coef(lm(stack.loss ~ Air.Flow, data = stackloss))\nfit2 <- coef(rlm(stack.loss ~ Air.Flow, data = stackloss))\n\nxyplot(stack.loss ~ Air.Flow, data=stackloss,\n       panel = function(x, y, ...){\n         panel.xyplot(x, y, ...)\n         panel.abline(fit1, type=\"l\", col=\"blue\")\n         panel.abline(fit2, type=\"l\", col=\"red\")\n       }, aspect=1)\n\n-- \nChuck Cleland, Ph.D.\nNDRI, Inc.\n71 West 23rd Street, 8th floor\nNew York, NY 10010\ntel: (212) 845-4495 (Tu, Th)\ntel: (732) 512-0171 (M, W, F)\nfax: (917) 438-0894\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}