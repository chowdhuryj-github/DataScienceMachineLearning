{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22635 - in branches/SAMBA_4_0/source/auth:\n\tgensec kerberos", "body": "Author: metze\nDate: 2007-05-02 09:54:06 +0000 (Wed, 02 May 2007)\nNew Revision: 22635\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22635\n\nLog:\nmake it possible to not turn off dns canonicalization of hostnames\nwith krb5:set_dns_canonicalize=yes\n\nneeded for the drsuapi replication, but we should fix this with\na kdc locator plugin ...\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/auth/gensec/gensec_gssapi.c\n   branches/SAMBA_4_0/source/auth/kerberos/krb5_init_context.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/auth/gensec/gensec_gssapi.c\n===================================================================\n--- branches/SAMBA_4_0/source/auth/gensec/gensec_gssapi.c\t2007-05-01 21:29:42 UTC (rev 22634)\n+++ branches/SAMBA_4_0/source/auth/gensec/gensec_gssapi.c\t2007-05-02 09:54:06 UTC (rev 22635)\n@@ -218,7 +218,7 @@\n \t}\n \n \t/* don't do DNS lookups of any kind, it might/will fail for a netbios name */\n-\tret = gsskrb5_set_dns_canonicalize(FALSE);\n+\tret = gsskrb5_set_dns_canonicalize(lp_parm_bool(-1, \"krb5\", \"set_dns_canonicalize\", false));\n \tif (ret) {\n \t\tDEBUG(1,(\"gensec_krb5_start: gsskrb5_set_dns_canonicalize failed\\n\"));\n \t\ttalloc_free(gensec_gssapi_state);\n\nModified: branches/SAMBA_4_0/source/auth/kerberos/krb5_init_context.c\n===================================================================\n--- branches/SAMBA_4_0/source/auth/kerberos/krb5_init_context.c\t2007-05-01 21:29:42 UTC (rev 22634)\n+++ branches/SAMBA_4_0/source/auth/kerberos/krb5_init_context.c\t2007-05-02 09:54:06 UTC (rev 22635)\n@@ -473,7 +473,8 @@\n \n \t/* Set options in kerberos */\n \n-\tkrb5_set_dns_canonicalize_hostname((*smb_krb5_context)->krb5_context, FALSE);\n+\tkrb5_set_dns_canonicalize_hostname((*smb_krb5_context)->krb5_context,\n+\t\t\t\t\t   lp_parm_bool(-1, \"krb5\", \"set_dns_canonicalize\", false));\n \n \treturn 0;\n }\n\n"}