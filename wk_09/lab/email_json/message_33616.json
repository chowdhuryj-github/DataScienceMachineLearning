{"category": "ham", "to_address": "\"toby909@gmail.com\" <toby909@gmail.com>", "from_address": "\"Spielas Bates\" <bates@stat.wisc.edu>", "subject": "Re: [R] can I get same results using lme and gls?", "body": "On 5/20/07, toby909@gmail.com  wrote:\n\n> I was wondering how to get the same results with gls and lme. In my lme, the\n> design matrix for the random effects is (should be) a identity matrix and\n> therefore G should add up with R to produce the R matrix that gls would report\n> (V=ZGZ'+R). Added complexity is that I have 3 levels, so I have R, G and say H\n> (V=WHW'+ZGZ'+R). The lme is giving me the correct results, I am having trouble\n> finding the right corresponding specification for the gls.\n\nThanks for including a reproducible example.  However, I'm a bit at a\nloss as to why you would want to try to create a gls model that fits a\nmixed-effects model that has random effects for intercept and slope at\ntwo nested levels.  I don't think that corCompSymm will do what you\nwant but, to tell the truth, I have difficulty in thinking of the\nmodel in that form.  I much prefer the mixed-effects form.\n\n\n>\n> Thanks for your help.\n>\n> Toby\n>\n>\n> dtaa =\n> read.table(\"http://www.ats.ucla.edu/stat/mplus/examples/ma_snijders/mlbook1.dat\",\n> sep=\",\")\n> dta1 = reshape(dtaa, list(c(\"V10\",\"V12\")), \"score\", direction=\"long\",\n> drop=c(\"V2\",\"V3\",\"V4\",\"V5\",\"V6\",\"V7\",\"V8\",\"V9\",\"V11\",\"V13\",\"V14\",\"V15\",\"V16\",\"V17\",\"V18\",\"V19\",\"V20\",\"V21\",\"V22\",\"V23\",\"V24\",\"V25\"))\n> colnames(dta1)[1] = \"schoolNR\"\n> dta2 = dta1[order(dta1$id),]\n> head(dta2)\n> timef = factor(dta2$time)\n>\n> summary(mdl1l <- lme(score~timef-1, dta2, ~timef-1|schoolNR/id,,,,\"ML\"))\n> summary(mdl1g <- gls(score~timef-1, dta2, corCompSymm(, ~timef|schoolNR/id),\n> varIdent(, ~1|id*timef),,\"ML\"))\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}