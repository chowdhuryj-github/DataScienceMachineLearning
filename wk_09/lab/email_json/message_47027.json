{"category": "ham", "to_address": "Frank Gruman <fgatwork@verizon.net>", "from_address": "tridge@samba.org", "subject": "Re: EPOLL_CTL_ADD failed (Bad file descriptor) in TP5", "body": "Frank,\n\n > Yes - this happens with just about every network operation (login,\n > folder access, file access, etc).  \n > \n > \n >         toybox:~ # smbd -i\n >         smbd version 4.0.0tp5-SVN-build-23403 started.\n >         Copyright Andrew Tridgell and the Samba Team 1992-2007\n >         smbd: using 'standard' process model\n >         EPOLL_CTL_ADD failed (Bad file descriptor) - falling back to\n >         select()\n\nDoes this happen with smbclient or smbtorture?\n\nWhat we really need is a backtrace showing the code path that causes\nthis. If you attach to smbd with gdb and set a breakpoint on\nevents_standard.c:162 then set follow-fork-mode to child, you should\nbe able to catch this. Then do a \"bt full\" and send that to us when\nthe error happens.\n\nFor example:\n\n    root@blu:/home/tridge/samba4# gdb --args bin/smbd -i\n    GNU gdb 6.6-debian\n    Copyright (C) 2006 Free Software Foundation, Inc.\n    GDB is free software, covered by the GNU General Public License, and you are\n    welcome to change it and/or distribute copies of it under certain conditions.\n    Type \"show copying\" to see the conditions.\n    There is absolutely no warranty for GDB.  Type \"show warranty\" for details.\n    This GDB was configured as \"i486-linux-gnu\"...\n    bUsing host libthread_db library \"/lib/libthread_db.so.1\".\n    (gdb) b events_standard.c:162\n    Breakpoint 1 at 0x879e788: file lib/events/events_standard.c, line 162.\n    (gdb) set follow-fork-mode child\n    (gdb) r\n    Starting program: /home/tridge/samba/branches/SAMBA_4_0/source/bin/smbd -i\n    smbd version 4.0.0tp5-SVN-build-23235 started.\n    Copyright Andrew Tridgell and the Samba Team 1992-2007\n    smbd: using 'standard' process model\n\n\nThanks!\n\nCheers, Tridge\n\n"}