{"category": "ham", "to_address": "Michael B Allen <mba2000@ioplex.com>", "from_address": "Jeremy Allison <jra@samba.org>", "subject": "Re: [SMB] NTCreateANDX quesiotn", "body": "On Thu, Jun 07, 2007 at 10:48:28PM -0400, Michael B Allen wrote:\n> On Fri, 8 Jun 2007 11:11:21 +0900\n> \"yang mikey\"  wrote:\n> \n> > hi, everybody\n> > I found a interesting thing,\n> > \n> > when I see the header of NTCreateANCX[0xA2] via Ethereal\n> > I found the value of WORD COUNT is 42, but the position of BYTE COUNT is not\n> > at\n> > (offset of WORD COUNT) +  (value of  WORD COUNT) *2.\n> > \n> > Why it happened, and How Ethereal knows  the correct position of BYTE COUNT.\n> \n> The WordCount should be more like 24. I would have to see a capture\n> to understand what the problem is. It could be that Ethereal just got\n> confused. Try the latest Wireshark.\n\nNo, the word count is correct. NTCreateX suffers from what\nI believe is an internal bug in Windows - the number of bytes\nreturned should mean a word count of 50, but the max word\ncount returned is 42 - the extra bytes are appended (even\nthough bcc is zero). This is only returned if the client\nasks for \"extended info\".\n\nJeremy.\n\n"}