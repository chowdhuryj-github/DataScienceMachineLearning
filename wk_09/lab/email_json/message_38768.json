{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r23236 - in branches: SAMBA_3_0/source/smbd\n\tSAMBA_3_0_26/source/smbd", "body": "Author: vlendec\nDate: 2007-05-30 07:02:40 +0000 (Wed, 30 May 2007)\nNew Revision: 23236\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23236\n\nLog:\nAnother bad merge: Correctly free and unlock the session record in\nsession_claim. Jerry, this fixes the hanging smbstatus.\n\nSorry for that,\n\nVolker\n\nModified:\n   branches/SAMBA_3_0/source/smbd/session.c\n   branches/SAMBA_3_0_26/source/smbd/session.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/smbd/session.c\n===================================================================\n--- branches/SAMBA_3_0/source/smbd/session.c\t2007-05-30 01:09:18 UTC (rev 23235)\n+++ branches/SAMBA_3_0/source/smbd/session.c\t2007-05-30 07:02:40 UTC (rev 23236)\n@@ -192,10 +192,11 @@\n \n \tstatus = rec->store(rec, data, TDB_REPLACE);\n \n+\tTALLOC_FREE(rec);\n+\n \tif (!NT_STATUS_IS_OK(status)) {\n \t\tDEBUG(1,(\"session_claim: unable to create session id \"\n \t\t\t \"record: %s\\n\", nt_errstr(status)));\n-\t\tTALLOC_FREE(rec);\n \t\treturn False;\n \t}\n \n\nModified: branches/SAMBA_3_0_26/source/smbd/session.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/smbd/session.c\t2007-05-30 01:09:18 UTC (rev 23235)\n+++ branches/SAMBA_3_0_26/source/smbd/session.c\t2007-05-30 07:02:40 UTC (rev 23236)\n@@ -192,10 +192,11 @@\n \n \tstatus = rec->store(rec, data, TDB_REPLACE);\n \n+\tTALLOC_FREE(rec);\n+\n \tif (!NT_STATUS_IS_OK(status)) {\n \t\tDEBUG(1,(\"session_claim: unable to create session id \"\n \t\t\t \"record: %s\\n\", nt_errstr(status)));\n-\t\tTALLOC_FREE(rec);\n \t\treturn False;\n \t}\n \n\n"}