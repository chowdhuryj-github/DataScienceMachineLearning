{"category": "ham", "to_address": "=?UTF-8?Q?Kaya_Bekiro=C4=9Flu?= <kaya.bekiroglu@isilon.com>", "from_address": "James Peach <jpeach@samba.org>", "subject": "Re: [RFC][SAMBA3] minimal named stream support ", "body": "On Jun 28, 2007, at 10:05 AM, Kaya Bekiro\\u011flu wrote:\n\n>> The patch does the bare minimum required to get stream pathnames\n>> through reply_ntcreate_and_X and into the VFS layer. The goal of this\n>> patch is not to have the best possible stream support, but to support\n>> named streams with minimally intrusive changes to the Samba code.\n>\n> Very nice!  Within the VFS layer, how do you disambiguate between a  \n> legitimate stream request and a demangled name which contains a  \n> colon (':'), such as one created via NFS?\n\nI don't. In all the path-based requests, I use split_ntfs_stream_name  \nto figure out the path and the stream name. If the path contains a  \ncolon, then matching the stream name to an extended attribute (or  \nwhatever) will fail, and the corresponding open will fail.\n\nAnother weakness (though not intrinsic) of my approach is that when I  \nhave a stream mapped to an extended attribute, I hold a file  \ndescriptor open on the file that hosts the extended attribute. You  \nkinda have to do this because you can't let the file disappear while  \nthe stream is open. On the other hand, doing this will really mess  \nwith  posix locks.\n\n--\nJames Peach | jpeach@samba.org\n\n\n"}