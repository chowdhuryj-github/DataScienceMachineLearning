{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22683 - in branches/SAMBA_4_0/source/librpc/rpc:\n\t.", "body": "Author: metze\nDate: 2007-05-05 19:05:42 +0000 (Sat, 05 May 2007)\nNew Revision: 22683\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22683\n\nLog:\nfix the logic for skipping the pipe_dead()\ncode on the 2nd run.\n\nthanks volker for finding this!\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb.c\n   branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb2.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb.c\n===================================================================\n--- branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb.c\t2007-05-05 18:59:52 UTC (rev 22682)\n+++ branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb.c\t2007-05-05 19:05:42 UTC (rev 22683)\n@@ -42,12 +42,12 @@\n {\n \tstruct smb_private *smb = c->transport.private;\n \n-\tsmb->dead = true;\n-\n \tif (smb->dead) {\n \t\treturn;\n \t}\n \n+\tsmb->dead = true;\n+\n \tif (NT_STATUS_EQUAL(NT_STATUS_UNSUCCESSFUL, status)) {\n \t\tstatus = NT_STATUS_UNEXPECTED_NETWORK_ERROR;\n \t}\n\nModified: branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb2.c\n===================================================================\n--- branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb2.c\t2007-05-05 18:59:52 UTC (rev 22682)\n+++ branches/SAMBA_4_0/source/librpc/rpc/dcerpc_smb2.c\t2007-05-05 19:05:42 UTC (rev 22683)\n@@ -44,12 +44,12 @@\n {\n \tstruct smb2_private *smb = c->transport.private;\n \n-\tsmb->dead = true;\n-\n \tif (smb->dead) {\n \t\treturn;\n \t}\n \n+\tsmb->dead = true;\n+\n \tif (NT_STATUS_EQUAL(NT_STATUS_UNSUCCESSFUL, status)) {\n \t\tstatus = NT_STATUS_UNEXPECTED_NETWORK_ERROR;\n \t}\n\n"}