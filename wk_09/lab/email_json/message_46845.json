{"category": "ham", "to_address": "\"'Patrick Wang'\" <pwang@berkeley.edu>,\n   \"'Bert Gunter'\" <gunter.berton@gene.com>", "from_address": "\"Ravi Varadhan\" <rvaradhan@jhmi.edu>", "subject": "Re: [R] how to find how many modes in 2 dimensions case", "body": "Patrick,\n\nHere is an example closer to what you are interested in - locating bumps in\nkernel density estimator.  I am using the example from package KernSmooth,\nusing the function bkde2D().\n\n# Another example for locating maxima in kernel density estimation\n data(geyser, package=\"MASS\")\n x <- cbind(geyser$duration, geyser$waiting)\n est <- bkde2D(x, bandwidth=c(0.7,7))\n persp(est$fhat)\n\nx <- est$x1\ny <- est$x2\nz <- est$fhat\n\n#  here is a brute-force algorithm to locate ALL the local maxima\n\nfor (i in 2:(nrow(z)-1) ) {\nfor (j in 2:(ncol(z)-1) ) {\nlmax <- (z[i,j] > z[i-1,j]) & (z[i,j] > z[i+1,j]) & (z[i,j] > z[i,j-1]) &\n(z[i,j] > z[i,j+1])\nif(lmax) cat(\"x: \",x[i], \"y: \", y[j], \"function: \", z[i,j], \"\\n\")\n} \n}\n\nx:  0.724 y:  41.1 function:  2.71e-20 \nx:  0.858 y:  39.4 function:  1.08e-19 \nx:  0.992 y:  35.9 function:  2.17e-19 \nx:  2.07 y:  82.4 function:  0.00795 \nx:  4.08 y:  77.2 function:  0.00722 \nx:  4.35 y:  54.9 function:  0.00778\n\nOf these, you can ignore the first 3, which have zero density.\n\nRavi.\n\n----------------------------------------------------------------------------\n-------\n\nRavi Varadhan, Ph.D.\n\nAssistant Professor, The Center on Aging and Health\n\nDivision of Geriatric Medicine and Gerontology \n\nJohns Hopkins University\n\nPh: (410) 502-2619\n\nFax: (410) 614-9625\n\nEmail: rvaradhan@jhmi.edu\n\nWebpage:  http://www.jhsph.edu/agingandhealth/People/Faculty/Varadhan.html\n\n \n\n----------------------------------------------------------------------------\n--------\n\n\n-----Original Message-----\nFrom: r-help-bounces@stat.math.ethz.ch\n[mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Patrick Wang\nSent: Friday, June 08, 2007 3:35 PM\nTo: Bert Gunter\nCc: r-help@stat.math.ethz.ch\nSubject: Re: [R] how to find how many modes in 2 dimensions case\n\nThanks for the reply,\n\nmaybe I shall say bumps, I can use persp to show a density on a X Y\ndimensions.\none peak is one mode I think. I try to find an automatic way to detect how\nmany peaks of the densities.\n\nPat\n> Note that \"the number of modes\" (local maxima??)  is a function of the\n> bandwidth, so I'm not sure your question is even meaningful.\n>\n> Bert Gunter\n> Genentech Nonclinical Statistics\n> South San Francisco, CA 94404\n> 650-467-7374\n>\n> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch\n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Patrick Wang\n> Sent: Friday, June 08, 2007 11:54 AM\n> To: R-help@stat.math.ethz.ch\n> Subject: [R] how to find how many modes in 2 dimensions case\n>\n> Hi,\n>\n> Does anyone know how to count the number of modes in 2 dimensions using\n> kde2d function?\n>\n> Thanks\n> Pat\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}