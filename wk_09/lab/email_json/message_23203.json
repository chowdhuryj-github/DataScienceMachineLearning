{"category": "ham", "to_address": "\"Spielas Bates\" <bates@stat.wisc.edu>", "from_address": "\"ivo welch\" <ivowel@gmail.com>", "subject": "Re: [R] nlme fixed effects specification", "body": "hi spie:  yikes.  could I have done better?  Oh dear.  I tried to make\nmy example clearer half-way through, but made it worse.  I meant\n\nset.seed(1);\nfe = as.factor( as.integer( runif(100)*10 ) ); y=rnorm(100); x=rnorm(100);\nprint(summary(lm( y ~ x + fe)))\n  \nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)   0.1128     0.3680    0.31     0.76\nx             0.0232     0.0960    0.24     0.81\nfe1          -0.6628     0.5467   -1.21     0.23\n  \nResidual standard error: 0.949 on 89 degrees of freedom\nMultiple R-Squared: 0.0838,     Adjusted R-squared: -0.0192\nF-statistic: 0.814 on 10 and 89 DF,  p-value: 0.616\n\nI really am interested only in this linear specification, the\ncoefficient on x (0.0232) and the R^2 of 8.38% (adjusted -1.92%).  If\nI did not have so much data in my real application, I would never have\nto look at nlme or nlme4.  I really only want to be able to run this\nspecification through lm with far more observations (100,000) and\ngroups (10,000), and be done with my problem.\n\nnow, with a few IQ points more, I would have looked at the lme\nfunction instead of the nlme function in library(nlme).    [then\nagain, I could understand stats a lot better with a few more IQ\npoints.]  I am reading the lme description now, but I still don't\nunderstand how to specify that I want to have dummies in my\nspecification, plus the x variable, and that's it.  I think I am not\nunderstanding the integration of fixed and random effects in the same\nR functions.\n\nthanks for pointing me at your lme4 library.  on linux, version 2.5.0, I did\n  R CMD INSTALL matrix*.tar.gz\n  R CMD INSTALL lme4*.tar.gz\nand it installed painlessly.  (I guess R install packages don't have\nknowledge of what they rely on;  lme4 requires matrix, which the docs\nstate, but having gotten this wrong, I didn't get an error.  no big\ndeal.  I guess I am too used to automatic resolution of dependencies\nfrom linux installers these days that I did not expect this.)\n\nI now tried your specification:\n\n> library(lme4)\nLoading required package: Matrix\nLoading required package: lattice\n> lmer(y~x+(1|fe))\nLinear mixed-effects model fit by REML\nFormula: y ~ x + (1 | fe)\n AIC BIC logLik MLdeviance REMLdeviance\n 282 290   -138        270          276\nRandom effects:\n Groups   Name        Variance       Std.Dev.\n fe       (Intercept) 0.000000000445 0.0000211\n Residual             0.889548532468 0.9431588\nnumber of obs: 100, groups: fe, 10\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  -0.0188     0.0943  -0.199\nx             0.0528     0.0904   0.585\n\nCorrelation of Fixed Effects:\n  (Intr)\nx -0.022\nWarning messages:\n1: Estimated variance for factor 'fe' is effectively zero\n in: `LMEoptimize<-`(`*tmp*`, value = list(maxIter = 200L, tolerance =\n0.0000000149011611938477,\n2: $ operator not defined for this S4 class, returning NULL in: x$symbolic.cor\n\nWithout being a statistician, I can still determine that this is not\nthe model I would like to work with.  The coefficient is 0.0528, not\n0.0232.  (I am also not sure why I am getting these warning messages\non my system, either, but I don't think it matters.)\n\nis there a simple way to get the equivalent specification for my smple\nmodel, using lmer or lme, which does not choke on huge data sets?\n\nregards,\n\n/ivo\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}