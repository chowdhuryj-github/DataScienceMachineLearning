{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "abartlet@samba.org", "subject": "svn commit: samba r22235 - in branches/SAMBA_4_0:\n\tsource/script/tests testprogs/blackbox", "body": "Author: abartlet\nDate: 2007-04-16 04:55:52 +0000 (Mon, 16 Apr 2007)\nNew Revision: 22235\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22235\n\nLog:\nTest kinit, and PKINIT functionality by means of a new blackbox test.\n\nAndrew Bartlett\n\nAdded:\n   branches/SAMBA_4_0/testprogs/blackbox/test_kinit.sh\nModified:\n   branches/SAMBA_4_0/source/script/tests/tests_all.sh\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/script/tests/tests_all.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/tests_all.sh\t2007-04-16 04:47:11 UTC (rev 22234)\n+++ branches/SAMBA_4_0/source/script/tests/tests_all.sh\t2007-04-16 04:55:52 UTC (rev 22235)\n@@ -11,6 +11,6 @@\n  $SRCDIR/script/tests/test_cifs.sh\n  $SRCDIR/script/tests/test_local.sh\n  $SRCDIR/script/tests/test_pidl.sh\n- $SRCDIR/script/tests/test_blackbox.sh $PREFIX/blackbox\n+ $SRCDIR/script/tests/test_blackbox.sh $PREFIX\n  $SRCDIR/script/tests/test_simple.sh\n  $SRCDIR/script/tests/test_s3upgrade.sh $PREFIX/upgrade\n\nAdded: branches/SAMBA_4_0/testprogs/blackbox/test_kinit.sh\n===================================================================\n--- branches/SAMBA_4_0/testprogs/blackbox/test_kinit.sh\t2007-04-16 04:47:11 UTC (rev 22234)\n+++ branches/SAMBA_4_0/testprogs/blackbox/test_kinit.sh\t2007-04-16 04:55:52 UTC (rev 22235)\n@@ -0,0 +1,45 @@\n+#!/bin/sh\n+\n+if [ $# -lt 5 ]; then\n+cat < ./tmppassfile\n+testit \"kinit with password\" samba4kinit --password-file=./tmppassfile --request-pac $USERNAME@$REALM   || failed=`expr $failed + 1`\n+testit \"kinit with pkinit\" samba4kinit --request-pac --pk-user=FILE:$PREFIX/dc/private/tls/admincert.pem,$PREFIX/dc/private/tls/adminkey.pem $USERNAME@$REALM || failed=`expr $failed + 1`\n+\n+echo ls | testit \"Test login with kerberos ccache\" $VALGRIND bin/smbclient $CONFIGURATION //$SERVER/tmp -k yes || failed=`expr $failed + 1`\n+\n+testit \"domain join with kerberos ccache\" $VALGRIND bin/net join $DOMAIN $CONFIGURATION  -W \"$DOMAIN\" -k yes $@\n+\n+rm -f tmpccfile tmppassfile\n+exit $failed\n\n"}