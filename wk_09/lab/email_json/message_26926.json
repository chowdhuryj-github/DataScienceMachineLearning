{"category": "ham", "to_address": "\"Patnaik, Tirthankar\" <tirthankar.patnaik@citi.com>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] Getting the last day of the month.", "body": "Try this:\n\nlibrary(zoo)\nx <- \"200212\"\nas.Date(as.yearmon(paste(x, \"01\", sep = \"\"), \"%Y%m%d\"), frac = 1)\n\n\n\nOn 5/10/07, Patnaik, Tirthankar  wrote:\n> Hi,\n>        Given a date, how do I get the last date of that month? I have\n> data in the form YYYYMM, that I've read as a date using\n>\n> > x$Date <-\n> as.Date(ISOdate(substr(x$YearEnd,1,4),substr(x$YearEnd,5,6),1))\n>\n> But this gives the first day of the month. To get the last day of the\n> month, I tried\n>\n> > as.Date(as.yearmon(x$Date,frac=0))\n>\n> But I don't get the last day of the month here. (Tried frac=1 too.)\n>\n> I then add a month to the date, substract one day from the resultant\n> date. But this wouldn't work for December.\n>\n> > x$YearEnd\n>  [1] 200203 200303 200403 200503 200603 200603 200312 200503 200603\n> 200203 200303\n> [12] 200403 200503 200512 200612 200203 200303 200403 200503 200603\n> >\n> > x$Date <- as.Date(ISOdate(substr(x$YearEnd,1,4),\n> + as.integer(substr(x$YearEnd,5,6))+1,\n> + 1))-1\n> > x$Date\n>  [1] \"2002-03-31\" \"2003-03-31\" \"2004-03-31\" \"2005-03-31\" \"2006-03-31\"\n> \"2006-03-31\"\n>  [7] NA           \"2005-03-31\" \"2006-03-31\" \"2002-03-31\" \"2003-03-31\"\n> \"2004-03-31\"\n> [13] \"2005-03-31\" NA           NA           \"2002-03-31\" \"2003-03-31\"\n> \"2004-03-31\"\n> [19] \"2005-03-31\" \"2006-03-31\"\n>\n> So I add a year, and set the month to 1 in a quick function.\n>\n> > GetEOM <- function(yyyymm=200406){\n>        year <- as.integer(substr(yyyymm,1,4))\n>        month <- as.integer(substr(yyyymm,5,6))\n>        if (month==12){\n>                date <- as.Date(ISOdate(year+1,1,1))-1\n>        }else{\n>                date <- as.Date(ISOdate(year,month+1,1))-1\n>        }\n>        print(date)\n> }\n>\n> x$Date <- as.vector(sapply(x$YearEnd,GetEOM))\n>\n> str(x$Date)\n>\n>\n> Is there a simpler way to do this please?\n>\n>\n> TIA and best,\n> -Tir\n>\n> Tirthankar Patnaik\n> India Strategy\n> Citigroup Investment Research\n> +91-22-6631 9887\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}