{"category": "ham", "to_address": "\"'Ravi Varadhan'\" <rvaradhan@jhmi.edu>,\n   \"'Charles C. Berry'\" <cberry@tajo.ucsd.edu>", "from_address": "\"Ravi Varadhan\" <rvaradhan@jhmi.edu>", "subject": "Re: [R] Normal and Poisson tail area expectations in R", "body": "Inspired by Chuck's elegant solution to the Poisson tail area problem, here\nis a simple solution to the normal tail area expectation that does not use\nintegrate().\n\nGu.k <- function(k) {1/sqrt(2*pi) * exp(-k*k/2) - k * pnorm(k, lower=FALSE)}\n\n> k <- 1:10\n> Gu.k(k)\n [1] 8.331547e-02 8.490703e-03 3.821543e-04 7.145258e-06 5.346166e-08\n1.563570e-10 1.760326e-13 7.550262e-17 1.224779e-20 7.474560e-25\n>\n> sapply(k, function(k)integrate(function(x)\n(x-k)*dnorm(x),lower=k,upper=Inf)$val)\n [1] 8.331547e-02 8.490702e-03 3.821543e-04 7.145259e-06 5.346163e-08\n1.563570e-10 1.760326e-13 7.550262e-17 1.224779e-20 7.474560e-25\n>\n\nRavi. \n\n----------------------------------------------------------------------------\n-------\n\nRavi Varadhan, Ph.D.\n\nAssistant Professor, The Center on Aging and Health\n\nDivision of Geriatric Medicine and Gerontology \n\nJohns Hopkins University\n\nPh: (410) 502-2619\n\nFax: (410) 614-9625\n\nEmail: rvaradhan@jhmi.edu\n\nWebpage:  http://www.jhsph.edu/agingandhealth/People/Faculty/Varadhan.html\n\n \n\n----------------------------------------------------------------------------\n--------\n\n\n-----Original Message-----\nFrom: r-help-bounces@stat.math.ethz.ch\n[mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Ravi Varadhan\nSent: Thursday, June 14, 2007 2:08 PM\nTo: 'Charles C. Berry'\nCc: 'kavindra malik'; r-help@stat.math.ethz.ch\nSubject: Re: [R] Normal and Poisson tail area expectations in R\n\nPerfect, Chuck.  I got a closed-form solution after some algebraic labor,\nbut your solution is simple and elegant.\n\nRavi.\n\n----------------------------------------------------------------------------\n-------\n\nRavi Varadhan, Ph.D.\n\nAssistant Professor, The Center on Aging and Health\n\nDivision of Geriatric Medicine and Gerontology \n\nJohns Hopkins University\n\nPh: (410) 502-2619\n\nFax: (410) 614-9625\n\nEmail: rvaradhan@jhmi.edu\n\nWebpage:  http://www.jhsph.edu/agingandhealth/People/Faculty/Varadhan.html\n\n \n\n----------------------------------------------------------------------------\n--------\n\n\n-----Original Message-----\nFrom: Charles C. Berry [mailto:cberry@tajo.ucsd.edu] \nSent: Thursday, June 14, 2007 1:36 PM\nTo: Ravi Varadhan\nCc: 'kavindra malik'; r-help@stat.math.ethz.ch\nSubject: RE: [R] Normal and Poisson tail area expectations in R\n\n\n\nRavi,\n\nThis looks simple to me.\n\nkm_G <- function(lambda,k)\n \tlambda*ppois(k-1,lambda,lower=FALSE) -\n \t\tk*ppois(k,lambda,lower=FALSE)\n\nAm I confused here?\n\nChuck\n\n\n\nOn Wed, 13 Jun 2007, Ravi Varadhan wrote:\n\n>\n> More interesting is the Poisson convolution. I don't know if there is an\n> analytic solution to this.  I looked at Jolley's \"Summation of Series\" and\n> Abramowitz and Stegun, but no help there.  It seems that discrete FFT\n> technique should work. Does anyone know the answer?\n>\n> Ravi.\n>\n----------------------------------------------------------------------------\n> -------\n>\n> Ravi Varadhan, Ph.D.\n>\n> Assistant Professor, The Center on Aging and Health\n>\n> Division of Geriatric Medicine and Gerontology\n>\n> Johns Hopkins University\n>\n> Ph: (410) 502-2619\n>\n> Fax: (410) 614-9625\n>\n> Email: rvaradhan@jhmi.edu\n>\n> Webpage:  http://www.jhsph.edu/agingandhealth/People/Faculty/Varadhan.html\n>\n>\n>\n>\n----------------------------------------------------------------------------\n> --------\n>\n> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch\n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of kavindra malik\n> Sent: Wednesday, June 13, 2007 5:45 PM\n> To: Charles C. Berry\n> Cc: r-help@stat.math.ethz.ch\n> Subject: Re: [R] Normal and Poisson tail area expectations in R\n>\n> Thank you very much. This solves the problem I was trying to solve. I am\nnew\n> to R and am learning. A great lesson in the power of R...\n>\n> \"Charles C. Berry\"  wrote: On Wed, 13 Jun 2007,\n> kavindra malik wrote:\n>\n>> I am interested in R functions for the following integrals / sums\n> (expressed best I can in text)  -\n>>\n>> Normal: G_u(k) =  Integration_{Lower limit=k}^{Upper limit=infinity} [(u\n> -k) f(u) d(u)], where where u is N(0,1), and f(u) is the density function.\n>>\n>> Poisson: G(lambda,k) = Sum_{Lower limit=k}^{Upper limit=infinity} [(x-k)\n> p(x, lambda)] where P(x,lambda) is the Poisson prob function with\nparameter\n> lambda.\n>>\n>> The Normal expression is very commonly used in inventory management to\n>> determine safety stocks (and its tabular values can be found in some\n>> texts) - and I am also looking for Poisson and/or Gamma as that'd fit\n>> the situation better.\n>>\n>> I am wondering if there are standard functions in R that might allow me\nto\n> get these values, instead of needing to do the numerical integration, etc.\n> myself.\n>\n> Not that I know of, but it is not difficult to do the integration:\n>\n>> k <- 1.1 # for example\n>> integrate(function(x) (x-k)*dnorm(x),lower=k,upper=Inf)\n> 0.06861951 with absolute error < 5.5e-07\n>>\n>\n> see\n>\n>  ?integrate\n>  ?qnorm\n>  ?qpois\n>  ?qgamma\n>\n>>                                                    Thank you very much.\n>>\n>>\n>>\n>> ---------------------------------\n>> Sucker-punch spam with award-winning protection.\n>>\n>>  [[alternative HTML version deleted]]\n>>\n>> ______________________________________________\n>> R-help@stat.math.ethz.ch mailing list\n>> https://stat.ethz.ch/mailman/listinfo/r-help\n>> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html\n>> and provide commented, minimal, self-contained, reproducible code.\n>>\n>\n> Charles C. Berry                            (858) 534-2098\n>                                             Dept of Family/Preventive\n> Medicine\n> E mailto:cberry@tajo.ucsd.edu             UC San Diego\n> http://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901\n>\n>\n>\n>\n>\n> ---------------------------------\n>\n>\n> \t[[alternative HTML version deleted]]\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\nhttp://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\nCharles C. Berry                            (858) 534-2098\n                                             Dept of Family/Preventive\nMedicine\nE mailto:cberry@tajo.ucsd.edu\t            UC San Diego\nhttp://famprevmed.ucsd.edu/faculty/cberry/  La Jolla, San Diego 92093-0901\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}