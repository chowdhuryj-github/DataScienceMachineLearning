{"category": "ham", "to_address": "Noah Kantrowitz <kantrn@rpi.edu>", "from_address": "Tomeu Vizoso <tomeu@tomeuvizoso.net>", "subject": "Re: [sugar] DBus .service files", "body": "On Sun, 2007-04-15 at 19:36 -0400, Noah Kantrowitz wrote:\n> Dan Williams wrote:\n> > On Sun, 2007-04-15 at 06:24 -0400, Noah Kantrowitz wrote:\n> >   \n> >> Anyone know how to get a system dbus install to see the service files in\n> >> ~/sugar-jhbuild/build/share/dbus-1/service? I tried putting a\n> >>  entry in /etc/dbus-1/system.d/sugar.conf, but dbus still\n> >> doesn't see it when running sugar-presence-service.:\n> >> [olpc@localhost sugar-jhbuild]$ build/bin/sugar-presence-service\n> >>     \n> >\n> > Don't do this.  There have been a couple fixes since late last week to\n> > make this all work.  First, 'git pull' in sugar-jhbuild.  Second,\n> > \"./sugar-jhbuild buildone -a telepathy-python\".  That should make this\n> > stuff just work.\n> >\n> > A fix was pushed to tp-python last week that allows it to find the\n> > service managers using XDG_DATA_DIR rather than hardcoding the search\n> > list.  A further fix was put into sugar-jhbuild to point the session\n> > DBus daemon that sugar spawns to the dbus service directories inside\n> > sugar-jhbuild rather than the local system.\n> >   \n> If I undo my changes to dbus' files, and just try running the emulator,\n> I get a black Xephyr window and this traceback:\n> $ ./sugar-jhbuild run\n> Extended Input Devices not yet supported. Impelement it at line 625 in\n> kinput.c\n> Introspect error: Message did not receive a reply (timeout by message bus)\n> Traceback (most recent call last):\n>   File \"/home/olpc/sugar-jhbuild/build/bin/sugar-shell\", line 117, in\n> \n>     model = ShellModel()\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/shell/model/ShellModel.py\",\n> line 52, in __init__\n>     self._mesh = MeshModel()\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/shell/model/MeshModel.py\",\n> line 87, in __init__\n>     for buddy in self._pservice.get_buddies():\n>   File\n> \"/home/olpc/sugar-jhbuild/build/lib/python2.5/site-packages/sugar/presence/presenceservice.py\",\n> line 277, in get_buddies\n>     resp = self._ps.GetBuddies()\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/proxies.py\", line\n> 87, in __call__\n>     return self._proxy_method(*args, **keywords)\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/proxies.py\", line\n> 171, in __call__\n>     reply_message =\n> self._connection.send_message_with_reply_and_block(message, timeout)\n> DBusException: org.freedesktop.DBus.Error.ServiceUnknown: The name :1.1\n> was not provided by any .service files\n> \n> Everything in Sugar is totally up to date as far as jhbuild tells me.\n\nHi Noah,\n\nI *think* that you have to delete your $HOME/.sugar dir. At least it's\nworking for me now.\n\nMy guess is that the presence service is getting an exception on startup\nbecause of some stale data in .sugar.\n\nRegards,\n\nTomeu\n\n_______________________________________________\nSugar mailing list\nSugar@laptop.org\nhttp://mailman.laptop.org/mailman/listinfo/sugar\n\n"}