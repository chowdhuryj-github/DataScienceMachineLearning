{"category": "ham", "to_address": "<wildscop@yahoo.com>, <r-help@stat.math.ethz.ch>", "from_address": "\"Kuhn, Max\" <Max.Kuhn@pfizer.com>", "subject": "Re: [R] Programming Problem (for loop, random # control,\n\t3 dimentional graph)", "body": "Wow.\n\nSome suggestions are below. \n\n1. You should \"vectorize\" the for loop in the function g. I would do\nsomething like this:\n\nz1 <- rnorm(20 * 100, 0, 1)\n\nQ1=0+1*z1*(1+.83*(1-exp(-G*z1))/(1+exp(-G*z1)))*(1+z1**2)**K\n\nQ1Matrix <- matrix(Q1, ncol = 100)\n\nksStat <- function(x) ks.test(x, \"pnorm\", mean = mean(x), sd\n=s(x))$p.value\n\npValues <- apply(Q1Matrix, 2, ksStat)\n\np <- ifelse(pValues <= 0.05, 1, 0)\n\n(please check the details. I have no idea of the purpose of this code).\n\nAlso, you might want to look at the outer function to compute across the\nvalues of G and K if you want the results in a matrix (to avoid your\nother loop). If you want the results in a data frame, you could use\nexpand.grid to create a grid of G and K combinations, then apply the\nfunction to the rows (via apply).\n\n2. I always put set.seed just prior the first function that call the\nrng. Others probably have better advice.\n\n3. To use traditional graphics like image our contour, save the data in\na matrix. For lattice graphics (my preference), the data frame approach\nin #1 above is better. I think that scatterplot3d wants the results in\nvector format (not matrix).\n\nGood luck,\n\nMax \n\n\n-----Original Message-----\nFrom: r-help-bounces@stat.math.ethz.ch\n[mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Mohammad Ehsanul\nKarim\nSent: Wednesday, April 11, 2007 9:06 AM\nTo: r-help@stat.math.ethz.ch\nSubject: [R] Programming Problem (for loop, random # control,3\ndimentional graph)\n\nDear List,\n\nThis is just a programming problem which i cannot seem\nto figure out. I am trying to get a set of power from\na test (say, kolmogorov smirnov) out of a distribution\n(say, G-K distribution) as follows. I am trying to\nreduce to pain of writing the whole set of data points\n(p# below) using \"for\" loop. However, I seem to have\nsome problem in it as the output \"M\" does not match\nfor the original and reduced form. I need to get\nanswer of the following questions:\n\n1. Is there any fault in the \"for\" loop in the Reduced\nform?\n2. To get exactly same result M in the next run, where\nshould i put set.seed()?\n3. How to plot such plots in R having dimentions G, K\nand vectorized M? In matlab, mesh(K,G,M) does the\ntrick. scatterplot3d(K,G,M) gives me error message.\n\n\nThank you for your time.\nThanks in advance.\n\nMohammad Ehsanul Karim\nwildscop at yahoo dot com\nInstitute of Statistical Research and Training\nUniversity of Dhaka\n\n\n##########################################\n#### Original form #######################\n\nlibrary(stats)\ng=function(G,K,z1){\np=rep(0,100)\t\n# 100 replication\nfor(i in 1:100){\nz1=rnorm(20,0,1)\t\n# standard normal with 20 sample size\nQ1=0+1*z1*(1+.83*(1-exp(-G*z1))/(1+exp(-G*z1)))*(1+z1**2)**K\n# density of G-K distribution\nks=ks.test(Q1, \"pnorm\", mean = mean(Q1), sd =\nsqrt(var(Q1)))\npv=ks$p.value\nif(pv<=0.05) {p[i]=1} else {p[i]=0}\n}\nm.p=mean(p)\nreturn(m.p)\n}\n\n# putting value of G -5,-4,-3,-2,-1,-.5,0,.5,1,2,3,4,5\n# putting value of K -.5,0,.5,1,2,3,4,5\n# in the function g()\np1=g(-5,-.5)\np2=g(-5,0)\np3=g(-5,0.5)\np4=g(-5,1)\np5=g(-5,2)\np6=g(-5,3)\np7=g(-5,4)\np8=g(-5,5)\np9=g(-4,-.5)\np10=g(-4,0)\np11=g(-4,0.5)\np12=g(-4,1)\np13=g(-4,2)\np14=g(-4,3)\t\np15=g(-4,4)\np16=g(-4,5)\np17=g(-3,-.5)\np18=g(-3,0)\np19=g(-3,.5)\np20=g(-3,1)\np21=g(-3,2)\np22=g(-3,3)\np23=g(-3,4)\np24=g(-3,5)\np25=g(-2,-.5)\np26=g(-2,0)\np27=g(-2,.5)\np28=g(-2,1)\np29=g(-2,2)\np30=g(-2,3)\np31=g(-2,4)\np32=g(-2,5)\np33=g(-1,-.5)\np34=g(-1,0)\np35=g(-1,.5)\np36=g(-1,1)\np37=g(-1,2)\np38=g(-1,3)\np39=g(-1,4)\np40=g(-1,5)\np41=g(-0.5,-0.5)\np42=g(-0.5,0)\np43=g(-0.5,0.5)\np44=g(-0.5,1)\np45=g(-0.5,2)\np46=g(-0.5,3)\np47=g(-0.5,4)\np48=g(-0.5,5)\np49=g(0,-0.5)\np50=g(0,0)\np51=g(0,.5)\np52=g(0,1)\np53=g(0,2)\np54=g(0,3)\np55=g(0,4)\np56=g(0,5)\np57=g(0.5,-.5)\np58=g(0.5,0)\np59=g(0.5,.5)\np60=g(0.5,1)\np61=g(0.5,2)\np62=g(0.5,3)\np63=g(0.5,4)\np64=g(0.5,5)\np65=g(1,-.5)\np66=g(1,0)\np67=g(1,.5)\np68=g(1,1)\np69=g(1,2)\np70=g(1,3)\np71=g(1,4)\np72=g(1,5)\np73=g(2,-.5)\np74=g(2,0)\np75=g(2,.5)\np76=g(2,1)\np77=g(2,2)\np78=g(2,3)\np79=g(2,4)\np80=g(2,5)\np81=g(3,-.5)\np82=g(3,0)\np83=g(3,.5)\np84=g(3,1)\np85=g(3,2)\np86=g(3,3)\np87=g(3,4)\np88=g(3,5)\np89=g(4,-.5)\np90=g(4,0)\np91=g(4,.5)\np92=g(4,1)\np93=g(4,2)\np94=g(4,3)\np95=g(4,4)\np96=g(4,5)\np97=g(5,-.5)\np98=g(5,0)\np99=g(5,0.5)\np100=g(5,1)\np101=g(5,2)\np102=g(5,3)\np103=g(5,4)\np104=g(5,5)\nMp<-c(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19\n,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37\n,p38,p39,p40,p41,p42,p43,p44,p45,p46,p47,p48,p49,p50,p51,p52,p53,p54,p55\n,p56,p57,p58,p59,p60,p61,p62,p63,p64,p65,p66,p67,p68,p69,p70,p71,p72,p73\n,p74,p75,p76,p77,p78,p79,p80,p81,p82,p83,p84,p85,p86,p87,p88,p89,p90,p91\n,p92,p93,p94,p95,p96,p97,p98,p99,p100,p101,p102,p103,p104)\nM<-matrix(Mp,nrow=13,ncol=8,byrow=T)\nM\n##########################################\n################ Result ##################\n> M\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n [1,] 0.33 0.23 0.47 0.60 0.85 0.97 0.98 0.97\n [2,] 0.31 0.28 0.40 0.46 0.90 0.92 0.99 0.99\n [3,] 0.28 0.26 0.34 0.61 0.85 0.95 0.99 0.99\n [4,] 0.15 0.15 0.24 0.53 0.78 0.96 0.99 0.99\n [5,] 0.04 0.04 0.19 0.35 0.84 0.94 0.96 0.99\n [6,] 0.01 0.00 0.06 0.24 0.80 0.93 0.98 0.99\n [7,] 0.00 0.00 0.02 0.27 0.73 0.94 0.97 0.98\n [8,] 0.01 0.00 0.05 0.25 0.79 0.87 0.98 0.99\n [9,] 0.07 0.03 0.22 0.44 0.71 0.94 0.97 1.00\n[10,] 0.13 0.15 0.28 0.46 0.76 0.89 0.97 0.98\n[11,] 0.27 0.27 0.35 0.55 0.86 0.97 0.99 1.00\n[12,] 0.36 0.22 0.48 0.62 0.88 0.97 0.95 0.98\n[13,] 0.41 0.29 0.34 0.59 0.88 0.96 0.99 0.99\n\n\n##########################################\n#### Reduced form ########################\nlibrary(stats)\ng=function(G,K,r1){\np=rep(0,100)\nfor(i in 1:100){\nz1=rnorm(r1,0,1)\nQ1=0+1*z1*(1+.83*(1-exp(-G*z1))/(1+exp(-G*z1)))*(1+z1**2)**K\nks=ks.test(Q1, \"pnorm\", mean = mean(Q1), sd =\nsqrt(var(Q1)))\npv=ks$p.value\nif(pv<=0.05) {p[i]=1} else {p[i]=0}\n}\nm.p=mean(p)\nreturn(m.p)\n}\n\nG<-c(-5,-4,-3,-2,-1,-.5,0,.5,1,2,3,4,5)\nK<-c(-.5,0,.5,1,2,3,4,5)\nlg<-length(G)\nlk<-length(K)\nM<-matrix(rep(NA,lg*lk),nrow=lg,ncol=lk,byrow=T)\nfor(i in G[1]:G[lg]){\nfor(j in K[1]:K[lk]){\nM[i,j]<-g(i,j,20)\n}\n}\nM\n##########################################\n################ Result ##################\n> M\n      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]\n [1,] 0.62 0.76 0.97 0.99   NA   NA   NA   NA\n [2,] 0.68 0.88 0.94 0.98   NA   NA   NA   NA\n [3,] 0.65 0.89 0.95 0.98   NA   NA   NA   NA\n [4,] 0.79 0.92 0.97 0.98   NA   NA   NA   NA\n [5,] 0.70 0.85 0.95 1.00   NA   NA   NA   NA\n [6,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n [7,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n [8,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n [9,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n[10,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n[11,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n[12,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n[13,] 0.59 0.91 0.93 0.99   NA   NA   NA   NA\n\n\n       \n________________________________________________________________________\n____________\nLooking for earth-friendly autos? \nBrowse Top Cars by \"Green Rating\" at Yahoo! Autos' Green Center.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide\nhttp://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n----------------------------------------------------------------------\nLEGAL NOTICE\\ Unless expressly stated otherwise, this messag...{{dropped}}\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}