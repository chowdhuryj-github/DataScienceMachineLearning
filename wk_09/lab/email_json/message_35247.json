{"category": "ham", "to_address": "R-help@stat.math.ethz.ch", "from_address": "\"Nordlund, Dan (DSHS/RDA)\" <NordlDJ@dshs.wa.gov>", "subject": "Re: [R] repeated measures regression", "body": "> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch \n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of John Christie\n> Sent: Wednesday, May 23, 2007 6:09 PM\n> To: Bert Gunter\n> Cc: R-help@stat.math.ethz.ch\n> Subject: Re: [R] repeated measures regression\n> \n> Hmmm, been away and got this...  I appreciate the effort but there  \n> wasn't anything, in principle, in MASS on this I didn't already  \n> know.  My question is just more about the functioning of the lm  \n> command and deriving these values.  I understand that its the wrong  \n> approach for repeated measures design and lme is more appropriate.   \n> But, I wanted to examine / compare.  So, my question still stands.   \n> How does one get something like the subject x effect \n> interaction term  \n> from lm?\n\nIf you just want to piece together a repeated measures analysis from lm(), it is certainly possible.  Say you have 10 subjects, each measured under 2 conditions.  You could do something like this:\n\n#create sample data\ny <- sample(1:10, 20, replace=TRUE) #response variable\nsubj <- as.factor(c(1:10, 1:10)) #subject id\ncondition <- as.factor(c(rep(1,10),rep(2,10))) #experimental condition\ntest.dat <- as.data.frame(cbind(y, subj, condition))\ntest.dat\n\n#model response as a function of subj and condition\ntest.lm <- lm(y ~ as.factor(subj) + as.factor(condition), data=test.dat) \nsummary(test.lm)\nanova(test.lm)\n\nIf you look at the anova() output, you will have sums of squares for subj, condition and residuals.  For this simple and balanced example, Residuals is the subj x condition interaction which can be used as the error term for testing the condition effect.  But as has been pointed out, there are better and easier ways to analyze repeated measures, especially as the designs get more complex.\n\n\nHope this is helpful,\n\nDan\n\nDaniel J. Nordlund\nResearch and Data Analysis\nWashington State Department of Social and Health Services\nOlympia, WA  98504-5204\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}