{"category": "ham", "to_address": "Michael B Allen <mba2000@ioplex.com>", "from_address": "Jeremy Allison <jra@samba.org>", "subject": "Re: Cross Realm SMB Signature Failure", "body": "On Thu, May 03, 2007 at 10:54:16PM -0400, Michael B Allen wrote:\n> When smbclient authenticates across realms (from MIT realm S.W.NET to\n> W2K3 realm W.NET) I'm seeing the server is just echoing back the same\n> signature sent by client. That signature of couse fails verification:\n> \n> $ kinit -f ioplex@S.W.NET\n> Password for ioplex@S.W.NET: \n> $ smbclient -k -U ioplex //dc1.w.net/tmp\n> signing_good: BAD SIG: seq 1\n> SMB Signature verification failed on incoming packet!\n> session setup failed: Server packet had invalid SMB signature!\n> \n> If I use a W.NET cred it works fine and ssh works in the other direction\n> so I think the trust is good.\n> \n> All enctypes are RC4. Haven't updated the W2K3 server since installing\n> it. Trying that now ...\n> \n> I'm using stock 3.0.23c-2 on CentOS 5.0 with an unmodified smb.conf.\n> \n> Has anyone seen this before?\n\nYes - I have a fix for this in the current 3.0.25rc tree.\n\nJeremy.\n\n"}