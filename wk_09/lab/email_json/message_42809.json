{"category": "ham", "to_address": "\"Peter Dalgaard\" <p.dalgaard@biostat.ku.dk>,\n   \"John Sorkin\" <jsorkin@grecc.umaryland.edu>", "from_address": "\"Doran, Harold\" <HDoran@air.org>", "subject": "Re: [R] lme vs. SAS proc mixed. Point estimates and SEs are the\n\tsame, DFs are different", "body": "In addition to Peter's comments, the following link summarizes the issue\nas well. This is a direct response to the SAS/lmer DF issue.\n\nhttps://stat.ethz.ch/pipermail/r-help/2006-May/094765.html\n\nHarold\n \n\n> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch \n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Peter Dalgaard\n> Sent: Tuesday, June 05, 2007 4:44 AM\n> To: John Sorkin\n> Cc: r-help@stat.math.ethz.ch\n> Subject: Re: [R] lme vs. SAS proc mixed. Point estimates and \n> SEs are the same, DFs are different\n> \n> John Sorkin wrote:\n> > R 2.3\n> > Windows XP\n> >\n> > I am trying to understand lme. My aim is to run a random \n> effects regression in which the intercept and jweek are \n> random effects. I am comparing output from SAS PROC MIXED \n> with output from R. The point estimates and the SEs are the \n> same, however the DFs and the p values are different. I am \n> clearly doing something wrong in my R code. I would \n> appreciate any suggestions of how I can change the R code to \n> get the same DFs as are provided by SAS.\n> >   \n> This has been hashed over a number of times before. In short:\n> \n> 1) You're not necessarily doing anything wrong\n> 2) SAS PROC MIXED is not necessarily doing it right\n> 3) lme() is _definitely_ not doing it right in some cases\n> 4) both work reasonably in large sample cases (but beware \n> that this is not equivalent to having many observation points)\n> \n> SAS has an implementation of the method by Kenward and \n> Rogers, which could be the most reliable general \n> DF-calculation method around (I don't trust their \n> Satterthwaite option, though). Getting this or equivalent \n> into lme() has been on the wish list for a while, but it is \n> not a trivial thing to do.\n> \n> > SAS code:\n> > proc mixed data=lipids2;\n> >   model ldl=jweek/solution;\n> >   random int jweek/type=un subject=patient;\n> >   where lastvisit ge 4;\n> > run;\n> >\n> > SAS output:\n> >                    Solution for Fixed Effects\n> >\n> >                          Standard\n> > Effect       Estimate       Error      DF    t Value    Pr > |t|\n> >\n> > Intercept      113.48      7.4539      25      15.22      <.0001\n> > jweek         -1.7164      0.5153      24      -3.33      0.0028\n> >\n> >         Type 3 Tests of Fixed Effects\n> >\n> >               Num     Den\n> > Effect         DF      DF    F Value    Pr > F\n> > jweek           1      24      11.09    0.0028\n> >\n> >\n> > R code:\n> > LesNew3 <- groupedData(LDL~jweek | Patient, \n> data=as.data.frame(LesData3), FUN=mean)\n> > fit3    <- lme(LDL~jweek, \n> data=LesNew3[LesNew3[,\"lastvisit\"]>=4,], random=~1+jweek)\n> > summary(fit3)\n> >\n> > R output:\n> > Random effects:\n> >  Formula: ~1 + jweek | Patient\n> >  Structure: General positive-definite, Log-Cholesky parametrization\n> >  \n> >\n> > Fixed effects: LDL ~ jweek \n> >                 Value Std.Error DF   t-value p-value\n> > (Intercept) 113.47957  7.453921 65 15.224144  0.0000\n> > jweek        -1.71643  0.515361 65 -3.330535  0.0014\n> >\n> > John Sorkin M.D., Ph.D.\n> > Chief, Biostatistics and Informatics\n> > University of Maryland School of Medicine Division of Gerontology \n> > Baltimore VA Medical Center 10 North Greene Street GRECC (BT/18/GR) \n> > Baltimore, MD 21201-1524\n> > (Phone) 410-605-7119\n> > (Fax) 410-605-7913 (Please call phone number above prior to faxing)\n> >\n> > Confidentiality Statement:\n> > This email message, including any attachments, is for the \n> > so...{{dropped}}\n> >\n> > ______________________________________________\n> > R-help@stat.math.ethz.ch mailing list\n> > https://stat.ethz.ch/mailman/listinfo/r-help\n> > PLEASE do read the posting guide \n> > http://www.R-project.org/posting-guide.html\n> > and provide commented, minimal, self-contained, reproducible code.\n> >\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide \n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}