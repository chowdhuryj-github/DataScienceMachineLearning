{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 412: log dates/time in event startup messages in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 412\nrevision-id: tridge@samba.org-20070601052316-xw1xo5fx9hxgdjl9\nparent: tridge@samba.org-20070601035018-iqs91hrut48yk8jg\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Fri 2007-06-01 15:23:16 +1000\nmessage:\n  log dates/time in event startup messages\nmodified:\n  tools/events                   events-20070529030121-04fjh63cxfh8v1pj-1\n=== modified file 'tools/events'\n--- a/tools/events\t2007-06-01 03:50:18 +0000\n+++ b/tools/events\t2007-06-01 05:23:16 +0000\n@@ -11,7 +11,7 @@\n \t# wait for local services to come up.\n \t[ -z \"$CTDB_WAIT_TCP_PORTS\" ] || {\n \t  all_ok=0\n-\t  echo \"Waiting for local tcp ports $CTDB_WAIT_TCP_PORTS\"\n+\t  echo \"`/bin/date` Waiting for local tcp ports $CTDB_WAIT_TCP_PORTS\"\n \t  while [ $all_ok -eq 0 ]; do\n \t  \t  all_ok=1\n \t  \t  for p in $CTDB_WAIT_TCP_PORTS; do\n@@ -23,12 +23,12 @@\n \t\t\texit 1\n \t\t  }\n           done\n-\t  echo \"Local tcp services are up\"\n+\t  echo \"`/bin/date` Local tcp services are up\"\n \t}\n \t# wait for local directories to becomes available (could be slow to mount)\n \t[ -z \"$CTDB_WAIT_DIRECTORIES\" ] || {\n \t  all_ok=0\n-\t  echo \"Waiting for local directories $CTDB_WAIT_DIRECTORIES\"\n+\t  echo \"`/bin/date` Waiting for local directories $CTDB_WAIT_DIRECTORIES\"\n \t  while [ $all_ok -eq 0 ]; do\n \t  \t  all_ok=1\n \t  \t  for d in $CTDB_WAIT_DIRECTORIES; do\n@@ -40,7 +40,7 @@\n \t\t\texit 1\n \t\t  }\n           done\n-\t  echo \"Local directories are available\"\n+\t  echo \"`/bin/date` Local directories are available\"\n \t}\n \texit 0;\t\n \t;;\n@@ -55,7 +55,7 @@\n \tmaskbits=$3\n \n \t/sbin/ip addr add $ip/$maskbits dev $iface || {\n-\t\t echo \"Failed to add $ip/$maskbits on dev $iface\"\n+\t\t echo \"`/bin/date` Failed to add $ip/$maskbits on dev $iface\"\n \t\t exit 1\n \t}\n \techo $ip >> /etc/ctdb/taken_ips\n@@ -72,14 +72,14 @@\n \n      releaseip)\n \tif [ $# != 3 ]; then\n-\t   echo \"must supply interface, IP and maskbits\"\n+\t   echo \"`/bin/date` must supply interface, IP and maskbits\"\n \t   exit 1\n \tfi\n \tiface=$1\n \tip=$2\n \tmaskbits=$3\n \t/sbin/ip addr del $ip dev $iface || {\n-\t\t echo \"Failed to del $ip on dev $iface\"\n+\t\t echo \"`/bin/date` Failed to del $ip on dev $iface\"\n \t\t exit 1\n \t}\n \t# if we have a local arp entry for this IP then remove it\n@@ -115,5 +115,5 @@\n \t;;\n esac\n \n-echo \"Invalid command $cmd\"\n+echo \"`/bin/date` Invalid command $cmd\"\n exit 1\n\n"}