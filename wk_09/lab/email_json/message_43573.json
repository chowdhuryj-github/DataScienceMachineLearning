{"category": "ham", "to_address": "Jeremy Allison <jra@samba.org>", "from_address": "\"Stefan (metze) Metzmacher\" <metze@samba.org>", "subject": "Re: samba3 crash", "body": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nJeremy Allison schrieb:\n> On Tue, Jun 05, 2007 at 02:30:30PM +0200, Stefan (metze) Metzmacher wrote:\n>> -----BEGIN PGP SIGNED MESSAGE-----\n>> Hash: SHA1\n>>\n>>>> home/build/build_farm/samba_3_0.metze/source/bin/smbd\"\n>>>>         result = 1696625253\n>>>> #5  0x374ecc in byte_range_lock_destructor (br_lck=0x40164868) at\n>>>> locking/brlock.c:1578\n>>>>         data = {dptr = 0x401b90c8 \"\", dsize = 8832}\n>>>>         status = {v = 3221225473}\n>>>>         key = {dptr = 0x40164878 \"\", dsize = 16}\n>>>> #6  0x3c862c in _talloc_free (ptr=0x40164868) at lib/talloc/talloc.c:0\n>>>> No locals.\n>>>> #7  0x3c9630 in talloc_free (ptr=0x40164868) at lib/talloc/talloc.c:0\n>> I just found the difference between LOCK3 and BASE-LOCK-LOCK3\n>> samba has torture_numops=100 and samba4 has torture_numops=10\n>>\n>> when I change it to 10 in samba3 it also doesn't appear...\n>>\n>> should we change samba4 to 100 again?\n> \n> Oh, is this on HPUX ? HPUX is one of the insane\n> systems that has a hard coded limit on the number\n> of allowable fcntl locks. You have to change a\n> kernel tunable and reboot to fix this.\n> \n> If it's running out of fcntl locks on HPUX this\n> is a known HPUX bug - we tell people to up the\n> number of allowable locks and reboot.\n\nHi Jeremy,\n\nthanks! we changed nflock from 200 to 500 and it works fine now.\n\nAnother workaround is \"posix locking = no\"...\n\nmetze\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.5 (GNU/Linux)\nComment: Using GnuPG with SUSE - http://enigmail.mozdev.org\n\niD8DBQFGZrAim70gjA5TCD8RAq0oAJ9zfgcQ0sJ/WO40f1LVkNlaMcu4HgCgwVVy\n1yIQt9U9jcT84utMvs7EhD8=\n=AUey\n-----END PGP SIGNATURE-----\n\n"}