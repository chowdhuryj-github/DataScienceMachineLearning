{"category": "ham", "to_address": "Jacques Wagnor <jacques.wagnor@gmail.com>", "from_address": "Sundar Dorai-Raj <sundar.dorai-raj@pdf.com>", "subject": "Re: [R] Alternatives to unlist()", "body": "\n\nJacques Wagnor said the following on 5/4/2007 8:53 AM:\n> Given the following, one of the things I am trying to see is what % of\n> draws are below a certain number:\n> \n> lambda <- 3\n> rate <- 5\n> n <- 5\n> \n> set.seed(123)\n> v <- replicate(n, rexp(rpois(1,lambda), rate))\n> vv <- unlist(v)\n> cat(\"% of draws below 0.1:\", round(length(subset(vv, vv <\n> 0.1))/length(vv)*100,0), \"%\\n\")\n> \n> In actuality, my lambda, rate, and n are 26, 10, 1000000,\n> respectively; which in effect makes the length of vv roughly equal\n> 26'000'000. When I run cat(...), I get the following:\n> \n> Error: cannot allocate vector of size 101540 Kb\n> In addition: Warning messages:\n> 1: Reached total allocation of 1015Mb: see help(memory.size)\n> 2: Reached total allocation of 1015Mb: see help(memory.size)\n> \n> Rather than keep the code as is and resort to memory.limit(), I would\n> like to see how the code can be modified (i.e., alternatives to\n> unlist()) such that I could still see what % of draws are below a\n> certain number.\n> \n> I'd appreciate any suggestions.\n> \n> Regards,\n> \n> platform i386-pc-mingw32\n> arch     i386\n> os       mingw32\n> system   i386, mingw32\n> status\n> major    2\n> minor    2.1\n> year     2005\n> month    12\n> day      20\n> svn rev  36812\n> language R\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\nThis works for me on R-2.5.0 on Win XP with 1GB RAM.\n\nsystem.time({\n   set.seed(1)\n   lambda <- 26\n   rate <- 10\n   n <- 1000000\n   v <- replicate(n, rexp(rpois(1, lambda), rate))\n   vbar <- sapply(v, function(x) mean(x < 0.1))\n   vlen <- sapply(v, length)\n})\n#   user  system elapsed\n#  75.67    1.13   96.85\n\n(m <- weighted.mean(vbar, vlen))\n# [1] 0.6320496\n\ncat(\"% of draws below 0.1: \", round(m * 100), \"%\\n\", sep = \"\")\n\nNote your version R is almost a year and half old. Please upgrade. It's \neasy and free.\n\n--sundar\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}