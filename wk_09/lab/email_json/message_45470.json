{"category": "ham", "to_address": "Patrick Wang <pwang@berkeley.edu>", "from_address": "Tony Plate <tplate@acm.org>", "subject": "Re: [R] how to find how many modes in 2 dimensions case", "body": "If you want to count the local maxima in the n x n matrix returned by \nkde2d, AND you know there are no ties, you could do something like the \nfollowing:\n\n > set.seed(1)\n > x <- matrix(sample(10, 25, rep=TRUE), 5, 5)\n > x\n      [,1] [,2] [,3] [,4] [,5]\n[1,]    3    9    3    5   10\n[2,]    4   10    2    8    3\n[3,]    6    7    7   10    7\n[4,]   10    7    4    4    2\n[5,]    3    1    8    8    3\n > sum(x > cbind(0, x[,-5]) & x > cbind(x[,-1], 0) & x > rbind(x[-1,], \n0) & x > rbind(0, x[-5,]))\n[1] 4\n >\n\nJust be careful that your counting formula matches your definition of \n\"neighbor\" (the above formula does not include diagonal neighbors).\n\nAnd of course, ties make things more complicated (note that the above \nsimple algorithm misses the local maximum consisting of two 8's in the \nlast row.)\n\n-- Tony Plate\n\n\nPatrick Wang wrote:\n> Hi,\n> \n> Does anyone know how to count the number of modes in 2 dimensions using\n> kde2d function?\n> \n> Thanks\n> Pat\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}