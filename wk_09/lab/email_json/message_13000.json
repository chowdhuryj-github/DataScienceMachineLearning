{"category": "ham", "to_address": "perl6-internals@perl.org", "from_address": "chromatic <chromatic@wgz.org>", "subject": "Re: [perl #42619] t/stm/llqueue_2.pir sometimes hangs", "body": "On Sunday 22 April 2007 18:35, Allison Randal wrote:\n\n> It fails for me too (MacOSX 10.4.9, Intel Core 2 Duo), but it was marked\n> as TODO for the release.\n>\n> t/stm/llqueue............................ok 1/2\n>       #     Failed (TODO) test (t/stm/llqueue.t at line 59)#\n> got: ''#     expected: 'sum is 4950# '# './parrot -D40 --gc-debug\n> \"/Users/allison/projects/svn/parrot/t/stm/llqueue_2.pir\"' failed with\n> exit code [SIGNAL 11]\n>\n> chromatic, your patch does seem to fix the problem for me, but then so\n> does running 'make realclean'. (I've been getting intermittent test\n> hangs with STM on various different tests for a few weeks now, and they\n> always go away when I run 'realclean'. And, when I set out to track them\n> down, they disappear.)\n\nMy patch only masks the symptom by disabling GC if there are threads running.  \nThe problem is that some thread somewhere sometimes gets aggressive and \nstarts collecting various important pieces of infrastructure like class \nvtables, even if other threads are using them.\n\nI haven't quite yet worked out why this happens.\n\n-- c\n\n"}