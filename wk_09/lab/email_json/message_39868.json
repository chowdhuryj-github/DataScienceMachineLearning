{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Lucke, Joseph F\" <Joseph.F.Lucke@uth.tmc.edu>", "subject": "[R] RODBC query", "body": "As a newbie to RODBC (Windows XP), I find that the commands aren't\nworking quite as expected.\nAfter\nLibrary(RODBC)\n\nI had planned to use the two-step process\n\nmyConn = odbcConnectExcel(\"Dates.xls\")\nsqlQuery(myConn,\"SELECT ID, ADM_DATE, ADM_TIME FROM A\")\t#A is the Excel\nspreadsheet name\nX = sqlGetResults(myConn, as.is=c(T,T,F))\n#2 char variables and 1 integer\nodbcClose(myConn)\n\nThis doesn't work.  Instead the following works:\n\nmyConn = odbcConnectExcel(\"Dates.xls\")\nX=sqlQuery(myConn,\"SELECT ID, ADM_DATE, ADM_TIME FROM A\",\nas.is=c(T,T,F))\nodbcClose(myConn)\n\n\n> class(X)\n[1] \"data.frame\"\n> class(X$ID)\n[1] \"character\"\n> class(X[,2])\n[1] \"character\"\n> class(X[,3])\n[1] \"integer\"\n\n\nI thought sqlQuery stored a query that was to be processed by\nsqlGetResults.  What's happening here?\n\nJoe\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}