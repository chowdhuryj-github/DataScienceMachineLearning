{"category": "ham", "to_address": "\"Leeds, Mark (IED)\" <Mark.Leeds@morganstanley.com>", "from_address": "Robert Gentleman <rgentlem@fhcrc.org>", "subject": "Re: [R] Gentleman and Ihaka , 2000 paper question", "body": "not sure just what you want, but here are some snippets\n\nnewton <-\n   function(lfun, est, tol = 1e-7, niter = 500) {\n     cscore <- lfun$score(est)\n     if (abs(cscore) < tol)\n       return(est)\n     for (i in 1:niter) {\n       new <- est - cscore / lfun$d2(est)\n       cscore <- lfun$score(new)\n       if (abs(cscore) < tol)\n         return(new)\n       est <- new\n     }\n     stop(\"exceeded allowed number of iterations\")\n   }\n\nwith the likelihood function\n\nRmklike <-\n   function(data) {\n     n <- length(data)\n     sumx <- sum(data)\n     lfun <- function(mu) n * log(mu) - mu * sumx\n     score <- function(mu) n / mu - sumx\n     d2 <- function(mu) -n / mu^2\n     list(lfun = lfun, score = score, d2 = d2)\n   }\n\n\nLeeds, Mark (IED) wrote:\n> In their paper, \"Lexical Scope and Statistical Computing\", the authors (\n> Gentleman and Ihaka ) go to great length explaining why R's use of\n> lexical scoping creates advantages when doing statistical computations.\n> \n> If anyone has or is familiar with this paper, could they provide the\n> main program code for how the \"newton\" function would be called in their\n> example on page 500 of the paper.  The authors are extremely clear in\n> their writing and the paper is quite an eye opener for me but it seems\n> like lfun somehow needs to be initialized so that it \"grabs\" the\n> environment of \"Rmklike\". \n\n   Rmlike is called to create the likelihood function, and since that \nfunction is defined in the body of Rmlike, it has the evaluation \nenvironment by default. And any return value will have the correct \nenvironment.\n\n> I'm not sure how one would go about doing this so I am wondering what\n> the main program that calls \"newton\" would be\n> if there was one. Thanks.\n> \n\nSo,\n\n   data=rexp(10, rate=.3)\n   lf = Rmklike(data)\n   newton(lf, .1)\n\n\nseems to do the trick (and surprisingly still works, as written some \nunbelievably long time ago)\n\n  Robert\n\n> \n> \t\n> Mark\n> --------------------------------------------------------\n> \n> This is not an offer (or solicitation of an offer) to buy/se...{{dropped}}\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n> \n\n-- \nRobert Gentleman, PhD\nProgram in Computational Biology\nDivision of Public Health Sciences\nFred Hutchinson Cancer Research Center\n1100 Fairview Ave. N, M2-B876\nPO Box 19024\nSeattle, Washington 98109-1024\n206-667-7700\nrgentlem@fhcrc.org\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}