{"category": "ham", "to_address": "chromatic <chromatic@wgz.org>", "from_address": "Joshua Isom <jrisom@gmail.com>", "subject": "Re: GC bug on freebsd/x86, triggered by a perl6 test", "body": "After a little prodding around, I think the problem is that the dynops \naren't build with the rpath.  I don't know how \"proper\" the following \npatch is(i.e. linux doesn't seem to have a problem so either this is \nright or the other way is right), but it does the trick.\n\nIndex: config/gen/makefiles/dynoplibs_pl.in\n===================================================================\n--- config/gen/makefiles/dynoplibs_pl.in    (revision 18819)\n+++ config/gen/makefiles/dynoplibs_pl.in    (working copy)\n@@ -24,7 +24,7 @@\n  # Config stuff\n  our $CC = q[@cc@ -c];\n  our $LD = q[@ld@];\n-our $LDFLAGS = q[@ldflags@ @ld_debug@];\n+our $LDFLAGS = q[@ldflags@ @ld_debug@ @rpath_blib@];\n  our $LD_LOAD_FLAGS = q[@ld_load_flags@];\n  our $PERL = q[@perl@];\n  our $LOAD_EXT = q[@load_ext@];\n\n\nOn Jun 4, 2007, at 3:07 PM, chromatic wrote:\n\n> On Monday 04 June 2007 12:49:45 Mark Glines wrote:\n>\n>> (the LD_LIBRARY_PATH bit is required on freebsd so parrot can find\n>> libparrot.so.)\n>\n> The GNU linker supports a flag to mark a relocatable shared library.  \n> From my\n> Makefile:\n>\n> \t -Wl,-rpath=/home/chromatic/dev/parrot/blib/lib\n>\n> I don't know which linker you use on FreeBSD, but is there a similar \n> flag?  If\n> so, using it could clear up some of the dynamic loading problems \n> (especially\n> for dynops and dynpmcs).\n>\n> -- c\n>\n\n"}