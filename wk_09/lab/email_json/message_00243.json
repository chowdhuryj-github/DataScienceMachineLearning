{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jelmer@samba.org", "subject": "svn commit: samba r22134 - in branches/SAMBA_4_0: .\n\tsource/script/tests", "body": "Author: jelmer\nDate: 2007-04-09 00:53:05 +0000 (Mon, 09 Apr 2007)\nNew Revision: 22134\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22134\n\nLog:\nCreate different smb.conf file for the client side. This should make use with Samba 3 or windows easier as well as environments.\nModified:\n   branches/SAMBA_4_0/\n   branches/SAMBA_4_0/source/script/tests/mktestdc.sh\n   branches/SAMBA_4_0/source/script/tests/selftest.pl\n\n\nChangeset:\n\nProperty changes on: branches/SAMBA_4_0\n___________________________________________________________________\nName: bzr:merge\n...skipped...\n\nModified: branches/SAMBA_4_0/source/script/tests/mktestdc.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/mktestdc.sh\t2007-04-08 23:55:01 UTC (rev 22133)\n+++ branches/SAMBA_4_0/source/script/tests/mktestdc.sh\t2007-04-09 00:53:05 UTC (rev 22134)\n@@ -43,8 +43,6 @@\n PREFIX_ABS=`pwd`\n cd $oldpwd\n \n-TEST_DATA_PREFIX=$PREFIX_ABS\n-\n TMPDIR=$PREFIX_ABS/tmp\n ETCDIR=$PREFIX_ABS/etc\n PIDDIR=$PREFIX_ABS/pid\n@@ -61,15 +59,8 @@\n rm -rf $PREFIX/*\n mkdir -p $PRIVATEDIR $ETCDIR $PIDDIR $NCALRPCDIR $LOCKDIR $TMPDIR $LDAPDIR/db $LDAPDIR/db/bdb-logs $LDAPDIR/db/tmp\n \n-if [ -z \"$VALGRIND\" ]; then\n-    nativeiconv=\"true\"\n-else\n-    nativeiconv=\"false\"\n-fi\n-\n cat >$CONFFILE<$conffile\");\n+print CF \"[global]\\n\";\n+if (defined($ENV{VALGRIND})) {\n+\tprint CF \"iconv:native = true\\n\";\n+} else {\n+\tprint CF \"iconv:native = false\\n\";\n+}\n+print CF \"\n+\tworkgroup = $testenv_vars->{DOMAIN}\n+\trealm = $testenv_vars->{REALM}\n+\tncalrpc dir = $testenv_vars->{NCALRPCDIR}\n+\tjs include = $srcdir/scripting/libjs\n+\twinbindd socket directory = $testenv_vars->{WINBINDD_SOCKET_DIR}\n+\tname resolve order = bcast\n+\tinterfaces = 127.0.0.1/8\n+\tpanic action = $srcdir/script/gdb_backtrace \\%PID\\% \\%PROG\\%\n+\tmax xmit = 32K\n+\tnotify:inotify = false\n+\tldb:nosync = true\n+\tsystem:anonymous = true\n+#We don't want to pass our self-tests if the PAC code is wrong\n+\ttorture:basedir = st\n+\tgensec:require_pac = true\n+\tpid directory = $testenv_vars->{PIDDIR}\n+\";\n+close(CF);\n+\n my @torture_options = ();\n push (@torture_options, \"--option=interfaces=$interfaces\");\n-push (@torture_options, $testenv_vars->{CONFIGURATION});\n+push (@torture_options, \"--configfile=$conffile\");\n # ensure any one smbtorture call doesn't run too long\n push (@torture_options, \"--maximum-runtime=$torture_maxtime\");\n push (@torture_options, \"--target=$opt_target\");\n\n"}