{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 137: merge from volker and ronnie in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 137\nrevision-id: tridge@samba.org-20070417092749-c3fed1e34bc970c8\nparent: tridge@samba.org-20070417071112-06cbeeb23d25fafa\nparent: ronniesahlberg@gmail.com-20070417081508-rhx2vqhbqqkyqtdm\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Tue 2007-04-17 19:27:49 +1000\nmessage:\n  merge from volker and ronnie\nmodified:\n  common/ctdb_daemon.c           ctdb_daemon.c-20070409200331-3el1kqgdb9m4ib0g-1\n    ------------------------------------------------------------\n    merged: ronniesahlberg@gmail.com-20070417081508-rhx2vqhbqqkyqtdm\n    parent: ronniesahlberg@gmail.com-20070417073849-4ea4b0uj0hykxjmv\n    parent: vl@samba.org-20070417073653-il05g8tsenhh7gq0\n    committer: Ronnie sahlberg \n    branch nick: ctdb\n    timestamp: Tue 2007-04-17 18:15:08 +1000\n    message:\n      merge from volker to prevent some valgrind errors\n        ------------------------------------------------------------\n        merged: vl@samba.org-20070417073653-il05g8tsenhh7gq0\n        parent: tridge@samba.org-20070417071112-06cbeeb23d25fafa\n        committer: Volker Lendecke \n        branch nick: tridge-ctdb\n        timestamp: Tue 2007-04-17 09:36:53 +0200\n        message:\n          ZERO_STRUCT writes one byte too many here.\n    ------------------------------------------------------------\n    merged: ronniesahlberg@gmail.com-20070417073849-4ea4b0uj0hykxjmv\n    parent: ronniesahlberg@gmail.com-20070417064353-vf3e7wrah1ifemrb\n    parent: tridge@samba.org-20070417071112-06cbeeb23d25fafa\n    committer: Ronnie sahlberg \n    branch nick: ctdb\n    timestamp: Tue 2007-04-17 17:38:49 +1000\n    message:\n      merge from tridge\n    ------------------------------------------------------------\n    merged: ronniesahlberg@gmail.com-20070417064353-vf3e7wrah1ifemrb\n    parent: ronniesahlberg@gmail.com-20070417053506-u2nrd3z872aj9y1r\n    parent: tridge@samba.org-20070417063528-1d3fb576e31269f0\n    committer: Ronnie sahlberg \n    branch nick: ctdb\n    timestamp: Tue 2007-04-17 16:43:53 +1000\n    message:\n      merge from tridge\n    ------------------------------------------------------------\n    merged: ronniesahlberg@gmail.com-20070417053506-u2nrd3z872aj9y1r\n    parent: ronniesahlberg@gmail.com-20070417050220-hdp626ifsk4qllek\n    parent: tridge@samba.org-20070417053358-ca65998497e6eb09\n    committer: Ronnie sahlberg \n    branch nick: ctdb\n    timestamp: Tue 2007-04-17 15:35:06 +1000\n    message:\n      merge from tridge\n    ------------------------------------------------------------\n    merged: ronniesahlberg@gmail.com-20070417050220-hdp626ifsk4qllek\n    parent: ronniesahlberg@gmail.com-20070417024252-02vexdegtsoenqjh\n    parent: tridge@samba.org-20070417050142-bfa384732fe44e41\n    committer: Ronnie sahlberg \n    branch nick: ctdb\n    timestamp: Tue 2007-04-17 15:02:20 +1000\n    message:\n      merge from tridge\n=== modified file 'common/ctdb_daemon.c'\n--- a/common/ctdb_daemon.c\t2007-04-17 06:20:32 +0000\n+++ b/common/ctdb_daemon.c\t2007-04-17 07:36:53 +0000\n@@ -89,7 +89,7 @@\n /*XXX cant use this since it returns an int\tCTDB_NO_MEMORY(ctdb, r);*/\n \ttalloc_set_name_const(r, \"req_message packet\");\n \n-\tZERO_STRUCT(*r);\n+\tmemset(r, 0, offsetof(struct ctdb_req_message, data));\n \n \tr->hdr.length    = len;\n \tr->hdr.ctdb_magic = CTDB_MAGIC;\n@@ -171,7 +171,7 @@\n \t\tprintf(\"Failed to allocate reply_call in ctdb daemon\\n\");\n \t\treturn;\n \t}\n-\tZERO_STRUCT(*r);\n+\tmemset(r, 0, offsetof(struct ctdb_reply_fetch_lock, data));\n \tr->hdr.length       = length;\n \tr->hdr.ctdb_magic   = CTDB_MAGIC;\n \tr->hdr.ctdb_version = CTDB_VERSION;\n@@ -347,7 +347,7 @@\n \t\tprintf(\"Failed to allocate reply_call in ctdb daemon\\n\");\n \t\treturn;\n \t}\n-\tZERO_STRUCT(*r);\n+\tmemset(r, 0, offsetof(struct ctdb_reply_call, data));\n \tr->hdr.length       = length;\n \tr->hdr.ctdb_magic   = CTDB_MAGIC;\n \tr->hdr.ctdb_version = CTDB_VERSION;\n\n"}