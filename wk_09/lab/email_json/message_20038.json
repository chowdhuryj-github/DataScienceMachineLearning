{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "Jelmer Vernooij <jelmer@samba.org>", "subject": "Rev 12051: Set _CFLAGS variables rather than putting knowledge in\n\tthe ldb Makefile. in file:///home/jelmer/bzr.samba/SAMBA_4_0/", "body": "At file:///home/jelmer/bzr.samba/SAMBA_4_0/\n\n------------------------------------------------------------\nrevno: 12051\nrevision-id: jelmer@samba.org-20070430095236-s1jiamoj4s5hnhj0\nparent: svn-v2:22595@0c0555d6-39d7-0310-84fc-f1cc0bd64818-branches%2fSAMBA_4_0\ncommitter: Jelmer Vernooij \nbranch nick: SAMBA_4_0\ntimestamp: Mon 2007-04-30 11:52:36 +0200\nmessage:\n  Set _CFLAGS variables rather than putting knowledge in the ldb Makefile. \n  This should make it easier to allow use of system tdb or talloc libs using \n  pkg-config.\nmodified:\n  source/lib/ldb/Makefile.in     svn-v2:6442@0c0555d6-39d7-0310-84fc-f1cc0bd64818-branches%2fSAMBA_4_0-source%2flib%2fldb%2fMakefile.in\n  source/lib/talloc/libtalloc.m4 svn-v2:18083@0c0555d6-39d7-0310-84fc-f1cc0bd64818-branches%2fSAMBA_4_0-source%2flib%2ftalloc%2flibtalloc.m4\n  source/lib/tdb/libtdb.m4       svn-v2:18108@0c0555d6-39d7-0310-84fc-f1cc0bd64818-branches%2fSAMBA_4_0-source%2flib%2ftdb%2flibtdb.m4\n=== modified file 'source/lib/ldb/Makefile.in'\n--- a/source/lib/ldb/Makefile.in\t2006-11-16 11:15:02 +0000\n+++ b/source/lib/ldb/Makefile.in\t2007-04-30 09:52:36 +0000\n@@ -18,11 +18,20 @@\n EXTRA_OBJ=@EXTRA_OBJ@\n TESTS=test-tdb.sh @TESTS@\n \n+TALLOC_LIBS = @TALLOC_LIBS@\n+TALLOC_CFLAGS = @TALLOC_CFLAGS@\n+\n+TDB_LIBS = @TDB_LIBS@\n+TDB_CFLAGS = @TDB_CFLAGS@\n+\n+POPT_LIBS = @POPT_LIBS@\n+POPT_CFLAGS = @POPT_CFLAGS@\n+\n CFLAGS=-g -I$(srcdir)/include -Iinclude -I$(srcdir) -I$(srcdir)/.. \\\n-       @POPT_CFLAGS@ -I@tallocdir@ -I@tdbdir@/include -I@libreplacedir@ \\\n+       $(POPT_CFLAGS) $(TALLOC_CFLAGS) $(TDB_CFLAGS) -I@libreplacedir@ \\\n \t-DLIBDIR=\\\"$(libdir)\\\" -DSHLIBEXT=\\\"@SHLIBEXT@\\\" -DUSE_MMAP=1 @CFLAGS@\n \n-LIB_FLAGS=@LDFLAGS@ -Llib -lldb @LIBS@ @POPT_LIBS@\n+LIB_FLAGS=@LDFLAGS@ -Llib -lldb @LIBS@ $(POPT_LIBS)\n \n LDB_TDB_DIR=ldb_tdb\n LDB_TDB_OBJ=$(LDB_TDB_DIR)/ldb_tdb.o \\\n\n=== modified file 'source/lib/talloc/libtalloc.m4'\n--- a/source/lib/talloc/libtalloc.m4\t2006-09-18 01:31:57 +0000\n+++ b/source/lib/talloc/libtalloc.m4\t2007-04-30 09:52:36 +0000\n@@ -15,6 +15,9 @@\n TALLOCOBJ=\"talloc.o\"\n AC_SUBST(TALLOCOBJ)\n \n+TALLOC_CFLAGS=\"-I$tallocdir\"\n+AC_SUBST(TALLOC_CFLAGS)\n+\n AC_CHECK_SIZEOF(size_t,cross)\n AC_CHECK_SIZEOF(void *,cross)\n \n\n=== modified file 'source/lib/tdb/libtdb.m4'\n--- a/source/lib/tdb/libtdb.m4\t2006-11-30 03:25:07 +0000\n+++ b/source/lib/tdb/libtdb.m4\t2007-04-30 09:52:36 +0000\n@@ -17,6 +17,9 @@\n AC_SUBST(TDBOBJ)\n AC_SUBST(LIBREPLACEOBJ)\n \n+TDB_CFLAGS=\"-I$tdbdir/include\"\n+AC_SUBST(TDB_CFLAGS)\n+\n AC_CHECK_FUNCS(mmap pread pwrite getpagesize utime)\n AC_CHECK_HEADERS(getopt.h sys/select.h sys/time.h)\n \n\n"}