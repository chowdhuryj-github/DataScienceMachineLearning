{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Vineet Kumar\" <vineetk@cmu.edu>", "subject": "Re: [R] generating correlated Bernoulli random variables", "body": "Thanks, all for your help!\nvineet\n\n\nOn 7/3/07, Bernhard Klingenberg  wrote:\n>\n> >\n> > > Hi all,\n> > > I was wondering how to generate samples for two RVs X1 and X2.\n> > >\n> > > X1 ~ Bernoulli (p1)\n> > > X2 ~ Bernoulli (p2)\n> > >\n> > > Also, X1 and X2 are correlated with correlation \\rho.\n> >\n>\n> You can use the rmvbin() function in the bindata package, e.g.,\n>\n> require(bindata)\n> n=10\n> p1=0.5\n> p2=0.3\n> rho=0.2\n> rmvbin(n, c(p1,p2), bincorr=(1-rho)*diag(2)+rho)\n> ?rmvbin\n>\n> However, as pointed out before, rho is bounded below and above by some\n> function of the marginal probabilities. (Try above code with rho=0.9)\n> You may want to use the odds ratio (which is unrestricted) to specify\n> the association between the two binary variables and then convert this\n> odds ratio, for given marginal probabilities p1 and p2, into a (valid)\n> correlation rho to be used in rmvbin().\n>\n> Here is some ad hoc code to do that:\n>\n> bincorr <- function(OR, p1, p2) {    #from odds ratio to binary\n> correlation\n>     if (OR==1) p11=p2-p2+p1*p2 else {\n>         p11_1=p2-(1/2/(1-OR)*(1-p1+OR*p1+p2-OR*p2-\n>               sqrt((-1+p1-OR*p1-p2+OR*p2)^2-4*(1-OR)*(p2-p1*p2))))\n>         p11_2=p2-(1/2/(1-OR)*(1-p1+OR*p1+p2-OR*p2-\n>               sqrt((-1+p1-OR*p1-p2+OR*p2)^2)-4*(1-OR)*(p2-p1*p2)))\n>         if (p11_1>0 && p11_1<=p1 && p11_1     }\n>     bincorr=(p11-p1*p2)/sqrt(p1*(1-p1)*p2*(1-p2))\n>     return(bincorr)\n> }\n>\n> For instance, try\n>\n> sapply(c(0,0.5,1,1.5,3,10,100),function(x) bincorr(x,p1,p2))\n>\n> to see the range of valid correlations for odds ratios between 0 and\n> 100, with p1 and p2 as above.\n>\n>\n> Bernhard Klingenberg\n> Dept. of Mathematics and Statistics\n> Williams College, MA\n> www.williams.edu/~bklingen\n>\n>\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}