{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "<hlynch@umd.edu>", "subject": "[R] mixed-effects model using lmer", "body": "Hello R-users,\n\nI have been trying to fit what I think is a simple mixed-effects model using lmer (from lme4), but I've run into some difficulty that I have not been able to resolve using the existing archives or Pinheiro and Bates (2000).\n\nI am measuring populations (of birds) which change with time at a number of different sites. These sites are grouped into regions. Sites are not measured with any regularity, so each site has a different number of observations. I want to treat the effect of year (i.e. the rate of population change) as a fixed effect which is modeled separately for each region, but I want to allow sites within regions to be random effects. I've come up with the following model, but I'm not sure its correct. Any help would be most appreciated.\n\nfit<-lmer(log.count~site+month+year:region-1+(year:region-1|site))\n\nWhat my variables mean:\nlog.count=log(count)\nsite=factor for the different sites, each site is associated with exactly one region\nmonth=fixed effect for the month of the survey\nyear:region = allows me to model different year effects for each region\n\nEach site should have a completely separate intercept, so I have chosen to suppress the intercept and use all the factors of site instead.\n\nThe difficulty is, of course, with the last term. I want to have sites vary randomly *within* a region, but I don't want them to vary randomly throughout all the regions, i.e. I want the random effects to sum to zero for each region separately. \n\nMy output looks like (using the display() function from Gelman and Hill (2007)):\n\n*******************************\nlmer(formula = log.count ~ site + month + year:region - 1 + (year:region - \n    1 | site))\n              coef.est coef.se\nsiteAITC       7.25     0.15  \nsiteALMI       4.57     0.29  \nsiteBENE       5.98     0.29  \nsiteBOOT       7.08     0.17  \nsiteBROW       6.47     0.14  \n(I cut some out here for space) \nsiteUSEF       6.97     0.21  \nsiteWATE       7.38     0.15  \nsiteYANK       8.31     0.11  \nmonthJAN      -0.15     0.07  \nmonthNOV      -0.01     0.07  \nyear:regionNE -0.16     0.12  \nyear:regionNW  0.04     0.01  \nyear:regionSH  0.02     0.02  \nyear:regionSW  0.07     0.01  \n\nError terms:\n Groups   Name          Std.Dev. Corr           \n site     year:regionNE 0.12                    \n          year:regionNW 0.03     0.00           \n          year:regionSH 0.00     0.00 0.00      \n          year:regionSW 0.00     0.00 0.00 0.00 \n Residual               0.26                    \n---\nnumber of obs: 110, groups: site, 23\nAIC = 157.8, DIC = -72.6\ndeviance = 3.6 \n\n********************************\n\nThe coefficients look totally reasonable given all the analysis I've already done on the system. My confusion comes about when I look at the random effects using ranef(fit) and se.ranef(fit):\n\n********************************\n>ranef(fit)\n\nAn object of class \"ranef.lmer\"\n[[1]]\n     year:regionNE year:regionNW year:regionSH year:regionSW\nAITC       0.0e+00       0.0e+00       5.8e-10       0.0e+00\nALMI       0.0e+00      -2.3e-04       0.0e+00       0.0e+00\nBENE       0.0e+00      -2.1e-17       0.0e+00       0.0e+00\nBOOT       0.0e+00       0.0e+00       0.0e+00      -2.4e-09\nBROW       3.0e-15       0.0e+00       0.0e+00       0.0e+00\nBRYE       0.0e+00      -1.3e-02       0.0e+00       0.0e+00\nBRYS       0.0e+00      -8.9e-17       0.0e+00       0.0e+00\nCUVE       0.0e+00      -1.7e-02       0.0e+00       0.0e+00\nDAMO       0.0e+00      -5.0e-03       0.0e+00       0.0e+00\nDANC       0.0e+00      -5.2e-03       0.0e+00       0.0e+00\nDOBE       0.0e+00       8.1e-04       0.0e+00       0.0e+00\nGEOR       0.0e+00      -9.3e-03       0.0e+00       0.0e+00\nHANN       0.0e+00       0.0e+00       3.2e-10       0.0e+00\nHERO      -6.3e-16       0.0e+00       0.0e+00       0.0e+00\nJOUG       0.0e+00      -2.3e-02       0.0e+00       0.0e+00\nMADD       7.3e-16       0.0e+00       0.0e+00       0.0e+00\nMOOT       0.0e+00       0.0e+00       0.0e+00       8.7e-11\nNEKO       0.0e+00      -2.1e-03       0.0e+00       0.0e+00\nPETE       0.0e+00       0.0e+00       0.0e+00       2.5e-09\nPLEN       0.0e+00       0.0e+00       0.0e+00      -2.0e-10\nUSEF       0.0e+00       5.6e-02       0.0e+00       0.0e+00\nWATE       0.0e+00       1.8e-02       0.0e+00       0.0e+00\nYANK       0.0e+00       0.0e+00      -9.0e-10       0.0e+00\n\n>se.ranef(fit)\n\n$site\n     year:regionNE year:regionNW year:regionSH year:regionSW\nAITC         0.120        0.0296       5.8e-06       5.8e-06\nALMI         0.120        0.0204       5.8e-06       5.8e-06\nBENE         0.120        0.0196       5.8e-06       5.8e-06\nBOOT         0.120        0.0296       5.8e-06       5.8e-06\nBROW         0.016        0.0296       5.8e-06       5.8e-06\nBRYE         0.120        0.0144       5.8e-06       5.8e-06\nBRYS         0.120        0.0231       5.8e-06       5.8e-06\nCUVE         0.120        0.0136       5.8e-06       5.8e-06\nDAMO         0.120        0.0086       5.8e-06       5.8e-06\nDANC         0.120        0.0211       5.8e-06       5.8e-06\nDOBE         0.120        0.0221       5.8e-06       5.8e-06\nGEOR         0.120        0.0153       5.8e-06       5.8e-06\nHANN         0.120        0.0296       5.8e-06       5.8e-06\nHERO         0.070        0.0296       5.8e-06       5.8e-06\nJOUG         0.120        0.0086       5.8e-06       5.8e-06\nMADD         0.047        0.0296       5.8e-06       5.8e-06\nMOOT         0.120        0.0296       5.8e-06       5.8e-06\nNEKO         0.120        0.0148       5.8e-06       5.8e-06\nPETE         0.120        0.0296       5.8e-06       5.8e-06\nPLEN         0.120        0.0296       5.8e-06       5.8e-06\nUSEF         0.120        0.0137       5.8e-06       5.8e-06\nWATE         0.120        0.0226       5.8e-06       5.8e-06\nYANK         0.120        0.0296       5.8e-06       5.8e-06\n**************************************\n\nI'm not sure this is correct. For one thing, I get an warning when I run the model that \"Estimated variance-covariance for factor 'site' is singular\". Also, although the random effects do add to zero for each region (within rounding error), I'm not sure how to interpret their standard errors. Each site is in only one of the four regions, and yet lmer seems to be estimating coefficients and standard errors as though each site was replicated in each region which is not the case. I have tried several other strategies based on suggestions from the archive, but this is the closest I have come to something reasonable. \n\nThanks in advance for the help,\nHeather Lynch\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}