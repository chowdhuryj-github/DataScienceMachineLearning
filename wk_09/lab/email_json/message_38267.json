{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jerry@samba.org", "subject": "svn commit: samba r23201 - in branches/SAMBA_3_0_26/source:\n\tpython/examples/tdbpack script script/tests", "body": "Author: jerry\nDate: 2007-05-29 14:38:31 +0000 (Tue, 29 May 2007)\nNew Revision: 23201\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23201\n\nLog:\nminor patches to make test and pythong examples from SAMBA-3_0\nModified:\n   branches/SAMBA_3_0_26/source/python/examples/tdbpack/tdbtimetrial.py\n   branches/SAMBA_3_0_26/source/python/examples/tdbpack/test_tdbpack.py\n   branches/SAMBA_3_0_26/source/script/mkversion.sh\n   branches/SAMBA_3_0_26/source/script/tests/selftest.sh\n   branches/SAMBA_3_0_26/source/script/tests/test_posix_s3.sh\n\n\nChangeset:\nModified: branches/SAMBA_3_0_26/source/python/examples/tdbpack/tdbtimetrial.py\n===================================================================\n--- branches/SAMBA_3_0_26/source/python/examples/tdbpack/tdbtimetrial.py\t2007-05-29 14:26:27 UTC (rev 23200)\n+++ branches/SAMBA_3_0_26/source/python/examples/tdbpack/tdbtimetrial.py\t2007-05-29 14:38:31 UTC (rev 23201)\n@@ -1,4 +1,4 @@\n-#! /usr/bin/python2.2\n+#! /usr/bin/python\n \n def run_trial():\n     # import tdbutil\n\nModified: branches/SAMBA_3_0_26/source/python/examples/tdbpack/test_tdbpack.py\n===================================================================\n--- branches/SAMBA_3_0_26/source/python/examples/tdbpack/test_tdbpack.py\t2007-05-29 14:26:27 UTC (rev 23200)\n+++ branches/SAMBA_3_0_26/source/python/examples/tdbpack/test_tdbpack.py\t2007-05-29 14:38:31 UTC (rev 23201)\n@@ -1,4 +1,4 @@\n-#! /usr/bin/env python2.2\n+#! /usr/bin/env python\n \n __doc__ = \"\"\"test case for samba.tdbpack functions\n \n\nModified: branches/SAMBA_3_0_26/source/script/mkversion.sh\n===================================================================\n--- branches/SAMBA_3_0_26/source/script/mkversion.sh\t2007-05-29 14:26:27 UTC (rev 23200)\n+++ branches/SAMBA_3_0_26/source/script/mkversion.sh\t2007-05-29 14:38:31 UTC (rev 23201)\n@@ -82,6 +82,13 @@\n \telse\n \t    TMP_SVK_REVISION_STR=\"${TMP_REVISION}-${USER}@${HOSTNAME}\"\n \tfi\n+\tif test x\"${HAVESVK}\" = x\"no\";then\n+\t    HAVEBZR=no\n+\t    bzr revno > /dev/null 2>&1 && HAVEBZR=yes\n+\t    TMP_BZR_REVNO=`bzr revno 2> /dev/null`\n+\t    TMP_BZR_NICK=`bzr nick 2> /dev/null`\n+\t    TMP_BZR_REVISION_STR=\"${TMP_BZR_NICK}-${TMP_BZR_REVNO}\"\n+\tfi\n     fi\n \n     if test x\"${HAVESVN}\" = x\"yes\";then\n@@ -89,6 +96,8 @@\n \t    echo \"#define SAMBA_VERSION_SVN_REVISION ${TMP_REVISION}\" >> $OUTPUT_FILE\n     elif test x\"${HAVESVK}\" = x\"yes\";then\n \t    SAMBA_VERSION_STRING=\"${SAMBA_VERSION_STRING}-SVK-build-${TMP_SVK_REVISION_STR}\"\n+    elif test x\"${HAVEBZR}\" = x\"yes\";then\n+\t    SAMBA_VERSION_STRING=\"${SAMBA_VERSION_STRING}-BZR-build-${TMP_BZR_REVISION_STR}\"\n     else\n \t    SAMBA_VERSION_STRING=\"${SAMBA_VERSION_STRING}-SVN-build-UNKNOWN\"\n     fi\n\nModified: branches/SAMBA_3_0_26/source/script/tests/selftest.sh\n===================================================================\n--- branches/SAMBA_3_0_26/source/script/tests/selftest.sh\t2007-05-29 14:26:27 UTC (rev 23200)\n+++ branches/SAMBA_3_0_26/source/script/tests/selftest.sh\t2007-05-29 14:38:31 UTC (rev 23201)\n@@ -95,8 +95,6 @@\n \tlog file = $LOGDIR/log.%m\n \tlog level = 0\n \n-\tpassdb backend = tdbsam\n-\n \tname resolve order = bcast\n EOF\n \n@@ -108,6 +106,8 @@\n \tinterfaces = $TORTURE_INTERFACES\n \tpanic action = $SCRIPTDIR/gdb_backtrace %d %\\$(MAKE_TEST_BINARY)\n \tinclude = $COMMONCONFFILE\n+\n+\tpassdb backend = tdbsam\n EOF\n \n cat >$SAMBA4CONFFILE<<EOF\n@@ -126,11 +126,14 @@\n \tpanic action = $SCRIPTDIR/gdb_backtrace %d %\\$(MAKE_TEST_BINARY)\n \tinclude = $COMMONCONFFILE\n \n+\tpassdb backend = tdbsam\n+\n \t; Necessary to add the build farm hacks\n \tadd user script = /bin/false\n \tadd machine script = /bin/false\n \n \tkernel oplocks = no\n+\tkernel change notify = no\n \n \tsyslog = no\n \tprinting = bsd\n@@ -212,7 +215,7 @@\n (\n  # give time for nbt server to register its names\n  echo \"delaying for nbt name registration\"\n- sleep 4\n+ sleep 10\n  # This will return quickly when things are up, but be slow if we need to wait for (eg) SSL init \n  bin/nmblookup $CONFIGURATION -U $SERVER_IP __SAMBA__\n  bin/nmblookup $CONFIGURATION __SAMBA__\n\nModified: branches/SAMBA_3_0_26/source/script/tests/test_posix_s3.sh\n===================================================================\n--- branches/SAMBA_3_0_26/source/script/tests/test_posix_s3.sh\t2007-05-29 14:26:27 UTC (rev 23200)\n+++ branches/SAMBA_3_0_26/source/script/tests/test_posix_s3.sh\t2007-05-29 14:38:31 UTC (rev 23201)\n@@ -49,8 +49,8 @@\n \n skipped=\"BASE-CHARSET BASE-DEFER_OPEN BASE-DELAYWRITE BASE-OPENATTR BASE-TCONDEV\"\n skipped=\"$skipped RAW-ACLS RAW-COMPOSITE RAW-CONTEXT RAW-EAS\"\n-skipped=\"$skipped RAW-IOCTL RAW-MKDIR RAW-MUX RAW-NOTIFY RAW-OPEN\"\n-skipped=\"$skipped RAW-QFILEINFO RAW-QFSINFO RAW-RENAME RAW-SEARCH\"\n+skipped=\"$skipped RAW-IOCTL RAW-MUX\"\n+skipped=\"$skipped RAW-QFILEINFO RAW-QFSINFO RAW-SEARCH\"\n skipped=\"$skipped RAW-SFILEINFO RAW-STREAMS RAW-WRITE\"\n \n echo \"WARNING: Skipping tests $skipped\"\n\n"}