{"category": "ham", "to_address": "Hans-Peter <gchappi@gmail.com>", "from_address": "\"Alberto Monteiro\" <albmont@centroin.com.br>", "subject": "Re: [R] importing excel-file", "body": "Hans-Peter wrote:\n>\n>> This works in most cases.\n>                 ~~~~~~~~~~~~\n> Huu? (the package is supposed to work in *all* cases...!). Do you use\n> the newest version (v1.3.1 or v1.3.2)? If there are any bugs/issues,\n> please report them to me and they - most likely - will get fixed.\n>\nHere are the problems I noticed.\n\nI can't call read.xls while Excel is opening the xls file. R crashes \nand must be aborted.\n\nI have a spreadsheet where in the first line A1..ZZ1 there are the\nnames of some products. However, A1 is empty, but A8..A311 store dates.\nThe other fields, like B8..B311, store numbers.\n\nSo, if I do:\n\ntest1 <- read.xls(filename, sheet = \"sheet name\")\n\nI will lose the first column: test1[1,1] will be B2. Also, the numbers\naren't recovered as numbers, but as strings, in _local_ format (which\nthe evil geniuses of M$ decided should be represented with commas)\n\n(BTW: what are those \"Levels\" that appear when I type test[x,y]?)\n\nIf I do:\n\ntest2 <- read.xls(filename, sheet = \"sheet name\", colClasses = \"double\")\n\nI will get the numbers correctly, but I will still lose the A8..A311\ncolumn.\n\nIf I do:\n\ntest3 <- read.xls(filename, sheet = \"sheet name\", colNames = FALSE)\n\nI will get A8..A311 (but these are not numbers, and I can't convert\nthem to the dates. Probably they represent the number of days\nsince 1900-01-01, take a day or two, because Excel programmers\nwere stupid and didn't know that 1900 was not a leap year).\n\nFinally, if I do:\n\ntest4 <- read.xls(filename, sheet = \"sheet name\", \n  colNames = FALSE, colClasses = \"double\")\n\nI get A8..A311 as something remotely similar to dates (I can even\ndisplay them as dates: \nas.POSIXlt(\"1899-12-30\", \"GMT\") + test4[8:17, 1] * 86400\nwill return a vector of dates!), but then I will lose the meaning\nof the columns, because test4[,1] is no longer the list of the\nproduct names.\n\nSo it seems that none of the four possibilities is entirely satisfactory.\n\nAlberto Monteiro\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}