{"category": "ham", "to_address": "Andy Spieherty <spiehera@lafayette.edu>", "from_address": "\"Patrick R. Michaud\" <pmichaud@pobox.com>", "subject": "Re: [perl #42620] PGE 'Out of memory' panics.", "body": "On Fri, Apr 20, 2007 at 03:52:35PM -0400, Andy Spieherty wrote:\n> Oh yes.  It's swapping like crazy.  Sorry I didn't mention that \n> explicitly.  (I figured it was obvious!)  The machine in question has \n> 128 MB of physical RAM.  [...]\n> \n> Specifically, I usually do something like:\n> \n>     ulimit -S -t 300   # Avoid runaway tests.\n>     ulimit -S -v 98304 # 96 MB max:  Avoid runaway memory leaks.\n>     ulimit -S -c 0     # Writing 96 MB core files wastes a lot of time.\n> \n> The main result is that the memory footprint of the pge tests appears to\n> continuously grow.  This is reasonable because they run with -G, i.e.\n> garbage collection is turned off.  Oddly, if you turn on garbage\n> collection, the memory use grows *faster*.  Either way, I can't run the\n> tests.\n\nWith chromatic's patch in r18323 (RT #42320), and removing the -G\nflag from the relevant files, I'm now able to run PGE's tests\nincluding p5rx.t and 01-regex.t in under 60MB of virtual \nmemory.  (See below.)\n\nAndy, could you update to r18323, remove the -G's, and see if it \nnow runs to completion on your Solaris box?\n\nThanks!\n\nPm\n\nResults from my x86_64 Linux box, r18323:\n\n$ ulimit -S -v 60000\n$ prove -r t/compilers/pge\nt/compilers/pge/01-codestring............ok\nt/compilers/pge/02-match.................ok\nt/compilers/pge/03-optable...............ok\nt/compilers/pge/06-grammar...............ok\nt/compilers/pge/p5regex/p5rx.............ok\n        355/960 skipped: various reasons\nt/compilers/pge/p6regex/01-regex.........ok\nt/compilers/pge/p6regex/builtins.........ok\nt/compilers/pge/p6regex/closure..........ok\nt/compilers/pge/p6regex/context..........ok\nt/compilers/pge/p6regex/subrules.........ok\nt/compilers/pge/p6regex/syntax_errors....ok\nt/compilers/pge/perl6regex/01-regex......ok\nt/compilers/pge/perl6regex/context.......ok\nt/compilers/pge/pge-hs...................ok\nt/compilers/pge/pge......................ok\nt/compilers/pge/pge_examples.............ok\nt/compilers/pge/pge_globs................ok\nt/compilers/pge/pge_text.................ok\nt/compilers/pge/pge_util.................ok\nAll tests successful, 355 subtests skipped.\nFiles=19, Tests=2292, 79 wallclock secs (62.03 cusr +  4.06 csys = 66.09 CPU)\n$\n\n"}