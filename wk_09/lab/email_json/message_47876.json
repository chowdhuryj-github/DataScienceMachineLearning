{"category": "ham", "to_address": "Marco Pesenti Gritti <mpg@redhat.com>", "from_address": "Bernardo Innocenti <bernie@codewiz.org>", "subject": "Re: [sugar] [PATCH] unfreeze DCON when Sugar UI is (almost) ready\n to\tshow", "body": "Marco Pesenti Gritti wrote:\n\n> we need to get the hardware-manager part of this in before, otherwise we \n> will traceback on startup.\n\nSorry, I sent the patches in reverse order.  Did you get\nthe next one?\n\n\n>> +        # Unfreeze the display when it's stable\n>> +        get_hardware_manager().set_dcon_freeze(0)\n>> +\n> \n> Is this actually working? You need something like:\n> \n> from hardware import hardwaremanager\n> ....\n\nOh, and actually I had that part too, but I've lost this hunk\nwhile copying them to the sandbox.  That's what you get for\nediting code right on the target.\n\nUpdated patch attached.\n\n\n>From b7bfbb7cc628afe29734557f56d92044d2d336d4 Mon Sep 17 00:00:00 2001\nFrom: Bernardo Innocenti \nDate: Wed, 13 Jun 2007 19:56:22 -0400\nSubject: [PATCH] unfreeze DCON when Sugar UI is (almost) ready to show\nOrganization: One Laptop Per Child\n\nThis is part of a masterplan to implement #621 .\n---\n shell/hardware/hardwaremanager.py |    6 ++++++\n shell/view/Shell.py               |    5 +++++\n 2 files changed, 11 insertions(+), 0 deletions(-)\n\ndiff --git a/shell/hardware/hardwaremanager.py b/shell/hardware/hardwaremanager.py\nindex f23af25..c962b28 100644\n--- a/shell/hardware/hardwaremanager.py\n+++ b/shell/hardware/hardwaremanager.py\n@@ -69,6 +69,12 @@ class HardwareManager(object):\n             logging.error('Cannot mute the audio channel')\n         self._mixer.set_mute(self._master, mute)\n \n+    def set_dcon_freeze(self, frozen):\n+        if not self._service:\n+            return\n+\n+        self._service.set_dcon_freeze(frozen)\n+\n     def set_display_mode(self, mode):\n         if not self._service:\n             return\ndiff --git a/shell/view/Shell.py b/shell/view/Shell.py\nindex 892123c..d73fe10 100644\n--- a/shell/view/Shell.py\n+++ b/shell/view/Shell.py\n@@ -38,6 +38,8 @@ from view.keyhandler import KeyHandler\n from view.home.HomeWindow import HomeWindow\n from model import bundleregistry\n \n+from hardware.hardwaremanager import get_hardware_manager\n+\n class Shell(gobject.GObject):\n     def __init__(self, model):\n         gobject.GObject.__init__(self)\n@@ -68,6 +70,9 @@ class Shell(gobject.GObject):\n \n         self.start_activity('org.laptop.JournalActivity')\n \n+        # Unfreeze the display when it's stable\n+        get_hardware_manager().set_dcon_freeze(0)\n+\n     def _activity_started_cb(self, home_model, home_activity):\n         activity_host = ActivityHost(home_activity)\n         self._hosts[activity_host.get_xid()] = activity_host\n-- \n1.5.2\n\n\n\n-- \n   // Bernardo Innocenti\n \\X/  http://www.codewiz.org/\n_______________________________________________\nSugar mailing list\nSugar@lists.laptop.org\nhttp://lists.laptop.org/listinfo/sugar\n\n"}