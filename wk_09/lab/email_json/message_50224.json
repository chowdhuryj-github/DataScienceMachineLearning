{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Andy Bunn\" <Andy.Bunn@wwu.edu>", "subject": "[R] Second y-axis in xyplot (lattice) where y1 and y2 have\n\tdifferent ranges", "body": "Hi all,\n\nI realize this is asking a lot of lattice, but I want to add a second y\naxis inside a xyplot and have y1 and y2 have different ranges. Given dat\nbelow, I can add a second y axis by overlaying a new plot with\npar(new=T) and label axis 4 with standard graphics. I've seen an example\nfor doing something similar in xyplot even though Deepayan has indicated\nthat lattice isn't the right tool for the job. \n\nHowever, is there a way to gracefully add a second y-axis to a xyplot\nwhere y1 and y2 have different scales as in the example below? I've seen\nthe experimental tools to focus and modify lattice graphics but do not\nknow if these are applicable. \n\nI have unreasonable faith that lattice can do anything. Since my\neventual goal is to make use of a grouping variable as with dat2 below,\nlattice will be preferable to complex layouts. Thanks, Andy\n\n\n  dat <- data.frame(Year = 1751:2000,\n                    Stuff = rnorm(250),\n                    Samples = floor(seq(5,30,length.out=250)\n                                +rnorm(250,5)),\n                    Grp = rep('SiteOne',250))\n  par(mar=c(5,4,4,4) + 0.1)\n  plot(Stuff~Year, data=dat, type='l')\n  par(new=T)\n  plot(Samples~Year, data=dat, type=\"l\", axes=F, bty=\"n\",\n       xlab=\"\", ylab=\"\")\n  axis(4, at=pretty(range(dat$Samples)))\n  mtext(\"Number of Samples\", 4, 3)\n\n  xyplot(Stuff + Samples ~ Year | Grp, data=dat,\n         layout = c(1, 1),\n         panel = panel.superpose.2,\n         ylab = \"Stuff\",\n         legend = list(right =\n         list(fun = grid::textGrob(\"Samples\", rot = 90))),\n         type = c('l', 'l'))\n\n  dat2 <- data.frame(Year = rep(1751:2000,2),\n                     Stuff = rep(rnorm(250),2),\n                     Samples = rep(floor(seq(5,30,length.out=250)+\n                       rnorm(250,5)),2),\n                     Grp = c(rep('SiteOne',250),\n                             rep('SiteTwo',250)))\n\n  xyplot(Stuff + Samples ~ Year | Grp, data=dat2,\n         panel = panel.superpose.2,\n         ylab = \"Stuff\",\n         legend = list(right =\n         list(fun = grid::textGrob(\"Samples\", rot = 90))),\n         type = c('l', 'l'))\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}