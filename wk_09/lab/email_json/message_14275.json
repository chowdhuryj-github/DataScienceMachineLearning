{"category": "ham", "to_address": "Yannan Jiang <y.jiang@ctru.auckland.ac.nz>", "from_address": "Chuck Cleland <ccleland@optonline.net>", "subject": "Re: [R] How to get LSMEANS from linear mixed model?", "body": "Yannan Jiang wrote:\n> Hi there,\n> \n>  \n> \n> I am trying to run simulations using R with linear mixed model (lme). There\n> are two factors in my fixed effect model, educ (treatment and control) and\n> mth (visit 1, 2, and 3). What I want to obtain is the estimated treatment\n> difference (treatment - control) at visit 3, plus the standard error and\n> p-value. This can be easily obtained in SAS using lsmeans or estimate\n> statements, but I am not sure how to do this in R. \n> \n>  \n> \n> The fixed effects I obtained are as follows:\n> \n>  \n> \n> Fixed effects: ymth ~ educ * mth - 1 \n> \n>                                     Value               Std.Error\n> DF        t-value               p-value\n> \n> educcont                       0.14814308       0.006232419      93\n> 23.769758         0.0000\n> \n> eductreat                       0.13696952       0.006255672      93\n> 21.895254         0.0000\n> \n> mthymth2                      0.00003759       0.006333043      165\n> 0.005936           0.9953\n> \n> mthymth3                      0.01075489       0.006251328      165\n> 1.720416           0.0872\n> \n> eductreat:mthymth2       0.00323847       0.008947291      165\n> 0.361950           0.7179\n> \n> eductreat:mthymth3       -0.01246565      0.008941306      165\n> -1.394164          0.1651\n> \n>  \n> \n>  \n> \n> The estimated treatment difference I am interested are:\n> \n>  \n> \n>  a<-0.14814308+0.01075489 \n> \n>  b<-0.13696952+0.01075489-0.01246565\n> \n>> b-a\n> \n> [1] -0.02363921   (treatment effect at visit 3, same as SAS lsmean output)\n> \n>  \n> \n> But I don't know how to get the standard error and corresponding p-value for\n> this estimate. Any of your helps on that would be greatly appreciated! \n\n  How about fitting the model this way?\n\ndf$mth <- relevel(df$mth, ref = \"ymth3\")\nlme(ymth ~ educ * mth, random = ~ 1 | id, data = df)\n\n  The coefficient for educ will contain the simple effect of educ at\nmth=ymth3, along with a standard error and p-value.\n\n> Thanks,\n> \n> Yannan\n> \n>  \n> \n> \n> \t[[alternative HTML version deleted]]\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code. \n\n-- \nChuck Cleland, Ph.D.\nNDRI, Inc.\n71 West 23rd Street, 8th floor\nNew York, NY 10010\ntel: (212) 845-4495 (Tu, Th)\ntel: (732) 512-0171 (M, W, F)\nfax: (917) 438-0894\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}