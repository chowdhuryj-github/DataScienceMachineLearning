{"category": "ham", "to_address": "Rhelp <r-help@stat.math.ethz.ch>", "from_address": "Mike Lawrence <Mike.Lawrence@dal.ca>", "subject": "Re: [R] Power calculation with measurement error", "body": "\nOn 26-Jun-07, at 2:36 PM, Mike Lawrence wrote:\n> On 26-Jun-07, at 8:12 AM, Mike Lawrence wrote:\n>> Hi all,\n>> Hopefully this will be quick, I'm looking for pointers to packages/\n>> functions that would allow me to calculate the power of a t.test when\n>> the DV has measurement error. That is, I understand that, ceteris\n>> paribus, experiments using measure with more error (lower\n>> reliability) will have lower power.\n>\n> I came across a reference (http://memetic.ca/reliability.pdf) that\n> provides a formula for calculating the noncentrality parameter for\n> tests using imperfect measures (see Eq. 4), as well as a table of\n> some resulting power estimates. However, while I have created a (very\n> slow) monte carlo function that so far as I can tell matches their\n> results, when I attempt to implement their analytic solution it's way\n> off. Can anyone see what I'm doing incorrectly?\n>\n> n=100\n> r=.5 #reliability\n> e=.5 #effect size\n> delta=(sqrt(r*n)/2)*e\n> power.t.test(n,delta,sig.level=.05,alternative='one.sided')\n>\n>       Two-sample t test power calculation\n>\n>                n = 100\n>            delta = 1.767767\n>               sd = 1\n>        sig.level = 0.05\n>            power = 1\n>      alternative = one.sided\n>\n> NOTE: n is number in *each* group\n>\n>\n> Meanwhile, their tables and my monte carlo method say that the power\n> in that circumstance should be .7\n\n\nFound it; I was using power.t.test without being thorough in reading  \nits details. Sorry for the spam, and for anyone that's interested,  \nhere's the final analytic solution:\n\n#get power for a t.test, incorporating measurement error.\n#n = total number of participants across your 2 groups\n#r = estimated reliability of the measure used\n#e = measured effect size\nget.power=function(n,r,e,tails=2,alpha=.05){\n\td=(sqrt(r*n)/2)*e\n\ta=1-ifelse(tails==2,alpha/2,alpha)\n\tp=1-pt(qt(a,n-2),n-2,d)\n\treturn(p)\n}\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}