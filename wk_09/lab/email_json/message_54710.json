{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Simon Wood <s.wood@bath.ac.uk>", "subject": "Re: [R] gam function in the mgcv library", "body": "On Monday 25 June 2007 13:26, Bill Wheeler wrote:\n> I would like to fit a logistic regression using a smothing spline, where\n> the spline is a piecewise cubic polynomial. Is the knots option used to\n> define the subintervals for each piece of the cubic spline? \n- if you use something like \ngam(y~s(x,bs=\"cr\",k=5),family=binomial,knots=list(x=c(0,.1,.3,.4,.8))\nthen yes, k is the number of knots and the `knots' list specifies where they \noccur. If you use the default `bs=\"tp\"' then the spline basis functions are \nnot really `knot' based, being instead an ordered set of eigenfunctions, that \nare optimal in a defined sense (see Wood, 2003, JRSSB).\n\n> If yes and \n> there are k knots, then why does the coefficients field in the returned\n> object from gam only list k coefficients? Shouldn't there be 4k -4\n> coefficients?\n\nA k knot natural cubic spline only has k free coefficients, so that is all \nthat mgcv:gam reports. If you are thinking about sections of cubic, then the \nother 3 coefficients of each section are determined by the spline  continuity \nconditions + the conditions of having zero second derivative at the end \nknots. Exact details of the `mgcv' \"cr\" basis are given in section 4.1.2 of \nmy 2006  book (see ?gam), but all you really need to know is that it's a \nnatural cubic spline basis parameterized in terms of function heights at the \nknots (although there  is a gam identifiability constraint absorbed into the \nparameterization which muddies this neat interpretability a little). \n\nbest,\nSimon\n\n\n> Sincerely,\n>\n> Bill\n>\n>\n> ---------------------------------\n>\n> \t[[alternative HTML version deleted]]\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html and provide commented, minimal,\n> self-contained, reproducible code.\n\n-- \n> Simon Wood, Mathematical Sciences, University of Bath, Bath, BA2 7AY UK\n> +44 1225 386603  www.maths.bath.ac.uk/~sw283\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}