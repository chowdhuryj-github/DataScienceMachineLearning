{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Ken Nussear <knussear@usgs.gov>", "subject": "[R] Package contrast error", "body": "Trying to use contrast to look at differences within an lme\n\nlme.fnl.REML <- lme(Max ~ S + Tr + Yr + Tr:Yr, random = ~1 |TID,  \nmethod = \"REML\")\n\nI have three levels of Tr I'm trying to contrast among different  \nyears (R, T97, T98), years = 1997-1999, so I'm interested in  \ncontrasts of the interaction term.\n\n > anova(lme.fnl.REML)\n             numDF denDF   F-value p-value\n(Intercept)     1   168 19255.389  <.0001\nS               1   168     5.912  0.0161\nTr              2   116    15.919  <.0001\nYr              1   168    77.837  <.0001\nTr:Yr           2   168    47.584  <.0001\n > summary(lme.fnl.REML)\nLinear mixed-effects model fit by REML\nData: NULL\n        AIC      BIC    logLik\n   580.6991 613.5399 -281.3496\n\nRandom effects:\nFormula: ~1 | TID\n         (Intercept)  Residual\nStdDev:   0.3697006 0.5316062\n\nFixed effects: Max ~ S + Tr + Yr + Tr:Yr\n                 Value Std.Error  DF   t-value p-value\n(Intercept)  -13.5681  113.2623 168 -0.119793  0.9048\nSM             0.2187    0.0957 168  2.284605  0.0236\nTrT97       1375.5897  164.0060 116  8.387434  0.0000\nTrT98       2890.9462  455.3497 116  6.348848  0.0000\nYr             0.0099    0.0567 168  0.174005  0.8621\nTrT97:Yr      -0.6883    0.0821 168 -8.384798  0.0000\nTrT98:Yr      -1.4463    0.2279 168 -6.347310  0.0000\nCorrelation:\n          (Intr) SM     TrT97  TrT98  Yr     TT97:Y\nSM        0.067\nTrT97    -0.691 -0.049\nTrT98    -0.248 -0.001  0.171\nYr       -1.000 -0.067  0.691  0.248\nTrT97:Yr  0.691  0.048 -1.000 -0.171 -0.691\nTrT98:Yr  0.248  0.001 -0.171 -1.000 -0.248  0.171\n\nStandardized Within-Group Residuals:\n         Min          Q1         Med          Q3         Max\n-2.19017911 -0.58108001 -0.04983642  0.57323031  2.39811353\n\nNumber of Observations: 291\nNumber of Groups: 119\n >\n\nWhen I try to get the contrast I get one of two errors each time.\n\nTrying for a paired contrast...\n\ntst <- contrast(lme.fnl.REML, a=list(Yr=levels(Yr), Tr=\"R\"), b=list \n(Yr=levels(Yr, Tr=\"T97\")))\nError in gendata.default(fit = list(modelStruct = list(reStruct = list \n( :\n\tnot enough factors\n\nTrying to include the other factor to make R happy....\n\n > tst <- contrast(lme.fnl.REML, a=list(Yr=levels(Yr), Tr=\"R\"), b=list \n(Yr=levels(Yr, Tr=\"T97\")), c=list(Yr=levels(Yr, Tr=\"T98\"))\n+ )\nError in contrastCalc(fit, ...) : argument 4 matches multiple formal  \narguments\n\nCan anyone help with the syntax here?\n\nThanks\n\nKen\n\n\n\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}