{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "idra@samba.org", "subject": "svn commit: samba r22696 - in\n\tbranches/SAMBA_4_0/source/lib/ldb/common: .", "body": "Author: idra\nDate: 2007-05-06 15:17:14 +0000 (Sun, 06 May 2007)\nNew Revision: 22696\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22696\n\nLog:\n\nMake sure this is an ascii char\nspotted by Volker\n\n\nModified:\n   branches/SAMBA_4_0/source/lib/ldb/common/ldb_dn.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/lib/ldb/common/ldb_dn.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/ldb/common/ldb_dn.c\t2007-05-06 13:46:30 UTC (rev 22695)\n+++ branches/SAMBA_4_0/source/lib/ldb/common/ldb_dn.c\t2007-05-06 15:17:14 UTC (rev 22696)\n@@ -292,6 +292,12 @@\n \t\t\t\t/* first char */\n \t\t\t\ttrim = false;\n \n+\t\t\t\tif (!isascii(*p)) {\n+\t\t\t\t\t/* attr names must be ascii only */\n+\t\t\t\t\tdn->invalid = true;\n+\t\t\t\t\tgoto failed;\n+\t\t\t\t}\n+\n \t\t\t\tif (isdigit(*p)) {\n \t\t\t\t\tis_oid = true;\n \t\t\t\t} else\n@@ -338,6 +344,12 @@\n \t\t\t\tcontinue;\n \t\t\t}\n \n+\t\t\tif (!isascii(*p)) {\n+\t\t\t\t/* attr names must be ascii only */\n+\t\t\t\tdn->invalid = true;\n+\t\t\t\tgoto failed;\n+\t\t\t}\n+\n \t\t\tif (is_oid && ( ! (isdigit(*p) || (*p == '.')))) {\n \t\t\t\t/* not a digit nor a dot, invalid attribute oid */\n \t\t\t\tdn->invalid = true;\n\n"}