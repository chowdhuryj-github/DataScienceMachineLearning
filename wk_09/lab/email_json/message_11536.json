{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 173: merge fixes from samba4 in http://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 173\nrevision-id: tridge@samba.org-20070421030822-6af160dfe70a87e4\nparent: tridge@samba.org-20070421030749-d1645f913f7f2f58\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Sat 2007-04-21 13:08:22 +1000\nmessage:\n  merge fixes from samba4\nmodified:\n  common/ctdb_daemon.c           ctdb_daemon.c-20070409200331-3el1kqgdb9m4ib0g-1\n  common/ctdb_lockwait.c         ctdb_lockwait.c-20070416214118-n1aeonljj3vpdd9q-1\n  config.mk                      config.mk-20070416041303-xql6zaaq90w8kovl-1\n=== modified file 'common/ctdb_daemon.c'\n--- a/common/ctdb_daemon.c\t2007-04-20 11:02:53 +0000\n+++ b/common/ctdb_daemon.c\t2007-04-21 03:08:22 +0000\n@@ -338,9 +338,9 @@\n \tif (res != 0) {\n \t\tDEBUG(0, (__location__ \"Failed to queue packet from daemon to client\\n\"));\n \t}\n+\tctdb_latency(&client->ctdb->status.max_call_latency, dstate->start_time);\n \ttalloc_free(dstate);\n \tclient->ctdb->status.pending_calls--;\n-\tctdb_latency(&client->ctdb->status.max_call_latency, dstate->start_time);\n }\n \n \n\n=== modified file 'common/ctdb_lockwait.c'\n--- a/common/ctdb_lockwait.c\t2007-04-20 11:02:53 +0000\n+++ b/common/ctdb_lockwait.c\t2007-04-21 03:08:22 +0000\n@@ -23,9 +23,9 @@\n #include \"system/filesys.h\"\n #include \"system/wait.h\"\n #include \"popt.h\"\n-#include \"../include/ctdb_private.h\"\n #include \"db_wrap.h\"\n #include \"lib/tdb/include/tdb.h\"\n+#include \"../include/ctdb_private.h\"\n \n \n struct lockwait_handle {\n\n=== modified file 'config.mk'\n--- a/config.mk\t2007-04-16 06:01:37 +0000\n+++ b/config.mk\t2007-04-21 03:08:22 +0000\n@@ -15,7 +15,6 @@\n \n ##################\n [SUBSYSTEM::ctdb]\n-INIT_FUNCTION = server_service_ctdbd_init\n OBJ_FILES = \\\n \t\tctdb_cluster.o \\\n \t\tcommon/ctdb.o \\\n@@ -25,6 +24,7 @@\n \t\tcommon/ctdb_util.o \\\n \t\tcommon/ctdb_io.o \\\n \t\tcommon/ctdb_client.o \\\n-\t\tcommon/ctdb_daemon.o\n+\t\tcommon/ctdb_daemon.o \\\n+\t\tcommon/ctdb_lockwait.o\n PUBLIC_DEPENDENCIES = LIBTDB LIBTALLOC\n PRIVATE_DEPENDENCIES = ctdb_tcp\n\n"}