{"category": "ham", "to_address": "sugar@laptop.org", "from_address": "Simon McVittie <simon.mcvittie@collabora.co.uk>", "subject": "[sugar] [PATCH] sugar.presence.presenceservice: don't mix up local\n\tvariable 'activity' and imported module 'activity'", "body": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nThis fixes AttributeErrors when trying to share activities.\n\n- ---\n sugar/presence/presenceservice.py |    8 +++++---\n 1 files changed, 5 insertions(+), 3 deletions(-)\n\ndiff --git a/sugar/presence/presenceservice.py b/sugar/presence/presenceservice.py\nindex f93c831..621a289 100644\n- --- a/sugar/presence/presenceservice.py\n+++ b/sugar/presence/presenceservice.py\n@@ -27,7 +27,9 @@ import logging\n # import), that would read as:\n #   from . import buddy, activity \n # see PEP: http://docs.python.org/whatsnew/pep-328.html\n- -import buddy, activity\n+\n+import buddy\n+from activity import Activity\n \n \n DBUS_SERVICE = \"org.laptop.Sugar.Presence\"\n@@ -158,7 +160,7 @@ class PresenceService(gobject.GObject):\n                 obj = buddy.Buddy(self._bus, self._new_object,\n                         self._del_object, object_path)\n             elif object_path.startswith(self._PS_ACTIVITY_OP):\n- -                obj = activity.Activity(self._bus, self._new_object,\n+                obj = Activity(self._bus, self._new_object,\n                         self._del_object, object_path)\n                 try:\n                     # Pre-fill the activity's ID\n@@ -353,7 +355,7 @@ class PresenceService(gobject.GObject):\n \n         # Ensure the activity is not already shared/joined\n         for obj in self._objcache.values():\n- -            if not isinstance(object, activity.Activity):\n+            if not isinstance(object, Activity):\n                 continue\n             if obj.props.id == actid or obj.props.joined:\n                 raise RuntimeError(\"Activity %s is already shared.\" % actid)\n- -- \n1.5.1.3\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.6 (GNU/Linux)\nComment: OpenPGP key: http://www.pseudorandom.co.uk/2003/contact/ or pgp.net\n\niD8DBQFGQJceWSc8zVUw7HYRApLbAKDFcvzSDRkXSuyB8HOojbv2aWqVVQCgr7jW\nIO9JA1PoD7mLGM9FyXLtgok=\n=PDAP\n-----END PGP SIGNATURE-----\n_______________________________________________\nSugar mailing list\nSugar@laptop.org\nhttp://mailman.laptop.org/mailman/listinfo/sugar\n\n"}