{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "sahlberg@samba.org", "subject": "svn commit: samba r23721 - in\n\tbranches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Wireshark: .", "body": "Author: sahlberg\nDate: 2007-07-05 07:19:14 +0000 (Thu, 05 Jul 2007)\nNew Revision: 23721\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23721\n\nLog:\nFor unions, The TAG and the ARM are aligned independently.\n\nMove emitting ALIGN_TO_x_BYTES to after the tag has been dissected so the \nalignment only affects the ARM.\n\n\n\nModified:\n   branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Wireshark/NDR.pm\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Wireshark/NDR.pm\n===================================================================\n--- branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Wireshark/NDR.pm\t2007-07-05 06:15:40 UTC (rev 23720)\n+++ branches/SAMBA_4_0/source/pidl/lib/Parse/Pidl/Wireshark/NDR.pm\t2007-07-05 07:19:14 UTC (rev 23721)\n@@ -614,12 +614,6 @@\n \t$self->pidl_code(\"$switch_type level;\");\n \t$self->pidl_code(\"\");\n \n-\tif ($e->{ALIGN} > 1) {\n-\t\t$self->pidl_code(\"ALIGN_TO_$e->{ALIGN}_BYTES;\");\n-\t}\n-\n-\t$self->pidl_code(\"\");\n-\n \t$self->pidl_code(\"old_offset = offset;\");\n \t$self->pidl_code(\"if (parent_tree) {\");\n \t$self->indent;\n@@ -632,6 +626,12 @@\n \n \t$self->pidl_code(\"offset = $switch_dissect(tvb, offset, pinfo, tree, drep, hf_index, &level);\");\n \n+\tif ($e->{ALIGN} > 1) {\n+\t\t$self->pidl_code(\"ALIGN_TO_$e->{ALIGN}_BYTES;\");\n+\t\t$self->pidl_code(\"\");\n+\t}\n+\n+\n \t$self->pidl_code(\"switch(level) {$res\\t}\");\n \t$self->pidl_code(\"proto_item_set_len(item, offset-old_offset);\\n\");\n \t$self->pidl_code(\"return offset;\");\n\n"}