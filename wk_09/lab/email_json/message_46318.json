{"category": "ham", "to_address": "\"Martin Henry H. Stevens\" <HStevens@muohio.edu>", "from_address": "Setzer.Woodrow@epamail.epa.gov", "subject": "Re: [R] Fwd: Using odesolve to produce non-negative solutions", "body": "By the way, if someone could forward the original question to me (I'm\nsubscribed to but not currently receiving R-help, as I found I was\nspending too much time reading it!) I might think of something more\nuseful. (alternatively, when was it posted; I can find it on gmane,\ntoo).\n\nWoody\nR. Woodrow Setzer, Ph. D.\nNational Center for Computational Toxicology\nUS Environmental Protection Agency\nMail Drop B205-01/US EPA/RTP, NC 27711\nPh: (919) 541-0128    Fax: (919) 541-1194\n\n\n                                                                        \n             \"Martin Henry H.                                           \n             Stevens\"                                                   \n                                 Spencer Graves                    \n                                                \n             06/11/2007 01:02                                        cc \n             PM                       Jeremy Goldhaber-Fiebert          \n                                      ,      \n                                      R-Help                            \n                                      ,       \n                                      Woodrow Setzer/RTP/USEPA/US@EPA   \n                                                                Subject \n                                      Re: [R] Fwd: Using odesolve to    \n                                      produce non-negative solutions    \n                                                                        \n                                                                        \n                                                                        \n                                                                        \n                                                                        \n                                                                        \n\n\n\n\nHi Spencer,\nI have copied Woody Setzer. I have no idea whether lsoda can estimate\nparameters that could take imaginary values.\nHank\nOn Jun 11, 2007, at 12:52 PM, Spencer Graves wrote:\n\n> \n>\n> Martin Henry H. Stevens wrote:\n>> Hi Jeremy,\n>> First, setting hmax to a small number could prevent a large step, if\n>> you think that is a problem. Second, however, I don't see how you can\n>> get a negative population size when using the log trick.\n> SG:  Can lsoda estimate complex or imaginary parameters?\nHmm. I have no idea.\n>\n>> I would think that that would prevent completely any negative values\n>> of N (i.e. e^-100000 > 0). Can you explain? or do you want to a void\n>> that trick? The only other solver I know of is rk4 and it is not\n>> recommended.\n>> Hank\n>> On Jun 11, 2007, at 11:46 AM, Jeremy Goldhaber-Fiebert wrote:\n>>\n>>> Hi Spencer,\n>>>\n>>> Thank you for your response. I also did not see anything on the\n>>> lsoda\n>>> help page which is the reason that I wrote to the list.\n>>>\n>>>> From your response, I am not sure if I asked my question clearly.\n>>>\n>>> I am modeling a group of people (in a variety of health states)\n>>> moving through time (and getting infected with an infectious\n>>> disease). This means that the count of the number of people in each\n>>> state should be positive at all times.\n>>>\n>>> What appears to happen is that lsoda asks for a derivative at a\n>>> given\n>>> point in time t and then adjusts the state of the population.\n>>> However, perhaps due to numerical instability, it occasionally lower\n>>> the population count below 0 for one of the health states (perhaps\n>>> because it's step size is too big or something).\n>>>\n>>> I have tried both the logarithm trick\n> \n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-\n> guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n\n\nDr. Hank Stevens, Assistant Professor\n338 Pearson Hall\nBotany Department\nMiami University\nOxford, OH 45056\n\nOffice: (513) 529-4206\nLab: (513) 529-4262\nFAX: (513) 529-4243\nhttp://www.cas.muohio.edu/~stevenmh/\nhttp://www.muohio.edu/ecology/\nhttp://www.muohio.edu/botany/\n\n\"E Pluribus Unum\"\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}