{"category": "ham", "to_address": "<beginners@perl.org>", "from_address": "\"Jenda Krynicky\" <Jenda@Krynicky.cz>", "subject": "Re: Simplification of the code", "body": "Subject:        \tSimplification of the code\nDate sent:      \tTue, 22 May 2007 19:04:01 +0530\nFrom:           \t\"Nath, Alok (STSD)\" \nTo:             \t\n\n> Hi,\n> \tCan anybody help me to simplify the for loops here ?\n> \tIt parses the excel file.\n> \t\n> \n> \tforeach my $col (1..10){\n> \t\tpush @row_1, $Sheet->Cells(1, $col)->{'Value'} ;\t\n> \t}\n> \tmy @node_names = th(\\@row_1);\n\nWhy the @row_1 variable?\n\n\tmy @node_names;\n \tforeach my $col (1..10){\n \t\tpush @node_names, $Sheet->Cells(1, $col)->{'Value'} ;\t\n \t}\n \t@node_names = th(\\node_names);\n\nor even better\n\n  my @node_names = th [map { $Sheet->Cells(1, $_)->{'Value'} } \n(1..10)];\n\n\n> \tforeach my $col (1..10){\n> \t\tpush @row_2, $Sheet->Cells(2, $col)->{'Value'} ;\t\n> \t}\n> \tmy @workstations = td(\\@row_2);\n> \n> \n> \tforeach my $col (1..10){\n> \t\tpush @row_3, $Sheet->Cells(3, $col)->{'Value'} ;\t\n> \t}\n> \tmy @cards = td(\\@row_3);\n\n\nThe different functions make it a bit harder, but you could merge \nthose loops into this:\n\n  my @rows = map {\n    my $row = $_;\n    [ map { $Sheet->Cells( $row, $_)->{'Value'} } (1..10) ]\n } (1..3);\n\nto get the data and then\n\n> \tI am using the above for loops to create a table -finally.\n> \n> \n> \tprint table({-border=>undef,-width=>'100%'},\n>             caption(b('My table')),\n>             Tr(\\@node_names),\n>             Tr(\\@workstations),\n>             Tr(\\@cards),\n> \t}\n\n \tprint table({-border=>undef,-width=>'100%'},\n             caption(b('My table')),\n             Tr([ th $rows[0]]),\n             Tr([ td $rows[1]]),\n             Tr([ td $rows[2]]),\n \t}\n\nHTH, Jenda\n===== Jenda@Krynicky.cz === http://Jenda.Krynicky.cz =====\nWhen it comes to wine, women and song, wizards are allowed \nto get drunk and croon as much as they like.\n\t-- Terry Pratchett in Sourcery\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}