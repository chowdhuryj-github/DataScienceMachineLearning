{"category": "ham", "to_address": "Mark Glines <mark@glines.org>", "from_address": "Allison Randal <allison@perl.org>", "subject": "Re: [perl #42774] [PATCH] Configure.pl --gc=libc doesn't compile", "body": "Mark Glines wrote:\n> On Fri, 27 Apr 2007 11:19:59 -0700\n> Andy Spieherty (via RT)  wrote:\n>> \"src/gc/dod.c\", line 462: undefined symbol:\n>> PObj_bufstart_external_FLAG\n> \n> I hunted for this a bit lastnight, so I'm posting my progress.\n> \n> The source lines in question are:\n> \n> 461         /* the real external flag */\n> 462>>       if (PObj_bufstart_external_TEST(b))    <<\n> 463             PObj_external_SET(b);\n> \n> PObj_bufstart_external_FLAG used to be defined in\n> include/parrot/pobj.h, but it was removed in svn r10582:\n> [...]\n> Strange that r10582 removed the flag itself, but not the accessors\n> (PObj_bufstart_external_TEST and PObj_bufstart_external_SET).\n\nAnd, on to the next step: Whether you remove the check for \nPObj_bufstart_external_TEST(b), or readd the PObj_bufstart_external_FLAG \n(as 1 << 31, since that's the next available flag), that error \ndisappears, to be replaced with an error in src/gc/res_lea.c that \nParrot_reallocate, Parrot_allocate, and Parrot_reallocate_string are \nredeclared with conflicting types, and that Parrot_allocate_zeroed is \nnever prototyped, and STRING_ALIGNMENT is undeclared.\n\nLooks to me like we've got a few incomplete refactors on our hands that \nhappen to live on rarely exercised code paths. (Automated multi-platform \nsmokes will help this.) I've started working on src/gc/res_lea.c, after \nremoving the check for the no-longer-used flag.\n\nAllison\n\n"}