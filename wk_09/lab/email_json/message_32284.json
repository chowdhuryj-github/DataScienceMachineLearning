{"category": "ham", "to_address": "Thomas Lumley <tlumley@u.washington.edu>", "from_address": "jiho <jo.irisson@gmail.com>", "subject": "Re: [R] lapply not reading arguments from the correct environment", "body": "\nOn 2007-May-18  , at 17:09 , Thomas Lumley wrote:\n> On Fri, 18 May 2007, jiho wrote:\n>> I am facing a problem with lapply which I ''''think''' may be a bug.\n>> This is the most basic function in which I can reproduce it:\n>>\n>> myfun <- function()\n>> {\n>> \tfoo = data.frame(1:10,10:1)\n>> \tfoos = list(foo)\n>> \tfooCollumn=2\n>> \tcFoo = lapply(foos,subset,select=fooCollumn)\n>> \treturn(cFoo)\n>> }\n>>\n> \n>> I get this error:\n>> \tError in eval(expr, envir, enclos) : object \"fooCollumn\" not found\n>> while fooCollumn is defined, in the function, right before lapply.\n> \n>> This is with R 2.5.0 on both OS X and Linux (Fedora Core 6)\n>> What did I do wrong? Is this indeed a bug? An intended behavior?\n>\n> The problem is that subset() evaluates its \"select\" argument in an  \n> unusual way. Usually the argument would be evaluated inside myfun()  \n> and the value passed to lapply(), and everything would work as you  \n> expect.\n> subset() bypasses the normal evaluation and explicitly evaluates  \n> the \"select\" argument in the calling frame, ie, inside lapply(),  \n> where fooCollumn is not visible.\n> You could do\n>   lapply(foos, function(foo) subset(foo, select=fooCollum))\n> capturing fooCollum by lexical scope.  In R this is often a better  \n> option than passing extra arguments to lapply (or other functions  \n> that take function arguments).\n\nThank you very much, this works well indeed. I agree it is a bit  \nconfusing, to say the least. The point is that supplying other  \narguments in the ... of lapply worked for all other functions I tried  \nbefore (mean, sd, summary and even spline) so it is really a problem  \nwith subset. Anyway, R is great even with such little flaws here and  \nthere and as long as the community is there to support it, it will rule.\n\nCheers,\n\nJiHO\n---\nhttp://jo.irisson.free.fr/\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}