{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jerry@samba.org", "subject": "svn commit: samba r23633 - in branches/SAMBA_3_0/source/rpc_server:\n\t.", "body": "Author: jerry\nDate: 2007-06-27 16:52:36 +0000 (Wed, 27 Jun 2007)\nNew Revision: 23633\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23633\n\nLog:\nFix a couple of crash bugs pointed out by Volker caused by an old\nchange from a pstring to a char* and still trying use pstrcpy().\n\nModified:\n   branches/SAMBA_3_0/source/rpc_server/srv_winreg_nt.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/rpc_server/srv_winreg_nt.c\n===================================================================\n--- branches/SAMBA_3_0/source/rpc_server/srv_winreg_nt.c\t2007-06-27 16:52:34 UTC (rev 23632)\n+++ branches/SAMBA_3_0/source/rpc_server/srv_winreg_nt.c\t2007-06-27 16:52:36 UTC (rev 23633)\n@@ -661,7 +661,12 @@\n \t\t\ttopkeypath ));\n \t\treturn WERR_BADFILE;\n \t}\n-\tpstrcpy( registry_key.name, topkeypath );\n+\n+\tregistry_key.name = talloc_strdup( regfile->mem_ctx, topkeypath );\n+\tif ( !registry_key.name ) {\n+\t\tDEBUG(0,(\"reg_load_tree: Talloc failed for reg_key.name!\\n\"));\n+\t\treturn WERR_NOMEM;\n+\t}\n \t\n \t/* now start parsing the values and subkeys */\n \n\n"}