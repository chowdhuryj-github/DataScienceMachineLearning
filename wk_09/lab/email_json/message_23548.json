{"category": "ham", "to_address": "Alberto Vieira Ferreira Monteiro <albmont@centroin.com.br>", "from_address": "Roger Bivand <Roger.Bivand@nhh.no>", "subject": "Re: [R] Help with map", "body": "On Sat, 5 May 2007, Alberto Vieira Ferreira Monteiro wrote:\n\n> [for those that worry about these things, this _is_ a homework\n> assignment. However, it's not an R homework, it's a Geography\n> and History homework... and I want to use R to create a pretty\n> map]\n> \n> Roger Bivand wrote:\n> >\n> >> Is there any way to associate one color to each country?\n> >\n> > Try:\n> >\n> > map_poly_obj <- map(\"worldHires\", c(\"Argentina\", \"Brazil\"), plot=FALSE,\n> >   fill=TRUE)\n> > str(map_poly_obj)\n> >\n> > and you'll see that the component of interest is the named polygons, of\n> > which there are 28, namely\n> >\n> Ok, I guess I can see what you mean. It worked, but I don't think\n> this is a practical way to draw things.\n> \n> For example, suppose [this would help homework mentioned above] I\n> want to draw a series of maps showing the evolution of Communism\n> in the XX century. I would like to start with a 1917 map, showing most\n> countries as in...\n> \n> map(\"worldHires\")\n> \n> ... but with the Soviet Union in red. I don't see how I could mix the two \n> maps (BTW, there's no Russia in worldHires, but there is a USSR...)\n> \n> map(\"worldHires\"); map(\"worldHires\", \"USSR\", col=\"red\", fill=T)\n\n[Please note that the worldHires database refers to a particular time\ncross section, probably late 1980's. The territorial extents of the former\nUSSR in 1919, 1920, 1939, 1940, 1941, 1944, 1945, etc., etc. are not the\nsame;  the same consideration would apply to PRC's actual control over\nTibet. \n\nSo to do this, you need a sequence of maps showing the marginal\nincrements, with 1917 actually only colouring Petrograd/St Petersburg and\nperhaps some other cities. I'm not aware of any publically available\nsequence of boundary files adequately representing the situation of say\nthe Baltic states or Finland for the 1917-2007 period, if anyone has a\nsuitable link, please say so.\n\nGeographical data are vintaged, not just \"where\", but \"where when\". Was\nfor example Estonia occupied by the USSR 1940-1941, 1944-1991, or was it\npart of the USSR for the purposes of this exercise? Using disputed \nboundaries implies a choice of point of view, one that may not be \nintended.]\n\nRoger\n\n> \n> >\n> > map_poly_obj$names\n> >\n> > So you can build a matching colours vector, or:\n> >\n> > library(sp)\n> > library(maptools)\n> > IDs <- sapply(strsplit(map_poly_obj$names, \":\"), function(x) x[1])\n> > SP_AB <- map2SpatialPolygons(map_poly_obj, IDs=IDs,\n> >   proj4string=CRS(\"+proj=longlat +datum=wgs84\"))\n> >\n> > but\n> >\n> > plot(SP_AB, col=c(\"cyan\", \"green\"))\n> >\n> > still misses, because some polygons have their rings of coordinates in\n> > counter-clockwise order, so:\n> >\n> > pl_new <- lapply(slot(SP_AB, \"polygons\"), checkPolygonsHoles)\n> > slot(SP_AB, \"polygons\") <- pl_new\n> > # please forget the assignment to the slot and do not do it unless you can\n> > # replace what was there before\n> >\n> > plot(SP_AB, col=c(\"cyan\", \"green\"), axes=TRUE)\n> >\n> > now works. Moreover, SP_AB is a SpatialPolygons object, which can be\n> > promoted to a SpatialPolygonsDataFrame object, for a data slot holding a\n> > data.frame with row names matching the Polygons ID values:\n> >\n> > sapply(slot(SP_AB, \"polygons\"), function(x) slot(x, \"ID\"))\n> >\n> > So adding a suitable data frame gets you to the lattice graphics method\n> >\n> > spplot(SP_AB, \"my_var\")\n> >\n> > Hope this helps,\n> >\n> So, in the above mentioned case, I could do something like:\n> \n> library(mapdata)\n> commies <- c(\"USSR\", \"Mongolia\") \n> # Mongolia was the 2nd communist country, in 1925\n> map_poly_obj <- map(\"worldHires\", plot=FALSE)\n> map_poly_commies <- map(\"worldHires\", commies,\n>   plot=FALSE, fill=TRUE)\n> plot(map_poly_obj, type=\"l\")\n> polygon(map_poly_commies, col=\"red\", border=\"black\")\n> \n> I guess I can keep going, unless there is a simpler solution.\n> \n> Alberto Monteiro\n> \n\n-- \nRoger Bivand\nEconomic Geography Section, Department of Economics, Norwegian School of\nEconomics and Business Administration, Helleveien 30, N-5045 Bergen,\nNorway. voice: +47 55 95 93 55; fax +47 55 95 95 43\ne-mail: Roger.Bivand@nhh.no\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}