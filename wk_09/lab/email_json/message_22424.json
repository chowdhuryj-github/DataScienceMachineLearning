{"category": "ham", "to_address": "Ken Nussear <knussear@usgs.gov>", "from_address": "Chuck Cleland <ccleland@optonline.net>", "subject": "Re: [R] Package contrast error", "body": "Ken Nussear wrote:\n> Trying to use contrast to look at differences within an lme\n> \n> lme.fnl.REML <- lme(Max ~ S + Tr + Yr + Tr:Yr, random = ~1 |TID,  \n> method = \"REML\")\n> \n> I have three levels of Tr I'm trying to contrast among different  \n> years (R, T97, T98), years = 1997-1999, so I'm interested in  \n> contrasts of the interaction term.\n> \n>  > anova(lme.fnl.REML)\n>              numDF denDF   F-value p-value\n> (Intercept)     1   168 19255.389  <.0001\n> S               1   168     5.912  0.0161\n> Tr              2   116    15.919  <.0001\n> Yr              1   168    77.837  <.0001\n> Tr:Yr           2   168    47.584  <.0001\n>  > summary(lme.fnl.REML)\n> Linear mixed-effects model fit by REML\n> Data: NULL\n>         AIC      BIC    logLik\n>    580.6991 613.5399 -281.3496\n> \n> Random effects:\n> Formula: ~1 | TID\n>          (Intercept)  Residual\n> StdDev:   0.3697006 0.5316062\n> \n> Fixed effects: Max ~ S + Tr + Yr + Tr:Yr\n>                  Value Std.Error  DF   t-value p-value\n> (Intercept)  -13.5681  113.2623 168 -0.119793  0.9048\n> SM             0.2187    0.0957 168  2.284605  0.0236\n> TrT97       1375.5897  164.0060 116  8.387434  0.0000\n> TrT98       2890.9462  455.3497 116  6.348848  0.0000\n> Yr             0.0099    0.0567 168  0.174005  0.8621\n> TrT97:Yr      -0.6883    0.0821 168 -8.384798  0.0000\n> TrT98:Yr      -1.4463    0.2279 168 -6.347310  0.0000\n> Correlation:\n>           (Intr) SM     TrT97  TrT98  Yr     TT97:Y\n> SM        0.067\n> TrT97    -0.691 -0.049\n> TrT98    -0.248 -0.001  0.171\n> Yr       -1.000 -0.067  0.691  0.248\n> TrT97:Yr  0.691  0.048 -1.000 -0.171 -0.691\n> TrT98:Yr  0.248  0.001 -0.171 -1.000 -0.248  0.171\n> \n> Standardized Within-Group Residuals:\n>          Min          Q1         Med          Q3         Max\n> -2.19017911 -0.58108001 -0.04983642  0.57323031  2.39811353\n> \n> Number of Observations: 291\n> Number of Groups: 119\n>  >\n> \n> When I try to get the contrast I get one of two errors each time.\n> \n> Trying for a paired contrast...\n> \n> tst <- contrast(lme.fnl.REML, a=list(Yr=levels(Yr), Tr=\"R\"), b=list \n> (Yr=levels(Yr, Tr=\"T97\")))\n> Error in gendata.default(fit = list(modelStruct = list(reStruct = list \n> ( :\n> \tnot enough factors\n> \n> Trying to include the other factor to make R happy....\n> \n>  > tst <- contrast(lme.fnl.REML, a=list(Yr=levels(Yr), Tr=\"R\"), b=list \n> (Yr=levels(Yr, Tr=\"T97\")), c=list(Yr=levels(Yr, Tr=\"T98\"))\n> + )\n> Error in contrastCalc(fit, ...) : argument 4 matches multiple formal  \n> arguments\n> \n> Can anyone help with the syntax here?\n\n  I believe you need to include one or more values S at which to\ncontrast the treatments in each of the lists.  So you might try\nsomething like this:\n\ncontrast(lme.fnl.REML,\n     a=list(Yr=levels(Yr), Tr=\"R\", S=\"M\"),\n     b=list(Yr=levels(Yr), Tr=\"T97\", S=\"M\"))\n\nor\n\ncontrast(lme.fnl.REML,\n     a=list(Yr=levels(Yr), Tr=\"R\", S=levels(S)),\n     b=list(Yr=levels(Yr), Tr=\"T97\", S=levels(S)))\n\n> Thanks\n> \n> Ken\n> \n> \n> \n> \n> \t[[alternative HTML version deleted]]\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code. \n\n-- \nChuck Cleland, Ph.D.\nNDRI, Inc.\n71 West 23rd Street, 8th floor\nNew York, NY 10010\ntel: (212) 845-4495 (Tu, Th)\ntel: (732) 512-0171 (M, W, F)\nfax: (917) 438-0894\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}