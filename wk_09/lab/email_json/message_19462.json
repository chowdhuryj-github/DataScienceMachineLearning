{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22571 - in\n\tbranches/SAMBA_4_0/source/script/tests: .", "body": "Author: metze\nDate: 2007-04-29 13:54:51 +0000 (Sun, 29 Apr 2007)\nNew Revision: 22571\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22571\n\nLog:\n- don't use \"localhost\" anymore in our tests\n- use different passwords for dc and member\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/script/tests/Samba4.pm\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/script/tests/Samba4.pm\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/Samba4.pm\t2007-04-29 13:31:13 UTC (rev 22570)\n+++ branches/SAMBA_4_0/source/script/tests/Samba4.pm\t2007-04-29 13:54:51 UTC (rev 22571)\n@@ -449,18 +449,17 @@\n \treturn ($slapd_conf, $pidfile);\n }\n \n-sub provision($$$$$)\n+sub provision($$$$$$)\n {\n-\tmy ($self, $prefix, $server_role, $domain, $netbiosname, $swiface) = @_;\n+\tmy ($self, $prefix, $server_role, $netbiosname, $netbiosalias, $swiface, $password) = @_;\n \n \tmy $smbd_loglevel = 1;\n \tmy $username = \"administrator\";\n+\tmy $domain = \"SAMBADOMAIN\";\n \tmy $realm = \"SAMBA.EXAMPLE.COM\";\n \tmy $dnsname = \"samba.example.com\";\n \tmy $basedn = \"dc=samba,dc=example,dc=com\";\n-\tmy $password = \"penguin\";\n \tmy $root = ($ENV{USER} or $ENV{LOGNAME} or `whoami`);\n-\tmy $server = \"localhost\";\n \tmy $srcdir=\"$RealBin/../..\";\n \t-d $prefix or mkdir($prefix, 0777) or die(\"Unable to create $prefix\");\n \tmy $prefix_abs = abs_path($prefix);\n@@ -490,7 +489,7 @@\n \tprint CONFFILE \"\n [global]\n \tnetbios name = $netbiosname\n-\tnetbios aliases = $server\n+\tnetbios aliases = $netbiosalias\n \tworkgroup = $domain\n \trealm = $realm\n \tprivate dir = $privatedir\n@@ -616,10 +615,10 @@\n \tmy $ret = {\n \t\tKRB5_CONFIG => $krb5_config,\n \t\tPIDDIR => $piddir,\n-\t\tSERVER => $server,\n+\t\tSERVER => $netbiosname,\n \t\tSERVER_IP => $ifaceipv4,\n \t\tNETBIOSNAME => $netbiosname,\n-\t\tNETBIOSALIAS => $server,\n+\t\tNETBIOSALIAS => $netbiosalias,\n \t\tLDAP_URI => $ldap_uri,\n \t\tDOMAIN => $domain,\n \t\tUSERNAME => $username,\n@@ -662,8 +661,12 @@\n \tmy ($self, $prefix, $dcvars) = @_;\n \tprint \"PROVISIONING MEMBER...\";\n \n-\tmy $ret = $self->provision($prefix, \"member server\", \"SAMBADOMAIN\", \n-\t\t\"localmember\", 3);\n+\tmy $ret = $self->provision($prefix,\n+\t\t\t\t   \"member server\",\n+\t\t\t\t   \"localmember3\",\n+\t\t\t\t   \"localmember\",\n+\t\t\t\t   3,\n+\t\t\t\t   \"localmemberpass\");\n \n \t$ret or die(\"Unable to provision\");\n \n@@ -688,8 +691,12 @@\n \tmy ($self, $prefix) = @_;\n \n \tprint \"PROVISIONING DC...\";\n-\tmy $ret = $self->provision($prefix, \"domain controller\", \"SAMBADOMAIN\", \n-\t\t\"localtest\", 1);\n+\tmy $ret = $self->provision($prefix,\n+\t\t\t\t   \"domain controller\",\n+\t\t\t\t   \"localdc1\",\n+\t\t\t\t   \"localdc\",\n+\t\t\t\t   1,\n+\t\t\t\t   \"localdcpass\");\n \n \t$self->add_wins_config(\"$prefix/private\") or \n \t\tdie(\"Unable to add wins configuration\");\n\n"}