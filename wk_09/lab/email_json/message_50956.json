{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r23549 - in branches: SAMBA_3_0/source/utils\n\tSAMBA_3_0_26/source/utils", "body": "Author: obnox\nDate: 2007-06-19 21:40:27 +0000 (Tue, 19 Jun 2007)\nNew Revision: 23549\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23549\n\nLog:\nMake \"net conf setparm\" always use registry data type \"sz\".\nThis simplifies the usage of this command from\n\"net conf setparm    \"\nto\n\"net conf setparm   \".\n\nMicheal\n\n\nModified:\n   branches/SAMBA_3_0/source/utils/net_conf.c\n   branches/SAMBA_3_0_26/source/utils/net_conf.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/utils/net_conf.c\n===================================================================\n--- branches/SAMBA_3_0/source/utils/net_conf.c\t2007-06-19 21:08:46 UTC (rev 23548)\n+++ branches/SAMBA_3_0/source/utils/net_conf.c\t2007-06-19 21:40:27 UTC (rev 23549)\n@@ -82,8 +82,7 @@\n \n static int net_conf_setparm_usage(int argc, const char **argv)\n {\n-\td_printf(\"USAGE: net conf setparm    \\n\"\n-\t\t \"\\t(Supported types are 'dword' and 'sz' by now.)\\n\");\n+\td_printf(\"USAGE: net conf setparm   \\n\");\n \treturn -1;\n }\n \n@@ -918,20 +917,18 @@\n \tstruct registry_key *key = NULL;\n \tchar *service = NULL;\n \tchar *param = NULL;\n-\tchar *type = NULL;\n \tconst char *value_str = NULL;\n \tTALLOC_CTX *ctx;\n \n \tctx = talloc_init(\"setparm\");\n \n-\tif (argc != 4) {\n+\tif (argc != 3) {\n \t\tnet_conf_setparm_usage(argc, argv);\n \t\tgoto done;\n \t}\n \tservice = strdup_lower(argv[0]);\n \tparam = strdup_lower(argv[1]);\n-\ttype = strdup_lower(argv[2]);\n-\tvalue_str = argv[3];\n+\tvalue_str = argv[2];\n \n \tif (!smbconf_key_exists(ctx, service)) {\n \t\twerr = reg_createkey_internal(ctx, service, &key);\n@@ -943,7 +940,7 @@\n \t\tgoto done;\n \t}\n \n-\twerr = reg_setvalue_internal(key, param, type, value_str);\n+\twerr = reg_setvalue_internal(key, param, \"sz\", value_str);\n \tif (!W_ERROR_IS_OK(werr)) {\n \t\td_fprintf(stderr, \"Error setting value '%s': %s\\n\",\n \t\t\t  param, dos_errstr(werr));\n\nModified: branches/SAMBA_3_0_26/source/utils/net_conf.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/utils/net_conf.c\t2007-06-19 21:08:46 UTC (rev 23548)\n+++ branches/SAMBA_3_0_26/source/utils/net_conf.c\t2007-06-19 21:40:27 UTC (rev 23549)\n@@ -82,8 +82,7 @@\n \n static int net_conf_setparm_usage(int argc, const char **argv)\n {\n-\td_printf(\"USAGE: net conf setparm    \\n\"\n-\t\t \"\\t(Supported types are 'dword' and 'sz' by now.)\\n\");\n+\td_printf(\"USAGE: net conf setparm   \\n\");\n \treturn -1;\n }\n \n@@ -918,20 +917,18 @@\n \tstruct registry_key *key = NULL;\n \tchar *service = NULL;\n \tchar *param = NULL;\n-\tchar *type = NULL;\n \tconst char *value_str = NULL;\n \tTALLOC_CTX *ctx;\n \n \tctx = talloc_init(\"setparm\");\n \n-\tif (argc != 4) {\n+\tif (argc != 3) {\n \t\tnet_conf_setparm_usage(argc, argv);\n \t\tgoto done;\n \t}\n \tservice = strdup_lower(argv[0]);\n \tparam = strdup_lower(argv[1]);\n-\ttype = strdup_lower(argv[2]);\n-\tvalue_str = argv[3];\n+\tvalue_str = argv[2];\n \n \tif (!smbconf_key_exists(ctx, service)) {\n \t\twerr = reg_createkey_internal(ctx, service, &key);\n@@ -943,7 +940,7 @@\n \t\tgoto done;\n \t}\n \n-\twerr = reg_setvalue_internal(key, param, type, value_str);\n+\twerr = reg_setvalue_internal(key, param, \"sz\", value_str);\n \tif (!W_ERROR_IS_OK(werr)) {\n \t\td_fprintf(stderr, \"Error setting value '%s': %s\\n\",\n \t\t\t  param, dos_errstr(werr));\n\n"}