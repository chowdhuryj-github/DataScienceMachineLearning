{"category": "ham", "to_address": "samba-technical@samba.org", "from_address": "Michael B Allen <mba2000@ioplex.com>", "subject": "Cross Realm SMB Signature Failure", "body": "When smbclient authenticates across realms (from MIT realm S.W.NET to\nW2K3 realm W.NET) I'm seeing the server is just echoing back the same\nsignature sent by client. That signature of couse fails verification:\n\n$ kinit -f ioplex@S.W.NET\nPassword for ioplex@S.W.NET: \n$ smbclient -k -U ioplex //dc1.w.net/tmp\nsigning_good: BAD SIG: seq 1\nSMB Signature verification failed on incoming packet!\nsession setup failed: Server packet had invalid SMB signature!\n\nIf I use a W.NET cred it works fine and ssh works in the other direction\nso I think the trust is good.\n\nAll enctypes are RC4. Haven't updated the W2K3 server since installing\nit. Trying that now ...\n\nI'm using stock 3.0.23c-2 on CentOS 5.0 with an unmodified smb.conf.\n\nHas anyone seen this before?\n\nMike\n\n"}