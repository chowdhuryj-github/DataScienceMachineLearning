{"category": "ham", "to_address": "Zack Weinberg <zackw@panix.com>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] evaluating variables in the context of a data frame", "body": "On Thu, 7 Jun 2007, Zack Weinberg wrote:\n\n> Given\n>\n>> D = data.frame(o=gl(2,1,4))\n>\n> this works as I expected:\n>\n>> evalq(o, D)\n> [1] 1 2 1 2\n> Levels: 1 2\n>\n> but neither of these does:\n>\n>> f <- function(x, dat) evalq(x, dat)\n>> f(o, D)\n> Error in eval(expr, envir, enclos) : object \"o\" not found\n>> g <- function(x, dat) eval(x, dat)\n>> g(o, D)\n> Error in eval(x, dat) : object \"o\" not found\n>\n> What am I doing wrong?  This seems to be what the helpfiles say you do\n> to evaluate arguments in the context of a passed-in data frame...\n\nWhen you call f(o, D), the argument 'o' is evaluated in the current \nenvironment ('context' in R means something different).  Because of lazy \nevaluation, it is not evaluated until evalq is called, but it evaluated as \nif it was evaluated greedily.\n\ng(quote(o), D) will work.\n\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}