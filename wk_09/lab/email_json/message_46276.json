{"category": "ham", "to_address": "\"Martin Henry H. Stevens\" <HStevens@muohio.edu>", "from_address": "Spencer Graves <spencer.graves@pdf.com>", "subject": "Re: [R] Fwd: Using odesolve to produce non-negative solutions", "body": "\n\nMartin Henry H. Stevens wrote:\n> Hi Jeremy,\n> First, setting hmax to a small number could prevent a large step, if \n> you think that is a problem. Second, however, I don't see how you can \n> get a negative population size when using the log trick. \nSG:  Can lsoda estimate complex or imaginary parameters? \n\n> I would think that that would prevent completely any negative values \n> of N (i.e. e^-100000 > 0). Can you explain? or do you want to a void \n> that trick? The only other solver I know of is rk4 and it is not \n> recommended.\n> Hank\n> On Jun 11, 2007, at 11:46 AM, Jeremy Goldhaber-Fiebert wrote:\n>\n>> Hi Spencer,\n>>\n>> Thank you for your response. I also did not see anything on the lsoda \n>> help page which is the reason that I wrote to the list.\n>>\n>>> From your response, I am not sure if I asked my question clearly.\n>>\n>> I am modeling a group of people (in a variety of health states) \n>> moving through time (and getting infected with an infectious \n>> disease). This means that the count of the number of people in each \n>> state should be positive at all times.\n>>\n>> What appears to happen is that lsoda asks for a derivative at a given \n>> point in time t and then adjusts the state of the population. \n>> However, perhaps due to numerical instability, it occasionally lower \n>> the population count below 0 for one of the health states (perhaps \n>> because it's step size is too big or something).\n>>\n>> I have tried both the logarithm trick\n\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}