{"category": "ham", "to_address": "Andrew Bartlett <abartlet@samba.org>", "from_address": "Michael B Allen <mba2000@ioplex.com>", "subject": "Re: Does PAC Validation Require External Communication?", "body": "On Tue, 15 May 2007 07:59:40 +1000\nAndrew Bartlett  wrote:\n\n> On Mon, 2007-05-14 at 13:34 -0400, Michael B Allen wrote:\n> > This link claims MS' PAC verification can require communication with\n> > the DC:\n> > \n> > http://blogs.msdn.com/spatdsg/archive/2007/03/07/pac-validation.aspx\n> > \n> > Is this true? If so, services will not be able to authenticate nearly\n> > as fast as they otherwise could.\n> \n> If you think that someone else (not root) has access to the local\n> kerberos keytab (or the machine account password), then that user could\n> spoof their way to any (CIFS) user via the PAC, because they could make\n> up a fake one.  Similarly, as always with kerberos, they could change\n> the principal in the ticket, etc. \n> \n> This can be worked around by validating the PAC to the KDC, but should\n> be of concern to anyone who shares that keytab too broadly (eg with\n> apache). \n> \n> On windows, I think a user could run a service, and unless the PAC was\n> validated with the KDC, they could use their password to fake their way\n> down to another more privileged user. \n\nHi Andrew,\n\nSo exploring the Apache example a little more - if Apache loaded the\nkeytab as root when it initialized and stored it in an in-memory only\nkeytab so that workers didn't really have access to it, the KDC checksum\nwouldn't really need to be validated and no communication with the KDC\nwould be necessary?\n\nMike\n\n"}