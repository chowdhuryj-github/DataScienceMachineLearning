{"category": "ham", "to_address": "<R-help@stat.math.ethz.ch>", "from_address": "\"Mike White\" <mikewhite.diu@btconnect.com>", "subject": "[R] Fisher's r to z' transformation - help needed", "body": "I am trying to use Fisher's z' transformation of the Pearson's r but the\nstandard error does not appear to be correct.  I have simulated an example\nusing the R code below.  The z' data appears to have a reasonably normal\ndistribution but the standard error given by the formula 1/sqrt(N-3) (from\nhttp://davidmlane.com/hyperstat/A98696.html) gives a different results than\nsd(z).  Can anyone tell me where I am going wrong?\n\nlibrary(amap)\n\n## SIMULATED DATA #########################################################\np<-10\nn<-3000\nmeans<-1000*c(1:p)\nSDs<-rep(100,p)\nset.seed(1)\ndat<-mapply(rnorm, mean=means, sd=SDs, n=n)\ncolnames(dat)<-paste(\"V\",1:p, sep=\"\")\nrownames(dat)<-1:n\n# calculate centroid of simulated data\ndat.mean<-apply(dat,2,mean)\n# calculated Pearson's r to centroid\nr<-apply(dat,1,cor, y=dat.mean)\nplot(density(r))\n# Fisher's z' transformation\nz<-0.5*log((1+r)/(1-r))\nplot(density(z))\nsd(z)\n# [1] 0.2661779\n\n1/sqrt(p-3)\n# [1] 0.3779645\n\n## alternatively use comparisons for all possible pairs\n## Centred Pearson's r on raw data\nr<-1-Dist(dat,\"corr\")\nplot(density(r))\nz<-0.5*log((1+r)/(1-r))\nplot(density(z))\nsd(z)\n# [1] 0.2669787\n1/sqrt(p-3)\n# [1] 0.3779645\n\nMany thanks\nMike White\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}