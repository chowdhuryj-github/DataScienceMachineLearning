{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"=?GB2312?B?wO6/ob3c?=\" <klijunjie@gmail.com>", "subject": "[R] R2 always increases as variables are added?", "body": "Hi, everybody,\n\n3 questions about R-square:\n---------(1)----------- Does R2 always increase as variables are added?\n---------(2)----------- Does R2 always greater than 1?\n---------(3)----------- How is R2 in summary(lm(y~x-1))$r.squared\ncalculated? It is different from (r.square=sum((y.hat-mean\n(y))^2)/sum((y-mean(y))^2))\n\nI will illustrate these problems by the following codes:\n---------(1)-----------  R2  doesn't always increase as variables are added\n\n> x=matrix(rnorm(20),ncol=2)\n> y=rnorm(10)\n>\n> lm=lm(y~1)\n> y.hat=rep(1*lm$coefficients,length(y))\n> (r.square=sum((y.hat-mean(y))^2)/sum((y-mean(y))^2))\n[1] 2.646815e-33\n>\n> lm=lm(y~x-1)\n> y.hat=x%*%lm$coefficients\n> (r.square=sum((y.hat-mean(y))^2)/sum((y-mean(y))^2))\n[1] 0.4443356\n>\n> ################ This is the biggest model, but its R2 is not the biggest,\nwhy?\n> lm=lm(y~x)\n> y.hat=cbind(rep(1,length(y)),x)%*%lm$coefficients\n> (r.square=sum((y.hat-mean(y))^2)/sum((y-mean(y))^2))\n[1] 0.2704789\n\n\n---------(2)-----------  R2  can greater than 1\n\n> x=rnorm(10)\n> y=runif(10)\n> lm=lm(y~x-1)\n> y.hat=x*lm$coefficients\n> (r.square=sum((y.hat-mean(y))^2)/sum((y-mean(y))^2))\n[1] 3.513865\n\n\n ---------(3)----------- How is R2 in summary(lm(y~x-1))$r.squared\ncalculated? It is different from (r.square=sum((y.hat-mean\n(y))^2)/sum((y-mean(y))^2))\n> x=matrix(rnorm(20),ncol=2)\n> xx=cbind(rep(1,10),x)\n> y=x%*%c(1,2)+rnorm(10)\n> ### r2 calculated by lm(y~x)\n> lm=lm(y~x)\n> summary(lm)$r.squared\n[1] 0.9231062\n> ### r2 calculated by lm(y~xx-1)\n> lm=lm(y~xx-1)\n> summary(lm)$r.squared\n[1] 0.9365253\n> ### r2 calculated by me\n> y.hat=xx%*%lm$coefficients\n> (r.square=sum((y.hat-mean(y))^2)/sum((y-mean(y))^2))\n[1] 0.9231062\n\n\nThanks a lot for any cue:)\n\n\n\n\n-- \nJunjie Li,                  klijunjie@gmail.com\nUndergranduate in DEP of Tsinghua University,\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}