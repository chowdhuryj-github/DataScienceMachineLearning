{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Mike Meredith <mmeredith@wcs.org>", "subject": "Re: [R] tcltk crashing R after the (ab)use of tkwait", "body": "\n>> library(tcltk)\n>> tt <- tktoplevel()\n>> done <- tclVar(0)\n>> but <- tkbutton(tt, text=\"OK\", command=function() tclvalue(done) <- 1)\n>> tkpack(but)\n>> tkwait.variable(done)\n>> \n>> works as fine as long as I click the OK. However, if I close\n>> the window (by clicking in the X), R enters into an infinite loop\n>> and there's no way of returning except by closing the R window.\n\nI have the same pbm with R 1.5.0 on Window XP Home SP2.\n\nI think it's doing what it's supposed to, ie. waiting for done==1, just that\nthis never happens.\n\nI've stopped using tkwait.variable for just this reason, and use\ntkwait.window(tt). You have to be careful to recover the variables you need\nbefore closing the window, so the function attached to the 'OK' button\nshould take care of that before calling tkdestroy. (See\nhttp://www.nabble.com/Dropdown-boxes-in-tcltk-and-R-tf3751327.html#a10603161)\n\nVariables can be created in .GlobalEnv with <<- which will be availble after\nthe function exits. See also how Greg Snow uses a purpose-built environment\nin his 'TeachingDemos' package.\n\nMike\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n\n\n-- \nView this message in context: http://www.nabble.com/tcltk-crashing-R-after-the-%28ab%29use-of-tkwait-tf3487962.html#a10821463\nSent from the R help mailing list archive at Nabble.com.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}