{"category": "ham", "to_address": "bugs-bitbucket@netlabs.develooper.com", "from_address": "Steve Peters (via RT) <parrotbug-followup@parrotcode.org>", "subject": "[perl #42594] [PATCH] Probable buffer overflow in compilers/imcc/parser_util.c ", "body": "# New Ticket Created by  Steve Peters \n# Please include the string:  [perl #42594]\n# in the subject line of all future correspondence about this issue. \n# \n\n\nI don't know how easily this is reached, but since the \"fmt\" variable\nis only NULL checked, it seems like this would be possible to reached.\n\nSteve Peters\nsteve@fisharerojo.org\n\nIndex: compilers/imcc/parser_util.c\n===================================================================\n--- compilers/imcc/parser_util.c        (revision 18270)\n+++ compilers/imcc/parser_util.c        (working copy)\n@@ -494,8 +494,10 @@\n     if (len >= 2)\n         len -= 2;\n     format[len] = '\\0';\n-    if (fmt && *fmt)\n-        strcpy(format, fmt);\n+    if (fmt && *fmt) {\n+        strncpy(format, fmt, sizeof(format - 1));\n+        format[sizeof(format - 1)] = '\\0';\n+    }\n #if 1\n     IMCC_debug(interp, DEBUG_PARSER,\"%s %s\\t%s\\n\", name, format, fullname);\n #endif\n\n"}