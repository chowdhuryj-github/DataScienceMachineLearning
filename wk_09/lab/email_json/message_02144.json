{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "\"Taj Khattra\" <taj.khattra@gmail.com>", "subject": "Re: tdb_transaction_cancel", "body": "take two...\n\nhere's a contrived test case.  it aborts with the latest tdb in svn,\nbut works ok with the tdb in samba4-tp4.\n\ncould someone please confirm if this is a bug, or a\nmisunderstanding/misuse of the tdb api on my part?\n\nthanks.\n\n--cut--\n\n#include \n#include \"tdb.h\"\n#include \n\nmain()\n{\n        TDB_CONTEXT *tdb = tdb_open(\"test.tdb\", 0, 0, O_CREAT|O_RDWR, 0644);\n        TDB_DATA key = {\"hi\", 2};\n        tdb_transaction_start(tdb);\n        assert(tdb_chainlock(tdb, key) == 0);\n        tdb_transaction_cancel(tdb);                    /* should\nrelease all locks??? */\n        assert(tdb_chainunlock(tdb, key) == -1);\n}\n\n"}