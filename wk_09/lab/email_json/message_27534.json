{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "psomogyi@gamax.hu", "subject": "Rev 95: merge from tridge in http://samba.org/~tridge/psomogyi/", "body": "------------------------------------------------------------\nrevno: 95\nrevision-id: psomogyi@gamax.hu-20070511114212-hctokiuaxv9fvdzr\nparent: psomogyi@gamax.hu-20070511112450-wjf21qva3pjifxy9\nparent: tridge@samba.org-20070511072921-1fmloqo3r1uzqxeq\ncommitter: Peter Somogyi \nbranch nick: ctdb\ntimestamp: Fri 2007-05-11 13:42:12 +0200\nmessage:\n  merge from tridge\nadded:\n  common/ctdb_recover.c          ctdb_recover.c-20070503002147-admmfgt1oj6gexfo-1\n  common/ctdb_traverse.c         ctdb_traverse.c-20070503021550-ztfs5rwx8jfm8qqx-1\n  direct/4nodes.txt              4nodes.txt-20070502024949-2rkyfp289w532z1l-1\n  direct/ctdb_recoverd.c         recoverd.c-20070503213540-bvxuyd9jm1f7ig90-1\n  lib/events/libevents.m4        libevents.m4-20070505071540-g8d5bc9j71yj33ct-1\n  tests/recover.sh               recover.sh-20070502031230-tpuiet6m6tjdotta-1\n  tools/monitor_recovery.sh      monitor_recovery.sh-20070508220533-oy7s689rcjsu7yte-1\nmodified:\n  Makefile.in                    makefile.in-20061117234101-o3qt14umlg9en8z0-1\n  autogen.sh                     autogen.sh-20061117234101-o3qt14umlg9en8z0-3\n  common/cmdline.c               cmdline.c-20070416041216-w1zvz91bkdsgjckw-1\n  common/ctdb.c                  ctdb.c-20061127094323-t50f58d65iaao5of-2\n  common/ctdb_call.c             ctdb_call.c-20061128065342-to93h6eejj5kon81-1\n  common/ctdb_client.c           ctdb_client.c-20070411010216-3kd8v37k61steeya-1\n  common/ctdb_control.c          ctdb_control.c-20070426122724-j6gkpiofhbwdin63-1\n  common/ctdb_daemon.c           ctdb_daemon.c-20070409200331-3el1kqgdb9m4ib0g-1\n  common/ctdb_io.c               ctdb_io.c-20070409200335-dzfc7f3rra5rcf60-1\n  common/ctdb_lockwait.c         ctdb_lockwait.c-20070416214118-n1aeonljj3vpdd9q-1\n  common/ctdb_ltdb.c             ctdb_ltdb.c-20061128065342-to93h6eejj5kon81-2\n  common/ctdb_message.c          ctdb_message.c-20070208224107-9dnio7x7z33prrmt-1\n  common/ctdb_util.c             ctdb_util.c-20061128065342-to93h6eejj5kon81-3\n  configure.ac                   configure.ac-20061117234101-o3qt14umlg9en8z0-10\n  direct/ctdbd_test.c            ctdbd_test.c-20070411085057-17kgjzfktsh28g99-1\n  include/ctdb.h                 ctdb.h-20061117234101-o3qt14umlg9en8z0-11\n  include/ctdb_private.h         ctdb_private.h-20061117234101-o3qt14umlg9en8z0-13\n  lib/events/config.m4           config.m4-20061117234101-o3qt14umlg9en8z0-24\n  lib/events/events.c            events.c-20061117234101-o3qt14umlg9en8z0-26\n  lib/events/events.h            events.h-20061117234101-o3qt14umlg9en8z0-27\n  lib/events/events_aio.c        events_aio.c-20070501213746-4fxluwiq4rcxib8p-1\n  lib/events/events_epoll.c      events_epoll.c-20070501213746-4fxluwiq4rcxib8p-2\n  lib/events/events_internal.h   events_internal.h-20061117234101-o3qt14umlg9en8z0-28\n  lib/events/events_liboop.c     events_liboop.c-20061117234101-o3qt14umlg9en8z0-29\n  lib/events/events_select.c     events_select.c-20070501213746-4fxluwiq4rcxib8p-3\n  lib/events/events_standard.c   events_standard.c-20061117234101-o3qt14umlg9en8z0-30\n  lib/events/events_timed.c      events_timed.c-20070501213746-4fxluwiq4rcxib8p-5\n  lib/popt/libpopt.m4            libpopt.m4-20070125040942-nz1rv4zkr26q77uw-7\n  lib/popt/samba.m4              samba.m4-20070125040942-nz1rv4zkr26q77uw-14\n  lib/replace/system/select.h    select.h-20070125040949-7t3f5zdl1q4z9hyv-88\n  lib/tdb/Makefile.in            makefile.in-20070125040949-7t3f5zdl1q4z9hyv-59\n  lib/tdb/common/lock.c          lock.c-20070220022425-m1wibgjq7n5hahs6-7\n  lib/tdb/common/tdb.c           tdb.c-20070220022425-m1wibgjq7n5hahs6-9\n  lib/tdb/configure.ac           configure.ac-20070125040949-7t3f5zdl1q4z9hyv-65\n  lib/tdb/include/tdb.h          tdb.h-20070125040949-7t3f5zdl1q4z9hyv-101\n  tests/ctdb_fetch.c             ctdb_fetch.c-20070405031748-f7gslozfj3rwh5ie-1\n  tests/ctdb_test.c              ctdb_test.c-20061117234101-o3qt14umlg9en8z0-16\n  tests/ctdbd.sh                 ctdbd.sh-20070411085038-phusiewluwzyqjpc-2\n  tools/ctdb_control.c           ctdb_control.c-20070426122705-9ehj1l5lu2gn9kuj-1\n    ------------------------------------------------------------\n    revno: 44.1.233\n    merged: tridge@samba.org-20070511072921-1fmloqo3r1uzqxeq\n    parent: tridge@samba.org-20070511003343-mdcfsv1todutp5mz\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-11 17:29:21 +1000\n    message:\n      fixed debug message\n    ------------------------------------------------------------\n    revno: 44.1.232\n    merged: tridge@samba.org-20070511003343-mdcfsv1todutp5mz\n    parent: tridge@samba.org-20070510074345-gp2mm5z8rqhytnvu\n    parent: sahlberg@ronnie-20070510200817-cd0cc3a541930600\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-11 10:33:43 +1000\n    message:\n      - merge from ronnie\n      - increment rsn only in become_dmaster\n      - add torture check for rsn regression in ctdb_ltdb_store\n        ------------------------------------------------------------\n        revno: 44.1.153.1.100\n        merged: sahlberg@ronnie-20070510200817-cd0cc3a541930600\n        parent: sahlberg@ronnie-20070510194011-4b6a20e4195d6b18\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-11 06:08:17 +1000\n        message:\n          we must bump the rsn everytime we do a REQ_DMASTER or a REPLY_DMASTER\n          to make sure that the \"merge records based on rsn during recovery\" will\n          merge correctly.\n          \n          this is extra important since samba3 never bumps the record when it \n          writes new data to it !\n        ------------------------------------------------------------\n        revno: 44.1.153.1.99\n        merged: sahlberg@ronnie-20070510194011-4b6a20e4195d6b18\n        parent: sahlberg@ronnie-20070510075951-10d944d8d76842c0\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-11 05:40:11 +1000\n        message:\n          make ctdb_control catdb work again\n        ------------------------------------------------------------\n        revno: 44.1.153.1.98\n        merged: sahlberg@ronnie-20070510075951-10d944d8d76842c0\n        parent: sahlberg@ronnie-20070510001058-a7ac6eddce1344a8\n        parent: tridge@samba.org-20070510074345-gp2mm5z8rqhytnvu\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 17:59:51 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.231\n    merged: tridge@samba.org-20070510074345-gp2mm5z8rqhytnvu\n    parent: tridge@samba.org-20070510074308-pfgaxsep5jj1v3w4\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 17:43:45 +1000\n    message:\n      - got rid of the complex hand marshalling in the recovery controls\n      \n      - fixed the re-send of ctdb calls after a generation change\n      \n      - fixed a reqid idr leak in controls\n      \n      - removed the write_record test code\n      \n      - use the new nonblock lockall code to prevent ctdbd from ever doing a\n        blocking lock that could deadlock with smbd\n      \n      - moved more of the recovery controls into ctdb_recover.c\n    ------------------------------------------------------------\n    revno: 44.1.230\n    merged: tridge@samba.org-20070510074308-pfgaxsep5jj1v3w4\n    parent: tridge@samba.org-20070510040648-0lwu9l2b8vl3zq86\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 17:43:08 +1000\n    message:\n      added nonblocking varients of the two lockall functions to tdb\n    ------------------------------------------------------------\n    revno: 44.1.229\n    merged: tridge@samba.org-20070510040648-0lwu9l2b8vl3zq86\n    parent: tridge@samba.org-20070510031558-ckupssp96wzoohkd\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 14:06:48 +1000\n    message:\n      better timeout handling for calls, controls and traverses\n    ------------------------------------------------------------\n    revno: 44.1.228\n    merged: tridge@samba.org-20070510031558-ckupssp96wzoohkd\n    parent: tridge@samba.org-20070510031023-yhipc23awqwfed3s\n    parent: sahlberg@ronnie-20070510001058-a7ac6eddce1344a8\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 13:15:58 +1000\n    message:\n      merge from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.97\n        merged: sahlberg@ronnie-20070510001058-a7ac6eddce1344a8\n        parent: sahlberg@ronnie-20070510000321-89f72cadfa94fb77\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 10:10:58 +1000\n        message:\n          create a correct vnnmap structure to prevent a segv\n        ------------------------------------------------------------\n        revno: 44.1.153.1.96\n        merged: sahlberg@ronnie-20070510000321-89f72cadfa94fb77\n        parent: sahlberg@ronnie-20070509234814-caea2e55dd3bc4e7\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 10:03:21 +1000\n        message:\n          update ctdb_control to create a correct ctdb_vnn_map->map array\n        ------------------------------------------------------------\n        revno: 44.1.153.1.95\n        merged: sahlberg@ronnie-20070509234814-caea2e55dd3bc4e7\n        parent: sahlberg@ronnie-20070509234610-5cdd047d69014c36\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 09:48:14 +1000\n        message:\n          when starting a new election, also force all nodes into recovery mode so \n          there is no internode traffic to interfere with our election\n        ------------------------------------------------------------\n        revno: 44.1.153.1.94\n        merged: sahlberg@ronnie-20070509234610-5cdd047d69014c36\n        parent: sahlberg@ronnie-20070509234428-38b8689cb7bd25fe\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 09:46:10 +1000\n        message:\n          when starting recovery repoint dmaster to an invalid node and not the \n          current vnn\n        ------------------------------------------------------------\n        revno: 44.1.153.1.93\n        merged: sahlberg@ronnie-20070509234428-38b8689cb7bd25fe\n        parent: sahlberg@ronnie-20070509234301-c9fe15e2fffd523e\n        parent: tridge@samba.org-20070509222226-gxev7f84ugyfdkti\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 09:44:28 +1000\n        message:\n          merge from tridge\n        ------------------------------------------------------------\n        revno: 44.1.153.1.92\n        merged: sahlberg@ronnie-20070509234301-c9fe15e2fffd523e\n        parent: sahlberg@ronnie-20070509205528-ea549e31fa9af90b\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 09:43:01 +1000\n        message:\n          actually check the remote nodes and not just the local node\n        ------------------------------------------------------------\n        revno: 44.1.153.1.91\n        merged: sahlberg@ronnie-20070509205528-ea549e31fa9af90b\n        parent: sahlberg@ronnie-20070509040811-460ac8e7d6691f7f\n        parent: tridge@samba.org-20070509015437-c9u6pubosc3jz0um\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-10 06:55:28 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.227\n    merged: tridge@samba.org-20070510031023-yhipc23awqwfed3s\n    parent: tridge@samba.org-20070509224957-9l3bc1ay2rluro28\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 13:10:23 +1000\n    message:\n      setup the random number generator a bit better\n    ------------------------------------------------------------\n    revno: 44.1.226\n    merged: tridge@samba.org-20070509224957-9l3bc1ay2rluro28\n    parent: tridge@samba.org-20070509222226-gxev7f84ugyfdkti\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 08:49:57 +1000\n    message:\n      remove old s3 recovery code\n      fixed vnnmap wire format in recover daemon\n    ------------------------------------------------------------\n    revno: 44.1.225\n    merged: tridge@samba.org-20070509222226-gxev7f84ugyfdkti\n    parent: tridge@samba.org-20070509221319-2i6pfo0e6gudc6dz\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 08:22:26 +1000\n    message:\n      fixed setvnnmap to use wire structures too\n    ------------------------------------------------------------\n    revno: 44.1.224\n    merged: tridge@samba.org-20070509221319-2i6pfo0e6gudc6dz\n    parent: tridge@samba.org-20070509215546-6s0mhsloyilervjf\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 08:13:19 +1000\n    message:\n      separate the wire format and internal format for the vnn_map\n    ------------------------------------------------------------\n    revno: 44.1.223\n    merged: tridge@samba.org-20070509215546-6s0mhsloyilervjf\n    parent: tridge@samba.org-20070509214318-io4xhj2e6k91eosm\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 07:55:46 +1000\n    message:\n      moved the vnn_map initialisation out of the cmdline code\n    ------------------------------------------------------------\n    revno: 44.1.222\n    merged: tridge@samba.org-20070509214318-io4xhj2e6k91eosm\n    parent: tridge@samba.org-20070509015437-c9u6pubosc3jz0um\n    parent: sahlberg@ronnie-20070509040811-460ac8e7d6691f7f\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-10 07:43:18 +1000\n    message:\n      merged ronnies code to delay client requests when in recovery mode\n        ------------------------------------------------------------\n        revno: 44.1.153.1.90\n        merged: sahlberg@ronnie-20070509040811-460ac8e7d6691f7f\n        parent: sahlberg@ronnie-20070509040647-f8724a40b8a205e5\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-09 14:08:11 +1000\n        message:\n          hang the event from the retry structure instead of the hdr structure\n        ------------------------------------------------------------\n        revno: 44.1.153.1.89\n        merged: sahlberg@ronnie-20070509040647-f8724a40b8a205e5\n        parent: sahlberg@ronnie-20070508235923-78a4589b69fa8935\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-09 14:06:47 +1000\n        message:\n          when we are in recovery mode and we get a REQ_CALL from a client,\n          defer it for one second and try again   \n    ------------------------------------------------------------\n    revno: 44.1.221\n    merged: tridge@samba.org-20070509015437-c9u6pubosc3jz0um\n    parent: tridge@samba.org-20070508111629-cgamk1fazmat0dog\n    parent: sahlberg@ronnie-20070508235923-78a4589b69fa8935\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Wed 2007-05-09 11:54:37 +1000\n    message:\n      merge from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.88\n        merged: sahlberg@ronnie-20070508235923-78a4589b69fa8935\n        parent: sahlberg@ronnie-20070508233153-a5fc5d5efade086d\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-09 09:59:23 +1000\n        message:\n          add a command line flag to ctdbd to start a recovery daemon.\n          \n          update the recovery test script to start all ctdb daemons with a \n          recovery daemon\n        ------------------------------------------------------------\n        revno: 44.1.153.1.87\n        merged: sahlberg@ronnie-20070508233153-a5fc5d5efade086d\n        parent: sahlberg@ronnie-20070508220553-7d7bb02b7a822678\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-09 09:31:53 +1000\n        message:\n          change the name of the recovery daemon to ctdb_recoverd\n        ------------------------------------------------------------\n        revno: 44.1.153.1.86\n        merged: sahlberg@ronnie-20070508220553-7d7bb02b7a822678\n        parent: sahlberg@ronnie-20070508045155-5aa31feeab7611e4\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-09 08:05:53 +1000\n        message:\n          add a small tool to monitor recovery\n        ------------------------------------------------------------\n        revno: 44.1.153.1.85\n        merged: sahlberg@ronnie-20070508045155-5aa31feeab7611e4\n        parent: sahlberg@ronnie-20070508044200-c535ef000d25dde9\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Tue 2007-05-08 14:51:55 +1000\n        message:\n          we must repoint dmaster to an invalid node during recovery to stop the \n          shortcut from working\n        ------------------------------------------------------------\n        revno: 44.1.153.1.84\n        merged: sahlberg@ronnie-20070508044200-c535ef000d25dde9\n        parent: sahlberg@ronnie-20070506220726-342d114d8479620e\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Tue 2007-05-08 14:42:00 +1000\n        message:\n          fix alignment bug for pulldb\n        ------------------------------------------------------------\n        revno: 44.1.153.1.83\n        merged: sahlberg@ronnie-20070506220726-342d114d8479620e\n        parent: sahlberg@ronnie-20070506215417-d96e79c116240aad\n        parent: tridge@samba.org-20070506215638-67wvsh0zwt7bbllo\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Mon 2007-05-07 08:07:26 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.220\n    merged: tridge@samba.org-20070508111629-cgamk1fazmat0dog\n    parent: tridge@samba.org-20070506215638-67wvsh0zwt7bbllo\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Tue 2007-05-08 21:16:29 +1000\n    message:\n      fixed a problem with the number of timed events growing without bound with the new seqnum code\n    ------------------------------------------------------------\n    revno: 44.1.219\n    merged: tridge@samba.org-20070506215638-67wvsh0zwt7bbllo\n    parent: tridge@samba.org-20070505074654-1cs2rodrtlo3dkjk\n    parent: sahlberg@ronnie-20070506215417-d96e79c116240aad\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Mon 2007-05-07 07:56:38 +1000\n    message:\n      merged from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.82\n        merged: sahlberg@ronnie-20070506215417-d96e79c116240aad\n        parent: sahlberg@ronnie-20070506214716-d88b489c9db3b15c\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Mon 2007-05-07 07:54:17 +1000\n        message:\n          hang the timeout event off state   and thus we dont need to explicitely \n          free it   and also we wont accidentally return from the function without \n          killing the event first\n        ------------------------------------------------------------\n        revno: 44.1.153.1.81\n        merged: sahlberg@ronnie-20070506214716-d88b489c9db3b15c\n        parent: sahlberg@ronnie-20070506205158-a1110272a8a362ad\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Mon 2007-05-07 07:47:16 +1000\n        message:\n          it now works to talloc_free() the timed event if we no longer want it to \n          trigger\n          \n          this must have been a sideeffect of a different bug in the recoverd.c \n          code that has now been fixed\n        ------------------------------------------------------------\n        revno: 44.1.153.1.80\n        merged: sahlberg@ronnie-20070506205158-a1110272a8a362ad\n        parent: sahlberg@ronnie-20070506190248-95317ce2ee808aa3\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Mon 2007-05-07 06:51:58 +1000\n        message:\n          recovery daemon with recovery master election\n          \n          election is primitive, it elects the lowest vnn as the recovery master\n          \n          two new controls, to get/set recovery master for a node\n          \n          \n          \n          to use recovery daemon,   start one  \n          ./bin/recoverd --socket=ctdb.socket*\n          for each ctdb daemon\n          \n          \n          it has been briefly tested by deleting and adding nodes to a 4 node \n          cluster but needs more testing\n        ------------------------------------------------------------\n        revno: 44.1.153.1.79\n        merged: sahlberg@ronnie-20070506190248-95317ce2ee808aa3\n        parent: sahlberg@ronnie-20070506184112-5da5d1b472919956\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Mon 2007-05-07 05:02:48 +1000\n        message:\n          add new controls to get and set the recovery master node of a daemon\n          i.e. which node is \"elected\" to check for and drive recovery\n        ------------------------------------------------------------\n        revno: 44.1.153.1.78\n        merged: sahlberg@ronnie-20070506184112-5da5d1b472919956\n        parent: sahlberg@ronnie-20070506024656-54065db42fc80030\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Mon 2007-05-07 04:41:12 +1000\n        message:\n          add a test in the function that checks whether the cluster needs \n          recovery or not  that all active nodes are in normal mode.\n          If we discover that some node is still in recoverymode it may indicate \n          that a previous recovery ended prematurely and thus we should start a \n          new recovery \n        ------------------------------------------------------------\n        revno: 44.1.153.1.77\n        merged: sahlberg@ronnie-20070506024656-54065db42fc80030\n        parent: sahlberg@ronnie-20070506005125-24f5190be388d944\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 12:46:56 +1000\n        message:\n          update a comment to be more desciptive\n        ------------------------------------------------------------\n        revno: 44.1.153.1.76\n        merged: sahlberg@ronnie-20070506005125-24f5190be388d944\n        parent: sahlberg@ronnie-20070506004218-e5dc99fda5598e6e\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:51:25 +1000\n        message:\n          change a lot of printf into debug statements\n        ------------------------------------------------------------\n        revno: 44.1.153.1.75\n        merged: sahlberg@ronnie-20070506004218-e5dc99fda5598e6e\n        parent: sahlberg@ronnie-20070506003844-cfa2e54767c22f74\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:42:18 +1000\n        message:\n          break out the code to update all nodes to the new vnnmap into a helper \n          function\n        ------------------------------------------------------------\n        revno: 44.1.153.1.74\n        merged: sahlberg@ronnie-20070506003844-cfa2e54767c22f74\n        parent: sahlberg@ronnie-20070506003018-5b7bebe70235b0fb\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:38:44 +1000\n        message:\n          create a helper function for recovery to push all local databases out \n          onto the remote nodes\n        ------------------------------------------------------------\n        revno: 44.1.153.1.73\n        merged: sahlberg@ronnie-20070506003018-5b7bebe70235b0fb\n        parent: sahlberg@ronnie-20070506002213-9ad049359f13100b\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:30:18 +1000\n        message:\n          add an extra blank line\n        ------------------------------------------------------------\n        revno: 44.1.153.1.72\n        merged: sahlberg@ronnie-20070506002213-9ad049359f13100b\n        parent: sahlberg@ronnie-20070506001648-69c865e04dda39ce\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:22:13 +1000\n        message:\n          break the code that repoints dmaster for all local and remote records \n          into a separate helper function\n        ------------------------------------------------------------\n        revno: 44.1.153.1.71\n        merged: sahlberg@ronnie-20070506001648-69c865e04dda39ce\n        parent: sahlberg@ronnie-20070506001242-2ad8fec87f6dea8b\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:16:48 +1000\n        message:\n          create a helper function for recovery that pulls and merges all remote \n          databases onto the local node\n        ------------------------------------------------------------\n        revno: 44.1.153.1.70\n        merged: sahlberg@ronnie-20070506001242-2ad8fec87f6dea8b\n        parent: sahlberg@ronnie-20070506000437-f1ba6eb009903e0e\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:12:42 +1000\n        message:\n          create a helper function to make sure the local node that does recovery \n          has all the databases that exist on any other remote node\n        ------------------------------------------------------------\n        revno: 44.1.153.1.69\n        merged: sahlberg@ronnie-20070506000437-f1ba6eb009903e0e\n        parent: sahlberg@ronnie-20070505235312-47eb2e7327632b8f\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 10:04:37 +1000\n        message:\n          add a helper function to create all missing remote databases detected \n          during recovery\n        ------------------------------------------------------------\n        revno: 44.1.153.1.68\n        merged: sahlberg@ronnie-20070505235312-47eb2e7327632b8f\n        parent: sahlberg@ronnie-20070505220522-a85200c3738602cb\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 09:53:12 +1000\n        message:\n          break out the setting/clearing of recovery mode into a dedicated helper \n          function\n        ------------------------------------------------------------\n        revno: 44.1.153.1.67\n        merged: sahlberg@ronnie-20070505220522-a85200c3738602cb\n        parent: sahlberg@ronnie-20070505215220-9645a5e6c1f75971\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 08:05:22 +1000\n        message:\n          dont allocate arrays where we can just return a single integer\n        ------------------------------------------------------------\n        revno: 44.1.153.1.66\n        merged: sahlberg@ronnie-20070505215220-9645a5e6c1f75971\n        parent: sahlberg@ronnie-20070505213216-a6ffc7923cad6b0c\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 07:52:20 +1000\n        message:\n          dont use arrays where a uint32_t works just as well\n        ------------------------------------------------------------\n        revno: 44.1.153.1.65\n        merged: sahlberg@ronnie-20070505213216-a6ffc7923cad6b0c\n        parent: sahlberg@ronnie-20070505210747-ae90637e16bf5cb7\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 07:32:16 +1000\n        message:\n          add a ifdeffed out block to the call.\n          \n          we really should kill the event in case the call completed before the \n          timeout   so that we can also make timed_out non-static\n        ------------------------------------------------------------\n        revno: 44.1.153.1.64\n        merged: sahlberg@ronnie-20070505210747-ae90637e16bf5cb7\n        parent: sahlberg@ronnie-20070505205801-e674f5fc04467b37\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 07:07:47 +1000\n        message:\n          hte timed_out variable needs to be static and can not be on the stack   \n          since if the command times out and we return from ctdb_control   we may \n          have events that can trigger later which will overwrite data that is no \n          longer in our stackframe\n        ------------------------------------------------------------\n        revno: 44.1.153.1.63\n        merged: sahlberg@ronnie-20070505205801-e674f5fc04467b37\n        parent: sahlberg@ronnie-20070505200639-0d19e58cc0e77781\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 06:58:01 +1000\n        message:\n          update to rhe recovery daemon\n          ctdb_ctrl_ calls are timedout due to nodes arriving or leaving the \n          cluster it crashes the recovery daemon afterwards with a SEGV but no \n          useful stack backtrace\n        ------------------------------------------------------------\n        revno: 44.1.153.1.62\n        merged: sahlberg@ronnie-20070505200639-0d19e58cc0e77781\n        parent: sahlberg@ronnie-20070505195315-2f67bc95926668e5\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 06:06:39 +1000\n        message:\n          in the recover test\n          start the daemons with explicit socketnames and explicit ip address/port\n          \n          remove all --socket=  from all ctdb_control calls since they are not \n          needed anymore\n        ------------------------------------------------------------\n        revno: 44.1.153.1.61\n        merged: sahlberg@ronnie-20070505195315-2f67bc95926668e5\n        parent: sahlberg@ronnie-20070505183841-3ee39c2e0abe51ca\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 05:53:15 +1000\n        message:\n          add support in catdb to dump the content of a specific nodes tdb instead \n          of traversing the full cluster.\n          this makes it easier to debug recovery\n          \n          update the test script for recovery to reflect the newish signatures to\n          ctdb_control\n          \n          \n          \n          the catdb control does still segfault however when there are missing \n          nodes in the cluster   as there are toward the end of the recovery test\n        ------------------------------------------------------------\n        revno: 44.1.153.1.60\n        merged: sahlberg@ronnie-20070505183841-3ee39c2e0abe51ca\n        parent: sahlberg@ronnie-20070505183122-09dfca19dab5ec41\n        parent: tridge@samba.org-20070505074654-1cs2rodrtlo3dkjk\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 04:38:41 +1000\n        message:\n          merge from tridge\n        ------------------------------------------------------------\n        revno: 44.1.153.1.59\n        merged: sahlberg@ronnie-20070505183122-09dfca19dab5ec41\n        parent: sahlberg@ronnie-20070505065134-e92a7a2ea17d523b\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sun 2007-05-06 04:31:22 +1000\n        message:\n          add a control to get the pid of a daemon.\n          this makes it possible to kill a specific daemon in the recover test \n          script\n        ------------------------------------------------------------\n        revno: 44.1.153.1.58\n        merged: sahlberg@ronnie-20070505065134-e92a7a2ea17d523b\n        parent: sahlberg@ronnie-20070505031726-667ed50c2053a8aa\n        parent: tridge@samba.org-20070505040946-iji1cxsyb8ail7bk\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sat 2007-05-05 16:51:34 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.218\n    merged: tridge@samba.org-20070505074654-1cs2rodrtlo3dkjk\n    parent: tridge@samba.org-20070505073528-7a0k8rak6j00p6bl\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 17:46:54 +1000\n    message:\n      merge relevant lib code from samba4\n    ------------------------------------------------------------\n    revno: 44.1.217\n    merged: tridge@samba.org-20070505073528-7a0k8rak6j00p6bl\n    parent: tridge@samba.org-20070505071959-wvf5a3e37mch3vy3\n    parent: sahlberg@ronnie-20070505031726-667ed50c2053a8aa\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 17:35:28 +1000\n    message:\n      merged vnn map broadcast from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.57\n        merged: sahlberg@ronnie-20070505031726-667ed50c2053a8aa\n        parent: sahlberg@ronnie-20070505014644-64544864493dc596\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sat 2007-05-05 13:17:26 +1000\n        message:\n          split the vnn broadcast address into two\n          one broadcast address for all nodes\n          and one broadcast address for all nodes in the current vnnmap\n          \n          update all useage of the old flag to now only broadcast to the vnnmap\n          except for tools/ctdb_control where it makes more sense to broadcast to \n          all nodes\n        ------------------------------------------------------------\n        revno: 44.1.153.1.56\n        merged: sahlberg@ronnie-20070505014644-64544864493dc596\n        parent: sahlberg@ronnie-20070504152230-2e8efa9c50c6791a\n        parent: tridge@samba.org-20070505010310-wlknjyla4cqkbdld\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sat 2007-05-05 11:46:44 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.216\n    merged: tridge@samba.org-20070505071959-wvf5a3e37mch3vy3\n    parent: tridge@samba.org-20070505071843-gdt3kgn66sa3xds0\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 17:19:59 +1000\n    message:\n      - take advantage of the new EVENT_FD_AUTOCLOSE flag\n      - use the tdb_chainlock_mark() call to allow us to guarantee forward progress in the ctdb_lockwait code\n    ------------------------------------------------------------\n    revno: 44.1.215\n    merged: tridge@samba.org-20070505071843-gdt3kgn66sa3xds0\n    parent: tridge@samba.org-20070505071806-hatj3yhl0nl335p3\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 17:18:43 +1000\n    message:\n      allow the events system to be chosen on the command line\n    ------------------------------------------------------------\n    revno: 44.1.214\n    merged: tridge@samba.org-20070505071806-hatj3yhl0nl335p3\n    parent: tridge@samba.org-20070505071725-5n1dbqmzop11bmcp\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 17:18:06 +1000\n    message:\n      use the new lib/events autoconf code\n    ------------------------------------------------------------\n    revno: 44.1.213\n    merged: tridge@samba.org-20070505071725-5n1dbqmzop11bmcp\n    parent: tridge@samba.org-20070505071433-i3i06lprinozpxhe\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 17:17:25 +1000\n    message:\n      - added a EVENT_FD_AUTOCLOSE flag that allows you to tell the event system to close the fd automatically when a fd_event is freed. This prevents races which can lead to epoll missing events\n      - added autoconf rules for automatically building with epoll support\n    ------------------------------------------------------------\n    revno: 44.1.212\n    merged: tridge@samba.org-20070505071433-i3i06lprinozpxhe\n    parent: tridge@samba.org-20070505040946-iji1cxsyb8ail7bk\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 17:14:33 +1000\n    message:\n      added tdb_chainlock_mark() call, which can be used to mark a chain locked without actually locking it. This will be used to guarantee forward progress in the ctdb non-blocking lockwait code\n    ------------------------------------------------------------\n    revno: 44.1.211\n    merged: tridge@samba.org-20070505040946-iji1cxsyb8ail7bk\n    parent: tridge@samba.org-20070505010310-wlknjyla4cqkbdld\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 14:09:46 +1000\n    message:\n      show number of connected clients in status output\n    ------------------------------------------------------------\n    revno: 44.1.210\n    merged: tridge@samba.org-20070505010310-wlknjyla4cqkbdld\n    parent: tridge@samba.org-20070504223335-oai3wi0jsmp8ywwp\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 11:03:10 +1000\n    message:\n      added a dumpmemory control, used to find memory leaks\n    ------------------------------------------------------------\n    revno: 44.1.209\n    merged: tridge@samba.org-20070504223335-oai3wi0jsmp8ywwp\n    parent: tridge@samba.org-20070504221154-bzrdobzto7dh90ze\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 08:33:35 +1000\n    message:\n      - fixed a crash bug after client disconnect in ctdb_control\n      - added total memory used to ctdb_control status output\n    ------------------------------------------------------------\n    revno: 44.1.208\n    merged: tridge@samba.org-20070504221154-bzrdobzto7dh90ze\n    parent: tridge@samba.org-20070504213923-5u40be09hum8yclu\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 08:11:54 +1000\n    message:\n      - added counters for controls in ctdb_control status\n    ------------------------------------------------------------\n    revno: 44.1.207\n    merged: tridge@samba.org-20070504213923-5u40be09hum8yclu\n    parent: tridge@samba.org-20070504121800-qg2ked2z7jg5eywl\n    parent: sahlberg@ronnie-20070504152230-2e8efa9c50c6791a\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Sat 2007-05-05 07:39:23 +1000\n    message:\n      merged from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.55\n        merged: sahlberg@ronnie-20070504152230-2e8efa9c50c6791a\n        parent: sahlberg@ronnie-20070504070528-02cb56ca5c37e8d8\n        parent: tridge@samba.org-20070504121800-qg2ked2z7jg5eywl\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Sat 2007-05-05 01:22:30 +1000\n        message:\n          merge from tridge\n        ------------------------------------------------------------\n        revno: 44.1.153.1.54\n        merged: sahlberg@ronnie-20070504070528-02cb56ca5c37e8d8\n        parent: sahlberg@ronnie-20070504052557-558731e832131140\n        parent: tridge@samba.org-20070504032530-ni45j80aucjdgxfe\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 17:05:28 +1000\n        message:\n          merge from tridge\n        ------------------------------------------------------------\n        revno: 44.1.153.1.53\n        merged: sahlberg@ronnie-20070504052557-558731e832131140\n        parent: sahlberg@ronnie-20070504052140-b809d96139570fb5\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 15:25:57 +1000\n        message:\n          remove a exit from the test script\n        ------------------------------------------------------------\n        revno: 44.1.153.1.52\n        merged: sahlberg@ronnie-20070504052140-b809d96139570fb5\n        parent: sahlberg@ronnie-20070504015745-d868b2ec34e8a893\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 15:21:40 +1000\n        message:\n          recovery daemon\n          \n          this program is a client to the local ctdb daemon\n          \n          every second it pulls all vnnmap and nodemaps from all nodes that are \n          available and checks if a recovery is required\n          \n          a recovery is required if :\n          * all nodes do NOT have an identical vnnmap and generation\n          * all nodes do NOT have an identical nodemap\n          * there are active nodes that are NOT in the nodemap\n          * there are nodes in the nodemap that are NOT active\n          \n          During recovery,  the recovery tool will also make sure that all nodes \n          know about and have created all databases.\n        ------------------------------------------------------------\n        revno: 44.1.153.1.51\n        merged: sahlberg@ronnie-20070504015745-d868b2ec34e8a893\n        parent: sahlberg@ronnie-20070504015107-7ed0989f18a1fe6c\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 11:57:45 +1000\n        message:\n          also verify that the generation id is the same on all the nodes and if \n          not, trigger a recovery\n        ------------------------------------------------------------\n        revno: 44.1.153.1.50\n        merged: sahlberg@ronnie-20070504015107-7ed0989f18a1fe6c\n        parent: sahlberg@ronnie-20070503234553-4bf967bca57c0ba6\n        parent: tridge@samba.org-20070504014129-3vxt4shmb042ov3d\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 11:51:07 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.206\n    merged: tridge@samba.org-20070504121800-qg2ked2z7jg5eywl\n    parent: tridge@samba.org-20070504053328-94qersgg4p3pmr1r\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-04 22:18:00 +1000\n    message:\n      added seqnum propogation code to ctdb\n    ------------------------------------------------------------\n    revno: 44.1.205\n    merged: tridge@samba.org-20070504053328-94qersgg4p3pmr1r\n    parent: tridge@samba.org-20070504052910-297ykux8e77ka6p0\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-04 15:33:28 +1000\n    message:\n      added a ctdb control for enabling the tdb seqnum\n    ------------------------------------------------------------\n    revno: 44.1.204\n    merged: tridge@samba.org-20070504052910-297ykux8e77ka6p0\n    parent: tridge@samba.org-20070504032530-ni45j80aucjdgxfe\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-04 15:29:10 +1000\n    message:\n      added a tdb_enable_seqnum() function\n    ------------------------------------------------------------\n    revno: 44.1.203\n    merged: tridge@samba.org-20070504032530-ni45j80aucjdgxfe\n    parent: tridge@samba.org-20070504021839-0d8138o2tzki943u\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-04 13:25:30 +1000\n    message:\n      make catdb take a dbname instead of an id\n    ------------------------------------------------------------\n    revno: 44.1.202\n    merged: tridge@samba.org-20070504021839-0d8138o2tzki943u\n    parent: tridge@samba.org-20070504014129-3vxt4shmb042ov3d\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-04 12:18:39 +1000\n    message:\n      nicer interface to ctdb traverse\n    ------------------------------------------------------------\n    revno: 44.1.201\n    merged: tridge@samba.org-20070504014129-3vxt4shmb042ov3d\n    parent: tridge@samba.org-20070504004339-kn6qu8t7ek3z1co5\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-04 11:41:29 +1000\n    message:\n      - changed the REQ_REGISTER PDU to be a control\n      \n      - allow controls to know which client invoked them\n      \n      - added a client_id to clients, so they can be identified remotely\n      \n      - added the ability to remove registered srvids\n      \n      - in the list_keys code, register a temp srvid, then remove it afterwards\n    ------------------------------------------------------------\n    revno: 44.1.200\n    merged: tridge@samba.org-20070504004339-kn6qu8t7ek3z1co5\n    parent: tridge@samba.org-20070503071223-l9hybdfd0lwdswu0\n    parent: sahlberg@ronnie-20070503234553-4bf967bca57c0ba6\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Fri 2007-05-04 10:43:39 +1000\n    message:\n      merge from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.49\n        merged: sahlberg@ronnie-20070503234553-4bf967bca57c0ba6\n        parent: sahlberg@ronnie-20070503230101-9fc8d7cbbc2fc6b8\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 09:45:53 +1000\n        message:\n          update getvnnmap control to take a timeout parameter\n          dont explicitely free the vnnmap pointer in the getvnnmap control  this \n          is freed by the mem_ctx instead\n          \n          add code to the recoverd to detect when/if recovery is required\n          veiry that the number of active nodes, the nodemap and the vnn map is \n          consistent across the entire cluster and if not   trigger a recovery \n          (which right now just prints \"we need to do recovery\" to the screen.\n        ------------------------------------------------------------\n        revno: 44.1.153.1.48\n        merged: sahlberg@ronnie-20070503230101-9fc8d7cbbc2fc6b8\n        parent: sahlberg@ronnie-20070503223202-6defdbe314660e83\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 09:01:01 +1000\n        message:\n          change the signature for ctdb_ctrl_getnodemap() so that a timeout \n          parameter is added.\n          change ctdb_get_connected_nodes in the same way\n        ------------------------------------------------------------\n        revno: 44.1.153.1.47\n        merged: sahlberg@ronnie-20070503223202-6defdbe314660e83\n        parent: sahlberg@ronnie-20070503223018-0799fc78283a686f\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 08:32:02 +1000\n        message:\n          ctdb_control should use the provided timeout and not hardcode to 1.0 \n          seconds\n        ------------------------------------------------------------\n        revno: 44.1.153.1.46\n        merged: sahlberg@ronnie-20070503223018-0799fc78283a686f\n        parent: sahlberg@ronnie-20070503071638-802462107800a0a8\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Fri 2007-05-04 08:30:18 +1000\n        message:\n          start working on a recovery daemon\n          \n          change ctdb_control so it takes a timeval pointer as argument.\n          this is the timeout. if the node has not responded within hte timeout\n          ctdb_control will return an error instead of hanging.\n          if the timeval pointer is NULL then the call will block indefinitely if \n          there is no response.\n          \n          this is used for now in the createdb control   but all the helpers \n          ctdb_ctrl_* should probably be updated to take a timeout parameter as \n          well.\n        ------------------------------------------------------------\n        revno: 44.1.153.1.45\n        merged: sahlberg@ronnie-20070503071638-802462107800a0a8\n        parent: sahlberg@ronnie-20070503061803-7e09396b07253194\n        parent: tridge@samba.org-20070503071223-l9hybdfd0lwdswu0\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 17:16:38 +1000\n        message:\n          merge from tridge\n        ------------------------------------------------------------\n        revno: 44.1.153.1.44\n        merged: sahlberg@ronnie-20070503061803-7e09396b07253194\n        parent: sahlberg@ronnie-20070503044253-a4389b52c03c42ba\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 16:18:03 +1000\n        message:\n          cleanup the control \"write record\"\n        ------------------------------------------------------------\n        revno: 44.1.153.1.43\n        merged: sahlberg@ronnie-20070503044253-a4389b52c03c42ba\n        parent: sahlberg@ronnie-20070503033038-5042e3eb473e382c\n        parent: tridge@samba.org-20070503035354-r8chwmgxqwl5o8fx\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 14:42:53 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.199\n    merged: tridge@samba.org-20070503071223-l9hybdfd0lwdswu0\n    parent: tridge@samba.org-20070503035354-r8chwmgxqwl5o8fx\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 17:12:23 +1000\n    message:\n      first version of traverse is working\n    ------------------------------------------------------------\n    revno: 44.1.198\n    merged: tridge@samba.org-20070503035354-r8chwmgxqwl5o8fx\n    parent: tridge@samba.org-20070503034427-cafju1wds7214w62\n    parent: sahlberg@ronnie-20070503033038-5042e3eb473e382c\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 13:53:54 +1000\n    message:\n      merged from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.42\n        merged: sahlberg@ronnie-20070503033038-5042e3eb473e382c\n        parent: sahlberg@ronnie-20070503030734-4752259c9631bf82\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 13:30:38 +1000\n        message:\n          cleanup getnodemap\n        ------------------------------------------------------------\n        revno: 44.1.153.1.41\n        merged: sahlberg@ronnie-20070503030734-4752259c9631bf82\n        parent: sahlberg@ronnie-20070503010624-725efe92ef4466ad\n        parent: tridge@samba.org-20070503011301-1nqmvtrhlnzcd6i7\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 13:07:34 +1000\n        message:\n          fixup getdbmap control so it looks a bit nicer\n    ------------------------------------------------------------\n    revno: 44.1.197\n    merged: tridge@samba.org-20070503034427-cafju1wds7214w62\n    parent: tridge@samba.org-20070503021603-p9q4auw135pzf905\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 13:44:27 +1000\n    message:\n      don't zero beyond packet header unnecessarily\n    ------------------------------------------------------------\n    revno: 44.1.196\n    merged: tridge@samba.org-20070503021603-p9q4auw135pzf905\n    parent: tridge@samba.org-20070503011301-1nqmvtrhlnzcd6i7\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 12:16:03 +1000\n    message:\n      first stage of efficient non-blocking ctdb traverse\n    ------------------------------------------------------------\n    revno: 44.1.195\n    merged: tridge@samba.org-20070503011301-1nqmvtrhlnzcd6i7\n    parent: tridge@samba.org-20070502214808-txyq9v6djt0tm7m4\n    parent: sahlberg@ronnie-20070503010624-725efe92ef4466ad\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 11:13:01 +1000\n    message:\n      merged cleanup from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.40\n        merged: sahlberg@ronnie-20070503010624-725efe92ef4466ad\n        parent: sahlberg@ronnie-20070502212129-ea81e17dee5122ae\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 11:06:24 +1000\n        message:\n          break set/get vnn map out from ctdb_control and put it in ctdb_recover.c \n          for the time being\n          \n          remove all the [de]marshalling and just pass a structure around instead\n    ------------------------------------------------------------\n    revno: 44.1.194\n    merged: tridge@samba.org-20070502214808-txyq9v6djt0tm7m4\n    parent: tridge@samba.org-20070502211929-dvwisi77qmhpxz7u\n    parent: sahlberg@ronnie-20070502212129-ea81e17dee5122ae\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 07:48:08 +1000\n    message:\n      merge from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.39\n        merged: sahlberg@ronnie-20070502212129-ea81e17dee5122ae\n        parent: sahlberg@ronnie-20070502195245-601cd27bc95d4712\n        parent: tridge@samba.org-20070502211929-dvwisi77qmhpxz7u\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 07:21:29 +1000\n        message:\n          merge from tridge\n        ------------------------------------------------------------\n        revno: 44.1.153.1.38\n        merged: sahlberg@ronnie-20070502195245-601cd27bc95d4712\n        parent: sahlberg@ronnie-20070502120048-4a6d39d2c036946a\n        parent: tridge@samba.org-20070502192114-f33n5eur6vzyi8xt\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Thu 2007-05-03 05:52:45 +1000\n        message:\n          merge from tridge\n    ------------------------------------------------------------\n    revno: 44.1.193\n    merged: tridge@samba.org-20070502211929-dvwisi77qmhpxz7u\n    parent: tridge@samba.org-20070502195146-3e77ekh35mpfa42k\n    parent: sahlberg@ronnie-20070502120048-4a6d39d2c036946a\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 07:19:29 +1000\n    message:\n      merge from ronnie\n        ------------------------------------------------------------\n        revno: 44.1.153.1.37\n        merged: sahlberg@ronnie-20070502120048-4a6d39d2c036946a\n        parent: sahlberg@ronnie-20070502113120-f18e1dc10a714c94\n        parent: tridge@samba.org-20070502051111-kol2q81ec0oz8o1k\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 22:00:48 +1000\n        message:\n          merge from tridge\n        ------------------------------------------------------------\n        revno: 44.1.153.1.36\n        merged: sahlberg@ronnie-20070502113120-f18e1dc10a714c94\n        parent: sahlberg@ronnie-20070502111437-97c77ad0177796e8\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 21:31:20 +1000\n        message:\n          do a real recovery by killing a node and then calling the recover \n          control\n        ------------------------------------------------------------\n        revno: 44.1.153.1.35\n        merged: sahlberg@ronnie-20070502111437-97c77ad0177796e8\n        parent: sahlberg@ronnie-20070502110002-20b32db806bab4f0\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 21:14:37 +1000\n        message:\n          recover.sh test script that build a few database and populates them with \n          a record  then performs a recovery which merges all records onto node 0\n        ------------------------------------------------------------\n        revno: 44.1.153.1.34\n        merged: sahlberg@ronnie-20070502110002-20b32db806bab4f0\n        parent: sahlberg@ronnie-20070502033142-06b6c60af183f6b9\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 21:00:02 +1000\n        message:\n          add a recover test   change alignment for the pull/push db structures\n        ------------------------------------------------------------\n        revno: 44.1.153.1.33\n        merged: sahlberg@ronnie-20070502033142-06b6c60af183f6b9\n        parent: sahlberg@ronnie-20070502031412-4c8d86f68d542932\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 13:31:42 +1000\n        message:\n          discard REQ/REPLY DMASTER when generation id is wrong or when in \n          recovery mode\n        ------------------------------------------------------------\n        revno: 44.1.153.1.32\n        merged: sahlberg@ronnie-20070502031412-4c8d86f68d542932\n        parent: sahlberg@ronnie-20070502024335-851a396c038c86a8\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 13:14:12 +1000\n        message:\n          remove sleep from the fetch test\n          \n          add a test script to start 4 daemons to test recovery\n        ------------------------------------------------------------\n        revno: 44.1.153.1.31\n        merged: sahlberg@ronnie-20070502024335-851a396c038c86a8\n        parent: sahlberg@ronnie-20070502010910-2b2c4f1db2b87767\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 12:43:35 +1000\n        message:\n          add a control to create a database\n        ------------------------------------------------------------\n        revno: 44.1.153.1.30\n        merged: sahlberg@ronnie-20070502010910-2b2c4f1db2b87767\n        parent: sahlberg@ronnie-20070502010658-31ae7f10fe7e85b2\n        committer: Ronnie Sahlberg \n        branch nick: ctdb\n        timestamp: Wed 2007-05-02 11:09:10 +1000\n        message:\n          remove test code in the fetch test to keep the daemons running forever \n          (so one has lots of tiume to play with ctdb_control)\n    ------------------------------------------------------------\n    revno: 44.1.192\n    merged: tridge@samba.org-20070502195146-3e77ekh35mpfa42k\n    parent: tridge@samba.org-20070502192114-f33n5eur6vzyi8xt\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 05:51:46 +1000\n    message:\n      fixed a memory leak in the ctdb_control code\n    ------------------------------------------------------------\n    revno: 44.1.191\n    merged: tridge@samba.org-20070502192114-f33n5eur6vzyi8xt\n    parent: tridge@samba.org-20070502051111-kol2q81ec0oz8o1k\n    committer: Andrew Tridgell \n    branch nick: tridge\n    timestamp: Thu 2007-05-03 05:21:14 +1000\n    message:\n      enabled built in popt if system doesn't have it\n\nDiff too large for email (6796, the limit is 1000).\n\n"}