{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 116: wait on the right fd .... in http://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 116\nrevision-id: tridge@samba.org-20070416141104-3c489b41c92932d3\nparent: tridge@samba.org-20070416135214-cb85876867405bbf\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Tue 2007-04-17 00:11:04 +1000\nmessage:\n  wait on the right fd ....\nmodified:\n  tests/lockwait.c               lockwait.c-20070416055753-3ztnb4cxqgamfudx-1\n=== modified file 'tests/lockwait.c'\n--- a/tests/lockwait.c\t2007-04-16 12:49:37 +0000\n+++ b/tests/lockwait.c\t2007-04-16 14:11:04 +0000\n@@ -41,6 +41,7 @@\n \t\t\t\t\t\t     struct lockwait_handle);\n \tvoid (*callback)(void *) = h->callback;\n \tvoid *p = h->private_data;\n+\tprintf(\"%s\\n\", __location__);\n \ttalloc_set_destructor(h, NULL);\n \tclose(h->fd[0]);\n \ttalloc_free(h);\t\n@@ -103,7 +104,7 @@\n \tclose(h->fd[1]);\n \ttalloc_set_destructor(h, lockwait_destructor);\n \n-\th->fde = event_add_fd(ev, h, fd, EVENT_FD_READ, lockwait_handler, h);\n+\th->fde = event_add_fd(ev, h, h->fd[0], EVENT_FD_READ, lockwait_handler, h);\n \tif (h->fde == NULL) {\n \t\ttalloc_free(h);\n \t\treturn NULL;\n\n"}