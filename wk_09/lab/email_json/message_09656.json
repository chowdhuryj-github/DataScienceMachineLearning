{"category": "ham", "to_address": "\"Deepankar Basu\" <basu.15@osu.edu>", "from_address": "\"Dimitris Rizopoulos\" <dimitris.rizopoulos@med.kuleuven.be>", "subject": "Re: [R] Problems in programming a simple likelihood", "body": "try the following:\n\nmlogl <- function (mu, y, X) {\n    zeta <- as.vector(X %*% mu)\n    y.logic <- as.logical(y)\n    lgLik <- numeric(length(y))\n    lgLik[y.logic] <- pnorm(zeta[y.logic], log.p = TRUE)\n    lgLik[!y.logic] <- pnorm(zeta[!y.logic], lower.tail = FALSE, log.p \n= TRUE)\n    -sum(lgLik)\n}\n\nwomen <- \nread.table(\"http://wps.aw.com/wps/media/objects/2228/2281678/Data_Sets/ASCII/Women13.txt\", \nheader=TRUE)\n\nmu.start <- c(0, -1.5, 0.01)\nout <- optim(mu.start, mlogl, method = \"BFGS\", y = women$J, X = \ncbind(1, women$M, women$S))\nout\n\nglm.fit(x = cbind(1, women$M, women$S), y = women$J, family = \nbinomial(link = \"probit\"))$coefficients\n\n\nI hope it helps.\n\nBest,\nDimitris\n\n----\nDimitris Rizopoulos\nPh.D. Student\nBiostatistical Centre\nSchool of Public Health\nCatholic University of Leuven\n\nAddress: Kapucijnenvoer 35, Leuven, Belgium\nTel: +32/(0)16/336899\nFax: +32/(0)16/337015\nWeb: http://med.kuleuven.be/biostat/\n     http://www.student.kuleuven.be/~m0390867/dimitris.htm\n\n\n----- Original Message ----- \nFrom: \"Deepankar Basu\" \nTo: \nSent: Thursday, April 19, 2007 12:38 AM\nSubject: [R] Problems in programming a simple likelihood\n\n\n> As part of carrying out a complicated maximum likelihood estimation, \n> I\n> am trying to learn to program likelihoods in R. I started with a \n> simple\n> probit model but am unable to get the code to work. Any help or\n> suggestions are most welcome. I give my code below:\n>\n> ************************************\n> mlogl <- function(mu, y, X) {\n> n <- nrow(X)\n> zeta <- X%*%mu\n> llik <- 0\n> for (i in 1:n) {\n>  if (y[i]==1)\n>   llik <- llik + log(pnorm(zeta[i,], mean=0, sd=1))\n>  else\n>   llik <- llik + log(1-pnorm(zeta[i,], mean=0, sd=1))\n>    }\n> return(-llik)\n> }\n>\n> women <- read.table(\"~/R/Examples/Women13.txt\", header=TRUE)  # DATA\n>\n> # THE DATA SET CAN BE ACCESSED HERE\n> # women <-\n> read.table(\"http://wps.aw.com/wps/media/objects/2228/2281678/Data_Sets/ASCII/Women13.txt\", \n> header=TRUE)\n> # I HAVE CHANGED THE NAMES OF THE VARIABLES\n> # J is changed to \"work\"\n> # M is changed to \"mar\"\n> # S is changed to \"school\"\n>\n> attach(women)\n>\n> # THE VARIABLES OF USE ARE\n> #   work: binary dependent variable\n> #   mar: whether married or not\n> #   school: years of schooling\n>\n> mu.start <- c(3, -1.5, 10)\n> data <- cbind(1, mar, school)\n> out <- nlm(mlogl, mu.start, y=work, X=data)\n> cat(\"Results\", \"\\n\")\n> out$estimate\n>\n> detach(women)\n>\n> *************************************\n>\n> When I try to run the code, this is what I get:\n>\n>> source(\"probit.R\")\n> Results\n> Warning messages:\n> 1: NA/Inf replaced by maximum positive value\n> 2: NA/Inf replaced by maximum positive value\n> 3: NA/Inf replaced by maximum positive value\n> 4: NA/Inf replaced by maximum positive value\n>\n> Thanks in advance.\n> Deepankar\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide \n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n> \n\n\nDisclaimer: http://www.kuleuven.be/cwis/email_disclaimer.htm\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}