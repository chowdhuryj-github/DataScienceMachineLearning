{"category": "ham", "to_address": "beginners@perl.org", "from_address": "Jeremy Kister <perl-04@jeremykister.com>", "subject": "Net::BGP advise", "body": "I sent [most of] the below message to Net::BGP's author a small while\nago and haven't yet heard back.  I'm hoping someone on the list can help.\n\nI'm trying to use Net::BGP to inject a /32 into my iBGP.\n\nWhat is the proper way to send a $peer->update?\n\nIf I do:\n\nmy $bgp = new Net::BGP::Process();\nmy $peer = new Net::BGP::Peer(\n   Start =>  1,\n   ThisID => '10.115.0.126',\n   ThisAS => 65535,\n   PeerID => '10.115.5.52',\n   PeerAS => 65535,\n   );\n\n$bgp->add_peer($peer);\n\nmy $update = new Net::BGP::Update (\n   NLRI       => [ qw| 10.232.210.15/32 | ],\n   Aggregator => [ 65535, '10.115.0.126' ],\n   AtomicAggregate => 1,\n   LocalPref  => 100,\n   MED        => 200,\n   NextHop    => '10.115.0.126',\n   Origin     => INCOMPLETE,\n   );\n\n$peer->update($update);\n$bgp->event_loop;\n__END__\n\nThen the bgp session establishes, but the /32 is not injected.\n\nIf put\n $peer->add_timer(\\&foo, 20);\nright before $bgp->event_loop, and put $peer->update inside sub foo,\nthen the injection works, but I resend the update every x seconds.\n\nI'm sure I'm just using the code incorrectly, but can't figure the\nright way to do it.\n\nThanks!\n\n-- \n\nJeremy Kister\nhttp://jeremy.kister.net./\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}