{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jerry@samba.org", "subject": "svn commit: samba r22447 - in branches: SAMBA_3_0/source/nsswitch\n\tSAMBA_3_0_25/source/nsswitch", "body": "Author: jerry\nDate: 2007-04-22 10:09:41 +0000 (Sun, 22 Apr 2007)\nNew Revision: 22447\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22447\n\nLog:\nPatch from Ying Li  to default tdb idmap \nplugin when neither idmap domains nor idmap backend have \nbeen defined.\n\n\n\nModified:\n   branches/SAMBA_3_0/source/nsswitch/idmap.c\n   branches/SAMBA_3_0_25/source/nsswitch/idmap.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/nsswitch/idmap.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/idmap.c\t2007-04-22 09:42:43 UTC (rev 22446)\n+++ branches/SAMBA_3_0/source/nsswitch/idmap.c\t2007-04-22 10:09:41 UTC (rev 22447)\n@@ -322,8 +322,16 @@\n \t\t\t*p = '\\0';\t\t\t\n \t\t\tcompat_params = p + 1;\n \t\t}\n+\t} else {\n+\t\t/* Back compatible: without idmap domains and explicit\n+\t\t   idmap backend.  Taking default idmap backend: tdb */\n+\t\t\n+\t\tcompat = 1;\n+\t\tcompat_backend = talloc_strdup( idmap_ctx, \"tdb\");\n+\t\tcompat_params = compat_backend;\n \t}\n \n+\n \tif ( ! dom_list) {\n \t\tdom_list = idmap_default_domain;\n \t}\n\nModified: branches/SAMBA_3_0_25/source/nsswitch/idmap.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/nsswitch/idmap.c\t2007-04-22 09:42:43 UTC (rev 22446)\n+++ branches/SAMBA_3_0_25/source/nsswitch/idmap.c\t2007-04-22 10:09:41 UTC (rev 22447)\n@@ -322,8 +322,16 @@\n \t\t\t*p = '\\0';\t\t\t\n \t\t\tcompat_params = p + 1;\n \t\t}\n+\t} else {\n+\t\t/* Back compatible: without idmap domains and explicit\n+\t\t   idmap backend.  Taking default idmap backend: tdb */\n+\t\t\n+\t\tcompat = 1;\n+\t\tcompat_backend = talloc_strdup( idmap_ctx, \"tdb\");\n+\t\tcompat_params = compat_backend;\n \t}\n \n+\n \tif ( ! dom_list) {\n \t\tdom_list = idmap_default_domain;\n \t}\n\n"}