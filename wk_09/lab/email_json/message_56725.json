{"category": "ham", "to_address": "beginners perl <beginners@perl.org>", "from_address": "Andrej Kastrin <andrej.kastrin@siol.net>", "subject": "DBI, postgresql and large table", "body": "Dear all,\n\nI need to process postgresql table with DBI module. The script below \nworks well for small tables, but when I want to process larger tables \n(100000 rows) out-of-memory occurs.\n\nAny suggestion? Thanks in advance,\nAndrej\n\nuse strict;\nuse warnings;\nuse DBI;\n\nmy $dbh = DBI->connect(\"DBI:Pg:dbname=medline;host=localhost\", \n\"postgres\", \"secret\", {'RaiseError' => 1});\nmy $sth = $dbh->prepare(\"SELECT text_a, text_b FROM tmp_table\");\n$sth->execute();\n\nwhile (my $ref = $sth->fetchrow_hashref()) {\n    my $field_a = $ref->{'text_a'};\n    my $field_b = $ref->{'text_b'};\n    print \"$field_a \\t $field_b\\n\";\n}\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}