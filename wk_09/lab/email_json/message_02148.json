{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "abartlet@samba.org", "subject": "svn commit: samba r22160 - in\n\tbranches/SAMBA_4_0/source/script/tests: .", "body": "Author: abartlet\nDate: 2007-04-11 01:32:38 +0000 (Wed, 11 Apr 2007)\nNew Revision: 22160\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22160\n\nLog:\nOnly use test environment names that actually exist (get make\nquicktest to pass).\n\nEnsure that when we fail on the build farm, this ends up in the total\nfailures.\n\nI think having the 2 different functions for running the tests is just\nasking for this kind of failure.  The build farm should be a\npresentation detail, and not alter the test behaviour.\n\nThere is still a gremlin in there, we will fail horribly on the farm,\nbut not on local tests...\n\nAndrew Bartlett\n\nModified:\n   branches/SAMBA_4_0/source/script/tests/selftest.pl\n   branches/SAMBA_4_0/source/script/tests/test_quick.sh\n   branches/SAMBA_4_0/source/script/tests/test_rpc_quick.sh\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/script/tests/selftest.pl\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/selftest.pl\t2007-04-10 22:59:42 UTC (rev 22159)\n+++ branches/SAMBA_4_0/source/script/tests/selftest.pl\t2007-04-11 01:32:38 UTC (rev 22160)\n@@ -223,6 +223,7 @@\n \tif ($ret == $expected_ret) {\n \t\tprint \"TEST PASSED: $name\\n\";\n \t} else {\n+\t\tpush(@$suitesfailed, $name);\n \t\tprint \"TEST FAILED: $name (status $ret)\\n\";\n \t}\n \tprint \"==========================================\\n\";\n\nModified: branches/SAMBA_4_0/source/script/tests/test_quick.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/test_quick.sh\t2007-04-10 22:59:42 UTC (rev 22159)\n+++ branches/SAMBA_4_0/source/script/tests/test_quick.sh\t2007-04-11 01:32:38 UTC (rev 22160)\n@@ -15,5 +15,5 @@\n \n for t in $tests; do\n     name=\"$t\"\n-    plantest \"$name\" base $VALGRIND bin/smbtorture $TORTURE_OPTIONS $ADDARGS //\\$SERVER/cifs -U\"\\$USERNAME\"%\"\\$PASSWORD\" $t\n+    plantest \"$name\" dc $VALGRIND bin/smbtorture $TORTURE_OPTIONS $ADDARGS //\\$SERVER/cifs -U\"\\$USERNAME\"%\"\\$PASSWORD\" $t\n done\n\nModified: branches/SAMBA_4_0/source/script/tests/test_rpc_quick.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/test_rpc_quick.sh\t2007-04-10 22:59:42 UTC (rev 22159)\n+++ branches/SAMBA_4_0/source/script/tests/test_rpc_quick.sh\t2007-04-11 01:32:38 UTC (rev 22160)\n@@ -18,7 +18,7 @@\n    esac\n    for t in $tests; do\n     name=\"$t on $transport with $bindoptions\"\n-    plantest \"$name\" rpc $VALGRIND bin/smbtorture $TORTURE_OPTIONS $transport:\"\\$SERVER[$bindoptions]\" -U\"\\$USERNAME\"%\"\\$PASSWORD\" -W \\$DOMAIN $t \"$*\"\n+    plantest \"$name\" dc $VALGRIND bin/smbtorture $TORTURE_OPTIONS $transport:\"\\$SERVER[$bindoptions]\" -U\"\\$USERNAME\"%\"\\$PASSWORD\" -W \\$DOMAIN $t \"$*\"\n    done\n  done\n done\n\n"}