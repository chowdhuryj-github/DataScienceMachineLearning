{"category": "ham", "to_address": "Brian Wilfley <bwilfley@tripleringtech.com>", "from_address": "Sundar Dorai-Raj <sundar.dorai-raj@pdf.com>", "subject": "Re: [R] abline plots at wrong abscissae after boxplot", "body": "\n\nBrian Wilfley said the following on 6/21/2007 2:44 PM:\n> Hi folks,\n> \n> I'm using R 2.5.0 under ESS under Windows XP. (This also happens using\n> the Rgui application.)\n> \n> I'm trying to add lines to a plot originally made with \"boxplot\", but\n> the lines appear in the wrong place. Below is a script that\n> illustrates the problem\n> \n> # boxablinetest.R - script to show problem with abline on box plot\n> \n> x <-  c(  2,  2,  2,  3,  3,  3,  4,  4,  4)\n> y <-  c(  1,  2,  3,  2,  3,  4,  3,  4,  5)\n> \n> xymodel <- lm( y~x)\n> \n> boxplot( y~x)\n> abline( xymodel)                        # Wrong abcissae\n> abline( v = 2.5)                        # Wrong abcissa\n> abline( h = 2.75)                       # Right ordinate\n> \n> # -------------- end --------------\n> \n> Here, I'm making a box plot with abscissae that start at 2. The box\n> plot looks fine: the numbers 2, 3, and 4 appear on the x-axis and the\n> boxes are centered at 2, 3, and 4.\n> \n> When I add the first abline, the line appears too low, but actually it\n> is too far to the right. The abscissae are being interpreted without\n> realizing that the plot originates at 2, not 1.\n> \n> The second call to abline should put a vertical line between 2 and 3,\n> but instead it shows up between 3 and 4. Again, it appears that the\n> offset in the origin of the boxplot is not accounted for.\n> \n> Finally the last abline appears where it should: between 2 and 3.\n> Evidently, ordinate values are correctly interpreted.\n> \n> Does anyone have any advice?\n> \n> Thanks very much.\n> \n> Brian Wilfley\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n\nThat's because the x is converted to a factor (see ?boxplot). Here's \nwhat you want:\n\n## changesd x==3 to 6 to demonstrate call to boxplot below\nx <- c(2, 2, 2, 3, 3, 3, 6, 6, 6)\ny <- c(1, 2, 3, 2, 3, 4, 3, 4, 5)\n\nxymodel <- lm(y ~ x)\n\nboxplot(y ~ x) ## note x-labels!\n\n## now fix your problem\nplot(y ~ x, type = \"n\", xlim = c(1, 7))\nbxp(boxplot(y ~ x, plot = FALSE), at = c(2, 3, 6),\n     add = TRUE, boxwex = 0.5, boxfill = \"lightblue\")\nabline(xymodel)\nabline(v = 2.5)\nabline(h = 2.75)\n\nHTH,\n\n--sundar\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}