{"category": "ham", "to_address": "\"Murali Menon\" <feanor0@hotmail.com>", "from_address": "\"Andrew Robinson\" <A.Robinson@ms.unimelb.edu.au>", "subject": "Re: [R] Jarque-Bera and rnorm()", "body": "\nOn Fri, April 27, 2007 7:02 pm, Murali Menon wrote:\n> Folks,\n>\n> I'm a bit puzzled by the fact that if I generate 100,000 standard normal\n> variates using rnorm() and perform the Jarque-Bera on the resulting\n> vector,\n> I get p-values that vary drastically from run to run. Is this expected?\n> Surely the p-val should be close to 1 for each test?\n\nNo.  Under the null hypothesis, the p-value is a uniformly-distributed\nrandom variable, with range 0 to 1.\n\nCheers,\n\nAndrew\n\n\n\n> Are 100,000 variates sufficient for this test?\n>\n> Or is it that rnorm() is not a robust random number generator? I looked at\n> the skewness and excess kurtosis, and the former seems to be unstable,\n> which\n> leads me to think that is why JB is failing.\n>\n> Here are my outputs from successive runs of rjb.test (the robust Jarque\n> Bera\n> from the lawstat package).\n>\n>\n>>set.seed(100)\n>\n>>y <- rnorm(100000);rjb.test(y);skewness(y)[1];kurtosis(y)[1]\n>\n>         Robust Jarque Bera Test\n>\n> data:  y\n> X-squared = 1.753, df = 2, p-value = 0.4162\n>\n> [1] -0.01025744\n> [1] 0.0008213325\n>\n>>y <- rnorm(100000);rjb.test(y);skewness(y)[1];kurtosis(y)[1]\n>\n>         Robust Jarque Bera Test\n>\n> data:  y\n> X-squared = 0.1359, df = 2, p-value = 0.9343\n>\n> [1] -0.001833042\n> [1] -0.002603599\n>\n>>y <- rnorm(100000);rjb.test(y);skewness(y)[1];kurtosis(y)[1]\n>\n>         Robust Jarque Bera Test\n>\n> data:  y\n> X-squared = 4.6438, df = 2, p-value = 0.09809\n>\n> [1] -0.01620776\n> [1] -0.005762349\n>\n>\n> Please advise. Thanks,\n>\n> Murali\n>\n> _________________________________________________________________\n> MSN is giving away a trip to Vegas to see Elton John.  Enter to win today.\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n\nAndrew Robinson\nSenior Lecturer in Statistics                       Tel: +61-3-8344-9763\nDepartment of Mathematics and Statistics            Fax: +61-3-8344 4599\nUniversity of Melbourne, VIC 3010 Australia\nEmail: a.robinson@ms.unimelb.edu.au    Website: http://www.ms.unimelb.edu.au\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}