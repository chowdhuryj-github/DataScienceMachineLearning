{"category": "ham", "to_address": "\"Martin Barth\" <martin@senfdax.de>, \"Perl List\" <beginners@perl.org>", "from_address": "\"Jay Savage\" <daggerquill@gmail.com>", "subject": "Re: bug in perl or in my head ;-)", "body": "On 6/18/07, Martin Barth  wrote:> Hi there,> have a look at:>> > % cat datei> eine test datei> die \"u \"a \"o> % file datei> datei: ASCII text> % cp datei datei.bk> % perl -wpi -e 'use encoding \"utf8\"; s/\"a/\u00e4/' datei> % file datei> datei: ISO-8859 text> % perl -wp -e 'use encoding \"utf8\"; s/\"a/\u00e4/' datei.bk > datei.neu> % file datei.neu> datei.neu: UTF-8 Unicode text> >> I'm a bit confused. Both files should be utf8??> ( my xterm is utf8 )>> Regards> Martin>\nMartin,\nYou haven't told us what Perl thinks the encoding of the first fileis. file is a system command that makes use of number of differentapproaches to determine file type including, on some systems, I thinkit even makes use of metadata. Actually examining the data in the fileis time-consuming, and therefore a method of last resort, employedonly when some other context doesn't match. It also returns the firstmatch, not all matches.\nSince the -i switch is processed prior to any data being written, it'sentirely possible that file's view of the file doesn't match theactually encoding of the stream being written. Read some data into aPerl script and see what Perl thinks it is. My guess is that the datais actually utf-8, but file mistakenly assumes it's in the defaultlocal encoding for some reason.\nAt the command line, you can use the -C switch to avoid confusion.\nBest,\n-- jay--------------------------------------------------This email and attachment(s): [  ] blogable; [ x ] ask first; [  ]private and confidential\ndaggerquill [at] gmail [dot] comhttp://www.tuaw.com  http://www.downloadsquad.com  http://www.engatiki.org\nvalues of \\u03b2 will give rise to dom!\n\n"}