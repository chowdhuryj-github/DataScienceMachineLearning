{"category": "ham", "to_address": "chromatic via RT <parrotbug-followup@parrotcode.org>", "from_address": "Andy Spieherty <spiehera@lafayette.edu>", "subject": "Re: [perl #42616] Parrot won't build with perl-5.6.", "body": "On Thu, 19 Apr 2007, chromatic via RT wrote:\n\n> On Thursday 19 April 2007 11:24, Andy Spieherty wrote:\n> \n> > But if you actually try it with perl-5.6.2, the build proceeds for a\n> > while and then dies with\n> >\n> >     perl5.6 tools/build/pmc2c.pl --vtable\n> >     \"longmess\" is not exported by the Carp module at\n> > /home/spiehera/src/parrot/parrot-andy/tools/build/../../lib/Parrot/Pmc2c/PC\n> >CMETHOD.pm line 8\n> \n> > What is the actual intent?  Requiring builders to run at least perl-5.8\n> > does not seem unreasonable to me, but neither would requiring\n> > developers to stick with perl-5.6 seem unreasonable.  Parrot should,\n> > however, be consistent.\n> \n> It looks like we could replace that longmess call in the WARN handler with \n> Carp::cluck() instead without changing the intent.\n\nI had already tried that and immediately ran into a bunch of other\nlittle things.  Before diving in (or encouraging others to dive in) I\nthought it prudent to ask the more general question.\n\nBut, since you ask, on to details:\n\nFixing lib/Parrot/Pmc2c/PCCMETHOD.pm, the next relevant message I see is\n(I have folded the long lines)\n\n    perl5.6 tools/build/ops2pm.pl src/ops/core.ops src/ops/bit.ops\n    src/ops/cmp.ops src/ops/debug.ops src/ops/experimental.ops\n    src/ops/io.ops src/ops/math.ops src/ops/object.ops src/ops/pic.ops\n    src/ops/pmc.ops src/ops/set.ops src/ops/stack.ops src/ops/stm.ops\n    src/ops/string.ops src/ops/sys.ops src/ops/var.ops\n\n    Bareword found where operator expected at lib/Parrot/Ops2pm/Utils.pm\n    line 536, near \"$MODULE Data::Dumper\"\n\t    (Missing operator before Data::Dumper?)\n\nNaturally, the resulting lib/Parrot/OpLib/core.pm file is not correct.\nA diff between core.pm and and one generated by perl-5.8 runs to\nover 40,000 lines.  Yet, amazingly, the build continued!  Somehow the\ntools/build/ops2pm.pl script still managed to return a successful status.\n\nIgnoring that problem for the moment, the next problem shows up with\npmc2c.pl:\n\n    perl5.6 tools/build/pmc2c.pl --vtable\n    Global symbol \"%decl\" requires explicit package name at /home/spiehera/src/parrot/parrot-perl5.6/tools/build/../../lib/Parrot/Pmc2c/delegate.pm line 99.\n    Compilation failed in require at /home/spiehera/src/parrot/parrot-perl5.6/tools/build/../../lib/Parrot/Pmc2c.pm line 1220.\n    Compilation failed in require at /home/spiehera/src/parrot/parrot-perl5.6/tools/build/../../lib/Parrot/Pmc2c/Library.pm line 29.\n    BEGIN failed--compilation aborted at /home/spiehera/src/parrot/parrot-perl5.6/tools/build/../../lib/Parrot/Pmc2c/Library.pm line 29.\n    Compilation failed in require at /home/spiehera/src/parrot/parrot-perl5.6/tools/build/../../lib/Parrot/Pmc2c/Utils.pm line 9.\n    BEGIN failed--compilation aborted at /home/spiehera/src/parrot/parrot-perl5.6/tools/build/../../lib/Parrot/Pmc2c/Utils.pm line 9.\n    Compilation failed in require at tools/build/pmc2c.pl line 12.\n    BEGIN failed--compilation aborted at tools/build/pmc2c.pl line 12.\n\npmc2c.pl --dump fails with the same error message.\n\nWorking around those problems by building those files with perl-5.8, the\nnext problem is with the 3-arg open() in lib/Test/Builder.pm:\n\nt/configure/01-options...................Unknown open() mode '>&' at\n/home/spiehera/src/parrot/parrot-perl5.6/t/configure/../../lib/Test/Builder.pm\nline 1217.\nCompilation failed in require at\n/home/spiehera/src/parrot/parrot-perl5.6/t/configure/../../lib/Test/More.pm\nline 6.\nBEGIN failed--compilation aborted at\n/home/spiehera/src/parrot/parrot-perl5.6/t/configure/../../lib/Test/More.pm\nline 6.\nCompilation failed in require at t/configure/01-options.t line 15.\nBEGIN failed--compilation aborted at t/configure/01-options.t line 15.\nt/configure/01-options...................dubious                             \n        Test returned status 255 (wstat 65280, 0xff00)\n\nAt this point, I stopped.\n\nExecutive summary:  There are a lot of little things.  Each one is\nprobably fixable without too much effort, but it's not worth the effort\nunless someone else cares enough to routinely test with perl-5.6.\n\nOtherwise, the requirements (in README and Configure.pl) should simply be \nchanged to perl-5.8.whatever.\n\nI'll be happy to help anyone who wants help getting perl-5.6 installed.\n\n-- \n    Andy Spieherty\t\tspiehera@lafayette.edu\n\n"}