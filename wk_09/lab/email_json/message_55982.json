{"category": "ham", "to_address": "<Marc.Zodet@ahrq.hhs.gov>, <r-help@stat.math.ethz.ch>", "from_address": "<Bill.Venables@csiro.au>", "subject": "Re: [R] Subscripting specified variables in a function", "body": "I think what you are trying to do is quite tricky.  Here is one way you\nmight like to think about.\n\n> tdat <- data.frame(a = 1:5, b = c(1:3, 101,101))\n> tdat\n  a   b\n1 1   1\n2 2   2\n3 3   3\n4 4 101\n5 5 101\n> test.fx <- function(dta, expvar, expval) {\n  lang <- substitute(subset(dat, v1 > v2),\n  \tlist(dat = substitute(dta), \n\t\tv1 = substitute(expvar), \n\t\tv2 = substitute(expval)))\n  newdta <- eval.parent(lang)\n  summary(newdta[deparse(substitute(expvar))])\n }\n> test.fx(tdat, b, 100)\n       b      \n Min.   :101  \n 1st Qu.:101  \n Median :101  \n Mean   :101  \n 3rd Qu.:101  \n Max.   :101  \n> test.fx(tdat, b, 2)\n       b         \n Min.   :  3.00  \n 1st Qu.: 52.00  \n Median :101.00  \n Mean   : 68.33  \n 3rd Qu.:101.00  \n Max.   :101.00  \n>  \n\n\nBill Venables\nCSIRO Laboratories\nPO Box 120, Cleveland, 4163\nAUSTRALIA\nOffice Phone (email preferred): +61 7 3826 7251\nFax (if absolutely necessary):  +61 7 3826 7304\nMobile:                         +61 4 8819 4402\nHome Phone:                     +61 7 3286 7700\nmailto:Bill.Venables@csiro.au\nhttp://www.cmis.csiro.au/bill.venables/ \n\n-----Original Message-----\nFrom: r-help-bounces@stat.math.ethz.ch\n[mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Zodet, Marc W.\n(AHRQ)\nSent: Wednesday, 27 June 2007 12:43 AM\nTo: r-help@stat.math.ethz.ch\nSubject: [R] Subscripting specified variables in a function\n\nI'm trying to create a function which will allow me to subset a data set\nbased on values of various specified variables.  I also want to then\napply some other function(s) (e.g., summary).\n\n \n\nThis is what I've tried so far....\n\n \n\n> test.fx <- function(dta, expvar, expval) {\n\n+ newdta <- subset(dta, eval(expvar)>expval)\n\n+ summary(newdta$eval(expvar))\n\n+ }\n\n> \n\n> test.fx(fyc04s, quote(totexp04), 100)\n\nError in summary(newdta$eval(expvar)) : attempt to apply non-function\n\n> \n\n \n\nThe subset works fine, but the my attempt to access the specified\nvariable bombs.  \n\n \n\nIs there a syntactical change I can make?\n\nIs it better to attach newdta?\n\n \n\nThanks in advance for any guidance.\n\n \n\nMarc\n\n \n\nMarc W. Zodet, MS                           \n\nSenior Health Statistician\n\nAgency for Healthcare Research and Quality\n\nCenter for Financing, Access, and Cost Trends\n\n301-427-1563 (Telephone)\n\n301-427-1276 (Fax)\n\nmarc.zodet@ahrq.hhs.gov\n\n \n\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide\nhttp://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}