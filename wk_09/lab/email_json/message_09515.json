{"category": "ham", "to_address": "\"Deepankar Basu\" <basu.15@osu.edu>", "from_address": "\"Stephen Weigand\" <weigand.stephen@gmail.com>", "subject": "Re: [R] Problems in programming a simple likelihood", "body": "Deepankar,\n\nSome general advice from a non-expert:\n\nWrite your likelihoods without a for loop. This is important because\nthe likelihood is evaluated multiple times in the maximization process\nand you don't want to be looping looping looping ...\n\nAlways try multiple starting values\n\nSometimes it helps to try different optimization functions (e.g., optim)\n\nMake sure your likelihood is correct. Check it against existing\nsoftware if possible\n\nIf necessary, simplify your model, to a single parameter even, and\nbuild it up from there\n\nGenerate data under the model and see if your estimates are getting\nclose to the truth\n\nGood luck,\nStephen\nRochester, Minn. USA\n\nOn 4/18/07, Deepankar Basu  wrote:\n> As part of carrying out a complicated maximum likelihood estimation, I\n> am trying to learn to program likelihoods in R. I started with a simple\n> probit model but am unable to get the code to work. Any help or\n> suggestions are most welcome. I give my code below:\n>\n> ************************************\n> mlogl <- function(mu, y, X) {\n> n <- nrow(X)\n> zeta <- X%*%mu\n> llik <- 0\n> for (i in 1:n) {\n>   if (y[i]==1)\n>    llik <- llik + log(pnorm(zeta[i,], mean=0, sd=1))\n>   else\n>    llik <- llik + log(1-pnorm(zeta[i,], mean=0, sd=1))\n>     }\n> return(-llik)\n> }\n>\n> women <- read.table(\"~/R/Examples/Women13.txt\", header=TRUE)  # DATA\n>\n> # THE DATA SET CAN BE ACCESSED HERE\n> # women <-\n> read.table(\"http://wps.aw.com/wps/media/objects/2228/2281678/Data_Sets/ASCII/Women13.txt\", header=TRUE)\n> # I HAVE CHANGED THE NAMES OF THE VARIABLES\n> # J is changed to \"work\"\n> # M is changed to \"mar\"\n> # S is changed to \"school\"\n>\n> attach(women)\n>\n> # THE VARIABLES OF USE ARE\n> #   work: binary dependent variable\n> #   mar: whether married or not\n> #   school: years of schooling\n>\n> mu.start <- c(3, -1.5, 10)\n> data <- cbind(1, mar, school)\n> out <- nlm(mlogl, mu.start, y=work, X=data)\n> cat(\"Results\", \"\\n\")\n> out$estimate\n>\n> detach(women)\n>\n> *************************************\n>\n> When I try to run the code, this is what I get:\n>\n> > source(\"probit.R\")\n> Results\n> Warning messages:\n> 1: NA/Inf replaced by maximum positive value\n> 2: NA/Inf replaced by maximum positive value\n> 3: NA/Inf replaced by maximum positive value\n> 4: NA/Inf replaced by maximum positive value\n>\n> Thanks in advance.\n> Deepankar\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}