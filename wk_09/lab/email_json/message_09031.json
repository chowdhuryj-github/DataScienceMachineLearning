{"category": "ham", "to_address": "\"Schmitt, Corinna\" <Corinna.Schmitt@igb.fraunhofer.de>,\n   <r-help@stat.math.ethz.ch>", "from_address": "\"Alberto Monteiro\" <albmont@centroin.com.br>", "subject": "Re: [R] importing excel-file", "body": "Corinna Schmitt wrote:\n> \n> It is a quite stupid question but please help me. I am very \n> confuced. I am able to import normal txt ant mat-files to R but \n> unable to import .xls-file\n> \nI've tried two ways to import excel files, but none of them\nseems perfect.\n\nMethod 1:\nThis method uses library RODBC. The way to import excel files is this:\n\n  channel <- odbcConnectExcel(\"myfile.xls\")\n  tables <- sqlTables(channel)  # list the names of the spreadsheets\n  name1 <- tables[1, \"TABLE_NAME\"]  # get the name of the 1st spreadsheet\n\n  plan1 <- sqlFetch(channel, name1)  # this _should_ work, but it doesn't\n# The reason is that somehow the names of the sheets are altered\n\n  plan1 <- sqlFetch(channel, \"sheet name\") # this works \n# but you must type the exact name of the sheet\n\n# the next line works, no matter what is name1 (taken from tables)\n  plan1 <- sqlQuery(channel, sprintf(\"select * from [%s]\", name1))\n\n  odbcClose(channel)  # close it\n\nThis is not perfect. Some (most?) of the numerical fields in the \nspreadsheet are translated to NA and become meaningless.\n\nMethod 2:\nThis method uses library xlsReadWrite. You must know the index\nof the spreadsheet that you want to load:\n\nplan6 <- read.xls(filename, sheet = 6, colClasses=\"double\")\n\nThis works in most cases.\n\n> I do not understand the online help. Can please anyone send me the\n> corresponding command lines?\n>\nhelp(help) # :-)\n\n> The .xls-file is attached.\n>\nNo, it's not.\n\n> In my file we use commas for the decimal format (example: 0,712),\n> changes might be needed.\n> \nI *think* this is an internal flag. If the numbers are numbers, then\nthis should be no problem. An excel spreadsheet in any language is\nportable to other languages, even when the evil geniuses of M$ \ndecided to localize function names so that, in Portuguese, we have\nSENO instead of SIN and RAIZ instead of SQRT.\n\nAlberto Monteiro\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}