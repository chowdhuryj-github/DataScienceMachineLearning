{"category": "ham", "to_address": "Andrew Bartlett <abartlet@samba.org>", "from_address": "\"Henry B. Hotz\" <hotz@jpl.nasa.gov>", "subject": "Re: Does PAC Validation Require External Communication?", "body": "\nOn May 14, 2007, at 3:26 PM, Andrew Bartlett wrote:\n\n> On Mon, 2007-05-14 at 15:21 -0700, Henry B. Hotz wrote:\n>> As I understand it, if you have access to the server's keytab, then\n>> in principle you can forge credentials for anyone, including non-\n>> existent users (but only for that server).  What you suggest would\n>> prevent someone faking the PAC data in a credential, and from\n>> inventing a fake user, but they could still fake the credential.\n>>\n>> In other words it wouldn't stop John Jones from presenting a fake\n>> credential for Sam Smith that just happened to include the real PAC\n>> data that Sam would have had if it were really Sam.\n>\n> The PAC includes another signature, with the KDC's private key.  This\n> signature can validate that the service didn't fake a user to itself.\n\nOK, good!\n\n> Of course, if you hold the keytab for the machine account, you could\n> also fake the signed and encrypted communication with the KDC to\n> validate the PAC...\n\n. . . but not perfect.  Still spoofing another live service is  \nanother barrier to an exploit.\n\n"}