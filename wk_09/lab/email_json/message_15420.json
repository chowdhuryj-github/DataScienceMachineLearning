{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22515 - in branches/SAMBA_4_0/source/librpc/rpc:\n\t.", "body": "Author: metze\nDate: 2007-04-25 12:36:12 +0000 (Wed, 25 Apr 2007)\nNew Revision: 22515\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22515\n\nLog:\nonly steal pipe on success\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/librpc/rpc/dcerpc_connect.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/librpc/rpc/dcerpc_connect.c\n===================================================================\n--- branches/SAMBA_4_0/source/librpc/rpc/dcerpc_connect.c\t2007-04-25 12:30:25 UTC (rev 22514)\n+++ branches/SAMBA_4_0/source/librpc/rpc/dcerpc_connect.c\t2007-04-25 12:36:12 UTC (rev 22515)\n@@ -889,9 +889,10 @@\n \tstruct pipe_conn_state *s;\n \n \tstatus = composite_wait(c);\n-\ts = talloc_get_type(c->private_data, struct pipe_conn_state);\n-\t*pp = talloc_steal(mem_ctx, s->pipe);\n-\n+\tif (NT_STATUS_IS_OK(status)) {\n+\t\ts = talloc_get_type(c->private_data, struct pipe_conn_state);\n+\t\t*pp = talloc_steal(mem_ctx, s->pipe);\n+\t}\n \ttalloc_free(c);\n \treturn status;\n }\n\n"}