{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "mimir@samba.org", "subject": "svn commit: samba r22811 - in branches/SAMBA_4_0/source/libnet: .", "body": "Author: mimir\nDate: 2007-05-11 21:51:53 +0000 (Fri, 11 May 2007)\nNew Revision: 22811\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22811\n\nLog:\ntwo more memory allocation checks.\n\n\nrafal\n\n\nModified:\n   branches/SAMBA_4_0/source/libnet/libnet_lookup.c\n   branches/SAMBA_4_0/source/libnet/userinfo.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/libnet/libnet_lookup.c\n===================================================================\n--- branches/SAMBA_4_0/source/libnet/libnet_lookup.c\t2007-05-11 21:48:29 UTC (rev 22810)\n+++ branches/SAMBA_4_0/source/libnet/libnet_lookup.c\t2007-05-11 21:51:53 UTC (rev 22811)\n@@ -74,6 +74,8 @@\n \n \t/* parameters */\n \ts->hostname.name   = talloc_strdup(s, io->in.hostname);\n+\tif (composite_nomem(s->hostname.name, c)) return c;\n+\n \ts->hostname.type   = io->in.type;\n \ts->hostname.scope  = NULL;\n \n\nModified: branches/SAMBA_4_0/source/libnet/userinfo.c\n===================================================================\n--- branches/SAMBA_4_0/source/libnet/userinfo.c\t2007-05-11 21:48:29 UTC (rev 22810)\n+++ branches/SAMBA_4_0/source/libnet/userinfo.c\t2007-05-11 21:51:53 UTC (rev 22811)\n@@ -296,9 +296,10 @@\n \t\ts->lookup.in.domain_handle    = &s->domain_handle;\n \t\ts->lookup.in.num_names        = 1;\n \t\ts->lookup.in.names            = talloc_array(s, struct lsa_String, 1);\n-\t\t\n \t\tif (composite_nomem(s->lookup.in.names, c)) return c;\n+\n \t\ts->lookup.in.names[0].string  = talloc_strdup(s, io->in.username);\n+\t\tif (composite_nomem(s->lookup.in.names[0].string, c)) return c;\n \t\t\n \t\t/* send request */\n \t\tlookup_req = dcerpc_samr_LookupNames_send(p, c, &s->lookup);\n\n"}