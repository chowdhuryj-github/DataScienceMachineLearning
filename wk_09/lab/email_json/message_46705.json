{"category": "ham", "to_address": "\"Andy Lester\" <andy@petdance.com>", "from_address": "\"jerry gay\" <jerry.gay@gmail.com>", "subject": "Re: Removing #pragma", "body": "On 6/12/07, Andy Lester  wrote:\n>\n> I'm very uncomfortable with removing #pragma once from our header\n> files.  It is perfectly valid C89 code, and I think bowing to a\n> broken compiler is unhealthy precedent.\n>\nto add some context, in r18884 andy committed a patch (after my\nsuggestion) to put C<#pragma once> in every c header file, after\nreading that it should speed up compilation with msvc. i consulted my\ncopy of k&r, which states that unrecognized pragmas should be ignored,\nso it should have no ill effects on other platforms.\n\nas it turns out, this pragma causes mingw gcc 3.4.2 to segfault. this\nis a bug in the compiler, not in the parrot code. after googling, it\nseems this bug is fixed in mingw gcc 3.4.6 (perhaps earlier.)\n\nin r18945, fperrad reverted andy's patch, after noticing the mingw gcc\nproblems. andy's message is in response to this commit.\n\ni apologize for not announcing the addition of C<#pragma once> and\nknowing about the problem with mingw gcc 3.4.2. it was discussed on\nirc, but should have been announced on the list as that's our primary\nform of communication.\n\nnow, to the matter at hand: i agree with andy. we shouldn't revert\nthis because one broken compiler doesn't like it. however, we should\nmake it clear in the documentation that the particular version of that\ncompiler has trouble compiling valid C89, will not compile parrot, and\nupgrading to a version with the proper patch is required.\n\n~jerry\n\n"}