{"category": "ham", "to_address": "samba tech <samba-technical@lists.samba.org>", "from_address": "Herb Lewis <hlewis@panasas.com>", "subject": "comment doesn't match code", "body": "in smbd/open.c in the function open_file_ntcreate we have the\nfollowing comment and code which contradict.\n\n         /* note that we ignore failure for the following. It is\n            basically a hack for NFS, and NFS will never set one of\n            these only read them. Nobody but Samba can ever set a deny\n            mode and we have already checked our more authoritative\n            locking database for permission to set this deny mode. If\n            the kernel refuses the operations then the kernel is wrong.\n            note that GPFS supports it as well - jmcd */\n\n         ret_flock = SMB_VFS_KERNEL_FLOCK(fsp, fsp->fh->fd, share_access);\n         if(ret_flock == -1 ){\n\n                 TALLOC_FREE(lck);\n                 fd_close(conn, fsp);\n                 file_free(fsp);\n\n                 return NT_STATUS_SHARING_VIOLATION;\n         }\n\n"}