{"category": "ham", "to_address": "Rense Nieuwenhuis <r.nieuwenhuis@student.ru.nl>", "from_address": "Andrew Robinson <A.Robinson@ms.unimelb.edu.au>", "subject": "Re: [R] {nlme} Multilevel estimation heteroscedasticity", "body": "Rense,\n\nhow about \n\nweights = varPower(form = ~ schavg)\n\nor \n\nweights = varConstPower(form = ~ schavg)\n\nor even \n\nweights = varPower(form = ~ schavg | type)\n\nYuo might find Pinheiro and Bates (2000) to be a valuable investment.\n\nI hope that this helps,\n\nAndrew\n\n\nOn Sun, Jun 10, 2007 at 04:35:58PM +0200, Rense Nieuwenhuis wrote:\n> Dear All,\n> \n> I'm trying to model heteroscedasticity using a multilevel model. To  \n> do so, I make use of the nlme package and the weigths-parameter.  \n> Let's say that I hypothesize that the exam score of students  \n> (normexam) is influenced by their score on a standardized LR test  \n> (standLRT). Students are of course nested in \"schools\". These  \n> variables are contained in the Exam-data in the mlmRev package.\n> \n> library(nlme)\n> library(mlmRev)\n> lme(fixed = normexam ~ standLRT,\n> \tdata = Exam,\n> \trandom = ~ 1 | school)\n> \n> \n> If I want to model only a few categories of variance, all works fine.  \n> For instance, should I (for whatever reason) hypothesize that the  \n> variance on the normexam-scores is larger in mixed schools than in  \n> boys-schools, I'd use weights = varIdent(form = ~ 1 | type), leading to:\n> \n> heteroscedastic <- lme(fixed = normexam ~ standLRT,\n> \tdata = Exam,\n> \tweights = varIdent(form = ~ 1 | type),\n> \trandom = ~ 1 | school)\n> \n> This gives me nice and clear output, part of which is shown below:\n> Variance function:\n> Structure: Different standard deviations per stratum\n> Formula: ~normexam | type\n> Parameter estimates:\n>       Mxd     Sngl\n> 1.000000 1.034607\n> Number of Observations: 4059\n> Number of Groups: 65\n> \n> \n> Though, should I hypothesize that the variance on the normexam- \n> variable is larger on schools that have a higher average score on  \n> intake-exams (schavg), I run into troubles. I'd use weights = varIdent \n> (form = ~ 1 | schavg), leading to:\n> \n> heteroscedastic <- lme(fixed = normexam ~ standLRT,\n> \tdata = Exam,\n> \tweights = varIdent(form = ~ 1 | schavg),\n> \trandom = ~ 1 | school)\n> \n> This leads to estimation problems. R tells me:\n> Error in lme.formula(fixed = normexam ~ standLRT, data = Exam,  \n> weights = varIdent(form = ~1 |  :\n> \tnlminb problem, convergence error code = 1; message = iteration  \n> limit reached without convergence (9)\n> \n> Fiddling with maxiter and setting an unreasonable tolerance doesn't  \n> help. I think the origin of this problem lies within the large number  \n> of categories on \"schavg\" (65), that may make estimation troublesome.\n> \n> This leads to my two questions:\n> - How to solve this estimation-problem?\n> - Is is possible that the varIdent (or more general: VarFunc) of lme  \n> returns a single value, representing a co?ffici?nt along which  \n> variance is increasing / decreasing?\n> \n> - In general: how can a variance-component / heteroscedasticity be  \n> made dependent on some level-2 variable (school level in my examples) ?\n> \n> Many thanks in advance,\n> \n> Rense Nieuwenhuis\n> \t[[alternative HTML version deleted]]\n> \n\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n\n-- \nAndrew Robinson  \nDepartment of Mathematics and Statistics            Tel: +61-3-8344-9763\nUniversity of Melbourne, VIC 3010 Australia         Fax: +61-3-8344-4599\nhttp://www.ms.unimelb.edu.au/~andrewpr\nhttp://blogs.mbs.edu/fishing-in-the-bay/\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}