{"category": "ham", "to_address": "\"Alan Jackson\" <Rhelp@ajackson.org>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] making a Time of Day axis", "body": "Here it is with a few improvements:\n- use as.is=TRUE on read.table to get character columns rather than factor\n- use xaxt = FALSE rather than axes = FALSE to eliminate axis(2)\n- use h$mids where h is the output of hist to avoid lots of tedious calcs\n- eliminate all that attaching and detaching\n- eliminate strptime\n\nDF <- read.table(\"input.dat\", header = TRUE, as.is = TRUE)\nDF$Time <- times(paste(DF$Time, \"00\", sep = \":\"))\ntod <- as.numeric(subset(DF, Trip == \"m\")$Time)\nh <- hist(tod, xaxt = \"n\", main = \"Morning Bus Arrival Times\",\n\txlab = \"Time\", col = \"blue\");\naxis(1, h$mids, sub(\":00$\", \"\", times(h$mids)))\n\nAlthough not used subsequently just in case you need it in\ncomputations that you did not show:\n\nDF$Date <- chron(DF$Date)\nDF$DateTime <- chron(DF$Date, DF$Time)\n\n\nOn 6/19/07, Alan Jackson  wrote:\n> I am wrestling with time and date data. I came up with a way to plot and\n> label a histogram with \"time of day\" on the x-axis, but it seemed like a\n> lot more work than should be necessary. Is there a better way to do what\n> I am trying to do?\n>\n> require(chron)\n> #       read input data\n> data = read.table(\"input.dat\", header=T)\n> #       Create date-time and chron objects\n> datetime = strptime(paste(data[,3], data[,2]),format=\"%m/%d/%y %H:%M\")\n> time = times(paste(as.vector(data[,2]), \":00\",sep=\"\"))\n> #       Put it all into a data frame\n> data = data.frame(time, datetime, data$Trip)\n> names(data) = c(\"Time\",\"DateTime\",\"Trip\")\n> attach(data)\n> #       Create time of day array\n> times = as.numeric(chron(times = Time))\n> tod = subset(times, Trip=='m');\n> #       Plot base histogram\n> hist(tod, axes=F, main=\"Morning Bus Arrival Times\", xlab=\"Time\", col=\"blue\");\n> axis(2);\n> #       where are the tics to be?\n> tics = seq(min(tod), max(tod), (max(tod)-min(tod))/5);\n> #       build a labeled x-axis for the plot\n> axis(1, tics, labels=sub(\":00$\",\"\",as.character(chron(times=tics, out.format=\"h:m:s\"))));\n>\n> #       cleanup\n> detach(data)\n>\n> --- Data ---\n> Trip Time Date\n> a 15:55 05/15/07\n> m  5:47 05/16/07\n> a 15:54 05/16/07\n> m  5:47 05/17/07\n> a 15:59 05/17/07\n> m  5:50 05/21/07\n> m  5:50 05/22/07\n> a 16:00 05/22/07\n> m  5:48 05/23/07\n> m  5:50 05/24/07\n> a 16:00 05/24/07\n> m  5:48 05/25/07\n> m  5:48 05/29/07\n> a 15:59 05/29/07\n> m  5:46 05/30/07\n> m  5:45 05/31/07\n> a 16:05 05/31/07\n> m  5:47 06/04/07\n> a 15:53 06/04/07\n> m  5:46 06/05/07\n> m  5:47 06/06/07\n> a 15:53 06/06/07\n> m  5:47 06/07/07\n> a 15:51 06/07/07\n> m  5:45 06/08/07\n> f 15:22 06/08/07\n> m  5:48 06/11/07\n> m  5:46 06/12/07\n> m  5:48 06/13/07\n> m  5:47 06/18/07\n> a 15:53 06/18/07\n> m  5:47 06/19/07\n> a 15:55 06/19/07\n>\n>\n> --\n> -----------------------------------------------------------------------\n> | Alan K. Jackson            | To see a World in a Grain of Sand      |\n> | alan@ajackson.org          | And a Heaven in a Wild Flower,         |\n> | www.ajackson.org           | Hold Infinity in the palm of your hand |\n> | Houston, Texas             | And Eternity in an hour. - Blake       |\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}