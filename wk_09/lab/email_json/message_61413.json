{"category": "ham", "to_address": "\"Dustin Hice\" <hicedustin@gmail.com>", "from_address": "\"Chas Owens\" <chas.owens@gmail.com>", "subject": "Re: Perl Device Manager?", "body": "On 7/2/07, Dustin Hice  wrote:\n> I was thinking about making a few different scripts that would enable/\n> disable components of my laptop to save power,  I am hoping to be able\n> to just make a few different scripts that will be stored on my\n> desktop.  These scripts will just check to see if a specific component\n> is enabled or disabled, and then turn that component on or off.  I was\n> thinking this would be easier than having to go into device manager\n> every single time I wanted to start up a USB slot or something.  If\n> anyone knows of any module that I could use to be able to access the\n> device manager it would be alot of help.\n>\n> Thanks for any replies,\n>\n> Dustin\n\nI looked around briefly on CPAN to see if there was a module that did\nsomething like this, but was unsuccessful; however, a quick Google\nsearch turned up a command line program* that can do what you want.\nIt should be as simple as\n\nsub enable_device {\n    my $device = shift;\n    my $ret = qx(devcon enable $device);\n    if ($?) {\n        warn \"could not enable $device, decon returned \" .  ($? >> 8) .\n            \" and said\\n\" . $ret\n    }\n}\n\nsub disable_device {\n    my $device = shift;\n    my $ret = qx(devcon disable $device);\n    if ($?) {\n        warn \"could not disable $device, decon returned \" .  ($? >> 8) .\n            \" and said\\n\" . $ret\n    }\n}\n\n* http://support.microsoft.com/kb/311272\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}