{"category": "ham", "to_address": "samba-technical@samba.org, samba@samba.org", "from_address": "\"Gerald (Jerry) Carter\" <jerry@samba.org>", "subject": "[SAMBA-SECURITY] CVE-2007-2447: Remote Command Injection\n\tVulnerability", "body": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\n==========================================================\n==\n== Subject:     Remote Command Injection Vulnerability\n== CVE ID#:     CVE-2007-2447\n==\n== Versions:    Samba 3.0.0 - 3.0.25rc3 (inclusive)\n==\n== Summary:\tUnescaped user input parameters are passed\n==              as arguments to /bin/sh allowing for remote\n==              command execution\n==\n==========================================================\n\n===========\nDescription\n===========\n\nThis bug was originally reported against the anonymous calls\nto the SamrChangePassword() MS-RPC function in combination\nwith the \"username map script\" smb.conf option (which is not\nenabled by default).\n\nAfter further investigation by Samba developers, it was\ndetermined that the problem was much broader and impacts\nremote printer and file share management as well.  The root\ncause is passing unfiltered user input provided via MS-RPC\ncalls to /bin/sh when invoking externals scripts defined\nin smb.conf.  However, unlike the \"username map script\"\nvulnerability, the remote file and printer management scripts\nrequire an authenticated user session.\n\n\n==================\nPatch Availability\n==================\n\nA patch against Samba 3.0.24 has been posted at\n\n  http://www.samba.org/samba/security/\n\n\n==========\nWorkaround\n==========\n\nThis defect may be alleviated by removing all defined\nexternal script invocations (username map script, add\nprinter command, etc...) from smb.conf.\n\nThe Samba Team always encourages users to run the latest\nstable release as a defense against attacks.  If this\nis not immediately possible, administrators should read\nthe \"Server Security\" documentation found at\n\n  http://www.samba.org/samba/docs/server_security.html\n\n\n=======\nCredits\n=======\n\nThis vulnerability was  discovered by an anonymous researcher\nand reported to Samba developers by Joshua J. Drake, iDefense\nLabs (http://www.idefense.com/), as part of their Vulnerability\nContributor Program.\n\nThe time line is as follows:\n\n* May 7, 2007: Initial defect disclosure to the security@samba.org\n  email alias.\n* May 7, 2007: Initial developer response by Samba\n  developer Gerald Carter.\n* May 9, 2007: Patch released by Samba developer Jeremy\n  Allison to iDefense for testing.\n* May 10, Announcement to vendor-sec mailing list\n* May 14, 2007: Public announcement of the security issue.\n\n\n\n==========================================================\n== Our Code, Our Bugs, Our Responsibility.\n== The Samba Team\n==========================================================\n\n\n\n\n\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.6 (GNU/Linux)\nComment: Using GnuPG with Mozilla - http://enigmail.mozdev.org\n\niD8DBQFGSGTJIR7qMdg1EfYRAvxbAJ9u/3d1CcgDF3hGkh4uiPfWBYN+ugCfcWu3\nXWkh9kFpHh9nXttNSHTaZ0M=\n=NUTG\n-----END PGP SIGNATURE-----\n\n"}