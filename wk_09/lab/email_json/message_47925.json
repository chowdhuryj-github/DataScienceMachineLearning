{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Kevin Wright\" <kw.statr@gmail.com>", "subject": "[R] Confidence interval for coefficient of variation", "body": "This is a function I coded a few years ago to calculate a confidence\ninterval for a coefficient of variation.  The code is based on a paper\nby Mark Vangel in The American Statistician.  I have not used the\nfunction much, but it could be useful for comparing cv's from\ndifferent groups.\n\nKevin Wright\n\n\nconfint.cv <- function(x,alpha=.05, method=\"modmckay\"){\n  # Calculate the confidence interval of the cv of the vector x\n  # Author: Kevin Wright\n  # See: Vangel, Mark.  Confidence Intervals for a Normal Coefficient\n  # of Variation. American Statistician, Vol 15, No1, p. 21--26.\n  # x <- c(326,302,307,299,329)\n  # confint.cv(x,.05,\"modmckay\")\n\n  x <- na.omit(x)\n  v <- length(x)-1\n  mu <- mean(x)\n  sigma <- sqrt(var(x))\n  k <- sigma/mu\n  # CV > .33 may give poor results, so warn the user\n  if(k>.33) warning(\"Confidence interval may be very approximate.\")\n\n  method <- casefold(method) # In case we see \"McKay\"\n\n  if(method==\"mckay\"){\n    # McKay method.  See equation 15.\n    t1 <- qchisq(1-alpha/2,v)/v\n    t2 <- qchisq(alpha/2,v)/v\n    u1 <- v*t1\n    u2 <- v*t2\n    lower <- k/sqrt(( u1/(v+1) -1)*k*k + u1/v)\n    upper <- k/sqrt(( u2/(v+1) -1)*k*k + u2/v)\n  } else if (method==\"naive\"){\n    # Naive method.  See equation 17.\n    t1 <- qchisq(1-alpha/2,v)/v\n    t2 <- qchisq(alpha/2,v)/v\n    lower <- k/sqrt(t1)\n    upper <- k/sqrt(t2)\n  } else {\n    # Modified McKay method. See equation 16.\n    u1 <- qchisq(1-alpha/2,v)\n    u2 <- qchisq(alpha/2,v)\n    lower <- k/sqrt(( (u1+2)/(v+1) -1)*k*k + u1/v)\n    upper <- k/sqrt(( (u2+2)/(v+1) -1)*k*k + u2/v)\n  }\n  ci <- c(lower,upper)\n  attr(ci,\"CV\") <- k\n  attr(ci,\"alpha\") <- alpha\n  return(ci)\n}\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}