{"category": "ham", "to_address": "jra@samba.org", "from_address": "\"Gerald (Jerry) Carter\" <jerry@samba.org>", "subject": "symlink failure when listing a dircetory in samba 3.0.25", "body": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nJeremy,\n\nIs this a change in behavior ?\n\n* create a symlink in a share to a directory that\n  has permissions that would deny a given user to\n  stat the link target\n\n* smbd removes the link from the list of files\n  in the output to smbclient and Windows 2003\n\n  get_lanman2_dir_entry: SMB_FIND_FILE_BOTH_DIRECTORY_INFO\n  get_lanman2_dir_entry:readdir on dirptr 0x8558a30 now at offset\n    -2147483648\n  dos_mode: ./..\n  dos_mode_from_sbuf returning d\n  dos_mode returning d\n  get_lanman2_dir_entry found ./.. fname=..\n  get_lanman2_dir_entry: SMB_FIND_FILE_BOTH_DIRECTORY_INFO\n  get_lanman2_dir_entry:readdir on dirptr 0x8558a30 now at offset 56\n  get_lanman2_dir_entry:Couldn't stat [./lwi-builds] (Permission denied)\n  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  get_lanman2_dir_entry:readdir on dirptr 0x8558a30 now at offset 72\n  dos_mode: ./winadmin\n  dos_mode_from_sbuf returning d\n  dos_mode returning d\n  get_lanman2_dir_entry found ./winadmin fname=winadmin\n  get_lanman2_dir_entry: SMB_FIND_FILE_BOTH_DIRECTORY_INFO\n  get_lanman2_dir_entry:readdir on dirptr 0x8558a30 now at offset 4096\n\nIt seems to be that we should display the link anyways.\nHide unreadable is not set.\n\n\n\n\n\ncheers, jerry\n=====================================================================\nSamba                                    ------- http://www.samba.org\nCenteris                         -----------  http://www.centeris.com\n\"What man is a man who does not make the world better?\"      --Balian\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.6 (GNU/Linux)\nComment: Using GnuPG with Mozilla - http://enigmail.mozdev.org\n\niD8DBQFGRI5YIR7qMdg1EfYRAl9LAKDIpfrPMX1h53ARm3cND8UrrZ+4gACeIgdr\nPxyvBMnMAYevJTHL3sz3kIY=\n=Vbh5\n-----END PGP SIGNATURE-----\n\n"}