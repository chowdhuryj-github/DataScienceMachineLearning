{"category": "ham", "to_address": "\"R Help\" <r-help@stat.math.ethz.ch>", "from_address": "\"hadley wickham\" <h.wickham@gmail.com>", "subject": "[R] Weighted least squares", "body": "Dear all,\n\nI'm struggling with weighted least squares, where something that I had\nassumed to be true appears not to be the case.  Take the following\ndata set as an example:\n\ndf <- data.frame(x = runif(100, 0, 100))\ndf$y <- df$x + 1 + rnorm(100, sd=15)\n\nI had expected that:\n\nsummary(lm(y ~ x, data=df, weights=rep(2, 100)))\nsummary(lm(y ~ x, data=rbind(df,df)))\n\nwould be equivalent, but they are not.  I suspect the difference is\nhow the degrees of freedom is calculated - I had expected it to be\nsum(weights), but seems to be sum(weights > 0).  This seems\nunintuitive to me:\n\nsummary(lm(y ~ x, data=df, weights=rep(c(0,2), each=50)))\nsummary(lm(y ~ x, data=df, weights=rep(c(0.01,2), each=50)))\n\nWhat am I missing?  And what is the usual way to do a linear\nregression when you have aggregated data?\n\nThanks,\n\nHadley\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}