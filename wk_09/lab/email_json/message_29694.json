{"category": "ham", "to_address": "\"Brian Riordan\" <bwriordan@gmail.com>", "from_address": "\"Spielas Bates\" <bates@stat.wisc.edu>", "subject": "Re: [R] parsing an lmer error with interaction term", "body": "On 5/14/07, Brian Riordan  wrote:\n> I'm trying to specify a model using lmer with a binary response and\n> interaction term, but I get an error I can't parse (see below).\n>\n> Here is some sample data:\n>\n> Subject    Concord    Age    Disc\n> SVC999MX148SU-F    yes    u    int\n> TOU999JU030S1    yes    u    int\n> TOU999JU030S1    yes    u    int\n> TOU999JU030S1    yes    u    int\n> TUT578MX037S2    yes    g    int\n> COL140MX114S2    yes    yf    mix\n> COL140MX114S6    yes    u    mix\n> COL140MX114S2    yes    yf    mix\n> COL425MX075S2    yes    of    mix\n> COL425MX075S2    yes    of    mix\n> COL425MX075S2    yes    of    mix\n> STP560JG118S14    no    g    pnl\n> STP560JG118S22    no    g    pnl\n> STP560JG118S20    no    g    pnl\n> STP560JG118S15    no    g    pnl\n> STP560JG118S20    no    g    int\n\nIf that is the entire data set you won't be able to fit a generalized\nlinear mixed model with a binomial distribution for the Concord\nresponse.  There is complete separation of the Concord response with\nrespect to the subject so you can't estimate the effects of\ncovariates.\n\nIt seems that your actual data set is larger than this but it would\nneed to be much larger to have a hope of estimating the Age x Disc\ninteraction as well as the variance of the random effect for subject.\nA binary response provides only one bit of information from each\nobservation so you need a lot of them to estimate a large number of\nparameters.\n\n>\n> And here is the model:\n>\n> lmer_int_ageXdisc <- lmer(Concord ~ Age*Disc\n>     + (1|Subject), family=\"binomial\", data=d, method=\"Laplace\")\n>\n> In the actual data set the AgexDisc interaction should have 16 levels.\n>\n> This produces the error:\n>\n> Error in devLaplace(PQLpars) : Leading minor of order 7 in downdated X'X is\n> not positive definite\n>\n> What does this mean?  This error is not thrown for other interactions I\n> specify from my data.\n>\n> Here is my session info:\n>\n> R version 2.4.1 (2006-12-18)\n> i386-pc-mingw32\n>\n> locale:\n> LC_COLLATE=English_United States.1252;LC_CTYPE=English_United\n> States.1252;LC_MONETARY=English_United\n> States.1252;LC_NUMERIC=C;LC_TIME=English_United States.1252\n>\n> attached base packages:\n> [1] \"stats\"     \"graphics\"  \"grDevices\" \"utils\"     \"datasets\"  \"methods\"\n> [7] \"base\"\n>\n> other attached packages:\n>        lme4      Matrix     lattice\n> \"0.9975-13\" \"0.9975-11\"   \"0.14-17\"\n>\n> Thanks in advance for your help!\n> --\n> Brian Riordan\n> NICHD Postdoctoral Fellow\n> Psychological and Brain Sciences\n> Indiana University\n>\n>         [[alternative HTML version deleted]]\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}