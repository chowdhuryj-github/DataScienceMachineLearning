{"category": "ham", "to_address": "Noah Kantrowitz <kantrn@rpi.edu>", "from_address": "Dan Williams <dcbw@redhat.com>", "subject": "Re: [sugar] DBus .service files", "body": "On Sun, 2007-04-15 at 06:24 -0400, Noah Kantrowitz wrote:\n> Anyone know how to get a system dbus install to see the service files in\n> ~/sugar-jhbuild/build/share/dbus-1/service? I tried putting a\n>  entry in /etc/dbus-1/system.d/sugar.conf, but dbus still\n> doesn't see it when running sugar-presence-service.:\n> [olpc@localhost sugar-jhbuild]$ build/bin/sugar-presence-service\n\nDon't do this.  There have been a couple fixes since late last week to\nmake this all work.  First, 'git pull' in sugar-jhbuild.  Second,\n\"./sugar-jhbuild buildone -a telepathy-python\".  That should make this\nstuff just work.\n\nA fix was pushed to tp-python last week that allows it to find the\nservice managers using XDG_DATA_DIR rather than hardcoding the search\nlist.  A further fix was put into sugar-jhbuild to point the session\nDBus daemon that sugar spawns to the dbus service directories inside\nsugar-jhbuild rather than the local system.\n\nDan\n\n> /usr/local/lib/python2.5/site-packages/gtk-2.0/gobject/__init__.py:49:\n> Warning: g_object_class_install_property: assertion `pspec->flags &\n> G_PARAM_WRITABLE' failed\n>   type_register(cls, namespace.get('__gtype_name__'))\n> Traceback (most recent call last):\n>   File \"build/bin/sugar-presence-service\", line 47, in \n>     presenceservice.main(test)\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/services/presence/presenceservice.py\",\n> line 336, in main\n>     ps = PresenceService(test)\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/services/presence/presenceservice.py\",\n> line 67, in __init__\n>     self._server_plugin = ServerPlugin(self._registry, self._owner)\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/services/presence/server_plugin.py\",\n> line 111, in __init__\n>     self._gabble_mgr = registry.GetManager('gabble')\n>   File\n> \"/home/olpc/sugar-jhbuild/build/lib/python2.5/site-packages/telepathy/client/managerregistry.py\",\n> line 135, in GetManager\n>     self.services[manager]['objectpath'])\n>   File\n> \"/home/olpc/sugar-jhbuild/build/lib/python2.5/site-packages/telepathy/client/connmgr.py\",\n> line 32, in __init__\n>     object = bus.get_object(service_name, object_path)\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/_dbus.py\", line 412,\n> in get_object\n>     follow_name_owner_changes=follow_name_owner_changes)\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/proxies.py\", line\n> 232, in __init__\n>     _dbus_bindings.UInt32(0))\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/proxies.py\", line\n> 171, in __call__\n>     reply_message =\n> self._connection.send_message_with_reply_and_block(message, timeout)\n> DBusException: org.freedesktop.DBus.Error.ServiceUnknown: The name\n> org.freedesktop.Telepathy.ConnectionManager.gabble was not provided by\n> any .service files\n> \n> It does find the service if I copy it to /usr/share/dbus-1/service,\n> though then I get:\n> [olpc@localhost sugar-jhbuild]$ build/bin/sugar-presence-service\n> /usr/local/lib/python2.5/site-packages/gtk-2.0/gobject/__init__.py:49:\n> Warning: g_object_class_install_property: assertion `pspec->flags &\n> G_PARAM_WRITABLE' failed\n>   type_register(cls, namespace.get('__gtype_name__'))\n> Traceback (most recent call last):\n>   File \"build/bin/sugar-presence-service\", line 47, in \n>     presenceservice.main(test)\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/services/presence/presenceservice.py\",\n> line 336, in main\n>     ps = PresenceService(test)\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/services/presence/presenceservice.py\",\n> line 67, in __init__\n>     self._server_plugin = ServerPlugin(self._registry, self._owner)\n>   File\n> \"/home/olpc/sugar-jhbuild/build/share/sugar/services/presence/server_plugin.py\",\n> line 111, in __init__\n>     self._gabble_mgr = registry.GetManager('gabble')\n>   File\n> \"/home/olpc/sugar-jhbuild/build/lib/python2.5/site-packages/telepathy/client/managerregistry.py\",\n> line 135, in GetManager\n>     self.services[manager]['objectpath'])\n>   File\n> \"/home/olpc/sugar-jhbuild/build/lib/python2.5/site-packages/telepathy/client/connmgr.py\",\n> line 32, in __init__\n>     object = bus.get_object(service_name, object_path)\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/_dbus.py\", line 412,\n> in get_object\n>     follow_name_owner_changes=follow_name_owner_changes)\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/proxies.py\", line\n> 232, in __init__\n>     _dbus_bindings.UInt32(0))\n>   File \"/usr/local/lib/python2.5/site-packages/dbus/proxies.py\", line\n> 171, in __call__\n>     reply_message =\n> self._connection.send_message_with_reply_and_block(message, timeout)\n> DBusException: org.freedesktop.DBus.Error.ServiceUnknown: The name\n> org.freedesktop.Telepathy.ConnectionManager.gabble was not provided by\n> any .service files\n> \n> Any ideas?\n> \n> --Noah\n> \n> _______________________________________________\n> Sugar mailing list\n> Sugar@laptop.org\n> http://mailman.laptop.org/mailman/listinfo/sugar\n\n_______________________________________________\nSugar mailing list\nSugar@laptop.org\nhttp://mailman.laptop.org/mailman/listinfo/sugar\n\n"}