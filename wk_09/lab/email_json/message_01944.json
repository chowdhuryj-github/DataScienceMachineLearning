{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jra@samba.org", "subject": "svn commit: samba r22157 - in branches: SAMBA_3_0/source/nmbd\n\tSAMBA_3_0_25/source/nmbd", "body": "Author: jra\nDate: 2007-04-10 20:35:30 +0000 (Tue, 10 Apr 2007)\nNew Revision: 22157\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22157\n\nLog:\nFix bug #3634 - stop nmbd segfaulting with bad interface line.\nJeremy.\n\nModified:\n   branches/SAMBA_3_0/source/nmbd/nmbd_subnetdb.c\n   branches/SAMBA_3_0_25/source/nmbd/nmbd_subnetdb.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/nmbd/nmbd_subnetdb.c\n===================================================================\n--- branches/SAMBA_3_0/source/nmbd/nmbd_subnetdb.c\t2007-04-10 20:19:31 UTC (rev 22156)\n+++ branches/SAMBA_3_0/source/nmbd/nmbd_subnetdb.c\t2007-04-10 20:35:30 UTC (rev 22157)\n@@ -223,6 +223,13 @@\n \t\t\treturn False;\n \t}\n \n+        /* We must have at least one subnet. */\n+\tif (subnetlist == NULL) {\n+\t\tDEBUG(0,(\"create_subnets: unable to create any subnet from \"\n+\t\t\t\t\"given interfaces. nmbd is terminating\\n\"));\n+\t\treturn False;\n+\t}\n+\n \tif (lp_we_are_a_wins_server()) {\n \t\t/* Pick the first interface ip address as the WINS server ip. */\n \t\tstruct in_addr *nip = iface_n_ip(0);\n\nModified: branches/SAMBA_3_0_25/source/nmbd/nmbd_subnetdb.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/nmbd/nmbd_subnetdb.c\t2007-04-10 20:19:31 UTC (rev 22156)\n+++ branches/SAMBA_3_0_25/source/nmbd/nmbd_subnetdb.c\t2007-04-10 20:35:30 UTC (rev 22157)\n@@ -223,6 +223,13 @@\n \t\t\treturn False;\n \t}\n \n+        /* We must have at least one subnet. */\n+\tif (subnetlist == NULL) {\n+\t\tDEBUG(0,(\"create_subnets: unable to create any subnet from \"\n+\t\t\t\t\"given interfaces. nmbd is terminating\\n\"));\n+\t\treturn False;\n+\t}\n+\n \tif (lp_we_are_a_wins_server()) {\n \t\t/* Pick the first interface ip address as the WINS server ip. */\n \t\tstruct in_addr *nip = iface_n_ip(0);\n\n"}