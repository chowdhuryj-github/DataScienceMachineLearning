{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Klaus Nordhausen\" <klausch@gmx.de>", "subject": "[R] Questions about bwplot", "body": "Dear R-experts,\n\nI have some questions about boxplots with lattice.\nMy data is similar as in the example below, I have two factors\n(Goodness of Fit and Algorithms) and data values but in each panels the scales are quite different, therefore the normal boxplots produced by\n\nset.seed(1)\nGOF <- factor(rep(c(\"GOF1\",\"GOF2\",\"GOF3\"),each=40))\nAlg <- rep(factor(rep(c(\"A1\",\"A2\",\"A3\",\"R1\"),each=10)),3)\nValue <- c(runif(40),rnorm(40),rnorm(30,10,3),rnorm(10,20,3))\ntest.data <- data.frame(Alg=Alg,GOF=GOF,Value=Value)\n\nlibrary(lattice)\nbwplot(Value ~ Alg | GOF, data = test.data, as.table=T, layout=c(1,3))\n\nare not very informative.\n\nThen I used\n\nbwplot(Value ~ Alg | GOF, data = test.data, scale=list(relation=\"free\"), as.table=T, layout=c(1,3))\n\nfrom which my first question arises:\n\nIs it possible to have no vertical space between the panels though they have different y-scales when using the\nargument scale=list(relation=\"free\")?\n\nThen I would like to modify the boxplot - actually I'm not interested so much in the boxes of factor R1 (=random guess)\nbut would rather have a horizontal line in each panel at the median of R1 for the given panel, and only the boxes for levels\nA1, A2 and A3 - and the horizontal line I would like only if it would fall in the plotting area when only plotting the boxes\nfor the levels A1, A2 and A3 (this means in the third panel the line should not be there).\n\nMy attempt \n\ntest.data$ind <- ifelse(Alg==\"R1\",1,0)\nmy.boxpanel <- function(x, y, subscripts, groups, ...) {\n                orig <- groups[subscripts] == 0\n                panel.bwplot(x[orig], y[orig], ...)\n                panel.abline(h=median(y[!orig]))\n                  }\nbwplot(Value ~ Alg | GOF, data = test.data, scale=list(relation=\"free\"),\n        as.table=T, groups=ind, layout=c(1,3),panel=my.boxpanel, \t\t        drop.unused.levels=T,\n        xlim=c(\"A1\",\"A2\",\"A3\"),\n        ylim=list(c(0,1),c(-2,2),c(0,17)))\n\nrequires that I know the range of the yaxis and at the xaxis leaves space for the box of R1. Can that be avoided?\n\nThen my last question - I would like to emphasise the best factor=algorithm in each panel by coloring its box.\nHowever \"best\" means in the first two panels lowest median and in the last panel highest median. Can this be done?\nI managed it only when in all panels the lowest median box should be filled with color.\n\ntrellis.device(color = FALSE)\nmy.boxpanel2 <- function(x, y, subscripts, groups, ...) {\n                orig <- groups[subscripts] == 0\n                medians<-tapply(y[orig],x[orig],median)\n                medians2<-medians[!is.na(medians)]\n                cols<-grey((1-as.numeric(medians2==min(medians2))/3))\n                z<-x[orig]\n                levels(z)<-c(\"A1\",\"A2\",\"A3\",NA)\n                w<-y[orig]\n                panel.bwplot(z, w, fill=cols, ...)\n                panel.abline(h=median(y[!orig]))\n                  }  \n\nbwplot(Value ~ Alg | GOF, data = test.data, scale=list(relation=\"free\"),\n        as.table=T, groups=ind, layout=c(1,3),panel=my.boxpanel2, drop.unused.levels=T, xlim=c(\"A1\",\"A2\",\"A3\"),\n        ylim=list(c(0,1),c(-2,2),c(0,17)))\n\nIt would be great if you could help me with this plot!\n\nThanks in advance,\n\nKlaus\n--\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}