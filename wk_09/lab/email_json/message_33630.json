{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r23038 - in\n\tbranches/SAMBA_3_0_26/source/nsswitch: .", "body": "Author: metze\nDate: 2007-05-21 13:39:34 +0000 (Mon, 21 May 2007)\nNew Revision: 23038\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23038\n\nLog:\nuse a helper function to construct the TDB_DATA key\nas strlen_m() is totally wrong here anyway\n\nmetze\nModified:\n   branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-05-21 13:33:46 UTC (rev 23037)\n+++ branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-05-21 13:39:34 UTC (rev 23038)\n@@ -3566,8 +3566,7 @@\n \t       \n \t\t\n \tasprintf( &keystr, \"TRUSTDOMCACHE/%s\", domain_name );\n-\tkey.dptr = (unsigned char*)keystr;\n-\tkey.dsize = strlen_m(keystr) + 1;\n+\tkey = string_term_tdb_data(keystr);\n \t\n \treturn key;\t\n }\n\n"}