{"category": "ham", "to_address": "bugs-bitbucket@netlabs.develooper.com", "from_address": "Steve Peters (via RT) <parrotbug-followup@parrotcode.org>", "subject": "[perl #42585] [PATCH] t/configure/01-options.t fails when testing in direcotries like ~/parrot/parrot ", "body": "# New Ticket Created by  Steve Peters \n# Please include the string:  [perl #42585]\n# in the subject line of all future correspondence about this issue. \n# \n\n\nIf you happen to try to test parrot and you have more than one directory\nnamed \"parrot\" in the full path, t/configure/01-options.t will fail.  The\npatch below fixes the problem by letting the regexp be more greedy in its\nmatching.  It also adds \"$!\" to the croaks so that developers won't be left\nscratching their heads as long when this test fails.\n\nSteve Peters\nsteve@fisharerojo.org\n\n\n--- t/configure/01-options.t.old        Tue Apr 17 09:49:05 2007\n+++ t/configure/01-options.t    Tue Apr 17 10:22:50 2007\n@@ -9,7 +9,7 @@\n BEGIN {\n     use FindBin qw($Bin);\n     use Cwd qw(cwd realpath);\n-    realpath($Bin) =~ m{^(.*\\/parrot)\\/[^/]*\\/[^/]*\\/[^/]*$};\n+    realpath($Bin) =~ m{^(.*\\/parrot)\\/.*$};\n     our $topdir = $1;\n     if ( defined $topdir ) {\n         print \"\\nOK:  Parrot top directory located\\n\";\n@@ -43,13 +43,13 @@\n ok( !defined $valid{$badoption}, \"invalid option not found\" );\n\n open my $FH, '<', \"$main::topdir/Configure.pl\"\n-    or croak \"Unable to open handle to Configure.pl\";\n+    or croak \"Unable to open handle to $main::topdir/Configure.pl:  $!\";\n my $bigstr;\n {\n     local $/ = undef;\n     $bigstr = <$FH>;\n }\n-close $FH or croak \"Unable to close handle to Configure.pl\";\n+close $FH or croak \"Unable to close handle to Configure.pl:  $!\";\n\n # Ignore any POD I have moved to an __END__ block.\n $bigstr =~ s/__END__.*//s;\n\n"}