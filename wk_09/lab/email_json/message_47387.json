{"category": "ham", "to_address": "James Peach <jpeach@samba.org>", "from_address": "Jeremy Allison <jra@samba.org>", "subject": "Re: kerberos auth account restrictions", "body": "On Wed, Jun 13, 2007 at 11:04:03AM -0700, James Peach wrote:\n> hi all,\n> \n> In check_sam_security(), we check whether the account is locked out  \n> like this:\n> \n> /* see if autolock flag needs to be updated */\n> if (pdb_get_acct_ctrl(sampass) & ACB_NORMAL)\n> \tpdb_update_autolock_flag(sampass, &updated_autolock);\n> /* Quit if the account was locked out. */\n> if (pdb_get_acct_ctrl(sampass) & ACB_AUTOLOCK) {\n> \tDEBUG(3,(\"check_sam_security: Account for user %s was locked \n> \tout.\\n\",  pdb_get_username(sampass)));\n> \treturn NT_STATUS_ACCOUNT_LOCKED_OUT;\n> }\n> \n> Is there a good reason that we don't do this for Kerberos auth in  \n> reply_spnego_kerberos()?\n\nI think the KDC does this, not the server. Once it's got a ticket\nfrom the KDC I think we assume that this isn't the case.\n\nJeremy.\n\n"}