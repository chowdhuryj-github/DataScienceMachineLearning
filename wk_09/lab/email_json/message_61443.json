{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "dave fournier <otter@otter-rsch.com>", "subject": "[R]  Using odesolve to produce non-negative solutions", "body": "If you didn't get this solved.\n\nI have done parameter estimation with models\ndefined by ODE's where negative solutions are a problem\nand one can only avoid them with great difficulty if the\nstandard explicit methods for solving the ODE are used. I found that\nusing implicit methods could be a great help.\n\nFor example in the exponential case\n\n     dN/dt = -k*N\n\nthe simple finite difference approximation is\n\n     N_{t+1}-N+t\n     --------------  = -k*N_t ,  k>=0\n        h\n\n   or\n     N_{t+1} = N_t -k*h*N_t\n\n   and if  k*h gets too large N_{t+1} goes negative and you are in trouble.\n\n   Consider instead the implicit formulation where the second\n   N_t on the RHS is replaced by N_{t+1}  and one gets\n\n     N_{t+1} = N_t/(1+k*h)\n\n    which is correct  for k*h=0 and as k*h--> infinity\n\n   For a more complicated example see\n\n    http://otter-rsch.com/admodel/cc4.html\n\n   for something I called \"semi-implicit\".\n   I hope these ideas will be useful for your problem.\n\n\n         Cheers,\n\n          Dave\n\n\n\n\n\n-- \nDavid A. Fournier\nP.O. Box 2040,\nSidney, B.C. V8l 3S3\nCanada\nPhone/FAX 250-655-3364\nhttp://otter-rsch.com\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}