{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 311: merged debug changes from samba4 in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 311\nrevision-id: tridge@samba.org-20070517024309-2e9qy28mgxdcevc2\nparent: tridge@samba.org-20070517023953-av5d587upxgja3cm\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Thu 2007-05-17 12:43:09 +1000\nmessage:\n  merged debug changes from samba4\nmodified:\n  lib/events/events_aio.c        events_aio.c-20070501213746-4fxluwiq4rcxib8p-1\n  lib/events/events_epoll.c      events_epoll.c-20070501213746-4fxluwiq4rcxib8p-2\n  lib/events/events_standard.c   events_standard.c-20061117234101-o3qt14umlg9en8z0-30\n=== modified file 'lib/events/events_aio.c'\n--- a/lib/events/events_aio.c\t2007-05-17 02:39:53 +0000\n+++ b/lib/events/events_aio.c\t2007-05-17 02:43:09 +0000\n@@ -108,8 +108,9 @@\n \tstruct fd_event *fde;\n \n \tclose(aio_ev->epoll_fd);\n-\taio_ev->epoll_fd = epoll_create(64);\n+\taio_ev->epoll_fd = epoll_create(MAX_AIO_QUEUE_DEPTH);\n \tif (aio_ev->epoll_fd == -1) {\n+\t\tDEBUG(0,(\"Failed to recreate epoll handle after fork\\n\"));\n \t\treturn;\n \t}\n \taio_ev->pid = getpid();\n\n=== modified file 'lib/events/events_epoll.c'\n--- a/lib/events/events_epoll.c\t2007-05-17 02:39:53 +0000\n+++ b/lib/events/events_epoll.c\t2007-05-17 02:43:09 +0000\n@@ -109,6 +109,7 @@\n \tclose(epoll_ev->epoll_fd);\n \tepoll_ev->epoll_fd = epoll_create(64);\n \tif (epoll_ev->epoll_fd == -1) {\n+\t\tDEBUG(0,(\"Failed to recreate epoll handle after fork\\n\"));\n \t\treturn;\n \t}\n \tepoll_ev->pid = getpid();\n\n=== modified file 'lib/events/events_standard.c'\n--- a/lib/events/events_standard.c\t2007-05-17 02:39:53 +0000\n+++ b/lib/events/events_standard.c\t2007-05-17 02:43:09 +0000\n@@ -126,6 +126,7 @@\n \tclose(std_ev->epoll_fd);\n \tstd_ev->epoll_fd = epoll_create(64);\n \tif (std_ev->epoll_fd == -1) {\n+\t\tDEBUG(0,(\"Failed to recreate epoll handle after fork\\n\"));\n \t\treturn;\n \t}\n \tstd_ev->pid = getpid();\n\n"}