{"category": "ham", "to_address": "Klaus Nordhausen <klausch@gmx.de>, r-help@stat.math.ethz.ch", "from_address": "\"Richard M. Heiberger\" <rmh@temple.edu>", "subject": "Re: [R] Questions about bwplot", "body": "## I simplified this panel function by taking the calculations outside\n## the panel function to allow use of the original variable names.\n\n\nmy.boxpanel3  <-  function(x, y, subscripts, ..., medians, best) { \n  cols <- grey(1-best[,panel.number()]/3)\n  panel.bwplot(x, y, fill=cols, ...) \n  panel.abline(h=medians[panel.number()])\n}   \n\ntd3 <- test.data[test.data$Alg != \"R1\",]\ntd3$Alg <- factor(td3$Alg)\nlevels(td3$Alg)\n\n\nR1.medians <- with(test.data[test.data$Alg==\"R1\",], tapply(Value, GOF, median))\nA.best <- with(td3, tapply(Value, data.frame(Alg, GOF), median))\nA.min <- apply(A.best, 2, function(x) x==min(x))\nA.max <- apply(A.best, 2, function(x) x==max(x))\nA.best <- cbind(A.min[ ,1:2, drop=FALSE], A.max[ ,3, drop=FALSE])\n\n\nbwplot(Value ~ Alg | GOF, data = td3, scale=list(relation=\"free\"), \n       as.table=T, layout=c(1,3), panel=my.boxpanel3,\n       ylim=list(c(0,1), c(-2,2), c(0,17)),\n       medians=R1.medians,\n       best=A.best)\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}