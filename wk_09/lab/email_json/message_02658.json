{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Ian Kennedy <ian_kennedy@hc-sc.gc.ca>", "subject": "[R] Reshape and column order", "body": "\nIf I try to reshape a data frame into a long format with more than one\ncolumn it seems to mix up the column headings (or the columns, depending on\nhow you look at it). For example:\n> d <-\ndata.frame(row=1:2,b.1=c(\"1b1\",\"2b1\"),b.2=c(\"1b2\",\"2b2\"),a.1=c(\"1a1\",\"2a1\"),a.2=c(\"1a2\",\"2a2\"))\n> d\n  row b.1 b.2 a.1 a.2\n1   1 1b1 1b2 1a1 1a2\n2   2 2b1 2b2 2a1 2a2\n\nIf I try reshape on this, the column headings are over the wrong columns:\n> reshape(d,direction=\"long\",idvar=\"row\",varying=2:5)\n    row time   b   a\n1.1   1    1 1a1 1b1\n2.1   2    1 2a1 2b1\n1.2   1    2 1a2 1b2\n2.2   2    2 2a2 2b2\n\nIf I reorder the columns, so the \"a\" columns come first, it reverses the\ncolumn names and gives the right result.\n> e <- d[,c(1,4,5,2,3)]\n> reshape(e,direction=\"long\",idvar=\"row\",varying=2:5)\n    row time   a   b\n1.1   1    1 1a1 1b1\n2.1   2    1 2a1 2b1\n1.2   1    2 1a2 1b2\n2.2   2    2 2a2 2b2\n\nI can also get the right result if I specify the \"varying\" parameter more\nexplicitly:\n>\nreshape(d,direction=\"long\",idvar=\"row\",varying=list(names(d)[2:3],names(d)[4:5]))\n    row time b.1 a.1\n1.1   1    1 1b1 1a1\n2.1   2    1 2b1 2a1\n1.2   1    2 1b2 1a2\n2.2   2    2 2b2 2a2\n\nI'm using R 2.4.1 on Windows XP.\n\nAm I doing something wrong? Is it supposed to work like this?\n\nThanks, Ian\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}