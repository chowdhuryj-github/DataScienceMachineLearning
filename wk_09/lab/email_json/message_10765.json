{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r22401 - in branches/SAMBA_3_0/source/script: .", "body": "Author: obnox\nDate: 2007-04-20 10:27:33 +0000 (Fri, 20 Apr 2007)\nNew Revision: 22401\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22401\n\nLog:\n\nAdd bzr revision+nick support to mkversion.sh.\n\nThe plan is to actually synchronize with SAMBA_4_0's mkversion.sh,\nwhich is more elaborate. But there are a few differences in \nbehaviour I still have to check. So I am cheching this here in for\na start...\n\nMichael\n\n\nModified:\n   branches/SAMBA_3_0/source/script/mkversion.sh\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/script/mkversion.sh\n===================================================================\n--- branches/SAMBA_3_0/source/script/mkversion.sh\t2007-04-20 07:36:21 UTC (rev 22400)\n+++ branches/SAMBA_3_0/source/script/mkversion.sh\t2007-04-20 10:27:33 UTC (rev 22401)\n@@ -82,6 +82,13 @@\n \telse\n \t    TMP_SVK_REVISION_STR=\"${TMP_REVISION}-${USER}@${HOSTNAME}\"\n \tfi\n+\tif test x\"${HAVESVK}\" = x\"no\";then\n+\t    HAVEBZR=no\n+\t    bzr revno > /dev/null 2>&1 && HAVEBZR=yes\n+\t    TMP_BZR_REVNO=`bzr revno 2> /dev/null`\n+\t    TMP_BZR_NICK=`bzr nick 2> /dev/null`\n+\t    TMP_BZR_REVISION_STR=\"${TMP_BZR_NICK}-${TMP_BZR_REVNO}\"\n+\tfi\n     fi\n \n     if test x\"${HAVESVN}\" = x\"yes\";then\n@@ -89,6 +96,8 @@\n \t    echo \"#define SAMBA_VERSION_SVN_REVISION ${TMP_REVISION}\" >> $OUTPUT_FILE\n     elif test x\"${HAVESVK}\" = x\"yes\";then\n \t    SAMBA_VERSION_STRING=\"${SAMBA_VERSION_STRING}-SVK-build-${TMP_SVK_REVISION_STR}\"\n+    elif test x\"${HAVEBZR}\" = x\"yes\";then\n+\t    SAMBA_VERSION_STRING=\"${SAMBA_VERSION_STRING}-BZR-build-${TMP_BZR_REVISION_STR}\"\n     else\n \t    SAMBA_VERSION_STRING=\"${SAMBA_VERSION_STRING}-SVN-build-UNKNOWN\"\n     fi\n\n"}