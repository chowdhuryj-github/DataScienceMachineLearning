{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Nitin Jain <nj7w@yahoo.com>", "subject": "[R] xyplot key using grid.text", "body": "Hello,\n\n\nI am trying to print the lm \ncoefficients using grid graphs (code below), and am getting all the coefficients \non top of each other.\n\n \n\nMy aim is to put them as legend, \nshowing both coefficients and mean values separated by colors as shown in \nxyplot.\n \n\ntestData <- data.frame(f1 = \nfactor(rep(LETTERS[1:5], each = 20)),\n\n                       f2 = \nfactor(rep(letters[6:7], 50)),\n\n                       x1 = \nrnorm(100, mean = 2, sd = 1),\n\n                       x2 = \nrnorm(100, mean = 10, sd = 4),\n\n                       x3 = \nrnorm(100, mean = 4, sd = 3),\n\n                       y = (1:50) + \nrnorm(50, sd = 3) + rep(c(-2, 2), 50))\n\n \n\n \n\ngrid.newpage()\n\ngrps <- factor(testData[, \n\"f2\"])\n\nxyplot( y ~ \nx1|f1,\n\n       \ngroups=grps,\n\n       panel=function(x, y, ...) \n{\n\n         panel.superpose(x, y, \n...)\n\n       \n},\n\n       panel.groups = function(x, y, \n...) {\n\n         fit.lm <- \nlm(y~x)\n\n         coef.fit <- \nround(coef(fit.lm)[-1], 2)\n\n         avg.y <- round(mean(y), \n2)\n\n         \npanel.abline(fit.lm)\n\n         panel.xyplot(x, y, \n...)\n\n         ## Add lm \ncoefficients:\n\n         grid.text(x= unit(0.1, \n\"npc\"),\n\n                   y= unit(seq(0.1, \nlength= length(levels(grps)), by =0.1),\n\n                     \n\"npc\"),\n\n                   label = \npaste(expression(beta), \"=\", coef.fit)\n\n                \n   ),\n##     Add mean values: (note that \"mu\" is not shown as symbol)\n\ngrid.text(x= unit(0.1, \n\"npc\"),\n\n\n                   y= unit(seq(0.9, \nlength= length(levels(grps)), by =-0.1),\n\n\n                     \n\"npc\"),\n\n\n                   label = \npaste(expression(mu), \"=\", avg.y)\n\n\n                \n   ),\n\n\n\n\n       \n},\n\n       ##  Key \n\n       key = \nsimpleKey(levels(grps),\n\n         columns = \n2,\n\n         space = \n\"bottom\",\n\n         points = \nTRUE,\n\n         lines = \nTRUE\n\n         \n),\n\n       ## \ngrid.legend()\n\n       data= \ntestData\n\n     )\n\n \n\n\n\nThanks.\n\n-NJ\n\n\n\n      ____________________________________________________________________________________\nPark yourself in front of a world of choices in alternative vehicles. Visit the Yahoo! Auto Green Center.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}