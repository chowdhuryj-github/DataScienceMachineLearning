{"category": "ham", "to_address": "Kai Blin <kai.blin@gmail.com>", "from_address": "\"Stefan (metze) Metzmacher\" <metze@samba.org>", "subject": "Re: Building libraries with the Samba4 build system", "body": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nKai Blin schrieb:\n> Index: nsswitch/config.m4\n> ===================================================================\n> --- nsswitch/config.m4\t(revision 23528)\n> +++ nsswitch/config.m4\t(working copy)\n> @@ -1 +1,25 @@\n>  AC_CHECK_HEADERS(nss.h nss_common.h ns_api.h )\n> +\n> +WINBIND_NSS=\"nsswitch/libnss_winbind.$SHLIBEXT\"\n> +dnl WINBIND_WINS_NSS=\"nsswitch/libnss_wins.$SHLIBEXT\"\n> +WINBIND_NSS_LDSHFLAGS=$LDSHFLAGS\n> +NSSSONAMEVERSIONSUFFIX=\"\"\n> +\n> +case \"$host_os\" in\n> +\t*linux*)\n> +\t\tWINBIND_NSS_EXTRA_OBJS=\"nsswitch/winbind_nss_linux.o\"\n> +\t\tSMB_ENABLE(nss_winbind, YES)\n> +\t;;\n> +\t*)\n> +\t\tWINBIND_NSS_EXTRA_OBJS=\"\"\n> +\t\tSMB_ENABLE(nss_winbind, NO)\n> +\t;;\n> +esac\n> +\n> +AC_SUBST(WINBIND_NSS)\n> +dnl AC_SUBST(WINBIND_WINS_NSS)\n> +AC_SUBST(WINBIND_NSS_LDSHFLAGS)\n> +AC_SUBST(WINBIND_NSS_EXTRA_OBJS)\n> +AC_SUBST(WINBIND_NSS_EXTRA_LIBS)\n> +AC_SUBST(NSSSONAMEVERSIONSUFFIX)\n> +\n> Index: nsswitch/config.mk\n> ===================================================================\n> --- nsswitch/config.mk\t(revision 23528)\n> +++ nsswitch/config.mk\t(working copy)\n> @@ -5,6 +5,14 @@\n>  OBJ_FILES = wb_common.o\n>  \n>  #################################\n> +# Start LIBRARY libnss_winbind\n> +[LIBRARY::nss_winbind]\n> +VERSION = 0.0.1\n> +SO_VERSION = 0\n> +DESCRIPTION = Name service switch library using winbind\n> +OBJ_FILES = $(WINBIND_NSS_EXTRA_OBJS)\n\nthis looks wrong you need to list the object files here.\n\nto make it more dependend on configure checks you could\nuse SMB_SUBSYSTEM(NSS_WINBIND_EXTRA,...) (see build/m4/public.m4) within\nnsswitch/config.m4 and use a PRIVATE_DEPENDENCIES = NSS_WINBIND_EXTRA\nwithin nsswitch/config.mk. Maybe we need to add a SMB_LIBRARY() macro...\n\nmetze\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.5 (GNU/Linux)\nComment: Using GnuPG with SUSE - http://enigmail.mozdev.org\n\niD8DBQFGgVvJm70gjA5TCD8RAiJgAJ9v3ZlAPRpC5sjjWf9D8+ZnPIdr3QCfWEWB\nCt+Z0AUV0yR1Ukv+jGFpBkA=\n=RJRp\n-----END PGP SIGNATURE-----\n\n"}