{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "shlomi lifshits <lifshits_il@yahoo.com>", "subject": "[R] Question regarding the mvtnorm R package", "body": "Hi,\n\nI am trying to compare two methods for the calculation of a trivariate normal cdf:\n\n1) \"direct\" - using the original covariance matrix\n2) \"indirect\" -  transforming the integration interval using the Mahalanobis transformation and then integrating as a standard random variable.\n\nThe following code demonstrates the two methods.\n\nUnfortunately, I get different results.\n\nAm I missing something?\n\nThanks in advance.\n\nShlomi Lifshits\nTel-Aviv University\n\n####################\n\nlibrary(mvtnorm)\n\n#create a symmetric positive definite matrix for the covariance matrix\nmy_mat<-matrix(data=c(1,2,3,0,0.1,0,0,0,0.1), nrow=3, ncol=3, byrow=TRUE)\ncovmat<-my_mat%*%t(my_mat)\n\n\n#calculate the Mahalanobis transformation \nspectral_dec<-eigen(covmat)\nnew_eigenval<-c(sqrt(spectral_dec$values[1]),sqrt(spectral_dec$values[2]),sqrt(spectral_dec$values[3]))\ncovmat_trans<-solve(spectral_dec$vectors%*%diag(new_eigenval)%*%t(spectral_dec$vectors))\n\n# integrate with the original limit\norig_limit<-c(-0.5,0.5,0.5)\na<-pmvnorm(lower=-Inf, upper=orig_limit, mean=rep(0, 3), sigma=covmat)\n\n#transform the limit and integrate\nnew_limit_raw<-covmat_trans%*%orig_limit\nnew_limit<-c(new_limit_raw[1,1],new_limit_raw[2,1],new_limit_raw[3,1])\nnew_sigma<-diag(3)\nb<-pmvnorm(lower=-Inf, upper=new_limit, mean=rep(0, 3), sigma=new_sigma)\n\n# a,b should be the same but they are not!!!?\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}