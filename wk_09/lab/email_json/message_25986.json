{"category": "ham", "to_address": "\"Adaikalavan Ramasamy\" <ramasamy@cancer.org.uk>", "from_address": "\"hadley wickham\" <h.wickham@gmail.com>", "subject": "Re: [R] Weighted least squares", "body": "On 5/9/07, Adaikalavan Ramasamy  wrote:\n> http://en.wikipedia.org/wiki/Weighted_least_squares gives a formulaic\n> description of what you have said.\n\nExcept it doesn't describe what I think is important in my case - how\ndo you calculate the degrees of freedom/n for weighted linear\nregression?\n\n> I believe the original poster has converted something like this\n>\n>         y         x\n>         0       1.1\n>         0       2.2\n>         0       2.2\n>         0       2.2\n>         1       3.3\n>         1       3.3\n>         2       4.4\n>          ...\n>\n> into something like the following\n>\n>         y         x     freq\n>         0       1.1        1\n>         0       2.2        3\n>         1       3.3        2\n>         2       4.4        1\n>          ...\n\nExactly!  Thanks for providing that example.\n\n>\n> Now, the variance of means of each row in table above is ZERO because\n> the individual elements that comprise each row are identical. Therefore\n> your method of using inverse-variance will not work here.\n>\n> Then is it valid then to use lm( y ~ x, weights=freq ) ?\n>\n> Regards, Adai\n>\n>\n>\n> S Ellison wrote:\n> > Hadley,\n> >\n> > You asked\n> >> .. what is the usual way to do a linear\n> >> regression when you have aggregated data?\n> >\n> > Least squares generally uses inverse variance weighting. For aggregated data fitted as mean values, you just need the variances for the _means_.\n> >\n> > So if you have individual means x_i and sd's s_i that arise from aggregated data with n_i observations in group i, the natural weighting is by inverse squared standard error of the mean. The appropriate weight for x_i would then be n_i/(s_i^2). In R, that's n/(s^2), as n and s would be vectors with the same length as x. If all the groups had the same variance, or nearly so, s is a scalar; if they have the same number of observations, n is a scalar.\n> >\n> > Of course, if they have the same variance and same number of observations, they all have the same weight and you needn't weight them at all: see previous posting!\n> >\n> > Steve E\n> >\n> >\n> >\n> > *******************************************************************\n> > This email and any attachments are confidential. Any use, co...{{dropped}}\n> >\n> > ______________________________________________\n> > R-help@stat.math.ethz.ch mailing list\n> > https://stat.ethz.ch/mailman/listinfo/r-help\n> > PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> > and provide commented, minimal, self-contained, reproducible code.\n> >\n> >\n> >\n>\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}