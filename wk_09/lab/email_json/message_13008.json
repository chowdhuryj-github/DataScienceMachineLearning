{"category": "ham", "to_address": "\"Alfonso Sammassimo\" <cincinattikid@bigpond.com>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] Help on manipulating a data frame", "body": "Do you mean you want to return the first row for each mont for\nwhich the value > 0?\n\nIn that case try this.  The first group of lines recreates your\ndata frame and calls it DF.  by causes f to operate on a subset of\nrows comprising one month extracting the first row for which\nthe value is positive and also adding in the week number.\ndo.call rbinds the results from each month altogether.\n\nInput <- \"2007-01-05 -1.52377151\n2007-01-12  1.04787390\n2007-01-19  0.61647047\n2007-01-26  1.87864283\n2007-02-02  0.54992405\n2007-02-09  1.96850069\n2007-02-16  0.26850159\n2007-02-23  1.56305144\n2007-03-02 -4.19500573\n2007-03-09  0.77127814\n2007-03-16  0.32387312\n2007-03-23  2.02163219\n2007-03-30  0.63175605\n2007-04-06  1.33346284\n2007-04-13  0.96021569\"\nDF <- read.table(textConnection(Input), col.names = c(\"Date\", \"Value\"),\n\tcolClasses = c(\"Date\", \"numeric\"))\n\nf <- function(x) cbind(x, Week = seq_len(nrow(x)))[which.max(x$Value > 0),]\ndo.call(\"rbind\", by(DF, format(DF$Date, \"%Y-%m\"), f))\n\nOn 4/22/07, Alfonso Sammassimo  wrote:\n> Hi R-experts,\n>\n>\n>\n> I have a large set of weekly data in this format:\n>\n>\n>\n> 2007-01-05 -1.52377151\n> 2007-01-12  1.04787390\n> 2007-01-19  0.61647047\n> 2007-01-26  1.87864283\n> 2007-02-02  0.54992405\n> 2007-02-09  1.96850069\n> 2007-02-16  0.26850159\n> 2007-02-23  1.56305144\n> 2007-03-02 -4.19500573\n> 2007-03-09  0.77127814\n> 2007-03-16  0.32387312\n> 2007-03-23  2.02163219\n> 2007-03-30  0.63175605\n> 2007-04-06  1.33346284\n> 2007-04-13  0.96021569\n>\n>\n>\n> How might this data be sorted to something like this?:\n>\n>\n>\n> Date               Week of Month     Value\n>\n> 2007-01-05          1                     -1.52377151\n> 2007-01-12          2                      1.04787390\n> 2007-01-19          3                      0.61647047\n> 2007-01-26          4                      1.87864283\n>\n> 2007-02-02          1                      0.54992405\n>\n>\n>\n> My aim is to return the last value of every month where the previous values\n> in that month were negative values, hence the need to split the data by\n> month. Any guide as to how this might this be possible without a loop?\n>\n>\n>\n> Any help would be much appreciated.\n>\n>\n>\n> Thanks,\n>\n>\n>\n> Alf Sammassimo\n>\n> Melbourne, Australia\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}