{"category": "ham", "to_address": "\"Peter Dalgaard\" <p.dalgaard@biostat.ku.dk>", "from_address": "\"Robert Wilkins\" <irishhacker@gmail.com>", "subject": "Re: [R] Tools For Preparing Data For Analysis", "body": "[ Arrggh, not reply , but reply to all , cross my fingers again , sorry Peter! ]\n\nHmm,\n\nI don't think you need a retain statement.\n\nif first.patientID ;\nor\nif last.patientID ;\n\nought to do it.\n\nIt's actually better than the Vilno version, I must admit, a bit more concise:\n\nif ( not firstrow(patientID) ) deleterow ;\n\nAh well.\n\n**********************************\nFor the folks asking for location of software ( I know posted it, but\nit didn't connect to the thread, and you get a huge number of posts\neach day , sorry):\n\nVilno , find at\nhttp://code.google.com/p/vilno\n\nDAP & PSPP,  find at\nhttp://directory.fsf.org/math/stats\n\nAwk, find at lots of places,\nhttp://www.gnu.org/software/gawk/gawk.html\n\nAnything else? DAP & PSPP are hard to find, I'm sure there's more out there!\nWhat about MDX? Nahh, not really the right problem domain.\nNobody uses MDX for this stuff.\n\n******************************************************\n\nIf my examples , using clinical trial data are boring and hard to\nunderstand for those who asked for examples\n( and presumably don't work in clinical trials) , let me\nknow. Some of these other examples I'm reading about are quite interesting.\nIt doesn't help that clinical trial databases cannot be public. Making\na fake database would take a lot of time.\nThe irony is , even with my deep understanding of data preparation in\nclinical trials,\nthe pharmas still don't want to give me a job ( because I was gone for\nmany years).\n\n********************************************************\nLet's see if this post works : thanks to the folks who gave me advice\non how to properly respond to a post within a  thread . ( Although the\nthread in my gmail account is only a subset of the posts visible in\nthe archives ). Crossing my fingers ....\n\nOn 6/10/07, Peter Dalgaard  wrote:\n> Spielas Bates wrote:\n> > Frank Harrell indicated that it is possible to do a lot of difficult\n> > data transformation within R itself if you try hard enough but that\n> > sometimes means working against the S language and its \"whole object\"\n> > view to accomplish what you want and it can require knowledge of\n> > subtle aspects of the S language.\n> >\n> Actually, I think Frank's point was subtly different: It is *because* of\n> the differences in view that it sometimes seems difficult to find the\n> way to do something in R that  is apparently straightforward in SAS.\n> I.e. the solutions exist and are often elegant, but may require some\n> lateral thinking.\n>\n> Case in point: Finding the first or the last observation for each\n> subject when there are multiple records for each subject. The SAS way\n> would be a datastep with IF-THEN-DELETE, and a RETAIN statement so that\n> you can compare the subject ID with the one from the previous record,\n> working with data that are sorted appropriately.\n>\n> You can do the same thing in R with a for loop, but there are better\n> ways e.g.\n> subset(df,!duplicated(ID)), and subset(df, rev(!duplicated(rev(ID))), or\n> maybe\n> do.call(\"rbind\",lapply(split(df,df$ID), head, 1)), resp. tail. Or\n> something involving aggregate(). (The latter approaches generalize\n> better to other within-subject functionals like cumulative doses, etc.).\n>\n> The hardest cases that I know of are the ones where you need to turn one\n> record into many, such as occurs in survival analysis with\n> time-dependent, piecewise constant covariates. This may require\n> \"transposing the problem\", i.e. for each  interval you find out which\n> subjects contribute and with what, whereas the SAS way would be a\n> within-subject loop over intervals containing an OUTPUT statement.\n>\n> Also, there are some really weird data formats, where e.g. the input\n> format is different in different records. Back in the 80's where\n> punched-card input was still common, it was quite popular to have one\n> card with background information on a patient plus several cards\n> detailing visits, and you'd get a stack of cards containing both kinds.\n> In R you would most likely split on the card type using grep() and then\n> read the two kinds separately and merge() them later.\n>\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}