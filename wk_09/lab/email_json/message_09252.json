{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "simo <idra@samba.org>", "subject": "Re: svn commit: samba r22342 - in branches/SAMBA_3_0_25/source:\n\tinclude nsswitch", "body": "\nI have not fixed all the problems I found yet, but this patch helped\na bit. I am investigating the Winbindd offline code some more,\nbecause I can reproduce a situation where if the DC is offline, on\nauthentication I get a username consisting only of the domain portion\nand a gid of 0. I am also investigating the situation when our clock\nis not in sync with that of the DC.\n\nSimo.\n\n\nOn Wed, 2007-04-18 at 20:50 +0000, idra@samba.org wrote:\n> Author: idra\n> Date: 2007-04-18 20:49:59 +0000 (Wed, 18 Apr 2007)\n> New Revision: 22342\n> \n> WebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22342\n> \n> Log:\n> \n> This patch tries to fix a number of problems with the offline code.\n> So far I have tested it only with idmap_tdb, idmap_ad testing is next.\n> \n> Fixes:\n> - The code returned an error on any idmap call if winbindd\n> was put offline before the idmap code was initialized.\n> - The code denied consulting any backend, even local ones\n> like idmap_tdb when offline, correct the situation by\n> handling offline decisions in the backends\n> \n> Simo.\n> \n> \n> Modified:\n>    branches/SAMBA_3_0_25/source/include/idmap.h\n>    branches/SAMBA_3_0_25/source/include/smb.h\n>    branches/SAMBA_3_0_25/source/nsswitch/idmap.c\n>    branches/SAMBA_3_0_25/source/nsswitch/idmap_ad.c\n>    branches/SAMBA_3_0_25/source/nsswitch/idmap_cache.c\n>    branches/SAMBA_3_0_25/source/nsswitch/idmap_ldap.c\n>    branches/SAMBA_3_0_25/source/nsswitch/idmap_nss.c\n>    branches/SAMBA_3_0_25/source/nsswitch/idmap_passdb.c\n>    branches/SAMBA_3_0_25/source/nsswitch/idmap_tdb.c\n> \n> \n> Changeset:\n> Sorry, the patch is too large (1193 lines) to include; please use WebSVN to see it!\n> WebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22342\n-- \nSimo Sorce\nSamba Team GPL Compliance Officer\nemail: idra@samba.org\nhttp://samba.org\n\n"}