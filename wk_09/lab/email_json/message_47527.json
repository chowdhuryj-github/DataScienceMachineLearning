{"category": "ham", "to_address": "\"Kevin Tew\" <tewk@tewk.com>", "from_address": "\"jerry gay\" <jerry.gay@gmail.com>", "subject": "perl6 likes the new find_vtable_meth_ns() (was Re: I Hate find_vtable_meth_ns())", "body": "On 6/13/07, Kevin Tew  wrote:\n> My patch only fails these tests.\n>\nthis patch is better now that you added the case chromatic missed.\n\nthe location of the free_list segfault that perl6 experiences now\noccurs when compiling the perl6 grammar, instead of when the test\nsuite was run. it looks similar (same line of code) but the backtrace\nis a bit different (note, no *_key_* function.) also, the pointer is\nnot at 0xffffffff, it's at a more reasonable 0x000022cc. note this\nmeans the bug is likely not due to an assignment of -1 somewhere it\nshouldn't have been. this has been suspected for a day or so, but now\nit's been confirmed.\n\ni'll continue to hunt. backtrace attached inline below.\n~jerry\n\n>\tlibparrot.dll!gc_ms_get_free_object(parrot_interp_t *\ninterp=0x00202dc8, Small_Object_Pool * pool=0x00203420)  Line 151 +\n0x6 bytes\tC\n \tlibparrot.dll!new_pmc_header(parrot_interp_t * interp=0x00202dc8,\nunsigned long flags=1024)  Line 216 + 0x10 bytes\tC\n \tlibparrot.dll!get_new_pmc_header(parrot_interp_t *\ninterp=0x00202dc8, long base_type=109, unsigned long flags=1024)  Line\n218 + 0xd bytes\tC\n \tlibparrot.dll!pmc_new_noinit(parrot_interp_t * interp=0x00202dc8,\nlong base_type=109)  Line 252 + 0xf bytes\tC\n \tlibparrot.dll!Parrot_new_p_i(long * cur_opcode=0x00c40310,\nparrot_interp_t * interp=0x00202dc8)  Line 72 + 0x19 bytes\tC\n \tlibparrot.dll!runops_slow_core(parrot_interp_t * interp=0x00202dc8,\nlong * pc=0x00c40310)  Line 184 + 0x18 bytes\tC\n \tlibparrot.dll!runops_int(parrot_interp_t * interp=0x00202dc8,\nunsigned int offset=3)  Line 779 + 0xb bytes\tC\n \tlibparrot.dll!runops(parrot_interp_t * interp=0x00202dc8, unsigned\nint offs=3)  Line 88 + 0xd bytes\tC\n \tlibparrot.dll!runops_args(parrot_interp_t * interp=0x00202dc8, PMC *\nsub=0x00bbc298, PMC * obj=0x0097b718, parrot_string_t *\nmeth=0x00000000, const char * sig=0x10291db4, char * ap=0x0017feac)\nLine 202 + 0xd bytes\tC\n \tlibparrot.dll!Parrot_runops_fromc_args(parrot_interp_t *\ninterp=0x00202dc8, PMC * sub=0x00bbc298, const char * sig=0x10291db4,\n...)  Line 304 + 0x1d bytes\tC\n \tlibparrot.dll!Parrot_runcode(parrot_interp_t * interp=0x00202dc8,\nint argc=4, char * * argv=0x00202ce4)  Line 803 + 0x16 bytes\tC\n \tlibparrot.dll!imcc_run_pbc(parrot_interp_t * interp=0x00202dc8, int\nobj_file=0, const char * output_file=0x00000000, int argc=4, char * *\nargv=0x00202ce4)  Line 569 + 0x11 bytes\tC\n \tlibparrot.dll!imcc_run(parrot_interp_t * interp=0x00202dc8, const\nchar * sourcefile=0x00202d1d, int argc=4, char * * argv=0x00202ce4)\nLine 766 + 0x19 bytes\tC\n \tparrot.exe!main(int argc=4, char * * argv=0x00202ce4)  Line 61 + 0x15 bytes\tC\n \tparrot.exe!__tmainCRTStartup()  Line 586 + 0x17 bytes\tC\n \tkernel32.dll!756519f1() \t\n \t[Frames below may be incorrect and/or missing, no symbols loaded for\nkernel32.dll]\n \tntdll.dll!773ed109()\n\n"}