{"category": "ham", "to_address": "livia <yn19832@msn.com>", "from_address": "Marc Schwartz <marc_schwartz@comcast.net>", "subject": "Re: [R] tapply histogram", "body": "On Fri, 2007-06-01 at 06:00 -0700, livia wrote:\n> Dear members,\n> \n> I would like to pass the histogram settings to each subset of the dataframe,\n> and generate a multiple figures graph.\n> \n> First, can anyone tell me how to generate a multiple figures environment? I\n> am trying \n> \n> mfrow=c(2,4) and nothing appears.\n> \n> Secondly, I want to pass the following function in tapply()\n> \n> hist(x, freq=FALSE)\n> lines(density(x), col=\"red\")\n> rug(x)\n> \n> how can I manage it?\n> \n> Many thanks\n\nIn this case, you would not want to use one of the *apply() family of\nfunctions. First, it does not save you anything and second, these\nfunctions are designed to return some type of R object, which you don't\nwant here.\n\nBetter to use a for() loop and if you wish, encapsulate the loop in a\nfunction. Something along the lines of the following, which actually\ndefines a new 'formula' method for hist() (though not fully tested):\n\n\nhist.formula <- function(formula, data, cols, rows, ...)\n{\n  DF <- model.frame(formula, data = data, ...)\n  DF.split <- split(DF[[1]], DF[[2]])\n  \n  par(mfrow = c(cols, rows))\n\n  for (i in names(DF.split))\n  {\n    Col <- DF.split[[i]]\n    hist(Col, freq = FALSE, main = i, ...)\n    lines(density(Col), col = \"red\")\n    rug(Col)\n  }\n}\n\n\n\nThe function will take the formula, create a data frame comprised of the\nformula terms and then loop over the list of data frames created by\nsplit(). \n\nSo we call it as follows:\n\n\n  hist(Sepal.Length ~ Species, data = iris, 2, 2)\n\n\nBased upon the formula specification, you will then get a matrix of\nhistograms, where each will be titled with the factor level used to\nsplit the original data frame.\n\nYou could further consolidate the function by implementing an automated\nmeans to determine the number of rows and columns required in the plot\nmatrix, but I'll leave that for you.\n\nSee ?model.frame and ?split\n\nHTH,\n\nMarc Schwartz\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}