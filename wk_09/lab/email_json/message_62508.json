{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "abartlet@samba.org", "subject": "svn commit: samba r23718 - in\n\tbranches/SAMBA_4_0/source/dsdb/samdb/ldb_modules: .", "body": "Author: abartlet\nDate: 2007-07-05 03:06:59 +0000 (Thu, 05 Jul 2007)\nNew Revision: 23718\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23718\n\nLog:\nMake Samba4 work against the LDAP backend again. \n\nWhen we set up the schema, we don't have a partitions container yet.\nThe LDAP error differs from that given by LDB, so I think we still\nhave some conformance work to do.\n\nAndrew Bartlett\n\nModified:\n   branches/SAMBA_4_0/source/dsdb/samdb/ldb_modules/naming_fsmo.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/dsdb/samdb/ldb_modules/naming_fsmo.c\n===================================================================\n--- branches/SAMBA_4_0/source/dsdb/samdb/ldb_modules/naming_fsmo.c\t2007-07-05 02:52:58 UTC (rev 23717)\n+++ branches/SAMBA_4_0/source/dsdb/samdb/ldb_modules/naming_fsmo.c\t2007-07-05 03:06:59 UTC (rev 23718)\n@@ -69,10 +69,16 @@\n \t\t\t LDB_SCOPE_BASE,\n \t\t\t NULL, naming_attrs,\n \t\t\t &naming_res);\n+\tif (ret == LDB_ERR_NO_SUCH_OBJECT) {\n+\t\tldb_debug(module->ldb, LDB_DEBUG_WARNING,\n+\t\t\t  \"naming_fsmo_init: no partitions dn present: (skip loading of naming contexts details)\\n\");\n+\t\ttalloc_free(mem_ctx);\n+\t\treturn ldb_next_init(module);\n+\t}\n \tif (ret != LDB_SUCCESS) {\n \t\tldb_debug_set(module->ldb, LDB_DEBUG_FATAL,\n-\t\t\t      \"naming_fsmo_init: failed to search the cross-ref container: %d:%s\\n\",\n-\t\t\t      ret, ldb_strerror(ret));\n+\t\t\t      \"naming_fsmo_init: failed to search the cross-ref container: %s: %s\\n\",\n+\t\t\t      ldb_strerror(ret), ldb_errstring(module->ldb));\n \t\ttalloc_free(mem_ctx);\n \t\treturn ret;\n \t}\n\n"}