{"category": "ham", "to_address": "owenman <solberg@speakeasy.net>", "from_address": "\"hadley wickham\" <h.wickham@gmail.com>", "subject": "Re: [R] Stacked barchart color", "body": "Hi Owen,\n\nThe bars should be stacked in the order specified by the factor.  Try\nusing factor(..., levels=...) to explicitly order them the way you\nwant.  If that doesn't work, please provide a small replicable example\nand I'll look into it.\n\nHadley\n\nOn 6/18/07, owenman  wrote:\n>\n> Hi Hadley,\n> Great, I am starting to get it.  It's working for me, but there is one more\n> thing I am having trouble with.  The ordering of the stacked bars seems to\n> be dictated by the name of the color, I guess because of the fill=color\n> argument in aes().  In other words, if I set up my colors like this:\n> y$color = c(\"gray1\",\"gray35\",\"gray45\",\"gray65\")  the bars get stacked in the\n> opposite order than if I set up the colors like this:  y$color =\n> c(\"gray65\",\"gray45\",\"gray35\",\"gray1\").  How can I control the order of the\n> bars independent of the name of the colors?   Thanks so much in advance!\n> Really neat package you've made.\n>\n> FYI, my plot command now looks like this:\n>\n> p = ggplot(y, aes(x=locus, y=Freq, fill=color))\n> p = p + geom_bar(position=\"fill\")\n> p = p + scale_fill_identity(labels=levels(y$Fnd), grob=\"tile\", name=\"Fnd\n> Results\")\n> p = p + coord_flip()\n>\n> And the data table is similar as before:\n>\n> > y\n>       Fnd locus        Freq  color\n> 1  signeg  DPB1 0.013071895  gray1\n> 2     neg  DPB1 0.581699346 gray35\n> 3     pos  DPB1 0.379084967 gray45\n> 4  sigpos  DPB1 0.026143791 gray65\n> 5  signeg  DPA1 0.068181818  gray1\n> 6     neg  DPA1 0.659090909 gray35\n> 7     pos  DPA1 0.250000000 gray45\n> 8  sigpos  DPA1 0.022727273 gray65\n>\n>\n>\n> hadley wrote:\n> >\n> > Hi Owen,\n> >\n> > The identity scale won't create a legend, unless you tell it what\n> > labels it should use - there's an example at\n> > http://had.co.nz/ggplot2/scale_identity.html.  Otherwise, if you have\n> > a continuous scale and you want something that works in black and\n> > white, p + scale_fill_gradient(low=\"white\", high=\"black\") might be\n> > easier.\n> >\n> > Hadley\n> >\n> >\n> >>\n> >> > y$color = factor(y$Fnd)\n> >> > y$color = c(\"black\",\"darkgray\",\"lightgray\",\"white\")\n> >> > y\n> >>       Fnd locus        Freq color\n> >> 1  signeg     A 0.087248322     black\n> >> 2     neg     A 0.711409396  darkgray\n> >> 3     pos     A 0.201342282 lightgray\n> >> 4  sigpos     A 0.000000000     white\n> >> 5  signeg     C 0.320754717     black\n> >> 6     neg     C 0.603773585  darkgray\n> >> 7     pos     C 0.075471698 lightgray\n> >> 8  sigpos     C 0.000000000     white\n> >> 9  signeg     B 0.157534247     black\n> >> 10    neg     B 0.732876712  darkgray\n> >> 11    pos     B 0.109589041 lightgray\n> >> 12 sigpos     B 0.000000000     white\n> >>\n> >> > p = ggplot(y, aes(x=locus, y=Freq, fill=color)) +\n> >> > geom_bar(position=\"fill\") + scale_fill_identity()\n> >> > p\n> >>\n> >>\n> >>\n> >>\n> >> hadley wrote:\n> >> >\n> >> >\n> >> > Hi Dieter,\n> >> >\n> >> > You can do this with ggplot2 (http://had.co.nz/ggplot2) as follows:\n> >> >\n> >> > library(ggplot2)\n> >> >\n> >> > barley1 <- subset(barley, site==\"Grand Rapids\" & variety %in%\n> >> > c(\"Velvet\",\"Peatland\"))\n> >> > barley1[] <- lapply(barley1, \"[\", drop=TRUE)\n> >> >\n> >> > qplot(variety, yield, data=barley1, geom=\"bar\", stat=\"identity\",\n> >> > fill=factor(year))\n> >> >\n> >> > barley1$fill <- c(\"red\",\"green\",\"blue\",\"gray\")\n> >> > qplot(variety, yield, data=barley1, geom=\"bar\", stat=\"identity\",\n> >> > fill=fill) + scale_fill_identity()\n> >> >\n> >> > See http://had.co.nz/ggplot2/scale_identity.html and\n> >> > http://had.co.nz/ggplot2/position_stack.html for more details.\n> >> >\n> >> > Hadley\n> >> >\n> >> >\n> >>\n> >>\n> >> --\n> >> View this message in context:\n> >> http://www.nabble.com/Stacked-barchart-color-tf3909162.html#a11149419\n> >> Sent from the R help mailing list archive at Nabble.com.\n> >>\n> >>\n> >> ______________________________________________\n> >> R-help@stat.math.ethz.ch mailing list\n> >> https://stat.ethz.ch/mailman/listinfo/r-help\n> >> PLEASE do read the posting guide\n> >> http://www.R-project.org/posting-guide.html\n> >> and provide commented, minimal, self-contained, reproducible code.\n> >>\n> >\n> > ______________________________________________\n> > R-help@stat.math.ethz.ch mailing list\n> > https://stat.ethz.ch/mailman/listinfo/r-help\n> > PLEASE do read the posting guide\n> > http://www.R-project.org/posting-guide.html\n> > and provide commented, minimal, self-contained, reproducible code.\n> >\n> >\n>\n>\n> --\n> View this message in context: http://www.nabble.com/Stacked-barchart-color-tf3909162.html#a11182581\n>\n> Sent from the R help mailing list archive at Nabble.com.\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}