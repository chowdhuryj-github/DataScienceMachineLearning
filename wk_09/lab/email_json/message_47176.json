{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r23463 - in\n\tbranches/SAMBA_3_0_26/source/registry: .", "body": "Author: obnox\nDate: 2007-06-13 10:40:31 +0000 (Wed, 13 Jun 2007)\nNew Revision: 23463\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23463\n\nLog:\nMerge r19853 and r19858 from 3_0:\n\nfix a memleak, add a const, update a link\n\n\nModified:\n   branches/SAMBA_3_0_26/source/registry/reg_perfcount.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0_26/source/registry/reg_perfcount.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/registry/reg_perfcount.c\t2007-06-13 10:32:57 UTC (rev 23462)\n+++ branches/SAMBA_3_0_26/source/registry/reg_perfcount.c\t2007-06-13 10:40:31 UTC (rev 23463)\n@@ -358,6 +358,7 @@\n     \n \tmemset(buf, 0, PERFCOUNT_MAX_LEN);\n \tmemcpy(buf, data.dptr, data.dsize);\n+\tSAFE_FREE(data.dptr);\n \treturn (uint32)atoi(buf);\n }\n \n@@ -1321,11 +1322,15 @@\n /*********************************************************************\n *********************************************************************/\n \n-WERROR reg_perfcount_get_hkpd(prs_struct *ps, uint32 max_buf_size, uint32 *outbuf_len, char *object_ids)\n+WERROR reg_perfcount_get_hkpd(prs_struct *ps, uint32 max_buf_size, uint32 *outbuf_len, const char *object_ids)\n {\n \t/*\n \t * For a detailed description of the layout of this structure,\n \t * see http://msdn.microsoft.com/library/default.asp?url=/library/en-us/perfmon/base/performance_data_format.asp\n+\t *\n+\t * By 2006-11-23 this link did not work anymore, I found something\n+\t * promising under\n+\t * http://msdn2.microsoft.com/en-us/library/aa373105.aspx -- vl\n \t */\n \tPERF_DATA_BLOCK block;\n \tuint32 buffer_size, base_index; \n\n"}