{"category": "ham", "to_address": "debian-mirrors@lists.debian.org", "from_address": "carlos@fisica.ufpr.br (Carlos Carvalho)", "subject": "Re: Mirroring ISOs", "body": "Jean-Francois Chevrette (mirrors@iweb.ca) wrote on 9 April 2007 11:40:\n >Simon Paillard wrote:\n >> On Mon, Apr 09, 2007 at 08:43:07AM -0400, Jean-Francois Chevrette wrote:\n >>> Hi,\n >>>\n >>> does anyone have a straightforward guide on how to use jigdo to build\n >>> and mirror ISOs? I've been reading both jigdo documentation and debian's\n >>> webpage on the subjet and it just won't work.\n >> \n >> Maybe with this one : http://www.debian.org/CD/mirroring/#jigdomirror\n >> and the related links ?\n >\n >Yes I've been using the suggested scripts however there appears to be a \n >problem with the template checksums.\n >\n > From what I've read these jigdo checksum errors are normal when there's \n >a new release?\n\nNo, it's a bug in jigdo-file. To workaround it put this\n\njigdoFile=\"jigdo-file --cache=$tmpDir/jigdo-cache.db --cache-expiry=1w --report=noprogress\"\n\nin jigdo-mirror.conf.in. It gets slower but works. This is what I sent\nyesterday to the debian-cd mailing list:\n\nDate: Sun, 8 Apr 2007 17:37:22 -0300\nTo: debian-cd@lists.debian.org\nSubject: followup: jigdo template mdsum mismatch??\nX-Mailer: VM 7.19 under Emacs 21.4.1\n\nLooking at this portion of jigdo-mirror,\n\n    # If possible, check md5sum of template data\n    if test \"$templateMD5\"; then\n        set -- `$jigdoFile md5sum --report=quiet \"template\"`\n        if test \"$1\" = \"$templateMD5\"; then\n            log \"    Template checksum is correct\"\n        else\n            log \"    Error - template checksum mismatch\"\n            exitCode=1\n            rm -f \"image\" \"template\"\n            return 0\n        fi\n    else\n\n$jigdoFile is \"jigdo-file --cache=$tmpDir/jigdo-cache.db\n--cache-expiry=1w --report=noprogress --no-check-files\",\n\nas usual (this is the default in jigdo-mirror). However when used with\n--no-check-files jigdo-file does NOT produce any md5sum! Taking a\ntrace of jigdo-mirror I get this:\n\n+ test OLshs7sHh08k63h8bLp8-Q   <-- This is the md5sum of the template,\n\n++ jigdo-file --cache=/home/debian-cd-sync/alpha.cd/jigdo-cache.db --cache-expir\ny=1w --report=noprogress --no-check-files md5sum --report=quiet template\n+ set --\n+ test '' = OLshs7sHh08k63h8bLp8-Q\n+ log '    Error - template checksum mismatch'\n\nThis shows that jigdo-file is returning an empty checksum. Running\nthe command by hand does produce nothing, with an exit status of zero.\nRemoving the --no-check-files argument yields the correct checksum.\n\nThis is a bug in jigdo-file, for not ignoring the option when used\nwith a md5sum command, since the man page says \"All options are\nsilently ignored if they are not applicable to the current command.\"\n\n\n-- \nTo UNSUBSCRIBE, email to debian-mirrors-REQUEST@lists.debian.org\nwith a subject of \"unsubscribe\". Trouble? Contact listmaster@lists.debian.org\n\n"}