{"category": "ham", "to_address": "Hans-Peter <gchappi@gmail.com>", "from_address": "\"Alberto Monteiro\" <albmont@centroin.com.br>", "subject": "Re: [R] importing excel-file", "body": "Hans-Peter wrote:\n> \n>> I can't call read.xls while Excel is opening the xls file.\n>> R crashes and must be aborted.\n> \n> Could not reproduce here (Win2000, Excel 2003, R 2.4.1 and\n> 2.5.0.alpha). Who knows...\n>\nThis is Windows XP, Excel 2003, R 2.4.1.\n\n> but I cannot think of anything that could\n> cause such a problem: xlsReadWrite works on the plain file (Excel is\n> not even needed), doesn't lock the file and, if there were problems,\n> handles eventual exceptions before leaving the DLL. If you have a\n> reproducible test case I would be very interested in it.\n>\nMaybe the problem is with Windows XP. I know that it locks some\nfiles, even when I open for reading. For example, if I open 'test.xls'\nfile, then I can't issue the DOS command 'copy test.xls new_test.xls'.\n \n> ...but the following should make you happy too:\n> \n> test9 <- read.xls( filename, sheet = \"sheet name\", rowNames = FALSE,\n> dateTimeAs = \"isodatetime\" )\n> \nI added colClasses = \"double\", and now it works - but I lose all\nstrings, that become NAs (they don't matter - maybe if they matter,\nI just have to call read.xls twice). Without colClasses = \"double\", \nthe numbers become meaningless stuff.\n\nOTOH, the dates aren't rendered as dates in either case, but using\ncolClasses=\"double\", they are something that be made into dates, with\n\n  as.POSIXlt(\"1899-12-30\", \"GMT\") + test9[100:120,1] * 86400\n\nAlberto Monteiro\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}