{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "denis lalountas <dlalountas@yahoo.com>", "subject": "[R] WEIBULL FRAILTY MODEL HELP", "body": "Dear R users,\nI try to write an  rcode for a paranetric weibull model with unobserved heterogeneity. \nThe data I have are giuven below.\n( The data comes from Keiding and Klein artricle published in\nthe Statistics in Medicine 1996) .\nWhile the simple weibull model runs perfectly ( I get -2*loglikelihood  1093,905), the \nweibull frailty model does not run well.\n  The code I write is :\nlikelihood.weibul <- function(p) {\ncumhaz <- exp(x1*p[4])*(timeto^p[2])/p[1]\ncumhaz <- sum(cumhaz)\nlnhaz <- (x1*p[4]+log((p[2]*timeto^(p[2]-1))/p[1]))*stat\nlik <- p[3]*log(p[3])-log(gamma(p[3]))+sum(lnhaz)+\nlog(gamma(di+p[3]))-(p[3]+di)*log(p[3]+cumhaz)\n-2*lik\n}\ndi <-sum(stat)\ninitial<-c(500000,2.8,.5,1.8)\n# initial 1/exp(constant)\nt<-nlm(likelihood.weibul,initial,print.level=1,hessian=T)\n   \n  Best Regards,\nDenis Lalountas\nUniversity of Patras\n  \ninsem<-read.table(\"Melanoma.txt\",header=T)\nid <- insem$id\ntimeto<-insem$time\nstat<-insem$status\nx1<-insem$ulcer\nx2 <-insem$thickness\nx2 <- log(x2)\n     id time status sex age year thickness ulcer\n1     1   10      0   1  76 1972      6.76     1\n2     2   30      0   1  56 1968      0.65     0\n3     3   35      0   1  41 1977      1.34     0\n4     4   99      0   0  71 1968      2.90     0\n5     5  185      1   1  52 1965     12.08     1\n6     6  204      1   1  28 1971      4.84     1\n7     7  210      1   1  77 1972      5.16     1\n8     8  232      0   0  60 1974      3.22     1\n9     9  232      1   1  49 1968     12.88     1\n10   10  279      1   0  68 1971      7.41     1\n11   11  295      1   0  53 1969      4.19     1\n12   12  355      0   0  64 1972      0.16     1\n13   13  386      1   0  68 1965      3.87     1\n14   14  426      1   1  63 1970      4.84     1\n15   15  469      1   0  14 1969      2.42     1\n16   16  493      0   1  72 1971     12.56     1\n17   17  529      1   1  46 1971      5.80     1\n18   18  621      1   1  72 1972      7.06     1\n19   19  629      1   1  95 1968      5.48     1\n20   20  659      1   1  54 1972      7.73     1\n21   21  667      1   0  89 1968     13.85     1\n22   22  718      1   1  25 1967      2.34     1\n23   23  752      1   1  37 1973      4.19     1\n24   24  779      1   1  43 1967      4.04     1\n25   25  793      1   1  68 1970      4.84     1\n26   26  817      1   0  67 1966      0.32     0\n27   27  826      0   0  86 1965      8.54     1\n28   28  833      1   0  56 1971      2.58     1\n29   29  858      1   0  16 1967      3.56     0\n30   30  869      1   0  42 1965      3.54     0\n31   31  872      1   0  65 1968      0.97     0\n32   32  967      1   1  52 1970      4.83     1\n33   33  977      1   1  58 1967      1.62     1\n34   34  982      1   0  60 1970      6.44     1\n35   35 1041      1   1  68 1967     14.66     0\n36   36 1055      1   0  75 1967      2.58     1\n37   37 1062      1   1  19 1966      3.87     1\n38   38 1075      1   1  66 1971      3.54     1\n39   39 1156      1   0  56 1970      1.34     1\n40   40 1228      1   1  46 1973      2.24     1\n41   41 1252      1   0  58 1971      3.87     1\n42   42 1271      1   0  74 1971      3.54     1\n43   43 1312      1   0  65 1970     17.42     1\n44   44 1427      0   1  64 1972      1.29     0\n45   45 1435      1   1  27 1969      3.22     0\n46   46 1499      0   1  73 1973      1.29     0\n47   47 1506      1   1  56 1970      4.51     1\n48   48 1508      0   1  63 1973      8.38     1\n49   49 1510      0   0  69 1973      1.94     0\n50   50 1512      0   0  77 1973      0.16     0\n51   51 1516      1   1  80 1968      2.58     1\n52   52 1525      0   0  76 1970      1.29     1\n53   53 1542      0   0  65 1973      0.16     0\n54   54 1548      1   0  61 1972      1.62     0\n55   55 1557      0   0  26 1973      1.29     0\n56   56 1560      1   0  57 1973      2.10     0\n57   57 1563      0   0  45 1973      0.32     0\n58   58 1584      1   1  31 1970      0.81     0\n59   59 1605      0   0  36 1973      1.13     0\n60   60 1621      1   0  46 1972      5.16     1\n61   61 1627      0   0  43 1973      1.62     0\n62   62 1634      0   0  68 1973      1.37     0\n63   63 1641      0   1  57 1973      0.24     0\n64   64 1641      0   0  57 1973      0.81     0\n65   65 1648      0   0  55 1973      1.29     0\n66   66 1652      0   0  58 1973      1.29     0\n67   67 1654      0   1  20 1973      0.97     0\n68   68 1654      0   0  67 1973      1.13     0\n69   69 1667      1   0  44 1971      5.80     1\n70   70 1678      0   0  59 1973      1.29     0\n71   71 1685      0   0  32 1973      0.48     0\n72   72 1690      1   1  83 1971      1.62     0\n73   73 1710      0   0  55 1973      2.26     0\n74   74 1710      0   1  15 1973      0.58     0\n75   75 1726      1   0  58 1970      0.97     1\n76   76 1745      0   0  47 1973      2.58     1\n77   77 1762      0   0  54 1973      0.81     0\n78   78 1779      0   1  55 1973      3.54     1\n79   79 1787      0   1  38 1973      0.97     0\n80   80 1787      0   0  41 1973      1.78     1\n81   81 1793      0   0  56 1973      1.94     0\n82   82 1804      0   0  48 1973      1.29     0\n83   83 1812      0   1  44 1973      3.22     1\n84   84 1836      0   0  70 1972      1.53     0\n85   85 1839      0   0  40 1972      1.29     0\n86   86 1839      0   1  53 1972      1.62     1\n87   87 1854      0   0  65 1972      1.62     1\n88   88 1856      0   1  54 1972      0.32     0\n89   89 1860      0   1  71 1969      4.84     1\n90   90 1864      0   0  49 1972      1.29     0\n91   91 1899      0   0  55 1972      0.97     0\n92   92 1914      0   0  69 1972      3.06     0\n93   93 1919      0   1  83 1972      3.54     0\n94   94 1920      0   1  60 1972      1.62     1\n95   95 1927      0   1  40 1972      2.58     1\n96   96 1933      1   0  77 1972      1.94     0\n97   97 1942      0   0  35 1972      0.81     0\n98   98 1955      0   0  46 1972      7.73     1\n99   99 1956      0   0  34 1972      0.97     0\n100 100 1958      0   0  69 1972     12.88     0\n101 101 1963      0   0  60 1972      2.58     0\n102 102 1970      0   1  84 1972      4.09     1\n103 103 2005      0   0  66 1972      0.64     0\n104 104 2007      0   1  56 1972      0.97     0\n105 105 2011      0   0  75 1972      3.22     1\n106 106 2024      0   0  36 1972      1.62     0\n107 107 2028      0   1  52 1972      3.87     1\n108 108 2038      0   0  58 1972      0.32     1\n109 109 2056      0   0  39 1972      0.32     0\n110 110 2059      0   1  68 1972      3.22     1\n111 111 2061      1   1  71 1968      2.26     0\n112 112 2062      1   0  52 1965      3.06     0\n113 113 2075      0   1  55 1972      2.58     1\n114 114 2085      0   0  66 1970      0.65     0\n115 115 2102      0   1  35 1972      1.13     0\n116 116 2103      1   1  44 1966      0.81     0\n117 117 2104      0   0  72 1972      0.97     0\n118 118 2108      1   0  58 1969      1.76     1\n119 119 2112      0   0  54 1972      1.94     1\n120 120 2150      0   0  33 1972      0.65     0\n121 121 2156      0   0  45 1972      0.97     0\n122 122 2165      0   1  62 1972      5.64     0\n123 123 2209      0   0  72 1971      9.66     0\n124 124 2227      0   0  51 1971      0.10     0\n125 125 2227      0   1  77 1971      5.48     1\n126 126 2256      1   0  43 1971      2.26     1\n127 127 2264      0   0  65 1971      4.83     1\n128 128 2339      0   0  63 1971      0.97     0\n129 129 2361      0   1  60 1971      0.97     0\n130 130 2387      0   0  50 1971      5.16     1\n131 131 2388      1   1  40 1966      0.81     0\n132 132 2403      0   0  67 1971      2.90     1\n133 133 2426      0   0  69 1971      3.87     0\n134 134 2426      0   0  74 1971      1.94     1\n135 135 2431      0   0  49 1971      0.16     0\n136 136 2460      0   0  47 1971      0.64     0\n137 137 2467      1   0  42 1965      2.26     1\n138 138 2492      0   0  54 1971      1.45     0\n139 139 2493      0   1  72 1971      4.82     1\n140 140 2521      0   0  45 1971      1.29     1\n141 141 2542      0   1  67 1971      7.89     1\n142 142 2559      0   0  48 1970      0.81     1\n143 143 2565      1   1  34 1970      3.54     1\n144 144 2570      0   0  44 1970      1.29     0\n145 145 2660      0   0  31 1970      0.64     0\n146 146 2666      0   0  42 1970      3.22     1\n147 147 2676      0   0  24 1970      1.45     1\n148 148 2738      0   0  58 1970      0.48     0\n149 149 2782      1   1  78 1969      1.94     0\n150 150 2787      0   1  62 1970      0.16     0\n151 151 2984      0   1  70 1969      0.16     0\n152 152 3032      0   0  35 1969      1.29     0\n153 153 3040      0   0  61 1969      1.94     0\n154 154 3042      1   0  54 1967      3.54     1\n155 155 3067      0   0  29 1969      0.81     0\n156 156 3079      0   1  64 1969      0.65     0\n157 157 3101      0   1  47 1969      7.09     0\n158 158 3144      0   1  62 1969      0.16     0\n159 159 3152      0   0  32 1969      1.62     0\n160 160 3154      0   1  49 1969      1.62     0\n161 161 3180      0   0  25 1969      1.29     0\n162 162 3182      0   1  49 1966      6.12     0\n163 163 3185      0   0  64 1969      0.48     0\n164 164 3199      0   0  36 1969      0.64     0\n165 165 3228      0   0  58 1969      3.22     1\n166 166 3229      0   0  37 1969      1.94     0\n167 167 3278      0   1  54 1969      2.58     0\n168 168 3297      0   0  61 1968      2.58     1\n169 169 3328      0   1  31 1968      0.81     0\n170 170 3330      0   1  61 1968      0.81     1\n171 171 3338      1   0  60 1967      3.22     1\n172 172 3383      0   0  43 1968      0.32     0\n173 173 3384      0   0  68 1968      3.22     1\n174 174 3385      0   0   4 1968      2.74     0\n175 175 3388      0   1  60 1968      4.84     1\n176 176 3402      0   1  50 1968      1.62     0\n177 177 3441      0   0  20 1968      0.65     0\n178 178 3458      0   0  54 1967      1.45     0\n179 179 3459      0   0  29 1968      0.65     0\n180 180 3459      0   1  56 1968      1.29     1\n181 181 3476      0   0  60 1968      1.62     0\n182 182 3523      0   0  46 1968      3.54     0\n183 183 3667      0   0  42 1967      3.22     0\n184 184 3695      0   0  34 1967      0.65     0\n185 185 3695      0   0  56 1967      1.03     0\n186 186 3776      0   1  12 1967      7.09     1\n187 187 3776      0   0  21 1967      1.29     1\n188 188 3830      0   1  46 1967      0.65     0\n189 189 3856      0   0  49 1967      1.78     0\n190 190 3872      0   0  35 1967     12.24     1\n191 191 3909      0   1  42 1967      8.06     1\n192 192 3968      0   0  47 1967      0.81     0\n193 193 4001      0   0  69 1967      2.10     0\n194 194 4103      0   0  52 1966      3.87     0\n195 195 4119      0   1  52 1966      0.65     0\n196 196 4124      0   0  30 1966      1.94     1\n197 197 4207      0   1  22 1966      0.65     0\n198 198 4310      0   1  55 1966      2.10     0\n199 199 4390      0   0  26 1965      1.94     1\n200 200 4479      0   0  19 1965      1.13     1\n201 201 4492      0   1  29 1965      7.06     1\n202 202 4668      0   0  40 1965      6.12     0\n203 203 4688      0   0  42 1965      0.48     0\n204 204 4926      0   0  50 1964      2.26     0\n205 205 5565      0   0  41 1962      2.90     0\n\n       \n---------------------------------\nBoardwalk for $500? In 2007? Ha! \n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}