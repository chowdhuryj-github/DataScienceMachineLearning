{"category": "ham", "to_address": "Ravi Varadhan <rvaradhan@jhmi.edu>", "from_address": "Spencer Graves <spencer.graves@pdf.com>", "subject": "Re: [R] Optim", "body": "Hello, Wassim: \n\nGENERAL THEORY: \n\n      To expand on Ravi's comments, what can you tell us about the \nproblem?  For example, if you have only 1 parameter, you can plot the \nlog(likelihood) over a wide enough range so you can be confident you've \ncovered all local maxima.  Then pick the max of the local maxima.  If \nthere are only 2 parameters, you can make contour plots. \n\n      If this is not convenient, what else can you tell us about the \nproblem?  For example, why are there local maxima?  If there are \nidentifiability issues as Ravi suggested, what can you do to \ncharacterize and eliminate them -- using either constraints or \ntransformations? \n\n      Also, can you find an upper bound with a unique maximum?  If yes, \nand if you've found one local maximum for your likelihood, you could (in \ntheory at least) construct the set of all points where the upper bound \nis above the local max you have.   \n\n\nPRAGMATICS IN R: \n\n      If you don't have time or knowledge to do something more \nsophisticated, you can try starting 'optim' at multiple places, store \nthe answers and pick the winner. \n\n      Also, have you considered method = 'SANN'?  Simulated Annealing is \ndesigned specifically to produce something sensible with nasty \nproblems.  It won't guarantee that you've found the optimal, but it \nmight get you close. \n\n      For functions that are poorly conditioned, I've had reasonable \nluck using different methods, using the optimal found by one method as \nstarting values for another method.  Also consider 'nlminb'. \n\n      hope this helps. \n      spencer graves\n\nRavi Varadhan wrote:\n> Let us first assume that you have enumerated all the local maxima, which is\n> by no means a trivial thing to assure.  How different are the likelihood\n> values?  If they are significantly different, then take the parameter\n> estimates corresponding to the largest likelihood.  If they are not\n> \"significantly\" different but the corresponding parameter estimates differ\n> widely, then you may have identifiability issues.  \n>\n> Ravi.\n>\n> ----------------------------------------------------------------------------\n> -------\n>\n> Ravi Varadhan, Ph.D.\n>\n> Assistant Professor, The Center on Aging and Health\n>\n> Division of Geriatric Medicine and Gerontology \n>\n> Johns Hopkins University\n>\n> Ph: (410) 502-2619\n>\n> Fax: (410) 614-9625\n>\n> Email: rvaradhan@jhmi.edu\n>\n> Webpage:  http://www.jhsph.edu/agingandhealth/People/Faculty/Varadhan.html\n>\n>  \n>\n> ----------------------------------------------------------------------------\n> --------\n>\n>\n> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch\n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Wassim Kamoum\n> Sent: Thursday, May 10, 2007 3:46 PM\n> To: r-help@stat.math.ethz.ch\n> Subject: [R] Optim\n>\n> Hello, \n>   I'm maximizing a likelihood function with the function \"optim\", but for\n> different intial parameters (in the input of the optim funtion) , I found\n> different value for the likelihood function and the parameters estimates,\n> the causes is that the algorithm has not found the global maximum for the\n> function but only a local maximum. What must I do to obtain the global\n> maximum for the likelihood function?\n>   Thanks\n>\n>  \t\t\n> ---------------------------------\n>\n> \t[[alternative HTML version deleted]]\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}