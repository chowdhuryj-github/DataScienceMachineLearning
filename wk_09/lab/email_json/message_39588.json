{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "new ruser <newruser@yahoo.com>", "subject": "[R] loading several \"samples\" of data from hard-drive, run \"lm\",\n\t\"rlm\", etc, save results in a list", "body": "I have many \"sample\" datasets (e.g. sample 5, sample 6, etc), each identified by a number as a suffix.  These datasets are saved as individual R objects on my hard drive. (e.g.\"Wind.5.r\" . \"Wind.6.r\",\"Solar.5.r\",\"Solar.6.r\")  For example purposes, I have written code that creates similar data files using the \"airquality\" dataset. (see below)\n\n#this creates my sample data files\nlibrary(datasets)\ngetwd() #fyi\n\nfor(m in 5:9) {\ntempdata=subset(airquality,Month==m)\nfor (col in 1:4){\ntempdata2 = tempdata[col]\ntempname=paste(names(airquality)[col],m,sep=\".\")\nassign(tempname,tempdata2,pos=.GlobalEnv ) \nsave( list=tempname , file = paste(tempname,\".r\",sep=\"\" ) )\nrm(tempdata2,list=tempname,tempname)\n}\nrm(tempdata,col,m)\n}\n\n\n \n(While it might be possible to combine all the data into one large R-object, I have chosen not to do so.  Due to the large size of my datasets, and the way they are organized, I feels it does make sense to keep them as individual files.)\n\nI wish to load several variables from each \"sample\", to perform a regression using the \"lm\" function, and to then save the all the regressions as objects in a list.\n\nHere is the code I have written.  Is there a \"better/simpler\" way to do this? (Ideally, I'd like the model I specify to be flexible, and to be able to use not only lm, but also rlm, etc.  (I have simplified my code for this example, but I think this repasts the essential parts of what I am trying to accomplish.) )\n\n#my code to run a regression for each \"sample\" (i.e.\"samples\" 5,6,7,8,& 9), \n#this saves the regression results in a list called \"results\"\ny='Ozone'\nx=c('Wind','Temp')\n\nresults=list(NULL)\n\nfor (i in 5:9) {\nload(file = paste(y,i,\"r\" ,sep=\".\"), envir = .GlobalEnv)\ny1=get(paste(y,i,sep=\".\"))\n\nfor (d in 1:length(x)) {\nload(file = paste(x[d],i,\"r\" ,sep=\".\"), envir = .GlobalEnv)\nassign(paste(\"x\",d,sep=\"\"),get(paste(x[d],i,sep=\".\") ))\n} #end d loop\n\nreg <- lm(y1[,1]~x1[,1]+x2[,1])\nresults[i-5] <- list(reg)\nnames(results)[i-5] <- i\n#need to add a line to remove any data files loaded\n}\n\nsummary(results[[1]])\nsummary(results[[2]])\n\nlapply(results,summary)\n\n\n       \n---------------------------------\n\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}