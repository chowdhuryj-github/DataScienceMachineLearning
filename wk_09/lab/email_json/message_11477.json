{"category": "ham", "to_address": "gecko951 <ben.lairson@gmail.com>", "from_address": "Jeffrey Horner <jeff.horner@vanderbilt.edu>", "subject": "Re: [R] Using R to create pdf's from each file in a directory", "body": "gecko951 wrote:\n> The Platform I am using R on is RHEL3.  I run a bash script that collects\n> data into many CSV files and have been processing them one at a time on my\n> local machine with an excel macro.  I would like to use R to take data\n> points from each of the CSV files and create line graphs in PDF format\n> because it will save me ALOT of time.  I am able to successfully do this\n> when I call the file name directly...however my script bombs when I try to\n> do multiple files.  I would like the created pdf's to have the same filename\n> as the original csv files.  I have looked quite a bit and not found much\n> help on \"batch processing\" an entire directory.  My current code is as\n> follows:\n> \n> list <- dir(\"/tmp/data\")\n> for(x in list){\n> d <- read.table(x, sep=\"\\t\", header=TRUE) # read data\n> pdf(\"/tmp/graph/x.pdf\")                              # file for graph\n> plot(d$BlockSeqNum, d$MBs,                              # Blocks as x, MB/s\n> as y     \n>      type=\"l\",                                     # plot lines, not points\n>      xlab=\"Blocks\",                                  # label x axis\n>      ylab=\"MB/s\",                                  # label y axis\n>      main=x)          # add title\n> dev.off()                                          # close file\n> q()                                                # quit\n\nBelow will get you closer to what you want, assuming that your files end \nin .csv, which they should, especially if you'll be creating new files \nin the same directory with a different extension. You certainly don't \nwant to re-run your R code and call read.table on a pdf. Another point \nis that your current working directory for R, returned by getwd(), is \nalready '/tmp/data'. Otherwise read.table wouldn't work, and a more \nportable solution is to use a variable to hold the directory name:\n\nworkdir <- '/tmp/data'\nfor (x in dir(workdir,pattern='.csv$')){\n   d <- read.table(paste(workdir,'/',x,sep=''), sep=\"\\t\", header=TRUE)\n   pdf(paste(workdir,'/',sub('.csv$','.pdf',x),sep=''))\n   plot(d$BlockSeqNum, d$MBs,\n     type=\"l\",\n     xlab=\"Blocks\",\n     ylab=\"MB/s\",\n     main=x)\n   dev.off()\n}\nq()\n\nBest,\n\nJeff\n---\nhttp://biostat.mc.vanderbilt.edu/JeffreyHorner\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}