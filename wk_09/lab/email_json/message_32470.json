{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jra@samba.org", "subject": "svn commit: samba r23007 - in branches: SAMBA_3_0/source/smbd\n\tSAMBA_3_0_26/source/smbd", "body": "Author: jra\nDate: 2007-05-19 01:27:34 +0000 (Sat, 19 May 2007)\nNew Revision: 23007\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23007\n\nLog:\nEnsure we don't allow large read over the possible\npacket size.\nJeremy.\n\nModified:\n   branches/SAMBA_3_0/source/smbd/reply.c\n   branches/SAMBA_3_0_26/source/smbd/reply.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/smbd/reply.c\n===================================================================\n--- branches/SAMBA_3_0/source/smbd/reply.c\t2007-05-18 23:56:34 UTC (rev 23006)\n+++ branches/SAMBA_3_0/source/smbd/reply.c\t2007-05-19 01:27:34 UTC (rev 23007)\n@@ -2718,6 +2718,10 @@\n \t\t\tif (srv_is_signing_active() || srv_encryption_on()) {\n \t\t\t\treturn ERROR_NT(NT_STATUS_NOT_SUPPORTED);\n \t\t\t}\n+\t\t\t/* Is there room in the reply for this data ? */\n+\t\t\tif (smb_maxcnt > (0xFFFFFF - (smb_size -4 + 12*2)))  {\n+\t\t\t\treturn ERROR_NT(NT_STATUS_INVALID_PARAMETER);\n+\t\t\t}\n \t\t\tbig_readX = True;\n \t\t}\n \t}\n\nModified: branches/SAMBA_3_0_26/source/smbd/reply.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/smbd/reply.c\t2007-05-18 23:56:34 UTC (rev 23006)\n+++ branches/SAMBA_3_0_26/source/smbd/reply.c\t2007-05-19 01:27:34 UTC (rev 23007)\n@@ -2716,6 +2716,10 @@\n \t\t\tif (srv_is_signing_active()) {\n \t\t\t\treturn ERROR_NT(NT_STATUS_NOT_SUPPORTED);\n \t\t\t}\n+\t\t\t/* Is there room in the reply for this data ? */\n+\t\t\tif (smb_maxcnt > (0xFFFFFF - (smb_size -4 + 12*2)))  {\n+\t\t\t\treturn ERROR_NT(NT_STATUS_INVALID_PARAMETER);\n+\t\t\t}\n \t\t\tbig_readX = True;\n \t\t}\n \t}\n\n"}