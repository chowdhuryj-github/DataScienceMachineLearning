{"category": "ham", "to_address": "\"Doran, Harold\" <HDoran@air.org>, r-help@stat.math.ethz.ch", "from_address": "(Ted Harding) <ted.harding@nessie.mcc.ac.uk>", "subject": "Re: [R] Spectral Decomposition", "body": "\nOn 29-Jun-07 12:29:31, Doran, Harold wrote:\n> All of my resources for numerical analysis show that the spectral\n> decomposition is\n> \n> A = CBC'\n> \n> Where C are the eigenvectors and B is a diagonal matrix of eigen\n> values. Now, using the eigen function in R\n> \n># Original matrix\n> aa <- matrix(c(1,-1,-1,1), ncol=2)\n> \n> ss <- eigen(aa)\n> \n># This results yields back the original matrix according to the\n> formula above\n> ss$vectors %*% diag(ss$values) %*% t(ss$vectors)\n> \n> However, for the following I do not get back the original matrix\n> using the general formula for the spectral decomposition:\n> \n> set.seed(123)\n> \n> aa <- matrix(rnorm(16), ncol=4)\n> \n> ss <- eigen(aa)\n> \n> ss$vectors %*% diag(ss$values) %*% t(ss$vectors)\n> \n> However, if I do the following\n> \n> A = CBC^{-1}\n> \n> I get back the original matrix A\n> \n> ss$vectors %*% diag(ss$values) %*% solve(ss$vectors)\n\nHarold, I think the key to the issue is whether your original\nmatric is symmetric or not. For your formula\n\n  A = C*B*C'\n\nto work, where B is a diagonal matrix (therefore essentially\nsymmetric) you have -- bearing in mind the reversal of factors --\n\n  A' = ReverseFactorsIn(C'*B'*C) = C*B*C' = A\n\nso A would have to be symmetric. This was the case for your\nfirst example matrix(c(1,-1,-1,1), ncol=2).\n\nHowever, your second example will not be symmetric, so the\nformula will not work, and you will need A = C*B*C^(-1).\n\nIf A is not symmetric, you have \"left\" eigenvectors:\n\n  x'*A = lambda*x'\n\nand \"right\" eigenvectors:\n\n  A*x = lambda*x\n\nand the \"left\" eigenvectors are not the same as the \"right\"\neigenvectors, though you have the same set of eigenvalues lambda\nin each case.\n\nYou then have\n\n  A = L'*B*R\n\nOf course the most frequent occurrence of this kind of question\nin statistics is where A is a covariance or correlation matrix,\nwhich is symmetric by definition.\n\nHoping this helps!\nTed.\n\n> In my lit search I am not finding an explanation for why this works, so\n> I am seeking R-help since there may be a computational rationale that\n> can be explained by users (or authors) of the function. In my\n> experimentation with some computations it seems that the latter\n> approach is more general in that it yields back the matrix I began\n> with, but deviates from the formula I commonly see in texts.\n> \n> Thanks,\n> Harold\n\n--------------------------------------------------------------------\nE-Mail: (Ted Harding) \nFax-to-email: +44 (0)870 094 0861\nDate: 29-Jun-07                                       Time: 14:23:03\n------------------------------ XFMail ------------------------------\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}