{"category": "ham", "to_address": "Carmen Meier <carmei3@web.de>", "from_address": "Martin Maechler <maechler@stat.math.ethz.ch>", "subject": "Re: [R] pnorm how to decide lower-tail true or false", "body": ">>>>> \"CM\" == Carmen Meier \n>>>>>     on Fri, 08 Jun 2007 19:31:49 +0200 writes:\n\n    CM> Hi to all, maybe the last question was not clear enough.\n    CM> I did not found any hints how to decide whether it\n    CM> should use lower.tail or not.  As it is an extra\n    CM> R-feature ( written in\n    CM> http://finzi.psych.upenn.edu/R/Rhelp02a/archive/66250.html\n    CM> ) I do not find anything about it in any statistical\n    CM> books of me.\n\nYes, most \"statistical books\" do not consider numerical accuracy\nwhich is the real issue here.\nNote that R is much more than a \"statistical package\" and hence\nto be appreciated properly needs much broader (applied)\nmathematical, statistical and computer science knowledge ;-)\n\nWhen  p ~= 1,  '1 - p' suffers from so called cancellation\n(\"Numerical analysis 101\").\nIf you already know that you will use \"q := 1 - p\",\nrather compuate 'q' directly than first compute p, then 1-p,\nlosing all accuracy.\n\nAll of R's  p(..) functions have an argument 'lower.tail'\nwhich is TRUE by default, since after all,\n\n      p(x) = Prob_{}[X <= x]   \n\nmeasures the probability of the lower or left tail of the\n-distribution.\n = norm  is just a special case.\nIf you really want \n   q =  1 - p(x) = Prob_{}[X > x]   \n\nthen you can get this directly via\n     \n   q <- p(x, lower.tail = FALSE, ....)\n\n\nSimple example with R :\n\n> pnorm(10)\n[1] 1\n> 1 - pnorm(10)\n[1] 0\n> pnorm(10, lower.tail=FALSE)\n[1] 7.619853e-24\n\n\nRegards,\nMartin Maechler, ETH Zurich\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}