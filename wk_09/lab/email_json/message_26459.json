{"category": "ham", "to_address": "Andrew Schuh <aschuh@atmos.colostate.edu>", "from_address": "Roy Mendelssohn <Roy.Mendelssohn@noaa.gov>", "subject": "Re: [R] generalized least squares with empirical error covariance\n matrix", "body": "Look at \"DLM\".  it can do bayesian dynamic linear models, ie. the  \nbayes equivalent of kalman filtering.\n\n-Roy M.\nOn May 9, 2007, at 1:09 PM, Andrew Schuh wrote:\n\n> I have a bayesian hierarchical normal regression model, in which the\n> regression coefficients are nested, which I've wrapped into one\n> regression framework, y = X %*% beta + e .  I would like to run data\n> through the model in a filter style (kalman filterish), updating\n> regression coefficients at each step new data can be gathered.  After\n> the first filter step, I will need to be able to feed the a non- \n> diagonal\n> posterior covariance in for the prior of the next step.  \"gls\" and  \n> \"glm\"\n> seem to be set up to handle structured error covariances, where  \n> mine is\n> more empirical, driven completely by the data.  Explicitly solving w/\n> \"solve\" is really sensitive to small values in the covariance  \n> matrix and\n> I've only been able to get reliable results at the first step by using\n> weighted regression w/ lm().  Am I missing an obvious function for\n> linear regression w/ a correlated  prior on the errors for the  \n> updating\n> steps?  Thanks in advance for any advice.\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting- \n> guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n**********************\n\"The contents of this message do not reflect any position of the U.S.  \nGovernment or NOAA.\"\n**********************\nRoy Mendelssohn\nSupervisory Operations Research Analyst\nNOAA/NMFS\nEnvironmental Research Division\t\nSouthwest Fisheries Science Center\n1352 Lighthouse Avenue\nPacific Grove, CA 93950-2097\n\ne-mail: Roy.Mendelssohn@noaa.gov (Note new e-mail address)\nvoice: (831)-648-9029\nfax: (831)-648-8440\nwww: http://www.pfeg.noaa.gov/\n\n\"Old age and treachery will overcome youth and skill.\"\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}