{"category": "ham", "to_address": "R-help <r-help@stat.math.ethz.ch>", "from_address": "Alan S Barnett <asb@mail.nih.gov>", "subject": "[R] 2 Trellis graphics question", "body": "1) I have a data that includes some \"bad\" data.  I want to make a\ntrellis plot where each panel contains \na) A scatter plot of the \"good\" data\nb) A scatter plot of the \"bad\" data in a different color\nc) A best fit line of all the data, and\nd) A best fit line of the \"good\" data.\n\nI tried using xyplot and setting the \"group\" argument, but I'm having\ntrouble.  Here is my code:\n\nxyplot(y ~ x | status, data=data,groups=good,\n+  panel=function(x,y,...){\n+  panel.xyplot(x,y,...)\n+  panel.lmline(x,y,col = \"red\")\n+  panel.lmline(x[good],y[good],col = \"blue\")\n+ } \n+ )\na,groups=good,\ndata is a data frame containing names x, y and status.\ngood is logical variable labeling the \"good\" data.\nEach panel of the trellis plot generated by this code includes\na) A scatterplot of the \"good\" data in magenta,\nb) A scatterplot of the \"bad\" data in blue,\nc) A best fit line of all the data in blue.\n\nIf I reverse the order of the last two lines, the best fit lines are\ndisplayed in red.  Clearly, the correct value of good is not being\npassed to panel.lmline, but is being correctly passed to panel.xyplot.\n\nSubstituting \n panel.lmline(x,y,...)\nfor\n panel.lmline(x,y,col = \"red\") \n panel.lmline(x[good],y[good],col = \"blue)\nresults in the best fit line being plotted in black.\n \n2) There are 5 different values of status, but I only want to plot three\nof them.  Can I do this without copying only the desired elements into a\nnew data frame?\n\n-- \nAlan S Barnett \nNIMH/CBDB\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}