{"category": "ham", "to_address": "R-Help <r-help@stat.math.ethz.ch>", "from_address": "\"Brian Wilfley\" <bwilfley@tripleringtech.com>", "subject": "[R] abline plots at wrong abscissae after boxplot", "body": "Hi folks,\n\nI'm using R 2.5.0 under ESS under Windows XP. (This also happens using\nthe Rgui application.)\n\nI'm trying to add lines to a plot originally made with \"boxplot\", but\nthe lines appear in the wrong place. Below is a script that\nillustrates the problem\n\n# boxablinetest.R - script to show problem with abline on box plot\n\nx <-  c(  2,  2,  2,  3,  3,  3,  4,  4,  4)\ny <-  c(  1,  2,  3,  2,  3,  4,  3,  4,  5)\n\nxymodel <- lm( y~x)\n\nboxplot( y~x)\nabline( xymodel)                        # Wrong abcissae\nabline( v = 2.5)                        # Wrong abcissa\nabline( h = 2.75)                       # Right ordinate\n\n# -------------- end --------------\n\nHere, I'm making a box plot with abscissae that start at 2. The box\nplot looks fine: the numbers 2, 3, and 4 appear on the x-axis and the\nboxes are centered at 2, 3, and 4.\n\nWhen I add the first abline, the line appears too low, but actually it\nis too far to the right. The abscissae are being interpreted without\nrealizing that the plot originates at 2, not 1.\n\nThe second call to abline should put a vertical line between 2 and 3,\nbut instead it shows up between 3 and 4. Again, it appears that the\noffset in the origin of the boxplot is not accounted for.\n\nFinally the last abline appears where it should: between 2 and 3.\nEvidently, ordinate values are correctly interpreted.\n\nDoes anyone have any advice?\n\nThanks very much.\n\nBrian Wilfley\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}