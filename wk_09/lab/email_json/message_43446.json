{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r23363 - in branches:\n\tSAMBA_3_0/source/lib/replace SAMBA_3_0_26/source/lib/replace\n\tSAMBA_4_0/source/lib/replace", "body": "Author: obnox\nDate: 2007-06-06 09:27:43 +0000 (Wed, 06 Jun 2007)\nNew Revision: 23363\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23363\n\nLog:\nActivate rep_pread and rep_pwrite in lib/replace/replace.h.\nThis fixes the build on a SuSE 6.1. :-)\nI guess this had been merely forgotten.\n\nBut beware: The implementations of rep_pread and rep_pwrite are\nnot thread safe.\n\nMichael\n\n\nModified:\n   branches/SAMBA_3_0/source/lib/replace/replace.c\n   branches/SAMBA_3_0/source/lib/replace/replace.h\n   branches/SAMBA_3_0_26/source/lib/replace/replace.c\n   branches/SAMBA_3_0_26/source/lib/replace/replace.h\n   branches/SAMBA_4_0/source/lib/replace/replace.c\n   branches/SAMBA_4_0/source/lib/replace/replace.h\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/lib/replace/replace.c\n===================================================================\n--- branches/SAMBA_3_0/source/lib/replace/replace.c\t2007-06-06 07:46:38 UTC (rev 23362)\n+++ branches/SAMBA_3_0/source/lib/replace/replace.c\t2007-06-06 09:27:43 UTC (rev 23363)\n@@ -438,6 +438,10 @@\n }\n #endif\n \n+/*****************************************************************\n+ Watch out: this is not thread safe.\n+*****************************************************************/\n+\n #ifndef HAVE_PREAD\n ssize_t rep_pread(int __fd, void *__buf, size_t __nbytes, off_t __offset)\n {\n@@ -448,6 +452,10 @@\n }\n #endif\n \n+/*****************************************************************\n+ Watch out: this is not thread safe.\n+*****************************************************************/\n+\n #ifndef HAVE_PWRITE\n ssize_t rep_pwrite(int __fd, const void *__buf, size_t __nbytes, off_t __offset)\n {\n\nModified: branches/SAMBA_3_0/source/lib/replace/replace.h\n===================================================================\n--- branches/SAMBA_3_0/source/lib/replace/replace.h\t2007-06-06 07:46:38 UTC (rev 23362)\n+++ branches/SAMBA_3_0/source/lib/replace/replace.h\t2007-06-06 09:27:43 UTC (rev 23363)\n@@ -350,6 +350,16 @@\n char *rep_mkdtemp(char *template);\n #endif\n \n+#ifndef HAVE_PREAD\n+#define pread rep_pread\n+ssize_t rep_pread(int __fd, void *__buf, size_t __nbytes, off_t __offset);\n+#endif\n+\n+#ifndef HAVE_PWRITE\n+#define pwrite rep_pwrite\n+ssize_t rep_pwrite(int __fd, const void *__buf, size_t __nbytes, off_t __offset);\n+#endif\n+\n #ifdef HAVE_LIMITS_H\n #include \n #endif\n\nModified: branches/SAMBA_3_0_26/source/lib/replace/replace.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/lib/replace/replace.c\t2007-06-06 07:46:38 UTC (rev 23362)\n+++ branches/SAMBA_3_0_26/source/lib/replace/replace.c\t2007-06-06 09:27:43 UTC (rev 23363)\n@@ -438,6 +438,10 @@\n }\n #endif\n \n+/*****************************************************************\n+ Watch out: this is not thread safe.\n+*****************************************************************/\n+\n #ifndef HAVE_PREAD\n ssize_t rep_pread(int __fd, void *__buf, size_t __nbytes, off_t __offset)\n {\n@@ -448,6 +452,10 @@\n }\n #endif\n \n+/*****************************************************************\n+ Watch out: this is not thread safe.\n+*****************************************************************/\n+\n #ifndef HAVE_PWRITE\n ssize_t rep_pwrite(int __fd, const void *__buf, size_t __nbytes, off_t __offset)\n {\n\nModified: branches/SAMBA_3_0_26/source/lib/replace/replace.h\n===================================================================\n--- branches/SAMBA_3_0_26/source/lib/replace/replace.h\t2007-06-06 07:46:38 UTC (rev 23362)\n+++ branches/SAMBA_3_0_26/source/lib/replace/replace.h\t2007-06-06 09:27:43 UTC (rev 23363)\n@@ -350,6 +350,16 @@\n char *rep_mkdtemp(char *template);\n #endif\n \n+#ifndef HAVE_PREAD\n+#define pread rep_pread\n+ssize_t rep_pread(int __fd, void *__buf, size_t __nbytes, off_t __offset);\n+#endif\n+\n+#ifndef HAVE_PWRITE\n+#define pwrite rep_pwrite\n+ssize_t rep_pwrite(int __fd, const void *__buf, size_t __nbytes, off_t __offset);\n+#endif\n+\n #ifdef HAVE_LIMITS_H\n #include \n #endif\n\nModified: branches/SAMBA_4_0/source/lib/replace/replace.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/replace/replace.c\t2007-06-06 07:46:38 UTC (rev 23362)\n+++ branches/SAMBA_4_0/source/lib/replace/replace.c\t2007-06-06 09:27:43 UTC (rev 23363)\n@@ -438,6 +438,10 @@\n }\n #endif\n \n+/*****************************************************************\n+ Watch out: this is not thread safe.\n+*****************************************************************/\n+\n #ifndef HAVE_PREAD\n ssize_t rep_pread(int __fd, void *__buf, size_t __nbytes, off_t __offset)\n {\n@@ -448,6 +452,10 @@\n }\n #endif\n \n+/*****************************************************************\n+ Watch out: this is not thread safe.\n+*****************************************************************/\n+\n #ifndef HAVE_PWRITE\n ssize_t rep_pwrite(int __fd, const void *__buf, size_t __nbytes, off_t __offset)\n {\n\nModified: branches/SAMBA_4_0/source/lib/replace/replace.h\n===================================================================\n--- branches/SAMBA_4_0/source/lib/replace/replace.h\t2007-06-06 07:46:38 UTC (rev 23362)\n+++ branches/SAMBA_4_0/source/lib/replace/replace.h\t2007-06-06 09:27:43 UTC (rev 23363)\n@@ -350,6 +350,16 @@\n char *rep_mkdtemp(char *template);\n #endif\n \n+#ifndef HAVE_PREAD\n+#define pread rep_pread\n+ssize_t rep_pread(int __fd, void *__buf, size_t __nbytes, off_t __offset);\n+#endif\n+\n+#ifndef HAVE_PWRITE\n+#define pwrite rep_pwrite\n+ssize_t rep_pwrite(int __fd, const void *__buf, size_t __nbytes, off_t __offset);\n+#endif\n+\n #ifdef HAVE_LIMITS_H\n #include \n #endif\n\n"}