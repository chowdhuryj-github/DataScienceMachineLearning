{"category": "ham", "to_address": "beginners@perl.org", "from_address": "Stanislav Nedelchev <stanislav.nedelchev@gmail.com>", "subject": "Data Mungling - Address Book;", "body": "Hi to all\nHere is my problem . I'm trying to export this data to SQL database .\nHere is example data.Don't pay attention on encoding. Every new record\nis starting --=NewRecord=--\ndelimiter between fields and data is = .\nContact=\\u0410\\u0413\\u041f\\u041f\\u041c\\u041f-\\u0421\\u042a\\u041d\\u0418\\u041c\\u0415\\u0414-\\u041e\\u041e\\u0414\nManager=\nRegion=\\u0420\\u0417\\u041e\\u041a \\u0411\\u0443\\u0440\\u0433\\u0430\\u0441\nMunicipality= \\u041d\\u0415\\u0421\\u0415\\u0411\\u042a\\u0420\nSettlement=\\u0413\\u0420.\\u041d\\u0415\\u0421\\u0415\\u0411\\u042a\\u0420\nAddress=\\u0443\\u043b.\\u0420\\u0438\\u0431\\u0430\\u0440\\u0441\\u043a\\u0430 11 \\u043a\\u0430\\u0431.1-2\nPhone=43058\nName=\\u041b\\u044e\\u0434\\u043c\\u0438\\u043b \\u041d\\u0438\\u043a\\u043e\\u043b\\u043e\\u0432 \\u0421\\u0442\\u0430\\u043c\\u0435\\u043d\\u043e\\u0432 - \\u041e\\u0431\\u0449\\u043e\\u043f\\u0440\\u0430\\u043a\\u0442\\u0438\\u043a\\u0443\\u0432\\u0430\\u0449 \\u043b\\u0435\\u043a\\u0430\\u0440\n--=NewRecord=--\nContact=\\u0410\\u0418\\u041f\\u041f\\u041c\\u041f \\u0434-\\u0440 \\u0420.\\u0414\\u0438\\u043c\\u0438\\u0442\\u0440\\u043e\\u0432\\u0415\\u041e\\u041e\\u0414\nManager=\nRegion=\\u0420\\u0417\\u041e\\u041a \\u0411\\u0443\\u0440\\u0433\\u0430\\u0441\nMunicipality= \\u0411\\u0423\\u0420\\u0413\\u0410\\u0421\nSettlement=\\u0413\\u0420.\\u0411\\u0423\\u0420\\u0413\\u0410\\u0421\nAddress=\\u0443\\u043b.\\u0425\\u0430\\u043d \\u041a\\u0440\\u0443\\u043c \\u211628 \\u0435\\u0442.2 \\u0441\\u0442.209\nPhone=\nName=\\u0420\\u0443\\u043c\\u0435\\u043d \\u041d\\u0438\\u043a\\u043e\\u043b\\u0430\\u0435\\u0432 \\u0414\\u0438\\u043c\\u0438\\u0442\\u0440\\u043e\\u0432 - \\u041e\\u0431\\u0449\\u043e\\u043f\\u0440\\u0430\\u043a\\u0442\\u0438\\u043a\\u0443\\u0432\\u0430\\u0449 \\u043b\\u0435\\u043a\\u0430\\u0440\n\n\n\nI was try to adapt some code that i see here and some people are helped\nme with other things.\n\nHere is my code . It's seems that %hashrecord is not after firs asaing\nto array is not changing anymore .\nIf i try to iniatilze the hash it's seem that i initialize the reference\nand everything becomes empty.\nCan anybody give advice how to fill this array of hashes and generate SQL.\n\nuse strict;\nuse warnings;\nopen FILE,\"insert.sql\" or die $!;\nmy @data;\nmy $sql;\nmy %hashrecord;\nmy %columns;\nwhile(){\n\nif(! /--=NewRecord=--/){\nmy ($fname,$fvalue) = split/=/;\n$hashrecord{$fname} = $fvalue;\n\n}\nif (/--=NewRecord=--/){push @data, \\%hashrecord};\n}\n\nforeach my $rec (@data) {\n$columns{$_}++ foreach keys %$rec;\n}\nforeach my $rec (@data) {\n$sql = sprintf \"insert into doctors (%s)\\nvalues(%s)\",\njoin(\",\", map qq( $_), keys %$rec),\njoin(\",\", map qq( '$_'), values %$rec);\nprint OUT $sql, \"\\n\";\n}\n\n\nThanks a lot.\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}