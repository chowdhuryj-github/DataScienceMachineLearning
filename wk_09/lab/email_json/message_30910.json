{"category": "ham", "to_address": "Beate Kowalczyk <beate.kowalczyk@googlemail.com>, r-help@stat.math.ethz.ch", "from_address": "Jim Lemon <jim@bitwrit.com.au>", "subject": "Re: [R] Filled step-function?", "body": "Beate Kowalczyk wrote:\n> Hello,\n> \n> I'd like to generate a filled step-function in R as you can see in the \n> attachement (image is generated by grapher, but I need a freely \n> available alternative). The problem is, that I don't know, how to fill \n> it up. My code right now looks like this:\n> \n> pH <- c(0,6.1,6.1,6.3,6.6,7.3,0)\n> Tiefe <- c(0,0,10,40,80,120,10)\n> plot(pH,Tiefe,type=\"s\",main=\"Tiefenfunktion pH\",ylim=c(120,0),xlim=c(0,23))\n> \nHi Beate,\nIf I understand this, you want the steps to be converted into a polygon \nand displayed instead of the plot \"step\" display. You also want the y \naxis reversed. This might do what you want:\n\nstepfun.polygon<-function(x,y,miny=min(y),col=NULL,...) {\n  plot(x,y,ylim=c(max(y),min(y)),type=\"n\",...)\n  polyx<-c(x[1],rep(x[2:length(x)],each=2),x[1])\n  polyy<-c(rep(y,each=2))\n  polygon(polyx,polyy,col=col)\n}\n\nNote that you will probably only want the observed values of x and y, as \nthe zeros on the end produce an unwanted spike in the polygon.\n\nJim\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}