{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 377: fixed some debug messages in http://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 377\nrevision-id: tridge@samba.org-20070529034830-j1dnavzkvremsri1\nparent: tridge@samba.org-20070529033359-zvutvg5816i8pp2f\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Tue 2007-05-29 13:48:30 +1000\nmessage:\n  fixed some debug messages\nmodified:\n  common/ctdb_daemon.c           ctdb_daemon.c-20070409200331-3el1kqgdb9m4ib0g-1\n  common/ctdb_ltdb.c             ctdb_ltdb.c-20061128065342-to93h6eejj5kon81-2\n  common/ctdb_recoverd.c         recoverd.c-20070503213540-bvxuyd9jm1f7ig90-1\n  include/ctdb_private.h         ctdb_private.h-20061117234101-o3qt14umlg9en8z0-13\n  lib/util/debug.h               debug.h-20070417155854-2i3crb0irl716qft-2\n  takeover/ctdb_takeover.c       ctdb_takeover.c-20070525071636-a5n1ihghjtppy08r-2\n=== modified file 'common/ctdb_daemon.c'\n--- a/common/ctdb_daemon.c\t2007-05-29 02:16:59 +0000\n+++ b/common/ctdb_daemon.c\t2007-05-29 03:48:30 +0000\n@@ -617,11 +617,11 @@\n \tstrncpy(addr.sun_path, ctdb->daemon.name, sizeof(addr.sun_path));\n \n \tif (bind(ctdb->daemon.sd, (struct sockaddr *)&addr, sizeof(addr)) == -1) {\n-\t\tDEBUG(0,(\"Unable to bind on ctdb socket '%s', ctdb->daemon.name\\n\"));\n+\t\tDEBUG(0,(\"Unable to bind on ctdb socket '%s'\\n\", ctdb->daemon.name));\n \t\tgoto failed;\n \t}\t\n \tif (listen(ctdb->daemon.sd, 10) != 0) {\n-\t\tDEBUG(0,(\"Unable to listen on ctdb socket '%s', ctdb->daemon.name\\n\"));\n+\t\tDEBUG(0,(\"Unable to listen on ctdb socket '%s'\\n\", ctdb->daemon.name));\n \t\tgoto failed;\n \t}\n \n\n=== modified file 'common/ctdb_ltdb.c'\n--- a/common/ctdb_ltdb.c\t2007-05-25 08:48:49 +0000\n+++ b/common/ctdb_ltdb.c\t2007-05-29 03:48:30 +0000\n@@ -367,7 +367,7 @@\n \tfor (tmp_db=ctdb->db_list;tmp_db;tmp_db=tmp_db->next) {\n \t\tif (tmp_db->db_id == ctdb_db->db_id) {\n \t\t\tDEBUG(0,(\"db_id 0x%x hash collision. name1='%s' name2='%s'\\n\",\n-\t\t\t\t db_name, tmp_db->db_name));\n+\t\t\t\t tmp_db->db_id, db_name, tmp_db->db_name));\n \t\t\ttalloc_free(ctdb_db);\n \t\t\treturn -1;\n \t\t}\n@@ -448,7 +448,7 @@\n \n \tctdb_db = find_ctdb_db(ctdb, db_id);\n \tif (!ctdb_db) {\n-\t\tDEBUG(0,(\"Unknown db_id 0x%x in ctdb_ltdb_update_seqnum\\n\"));\n+\t\tDEBUG(0,(\"Unknown db_id 0x%x in ctdb_ltdb_update_seqnum\\n\", db_id));\n \t\treturn -1;\n \t}\n \n@@ -491,7 +491,7 @@\n \tstruct ctdb_db_context *ctdb_db;\n \tctdb_db = find_ctdb_db(ctdb, db_id);\n \tif (!ctdb_db) {\n-\t\tDEBUG(0,(\"Unknown db_id 0x%x in ctdb_ltdb_enable_seqnum\\n\"));\n+\t\tDEBUG(0,(\"Unknown db_id 0x%x in ctdb_ltdb_enable_seqnum\\n\", db_id));\n \t\treturn -1;\n \t}\n \n\n=== modified file 'common/ctdb_recoverd.c'\n--- a/common/ctdb_recoverd.c\t2007-05-26 23:43:25 +0000\n+++ b/common/ctdb_recoverd.c\t2007-05-29 03:48:30 +0000\n@@ -546,7 +546,7 @@\n \tif (ctdb->takeover.enabled) {\n \t\tret = ctdb_takeover_run(ctdb, nodemap);\n \t\tif (ret != 0) {\n-\t\t\tDEBUG(0, (__location__, \" Unable to setup public takeover addresses\\n\"));\n+\t\t\tDEBUG(0, (__location__ \" Unable to setup public takeover addresses\\n\"));\n \t\t\treturn -1;\n \t\t}\n \t}\n\n=== modified file 'include/ctdb_private.h'\n--- a/include/ctdb_private.h\t2007-05-29 03:33:59 +0000\n+++ b/include/ctdb_private.h\t2007-05-29 03:48:30 +0000\n@@ -945,7 +945,9 @@\n int32_t ctdb_control_startup(struct ctdb_context *ctdb, uint32_t vnn);\n \n void ctdb_takeover_client_destructor_hook(struct ctdb_client *client);\n-int ctdb_event_script(struct ctdb_context *ctdb, const char *fmt, ...);\n+int ctdb_event_script(struct ctdb_context *ctdb, const char *fmt, ...) PRINTF_ATTRIBUTE(2,3);\n void ctdb_release_all_ips(struct ctdb_context *ctdb);\n \n+\n+\n #endif\n\n=== modified file 'lib/util/debug.h'\n--- a/lib/util/debug.h\t2007-04-17 15:59:39 +0000\n+++ b/lib/util/debug.h\t2007-05-29 03:48:30 +0000\n@@ -18,4 +18,4 @@\n    Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.\n */\n \n-void do_debug(const char *format, ...);\n+void do_debug(const char *format, ...) PRINTF_ATTRIBUTE(1, 2);\n\n=== modified file 'takeover/ctdb_takeover.c'\n--- a/takeover/ctdb_takeover.c\t2007-05-29 03:33:59 +0000\n+++ b/takeover/ctdb_takeover.c\t2007-05-29 03:48:30 +0000\n@@ -239,7 +239,7 @@\n \t}\n \n \tif (nlines != ctdb->num_nodes) {\n-\t\tDEBUG(0,(\"Number of lines in %s does not match number of nodes!\\n\"));\n+\t\tDEBUG(0,(\"Number of lines in %s does not match number of nodes!\\n\", alist));\n \t\ttalloc_free(lines);\n \t\treturn -1;\n \t}\n\n"}