{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Yong Wang\" <wangyong1@gmail.com>", "subject": "[R] A \"subscript out of bonds\" and \"write.table\" problem on\n\tmanipulating a large size dataset", "body": "Dear all:\n\nDescribed below is a large data set problem (data size > 2G after\nunzipping, table delimited). I know R is not the\nappropriate tool for such task, anyway\nI did it on a server and get some straightforward problems.\n\n1. The first is count.fields can count all the rows, however, when I\ntried to remove rows beyond 3/5 of the data,R says\nsubscripts out of bounds, is there any option constraining the maximal\nsize for R to read in?\n\n2. I rewrote the original data due to careless coding and find the\nrewrote table delimited file does not match the\noriginal file.\nI experimented the code on a small dataset as attached at the end, no\nproblem at all for such small dataset.\n\nI appreciate any tips and suggestions on how to remove the unwanted\nrows in such a large dataset.\n\nfinally, thanks for all answering the tab delimited problem I rised yesterday.\n\n### code as following ###\n\ndata.mm <- read.table(file,header=T,sep=\"\\t\",fill=T); \t#read in the large file\ncf <- count.fields(file,sep=\"\\t\");\t\t     #count fields\t\nn <- 23;\t\t\t\t#the CORRECT fields for each row i.e., the number of variable name\ndel <- which(cf!=n);\t\t# try to remove any row which has number of\nfields not euqal to 23\ndel <- del-1;\t\t\t# count cf contains the fields of header, -1 give the\nrow I want to remove\n\ndata.mm <- data.mm[-del,];\t# try to remove the rows with fields number\nunequal to 23\n\t\t\t\t### PROBLEM: R says \"subscripts out of bonds\"\n\nwrite.table(data.mm,file=\"mm_0206.txt\",\n\t    eol=\"\\n\",sep=\"\\t\",\n\t    quote=F,row.names=F); # since data.mm <- data.mm[-del,] aborted,\nwrite the original data as mm_0206.txt\n\t\t\t\t  ### PROBLEM:then following code should have the same output\n\ntable(cf);\t\t\t   # maximal fields number is 23\ntable( count.fields(\"mm_0206.txt\",sep=\"\\t\")); # maximal fields number\nlarger than 23 and other things also unequle\n\t\t\t\t\t      # for example, original data has x rows with 10 fields, the wrote\n\t\t\t\t\t      # data has y row with 10 fields.\n\t\t\t\t\t      # if the original file is not correctly rewrote, probably\nan equal length\n\t\t\t\t\t      # file will also not be wrote properly wrote, suppose\ndata.mm <- data.mm[-del,];\n\t\t\t\t\t      # get executed successfully.\n\n\n\n####  experimental data set as following\t###\n\nV1\tV2\tV3\tv4\tv5\tv6\tv7\tv8\tv9\n11\t1\tdesc\tA\t1\t34\t1-Sep-00\t1\tfirst mid last\n12\t2\tdesc\tB\t6\t56\t2-Sep-00\t1\tFirst last\n13\t3\tdesc\tA\t7\t32\t3-Sep-00\t1\tlast\n14\t4\tdesc\t4-Sep-00\t0\tfirst mid last\n15\t5\tdesc\tA\t2\t.\t5-Sep-00\t1\tfirst mid last\n16\t6\tdesc\tB\t9\t3\t6-Sep-00\t0\tlast\n17\t7\t\tA\t6\t65\t7-Sep-00\tfirst last\n18\t8\tdesc\tB\t2\t.\t8-Sep-00\t0\tlast\n19\t9\tdesc\tA\t8\t56\t9-Sep-00\t1\tfirst last\n20\t10\tdesc\tB\t5\t89\t10-Sep-00\t0\tfirst last\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}