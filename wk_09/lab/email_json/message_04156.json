{"category": "ham", "to_address": "Jeremy Allison <jra@samba.org>", "from_address": "tridge@samba.org", "subject": "Re: svn commit: samba r22202 - in\n\tbranches/SAMBA_3_0/source/nsswitch: .", "body": "Jeremy,\n\n > The issue some (real) customers are seeing is with laptops\n > (mainly I believe) going down hard - no shutdown. In that\n > case without the equivalent of an msync it's easy to get\n > a corrupted tdb state.\n\nThat wasn't my question. I don't doubt that it is possible to get a\ncorrupt tdb file. What I am asking is if you have seen a corrupt tdb\nfile that causes a 'wild pointer', and presumably a crash in the tdb\ncode that is reading the file.\n\nThe patch you applied implied that you thought we might get a file\nlike that, and that disabling MMAP would avoid the segv. I shouldn't\nmatter if you have the contents of /dev/random in a tdb file, it\nshould not segv, no matter if using mmap or not (there is an exception\nto this, where the file is truncated out from under a running program\naccessing tdb via mmap - that is arguably a kernel bug, and is not\nrelevant to the situation you are trying to fix).\n\nSo if you do have a tdb file that when read using mmap causes a crash,\nplease give me a copy. It implies that we have a real bug.\n\nCheers, Tridge\n\n"}