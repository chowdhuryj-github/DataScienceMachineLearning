{"category": "ham", "to_address": "\"John Kane\" <jrkrideau@yahoo.ca>, \"R R-help\" <r-help@stat.math.ethz.ch>", "from_address": "\"Jason Barnhart\" <jasoncbarnhart@msn.com>", "subject": "Re: [R] Function call within a function.", "body": "The problem isn't the function call.\n\nFirst, list1 returned by lstfun does not name its elements so nts$cda \nwon't work. See code change in lstfun.\n\nSecond, specifying nts$cda as the nam1 argument tells R to look for \nthe nts object in the environment in which ukn is called.  However, \nthe nts object is not created in the parent environment, it is created \nin the ukn's environment.\n\nThird, nam1[,3] should be nam1[2] as there is no third element to this \nlist (although and this doesn't resolve the environment issue).\n\nI've modified your code below to work, but there are better ways to go \nabout this.  Thomas Lumley has a famous quote regarding parse.  See \nhttp://tolstoy.newcastle.edu.au/R/e2/help/07/01/8059.html among \nothers.\n\nI was once referred to Patrick Burns' S Poetry to learn about the \n\"eval(parse(text=)))\" paradigm which was very helpful. You may also \nwant to brush up on environments (see ?environment) to learn more \nabout lexical scoping.\n\nHope this helps.\n-jason\n\n#MODIFIED CODE\n# create data.frame\ncata <- c( 1,1,6,1,1,4)\ncatb <- c( 1,2,3,4,5,6)\nid <- c('a', 'b', 'b', 'a', 'a', 'b')\ndd1 <- data.frame(id, cata,catb)\n\n# function to create list from data.frame\nlstfun <- function(file, alpha , beta ) {\ncda <- subset(file, file[,1] == alpha)\ncdb <- subset (file, file[,1]== beta)\n### CODE ADDED HERE\nlist1 <- list(cda=cda,cdb=cdb)\n}\n\n# funtion to operate on list\nukn <- function(file, alpha, beta, nam1){\naa <- alpha\nbb <- beta\nmyfile <- file\nnts <- lstfun(myfile, aa, bb)\n### CODE ADDED HERE\nmysum <- eval(parse(text=nam1))\n#mysum <- nam1[,3]*5\nreturn(mysum)\n}\n\nresults <- ukn(dd1, \"a\", \"b\", \"nts$cda\") ### modified how called.\n\n----- Original Message ----- \nFrom: \"John Kane\" \nTo: \"R R-help\" \nSent: Thursday, June 28, 2007 12:03 PM\nSubject: [R] Function call within a function.\n\n\n>I am trying to call a funtion within another function\n> and I clearly am misunderstanding what I should do.\n> Below is a simple example.\n> I know lstfun works on its own but I cannot seem to\n> figure out how to get it to work within ukn. Basically\n> I need to create the variable \"nts\". I have probably\n> missed something simple in the Intro or FAQ.\n>\n> Any help would be much appreciated.\n>\n> EXAMPLE\n> -------------------------------------------------------------------------------\n> # create data.frame\n> cata <- c( 1,1,6,1,1,4)\n> catb <- c( 1,2,3,4,5,6)\n> id <- c('a', 'b', 'b', 'a', 'a', 'b')\n> dd1  <-  data.frame(id, cata,catb)\n>\n> # function to create list from data.frame\n> lstfun  <- function(file, alpha , beta ) {\n> cda  <-  subset(file, file[,1] == alpha)\n> cdb  <-  subset (file, file[,1]== beta)\n> list1 <- list(cda,cdb)\n> }\n>\n> # funtion to operate on list\n> ukn  <-  function(file, alpha, beta, nam1){\n> aa  <- alpha\n> bb  <- beta\n> myfile  <- file\n> nts <- lstfun(myfile, aa, bb)\n> mysum <- nam1[,3]*5\n> return(mysum)\n> }\n>\n> results <- ukn(dd1, \"a\", \"b\", nts$cda)\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide \n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}