{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r22330 - in branches/SAMBA_3_0: .", "body": "Author: obnox\nDate: 2007-04-18 11:12:31 +0000 (Wed, 18 Apr 2007)\nNew Revision: 22330\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22330\n\nLog:\nFor my own convenience (changes discussed some weeks ago with\nJerry, who basically didn't care - now I can commit them myself;-):\n\n- Add a call to mkversion.sh to ensure sane version number even\n  from a plain checkout.\n- Add a \"nodocs\" switch to allow for calling make-tarball.sh without\n  the need of having samba-docs and using-samba around.\n\n\nModified:\n   branches/SAMBA_3_0/make-tarball.sh\n\n\nChangeset:\nModified: branches/SAMBA_3_0/make-tarball.sh\n===================================================================\n--- branches/SAMBA_3_0/make-tarball.sh\t2007-04-18 11:08:16 UTC (rev 22329)\n+++ branches/SAMBA_3_0/make-tarball.sh\t2007-04-18 11:12:31 UTC (rev 22330)\n@@ -4,35 +4,43 @@\n ## You either need to include the using_samba cvs module in the\n ## parent directory or tell the script where to find it \n ##\n-## Usgae:  ./make-tarball.sh\n+## Usgae:  ./make-tarball.sh [nodocs]\n \n+NODOCS=0\n+if [ x\"$1\" = x\"nodocs\" ] ; then\n+\tNODOCS=1\n+\techo Not including docs.\n+fi\n+\n DOCSDIR=../samba-docs/\n USING_SAMBA=../using_samba/\n SRCDIR=`pwd`\n \n-if [ ! -d $USING_SAMBA ]; then\n-\n-\techo Cannot find \"Using Samba\" directory \\(assuming $USING_SAMBA\\).  \n-\techo Please set the USING_SAMBA variable in this script to the correct\n-\techo location.  The html files are available in the using_samba CVS \n-\techo module on cvs.samba.org.  See http://cvs/samba.org/ for details \n-\techo about anonymous CVS access.  Exiting now....\n-\n-\texit 1\n-\n+if [ $NODOCS -eq 0 ]; then\n+\tif [ ! -d $USING_SAMBA ]; then\n+\t\n+\t\techo Cannot find \"Using Samba\" directory \\(assuming $USING_SAMBA\\).  \n+\t\techo Please set the USING_SAMBA variable in this script to the correct\n+\t\techo location.  The html files are available in the using_samba CVS \n+\t\techo module on cvs.samba.org.  See http://cvs.samba.org/ for details \n+\t\techo about anonymous CVS access.  Exiting now....\n+\t\n+\t\texit 1\n+\t\n+\tfi\n+\t\n+\tif [ ! -d $DOCSDIR ]; then\n+\t\n+\t\techo Cannot find samba-docs \\(assuming $DOCSDIR\\).\n+\t\techo Please set the DOCSDIR variable in this script \n+\t\techo to the correct path.\n+\t\n+\t\texit 1\n+\t\n+\tfi\n fi\n \n-if [ ! -d $DOCSDIR ]; then\n-\n-\techo Cannot find samba-docs \\(assuming $DOCSDIR\\).\n-\techo Please set the DOCSDIR variable in this script \n-\techo to the correct path.\n-\n-\texit 1\n-\n-fi\n-\n-\n+( cd source ; sh script/mkversion.sh )\n VERSION=`grep SAMBA_VERSION_OFFICIAL_STRING source/include/version.h | cut -d\\\" -f2 | sed 's/ /_/g'`\n TARBALLDIR=/tmp/samba-$VERSION\n \n@@ -44,8 +52,10 @@\n mkdir $TARBALLDIR\n rsync -aC ./ $TARBALLDIR\n /bin/rm -rf $TARBALLDIR/docs/*\n-rsync -aC $DOCSDIR/ $TARBALLDIR/docs/ \n-rsync -aC $USING_SAMBA $TARBALLDIR/docs/htmldocs/\n+if [ $NODOCS -eq 0 ]; then\n+\trsync -aC $DOCSDIR/ $TARBALLDIR/docs/ \n+\trsync -aC $USING_SAMBA $TARBALLDIR/docs/htmldocs/\n+fi\n \n echo Creating packaging scripts...\n ( cd $TARBALLDIR/packaging; sh bin/update-pkginfo $VERSION 1 )\n\n"}