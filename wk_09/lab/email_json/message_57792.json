{"category": "ham", "to_address": "\"Alexandre Salvador\" <alxsal@free.fr>", "from_address": "\"Deepayan Sarkar\" <deepayan.sarkar@gmail.com>", "subject": "Re: [R] Adding different output to different lattice panels", "body": "On 6/28/07, Alexandre Salvador  wrote:\n> Selon deepayan.sarkar@gmail.com:\n>\n> > On 6/28/07, alxsal@free.fr  wrote:\n> > > I would like to add a reference line to lattice graphs, with the reference\n> > > line\n> > > being different according to the factor level.\n> > >\n> > > Example : Draw 3 dotplots for \"a\",\"b\" and \"c\" factors, and then add an\n> > > horizontal line at y=10 for panel \"a\", y=8 for panel \"b\" and y=6 for panel\n> > > \"4\"\n> > >\n> > > I tried the code below, but this draw all three reference lines for each\n> > > panel.\n> > > How do I index the current panel to chose the right reference vector value\n> > ?\n> > >\n> > >\n> >\n> dat<-data.frame(id=rep(c(\"a\",\"b\",\"c\"),4),val=1:12,quand=rep(c(\"t1\",\"t2\",\"t3\",\"t4\"),each=3))\n> > > ref<-c(10,8,6)\n> > > plot.new()\n> > > datplot<-dotplot(val~quand|id,data=dat,panel=function(...){\n> > > panel.dotplot(...)\n> > > panel.abline(h=ref)\n> > > })\n> > > print(datplot)\n> >\n> > dotplot(val~quand|id,data=dat,panel=function(...){\n> >     panel.dotplot(...)\n> >     panel.abline(h = ref[packet.number()])\n> > })\n> >\n> > (Things are more complicated if you have more than one conditioning\n> > variable.)\n> >\n> > -Deepayan\n> >\n>\n> I tried you solution, but the following error appears when I print(datplot):\n>\n>    Erreur dans as.numeric(h) : impossible de trouver la fonction \"packet.number\"\n>\n> I have lattice and grid libraries loaded. The exact code I use is\n> datplot<-dotplot(val~quand|id,data=dat,panel=function(...){\n> panel.dotplot(...)\n> panel.abline(h=ref[packet.number()])\n> })\n> print(datplot)\n> What do I do wrong ?\n\nYou are using a very old version of R (or at least old enough that the\npacket.number number didn't exist). You haven't told us what version\nyou are using.\n\nI would encourage you to upgrade, but this might work for now:\n\ndotplot(val~quand|id,data=dat,\n        panel=function(..., panel.number){\n            panel.dotplot(...)\n            panel.abline(h = ref[panel.number])\n})\n\n> Note : I usually need to use the indirect datplot<-dotplot(...  and then\n> print(datplot) when I store my code in a file and use it through\n> source(\"myfile.R\"). The direct dotplot(... does not open a device whereas it\n> does if I type directly dotplot(... at the R command line...\n> Is this normal ?\n\nYes, and a FAQ:\n\nhttp://cran.r-project.org/doc/FAQ/R-FAQ.html#Why-do-lattice_002ftrellis-graphics-not-work_003f\n\n-Deepayan\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}