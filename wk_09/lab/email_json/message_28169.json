{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r22814 - in branches/SAMBA_3_0_25/source/python: .", "body": "Author: vlendec\nDate: 2007-05-12 11:08:42 +0000 (Sat, 12 May 2007)\nNew Revision: 22814\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22814\n\nLog:\nFix the python build. Thanks to Steve Langasek!\n\nDoes not apply cleanly to 3_0, working on that.\n\nVolker\n\n\nModified:\n   branches/SAMBA_3_0_25/source/python/py_ntsec.c\n   branches/SAMBA_3_0_25/source/python/py_spoolss_printers_conv.c\n   branches/SAMBA_3_0_25/source/python/py_srvsvc.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0_25/source/python/py_ntsec.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/python/py_ntsec.c\t2007-05-12 07:44:09 UTC (rev 22813)\n+++ branches/SAMBA_3_0_25/source/python/py_ntsec.c\t2007-05-12 11:08:42 UTC (rev 22814)\n@@ -60,7 +60,7 @@\n \n \t*dict = Py_BuildValue(\"{sisisi}\", \"type\", ace->type,\n \t    \t\t\t\"flags\", ace->flags,\n-\t\t\t\t\"mask\", ace->info.mask);\n+\t\t\t\t\"mask\", ace->access_mask);\n \n \tif (py_from_SID(&obj, &ace->trustee)) {\n \t\tPyDict_SetItemString(*dict, \"trustee\", obj);\n@@ -103,7 +103,7 @@\n \t    !PyInt_Check(obj))\n \t\treturn False;\n \n-\tsec_access.mask = PyInt_AsLong(obj);\n+\tsec_access = PyInt_AsLong(obj);\n \n \tinit_sec_ace(ace, &trustee, ace_type, sec_access, ace_flags);\n \n@@ -130,7 +130,7 @@\n \tfor (i = 0; i < acl->num_aces; i++) {\n \t\tPyObject *obj;\n \n-\t\tif (py_from_ACE(&obj, &acl->ace[i]))\n+\t\tif (py_from_ACE(&obj, &acl->aces[i]))\n \t\t\tPyList_SetItem(ace_list, i, obj);\n \t}\n \n@@ -157,16 +157,16 @@\n \t\n \tacl->num_aces = PyList_Size(obj);\n \n-\tacl->ace = _talloc(mem_ctx, acl->num_aces * sizeof(SEC_ACE));\n+\tacl->aces = _talloc(mem_ctx, acl->num_aces * sizeof(SEC_ACE));\n \tacl->size = SEC_ACL_HEADER_SIZE;\n \n \tfor (i = 0; i < acl->num_aces; i++) {\n \t\tPyObject *py_ace = PyList_GetItem(obj, i);\n \n-\t\tif (!py_to_ACE(&acl->ace[i], py_ace))\n+\t\tif (!py_to_ACE(&acl->aces[i], py_ace))\n \t\t\treturn False;\n \n-\t\tacl->size += acl->ace[i].size;\n+\t\tacl->size += acl->aces[i].size;\n \t}\n \n \treturn True;\n@@ -191,7 +191,7 @@\n \t\tPy_DECREF(obj);\n \t}\n \n-\tif (py_from_SID(&obj, sd->grp_sid)) {\n+\tif (py_from_SID(&obj, sd->group_sid)) {\n \t\tPyDict_SetItemString(*dict, \"group_sid\", obj);\n \t\tPy_DECREF(obj);\n \t}\n\nModified: branches/SAMBA_3_0_25/source/python/py_spoolss_printers_conv.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/python/py_spoolss_printers_conv.c\t2007-05-12 07:44:09 UTC (rev 22813)\n+++ branches/SAMBA_3_0_25/source/python/py_spoolss_printers_conv.c\t2007-05-12 11:08:42 UTC (rev 22814)\n@@ -103,7 +103,6 @@\n };\t\n \n struct pyconv py_PRINTER_INFO_3[] = {\n-\t{ \"flags\", PY_UINT32, offsetof(PRINTER_INFO_3, flags) },\n \t{ NULL }\n };\t\n \n\nModified: branches/SAMBA_3_0_25/source/python/py_srvsvc.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/python/py_srvsvc.c\t2007-05-12 07:44:09 UTC (rev 22813)\n+++ branches/SAMBA_3_0_25/source/python/py_srvsvc.c\t2007-05-12 11:08:42 UTC (rev 22814)\n@@ -122,7 +122,7 @@\n \n \tstatus = rpccli_srvsvc_net_srv_get_info(cli->pipe_list, mem_ctx, level, &ctr);\n \n-\tif (!NT_STATUS_IS_OK(status)) {\n+\tif (!W_ERROR_IS_OK(status)) {\n \t\tPyErr_SetObject(srvsvc_error, py_werror_tuple(status));\n \t\tgoto done;\n \t}\n\n"}