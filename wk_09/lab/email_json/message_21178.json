{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22624 - in branches/SAMBA_4_0/source/selftest: .", "body": "Author: metze\nDate: 2007-05-01 03:28:12 +0000 (Tue, 01 May 2007)\nNew Revision: 22624\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22624\n\nLog:\n- configure other auth methods for the member server\n- use the netbiosname as domain and realm for the provision\n  of the member server\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/selftest/Samba4.pm\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/selftest/Samba4.pm\n===================================================================\n--- branches/SAMBA_4_0/source/selftest/Samba4.pm\t2007-05-01 03:26:01 UTC (rev 22623)\n+++ branches/SAMBA_4_0/source/selftest/Samba4.pm\t2007-05-01 03:28:12 UTC (rev 22624)\n@@ -485,6 +485,14 @@\n \tmkdir($_, 0777) foreach ($privatedir, $etcdir, $piddir, $ncalrpcdir, $lockdir, \n \t\t$tmpdir);\n \n+\tmy $auth_methods = \"anonymous sam_ignoredomain\";\n+\t$auth_methods = \"anonymous sam winbind\" if $server_role eq \"member server\";\n+\n+\tmy $localdomain = $domain;\n+\t$localdomain = $netbiosname if $server_role eq \"member server\";\n+\tmy $localrealm = $realm;\n+\t$localrealm = $netbiosname if $server_role eq \"member server\";\n+\n \topen(CONFFILE, \">$conffile\");\n \tprint CONFFILE \"\n [global]\n@@ -505,6 +513,7 @@\n \tpanic action = $srcdir/script/gdb_backtrace \\%PID% \\%PROG%\n \twins support = yes\n \tserver role = $server_role\n+\tauth methods = $auth_methods\n \tmax xmit = 32K\n \tserver max protocol = SMB2\n \tnotify:inotify = false\n@@ -596,8 +605,8 @@\n \tpush (@provision_options, \"--host-name=$netbiosname\");\n \tpush (@provision_options, \"--host-ip=$ifaceipv4\");\n \tpush (@provision_options, \"--quiet\");\n-\tpush (@provision_options, \"--domain $domain\");\n-\tpush (@provision_options, \"--realm $realm\");\n+\tpush (@provision_options, \"--domain $localdomain\");\n+\tpush (@provision_options, \"--realm $localrealm\");\n \tpush (@provision_options, \"--adminpass $password\");\n \tpush (@provision_options, \"--krbtgtpass krbtgt$password\");\n \tpush (@provision_options, \"--machinepass machine$password\");\n\n"}