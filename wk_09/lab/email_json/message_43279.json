{"category": "ham", "to_address": "tridge@samba.org", "from_address": "James Peach <jpeach@samba.org>", "subject": "Re: getting rid of mkproto.sh from Samba3", "body": "On 05/06/2007, at 5:10 PM, tridge@samba.org wrote:\n\n> James,\n>\n>> If I have a decent header file, I can see the full interface in a\n>> single screen, along with comments, macros and typedefs. I don't  \n>> think\n>> the argument about the extra typing involved in changing headers by\n>> hand is very strong, since the code needs to be read and understood\n>> thousands more times than it needs to be written.\n>\n> It is not the extra typing, it's the mistakes. Before we had auto\n> prototypes in Samba the following mistakes were common:\n>\n>  *) leaving a prototype in a header for a function that has been\n>   removed. I don't know of any tool that will find/remove those.\n>\n>  *) getting details in the prototype wrong, especially the varargs\n>   functions with printf arguments.\n>\n>  *) when the arguments to a function change, and the prototype isn't\n>   updated. This is especially insidious when the new and old arguments\n>   are type compatible, but change their meaning, so the old prototype\n>   is completely misleading (ie. is still takes an int as the 3rd\n>   argument, but now its a set of flags, not a counter)\n>\n>  *) once you start breaking up your includes out of a single\n>   includes.h, then you risk getting the prototype completely wrong if\n>   the source file of the function doesn't include the prototype\n>   header. The compiler won't complain.\n>\n>  *) programmers add nice comments to the prototype header, which is in\n>   a completely different file to the code. Those comments will degrade\n>   over time as the code changes and the comment is not upgraded, so\n>   those nice docs that you do this month will become completely wrong\n>   by next year, and the person updating the function will not notice,\n>   as the prototype is not on the same screen as the code they are\n>   changing.\n\nOK, these are pretty convincing. I'll take a look at integrating the  \nSamba4 mkproto, that seems uncontroversial and likely to improve things.\n\n--\nJames Peach | jpeach@samba.org\n\n\n"}