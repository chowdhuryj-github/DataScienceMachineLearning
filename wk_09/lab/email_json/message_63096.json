{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"James Foadi\" <james.foadi@diamond.ac.uk>", "subject": "Re: [R] unexpected result in function valuation", "body": "True.\nI've corrected my function in this way:\n\n#######################################\nsinca <- function(N,th)\n\n{\n\nmod_th <- th%%(2*pi)\n\nif (mod_th == 0)\n\n{\n\nff <- 2*N+1\n\n}\n\nelse\n\n{\n\nff <- sin((N+0.5)*th)/sin(0.5*th)\n\n}\n\nreturn(ff)\n\n}\n\n#######################################\n\nThe function is equal to 2*N+1 at 0, 2Pi, 4Pi, etc.\n\nStill having the same problem.\n\nJ\n\n  ----- Original Message ----- \n  From: jim holtman \n  To: James Foadi \n  Cc: r-help@stat.math.ethz.ch \n  Sent: Thursday, July 05, 2007 8:44 PM\n  Subject: Re: [R] unexpected result in function valuation\n\n\n  Very simple; it is your function.  You need to step through and see that you are evaluating close to zero:\n\n  > x[701]\n  [1] 6.283185\n  > sin((4.5*x[701]))\n  [1] -1.666142e-14\n  > sin(.5*x[701])\n  [1] -1.653896e-15\n  > sin((4.5*x[701]))/sin(.5*x[701])\n  [1] 10.07404\n  > \n   \n  With numbers that small you might be losing significance.  See the FAQ on floating point numbers.\n\n   \n  On 7/5/07, James Foadi  wrote: \n    Dear all,\n    I have a very small script to plot a function. Here it is:\n\n    ########################################## \n    sinca <- function(N,th)\n\n    {\n\n    return(sin((N+0.5)*th)/sin(0.5*th))\n\n    }\n\n    plot_sinca <- function(N)\n\n    {\n\n    x <- seq(-5*pi,5*pi,by=pi/100)\n\n    y <- rep(0,length=length(x))\n\n    for (i in 1:length(x))y[i] <- sinca(N,x[i])\n\n    plot(x,y,type=\"l\",ylim=c(0,2*N+4))\n\n    return(c(x,y))\n\n    }\n\n    ##########################################\n\n    When I load the script and run the function like this: \n\n    ###########################################\n    > data <- plot_sinca(4)\n    > y <- data[1002:2002]\n    ###########################################\n\n    I notice a spike on the plot which should not be there. \n    In fact I have checked and:\n    ###########################################\n    > y[701]\n    [1] 10.07404\n    > sinca(4,2*pi)\n    [1] 9\n    ###########################################\n\n    The second result is the correct one. Why, then do \n    I get the y[701]=10.07404? This function is not supposed\n    to be higher than 9...\n\n    Any help is greatly appreciated.\n\n    Regards,\n\n    J\n\n    Dr James Foadi\n    Membrane Protein Laboratory\n    Diamond Light Source Ltd \n    Chilton, Didcot\n    Oxfordshire OX11 0DE\n    ---\n\n           [[alternative HTML version deleted]]\n\n    ______________________________________________\n    R-help@stat.math.ethz.ch mailing list\n    https://stat.ethz.ch/mailman/listinfo/r-help\n    PLEASE do read the posting guide http://www.R-project.org/posting-guide.html \n    and provide commented, minimal, self-contained, reproducible code.\n\n\n\n\n  -- \n  Jim Holtman\n  Cincinnati, OH\n  +1 513 646 9390\n\n  What is the problem you are trying to solve? \n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}