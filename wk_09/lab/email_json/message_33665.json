{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Viechtbauer Wolfgang \\(STAT\\)\" <Wolfgang.Viechtbauer@STAT.unimaas.nl>", "subject": "[R] Boostrap p-value in regression [indirectly related to R]", "body": "Hello All,\n\nDespite my preference for reporting confidence intervals, I need to\nobtain a p-value for a hypothesis test in the context of regression\nusing bootstrapping. I have read John Fox's chapter on bootstrapping\nregression models and have consulted Efron & Tibshirani's \"An\nIntroduction to the Bootstrap\" but I just wanted to ask the experts here\nfor some feedback to make sure that I am not doing something wrong.\n\nLet's take a simplified example where the model includes one independent\nvariable and the idea is to test H0: beta1 = 0 versus Ha: beta1 != 0.\n\n########################################################\n\n### generate some sample data\n\nn  <- 50\nxi <- runif(n, min=1, max=5)\nyi <- 0 + 0.2 * xi + rnorm(n, mean=0, sd=1)\n\n### fit simple regression model\n\nmod <- lm(yi ~ xi)\nsummary(mod)\nb1  <- coef(mod)[2]\nt1  <- coef(mod)[2] / coef(summary(mod))[2,2]\n\n### 1000 bootstrap replications using (X,Y)-pair resampling\n\nt1.star <- rep(NA,1000)\n\nfor (i in 1:1000) {\n\n  ids        <- sample(1:n, replace=TRUE)\n  newyi      <- yi[ids]\n  newxi      <- xi[ids]  \n  mod        <- lm(newyi ~ newxi)\n  t1.star[i] <- ( coef(mod)[2] - b1) / coef(summary(mod))[2,2]\n\n}\n\n### get bootstrap p-value\n\nhist(t1.star, nclass=40)\nabline(v=t1, lwd=3)\nabline(v=-1*t1, lwd=3)\n2 * mean( t1.star > abs(t1) )\n\n########################################################\n\nAs suggested in the chapter on bootstrapping regression models by John\nFox, the bootstrap p-value is 2 times the proportion of bootstrap\nt-values (with b1 subtracted so that we get the distribution under H0)\nlarger than the absolute value of the actual t-value observed in the\ndata. \n\nDoesn't this assume that the bootstrap sampling distribution is\nsymmetric? And if yes, would it then not be more reasonable to\ncalculate:\n\nmean( abs(t1.star) > abs(t1) )\n\nor in words: the number of bootstrap t-values that are more extreme on\neither side of the bootstrap distribution than the actual t-value\nobserved?\n\nAny suggestions or comments would be appreciated!\n\n-- \nWolfgang Viechtbauer \n Department of Methodology and Statistics \n University of Maastricht, The Netherlands \n http://www.wvbauer.com\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}