{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 228: fixed a lib/events bug found by volker in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 228\nrevision-id: tridge@samba.org-20070501205012-nlrvpj4m3znvumdz\nparent: tridge@samba.org-20070501032502-6fk64ptyeqjybf45\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Wed 2007-05-02 06:50:12 +1000\nmessage:\n  fixed a lib/events bug found by volker\nmodified:\n  lib/events/events_standard.c   events_standard.c-20061117234101-o3qt14umlg9en8z0-30\n=== modified file 'lib/events/events_standard.c'\n--- a/lib/events/events_standard.c\t2006-11-17 23:41:20 +0000\n+++ b/lib/events/events_standard.c\t2007-05-01 20:50:12 +0000\n@@ -377,9 +377,10 @@\n \tfde->additional_data\t= NULL;\n \n \tDLIST_ADD(std_ev->fd_events, fde);\n-\tif (fde->fd > std_ev->maxfd) {\n-\t\tstd_ev->maxfd = fde->fd;\n-\t}\n+\tif ((std_ev->maxfd != EVENT_INVALID_MAXFD)\n+\t    && (fde->fd > std_ev->maxfd)) {\n+ \t\tstd_ev->maxfd = fde->fd;\n+ \t}\n \ttalloc_set_destructor(fde, std_event_fd_destructor);\n \n \tepoll_add_event(std_ev, fde);\n\n"}