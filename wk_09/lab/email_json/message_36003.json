{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "svn commit: samba r23139 - in\n\tbranches/SAMBA_4_0/source/torture/raw: .", "body": "Author: tridge\nDate: 2007-05-25 10:43:06 +0000 (Fri, 25 May 2007)\nNew Revision: 23139\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23139\n\nLog:\n\nuse echo operations once a second in lockbench and openbench to ensure\nwe detect IP takeover on servers\n\nModified:\n   branches/SAMBA_4_0/source/torture/raw/lockbench.c\n   branches/SAMBA_4_0/source/torture/raw/openbench.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/torture/raw/lockbench.c\n===================================================================\n--- branches/SAMBA_4_0/source/torture/raw/lockbench.c\t2007-05-25 10:42:29 UTC (rev 23138)\n+++ branches/SAMBA_4_0/source/torture/raw/lockbench.c\t2007-05-25 10:43:06 UTC (rev 23139)\n@@ -257,6 +257,16 @@\n \tprintf(\"\\r\");\n \tfflush(stdout);\n \tevent_add_timed(ev, state, timeval_current_ofs(1, 0), report_rate, state);\n+\n+\t/* send an echo on each interface to ensure it stays alive - this helps\n+\t   with IP takeover */\n+\tfor (i=0;isession->transport, &p);\n+\t}\n }\n \n /* \n\nModified: branches/SAMBA_4_0/source/torture/raw/openbench.c\n===================================================================\n--- branches/SAMBA_4_0/source/torture/raw/openbench.c\t2007-05-25 10:42:29 UTC (rev 23138)\n+++ branches/SAMBA_4_0/source/torture/raw/openbench.c\t2007-05-25 10:43:06 UTC (rev 23139)\n@@ -297,6 +297,16 @@\n \tprintf(\"\\r\");\n \tfflush(stdout);\n \tevent_add_timed(ev, state, timeval_current_ofs(1, 0), report_rate, state);\n+\n+\t/* send an echo on each interface to ensure it stays alive - this helps\n+\t   with IP takeover */\n+\tfor (i=0;isession->transport, &p);\n+\t}\n }\n \n /* \n@@ -355,6 +365,7 @@\n \t\tstate[i].fnum = smbcli_open(state[i].tree, \n \t\t\t\t\t    fnames[state->file_num], \n \t\t\t\t\t    O_RDWR|O_CREAT, DENY_ALL);\n+\t\tstate[i].old_fnum = state[i].fnum;\n \t\tstate[i].stage = OPEN_OPEN;\n \t\tnext_operation(&state[i]);\n \t}\n\n"}