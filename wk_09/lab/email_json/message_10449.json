{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "Christopher Mason <Mason.Christopher@mayo.edu>", "subject": "net ads join fails with NT_STATUS_WRONG_PASSWORD", "body": "\nHello.\n\nAttempts to join an AD domain fail with NT_STATUS_WRONG_PASSWORD \nunder both samba-3.0.24-10.fc7 and samba-3.0.25-3.rc1.  I've tried \nboth precreating the computer account via Users and Computers and \nnot.  Note that we have a disjoint namespace (AD \ndomain=mfad.mfroot.org, DNS domain=mayo.edu).  This is against win2k3.\n\nCommand is:\n\nnet ads join -d5 \"createcomputer=Research/MCR/Resources/SAMBA Servers \n-- LABS/MPRC\" -S mfadir09.mfad.mfroot.org -Ucjm37\n\nNote that this has worked with previous versions (probably with \n3.0.24-1).\n\nNote also that 3.0.25 prompts for a password where previous versions \ndid not (just used my existing kerberos ticket).\n\nNote further that I'm able to kinit, and I do get a service ticket \nfor the AD server.\n\nI've put some debug output below.  I have full traces, etc. and can \nsend or post but would prefer (due to password issues, length) to not \nsend to the open list.\n\nAny help would be most appreciated,\n\n-c\n\n\n[2007/04/19 18:51:17, 5] rpc_client/cli_pipe.c:rpc_api_pipe(770)\n  rpc_api_pipe: Remote machine MFADIR09.mfad.mfroot.org pipe \\samr \nfnum 0x4001\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(484)\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(494)\n  size=647\n  smb_com=0x25\n  smb_rcls=0\n  smb_reh=0\n  smb_err=0\n  smb_flg=8\n  smb_flg2=51201\n  smb_tid=2048\n  smb_pid=1850\n  smb_uid=2048\n  smb_mid=17\n  smt_wct=16\n  smb_vwv[ 0]=    0 (0x0)\n  smb_vwv[ 1]=  565 (0x235)\n  smb_vwv[ 2]=    0 (0x0)\n  smb_vwv[ 3]= 4280 (0x10B8)\n  smb_vwv[ 4]=    0 (0x0)\n  smb_vwv[ 5]=    0 (0x0)\n  smb_vwv[ 6]=    0 (0x0)\n  smb_vwv[ 7]=    0 (0x0)\n  smb_vwv[ 8]=    0 (0x0)\n  smb_vwv[ 9]=    0 (0x0)\n  smb_vwv[10]=   82 (0x52)\n  smb_vwv[11]=  565 (0x235)\n  smb_vwv[12]=   82 (0x52)\n  smb_vwv[13]=    2 (0x2)\n  smb_vwv[14]=   38 (0x26)\n  smb_vwv[15]=16385 (0x4001)\n  smb_bcc=580\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(484)\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(494)\n  size=84\n  smb_com=0x25\n  smb_rcls=0\n  smb_reh=0\n  smb_err=0\n  smb_flg=136\n  smb_flg2=51205\n  smb_tid=2048\n  smb_pid=1850\n  smb_uid=2048\n  smb_mid=17\n  smt_wct=10\n  smb_vwv[ 0]=    0 (0x0)\n  smb_vwv[ 1]=   28 (0x1C)\n  smb_vwv[ 2]=    0 (0x0)\n  smb_vwv[ 3]=    0 (0x0)\n  smb_vwv[ 4]=   56 (0x38)\n  smb_vwv[ 5]=    0 (0x0)\n  smb_vwv[ 6]=   28 (0x1C)\n  smb_vwv[ 7]=   56 (0x38)\n  smb_vwv[ 8]=    0 (0x0)\n  smb_vwv[ 9]=    0 (0x0)\n  smb_bcc=29\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(484)\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(494)\n  size=84\n  smb_com=0x25\n  smb_rcls=0\n  smb_reh=0\n  smb_err=0\n  smb_flg=136\n  smb_flg2=51205\n  smb_tid=2048\n  smb_pid=1850\n  smb_uid=2048\n  smb_mid=17\n  smt_wct=10\n  smb_vwv[ 0]=    0 (0x0)\n  smb_vwv[ 1]=   28 (0x1C)\n  smb_vwv[ 2]=    0 (0x0)\n  smb_vwv[ 3]=    0 (0x0)\n  smb_vwv[ 4]=   56 (0x38)\n  smb_vwv[ 5]=    0 (0x0)\n  smb_vwv[ 6]=   28 (0x1C)\n  smb_vwv[ 7]=   56 (0x38)\n  smb_vwv[ 8]=    0 (0x0)\n  smb_vwv[ 9]=    0 (0x0)\n  smb_bcc=29\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_debug(84)\n  000000 smb_io_rpc_hdr rpc_hdr\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0000 major     : 05\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0001 minor     : 00\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0002 pkt_type  : 02\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0003 flags     : 03\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0004 pack_type0: 10\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0005 pack_type1: 00\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0006 pack_type2: 00\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0007 pack_type3: 00\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint16(677)\n      0008 frag_len  : 001c\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint16(677)\n      000a auth_len  : 0000\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint32(706)\n      000c call_id   : 0000000b\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_debug(84)\n  000010 smb_io_rpc_hdr_resp rpc_hdr_resp\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint32(706)\n      0010 alloc_hint: 00000004\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint16(677)\n      0014 context_id: 0000\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0016 cancel_ct : 00\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_uint8(616)\n      0017 reserved  : 00\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_debug(84)\n  000000 samr_io_r_set_userinfo\n[2007/04/19 18:51:17, 5] rpc_parse/parse_prs.c:prs_ntstatus(765)\n      0000 status: NT_STATUS_WRONG_PASSWORD\nFailed to set password for machine account (NT_STATUS_WRONG_PASSWORD)\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(484)\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(494)\n  size=35\n  smb_com=0x4\n  smb_rcls=0\n  smb_reh=0\n  smb_err=0\n  smb_flg=136\n  smb_flg2=51205\n  smb_tid=2048\n  smb_pid=1850\n  smb_uid=2048\n  smb_mid=18\n  smt_wct=0\n  smb_bcc=0\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(484)\n[2007/04/19 18:51:17, 5] lib/util.c:show_msg(494)\n  size=35\n  smb_com=0x71\n  smb_rcls=0\n  smb_reh=0\n  smb_err=0\n  smb_flg=136\n  smb_flg2=51205\n  smb_tid=2048\n  smb_pid=1850\n  smb_uid=2048\n  smb_mid=19\n  smt_wct=0\n  smb_bcc=0\n[2007/04/19 18:51:17, 1] utils/net_ads.c:net_ads_join(1548)\n  call of net_join_domain failed: Wrong Password\n\n-- \n[ Christopher Mason  MPRC Bioinformatics  http://proteomics ]\n\n"}