{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r23671 - in branches: SAMBA_3_0/source/include\n\tSAMBA_3_0/source/intl SAMBA_3_0_26/source/include\n\tSAMBA_3_0_26/source/intl", "body": "Author: vlendec\nDate: 2007-07-01 19:40:04 +0000 (Sun, 01 Jul 2007)\nNew Revision: 23671\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23671\n\nLog:\nRemove unused code -- 16416 bytes of bss space...\n\nModified:\n   branches/SAMBA_3_0/source/include/intl.h\n   branches/SAMBA_3_0/source/intl/lang_tdb.c\n   branches/SAMBA_3_0_26/source/include/intl.h\n   branches/SAMBA_3_0_26/source/intl/lang_tdb.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/include/intl.h\n===================================================================\n--- branches/SAMBA_3_0/source/include/intl.h\t2007-07-01 19:11:40 UTC (rev 23670)\n+++ branches/SAMBA_3_0/source/include/intl.h\t2007-07-01 19:40:04 UTC (rev 23671)\n@@ -21,5 +21,4 @@\n \n /* ideally we would have a static mapping, but that precludes\n    dynamic loading. This is a reasonable compromise */\n-#define _(x) lang_msg_rotate(x)\n #define N_(x) (x)\n\nModified: branches/SAMBA_3_0/source/intl/lang_tdb.c\n===================================================================\n--- branches/SAMBA_3_0/source/intl/lang_tdb.c\t2007-07-01 19:11:40 UTC (rev 23670)\n+++ branches/SAMBA_3_0/source/intl/lang_tdb.c\t2007-07-01 19:40:04 UTC (rev 23671)\n@@ -231,32 +231,6 @@\n \tfree((void *)msgstr);\n }\n \n-\n-/*\n-  when the _() translation macro is used there is no obvious place to free\n-  the resulting string and there is no easy way to give a static pointer.\n-  All we can do is rotate between some static buffers and hope a single d_printf() \n-  doesn't have more calls to _() than the number of buffers \n-*/\n-const char *lang_msg_rotate(const char *msgid)\n-{\n-#define NUM_LANG_BUFS 16\n-\tchar *msgstr;\n-\tstatic pstring bufs[NUM_LANG_BUFS];\n-\tstatic int next;\n-\n-\tmsgstr = (char *)lang_msg(msgid);\n-\tif (!msgstr) return msgid;\n-\n-\tpstrcpy(bufs[next], msgstr);\n-\tmsgstr = bufs[next];\n-\n-\tnext = (next+1) % NUM_LANG_BUFS;\n-\t\n-\treturn msgstr;\n-}\n-\n-\n /* \n    return the current language - needed for language file mappings \n */\n\nModified: branches/SAMBA_3_0_26/source/include/intl.h\n===================================================================\n--- branches/SAMBA_3_0_26/source/include/intl.h\t2007-07-01 19:11:40 UTC (rev 23670)\n+++ branches/SAMBA_3_0_26/source/include/intl.h\t2007-07-01 19:40:04 UTC (rev 23671)\n@@ -21,5 +21,4 @@\n \n /* ideally we would have a static mapping, but that precludes\n    dynamic loading. This is a reasonable compromise */\n-#define _(x) lang_msg_rotate(x)\n #define N_(x) (x)\n\nModified: branches/SAMBA_3_0_26/source/intl/lang_tdb.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/intl/lang_tdb.c\t2007-07-01 19:11:40 UTC (rev 23670)\n+++ branches/SAMBA_3_0_26/source/intl/lang_tdb.c\t2007-07-01 19:40:04 UTC (rev 23671)\n@@ -231,32 +231,6 @@\n \tfree((void *)msgstr);\n }\n \n-\n-/*\n-  when the _() translation macro is used there is no obvious place to free\n-  the resulting string and there is no easy way to give a static pointer.\n-  All we can do is rotate between some static buffers and hope a single d_printf() \n-  doesn't have more calls to _() than the number of buffers \n-*/\n-const char *lang_msg_rotate(const char *msgid)\n-{\n-#define NUM_LANG_BUFS 16\n-\tchar *msgstr;\n-\tstatic pstring bufs[NUM_LANG_BUFS];\n-\tstatic int next;\n-\n-\tmsgstr = (char *)lang_msg(msgid);\n-\tif (!msgstr) return msgid;\n-\n-\tpstrcpy(bufs[next], msgstr);\n-\tmsgstr = bufs[next];\n-\n-\tnext = (next+1) % NUM_LANG_BUFS;\n-\t\n-\treturn msgstr;\n-}\n-\n-\n /* \n    return the current language - needed for language file mappings \n */\n\n"}