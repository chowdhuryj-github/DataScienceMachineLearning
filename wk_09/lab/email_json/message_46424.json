{"category": "ham", "to_address": "\"Christopher R. Hertel\" <crh@ubiqx.mn.org>", "from_address": "Michael B Allen <mba2000@ioplex.com>", "subject": "Re: [SMB] NTCreateANDX quesiotn", "body": "On Mon, 11 Jun 2007 15:50:04 -0500\n\"Christopher R. Hertel\"  wrote:\n\n> > WordCount\n> > 00000:  2a                                               |*               |\n> > Words\n> > 00000:  ff 00 87 00 03 00 c0 01 00 00 00 80 65 7a c2 f5  |............ez..|\n> > 00010:  77 c3 01 5e 1b 3e 77 91 6c c6 01 80 65 7a c2 f5  |w..^.>w.l...ez..|\n> > 00020:  77 c3 01 28 34 0f 62 2d 21 c4 01 20 00 00 00 00  |w..(4.b-!.. ....|\n> > 00030:  f0 00 00 00 00 00 00 00 e8 00 00 00 00 00 00 00  |................|\n> > 00040:  00 07 00 00 00 00 00 70 00 2e 00 65 00 78 00 65  |.......p...e.x.e|\n> > 00050:  00 00 00 00                                      |....            |\n> > Unknown\n> > 00000:  00 03 81 d8 bf 03 81 20 ff 01 1f 00 00 00 00 00  |....... ........|\n> > 00010:  00 00                                            |..              |\n> > \n> > So I see 'p.exe' in the Words and Wireshark doesn't decode those bytes\n> > so it looks like there's just garbage at the end. Meaning the WordCount\n> > and the NetBIOS header payload size are incorrect (too large).\n> \n> So... my next question.  Is the WordCount value 42 (0x2a) correct (for this\n> packet)?  If so, then the \"p.exe\" string really is part of the Words.\n> \n> ...but you said earlier that you thought the correct value should be closer\n> to 34 (0x22).  If that were the case, the bytecount would be zero and\n> 'p.exe' would not be part of the packet at all.\n> \n> I am curious as to how this packet should be read.\n\nHow it \"should\" read is not important. What is important is the algorithm\nby which you decode and encode this packet.\n\nThis packet's size is whatever the NetBIOS header says it is. There are\nno Bytes in an SMB_COM_NT_CREATE_ANDX and therefore the WordCount should\njust be ignored by clients and encoded by servers with the incorrect\nvalue of 0x2a. Clients and servers should then decode / encode whatever\nparts of the Words they know the format for. The remainder of the packet\nshould contain the user's horiscope or perhaps a fortune.\n\nMike\n\n-- \nMichael B Allen\nPHP Active Directory Kerberos SSO\nhttp://www.ioplex.com/\n\n"}