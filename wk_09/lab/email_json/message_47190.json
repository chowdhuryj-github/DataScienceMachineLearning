{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r23466 - in branches: SAMBA_3_0/source/smbd\n\tSAMBA_3_0_26/source/smbd", "body": "Author: vlendec\nDate: 2007-06-13 11:32:46 +0000 (Wed, 13 Jun 2007)\nNew Revision: 23466\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23466\n\nLog:\nFix RAW-NOTIFY: by using delete on close the notify is triggered deep\ninside close_file() already.\n\nModified:\n   branches/SAMBA_3_0/source/smbd/reply.c\n   branches/SAMBA_3_0_26/source/smbd/reply.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/smbd/reply.c\n===================================================================\n--- branches/SAMBA_3_0/source/smbd/reply.c\t2007-06-13 11:04:31 UTC (rev 23465)\n+++ branches/SAMBA_3_0/source/smbd/reply.c\t2007-06-13 11:32:46 UTC (rev 23466)\n@@ -2012,9 +2012,6 @@\n \t\t}\n \n \t\tcount++;\n-\t\tnotify_fname(conn, NOTIFY_ACTION_REMOVED,\n-\t\t\t     FILE_NOTIFY_CHANGE_FILE_NAME,\n-\t\t\t     directory);\n \t} else {\n \t\tstruct smb_Dir *dir_hnd = NULL;\n \t\tlong offset = 0;\n@@ -2081,9 +2078,6 @@\n \t\t\tcount++;\n \t\t\tDEBUG(3,(\"unlink_internals: succesful unlink [%s]\\n\",\n \t\t\t\t fname));\n-\t\t\tnotify_fname(conn, NOTIFY_ACTION_REMOVED,\n-\t\t\t\t     FILE_NOTIFY_CHANGE_FILE_NAME,\n-\t\t\t\t     fname);\n \t\t}\n \t\tCloseDir(dir_hnd);\n \t}\n\nModified: branches/SAMBA_3_0_26/source/smbd/reply.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/smbd/reply.c\t2007-06-13 11:04:31 UTC (rev 23465)\n+++ branches/SAMBA_3_0_26/source/smbd/reply.c\t2007-06-13 11:32:46 UTC (rev 23466)\n@@ -2011,9 +2011,6 @@\n \t\t}\n \n \t\tcount++;\n-\t\tnotify_fname(conn, NOTIFY_ACTION_REMOVED,\n-\t\t\t     FILE_NOTIFY_CHANGE_FILE_NAME,\n-\t\t\t     directory);\n \t} else {\n \t\tstruct smb_Dir *dir_hnd = NULL;\n \t\tlong offset = 0;\n@@ -2080,9 +2077,6 @@\n \t\t\tcount++;\n \t\t\tDEBUG(3,(\"unlink_internals: succesful unlink [%s]\\n\",\n \t\t\t\t fname));\n-\t\t\tnotify_fname(conn, NOTIFY_ACTION_REMOVED,\n-\t\t\t\t     FILE_NOTIFY_CHANGE_FILE_NAME,\n-\t\t\t\t     fname);\n \t\t}\n \t\tCloseDir(dir_hnd);\n \t}\n\n"}