{"category": "ham", "to_address": "Andrew Bartlett <abartlet@samba.org>", "from_address": "=?ISO-8859-1?Q?Love_H=F6rnquist_=C5strand?= <lha@it.su.se>", "subject": "Re: Issue with PAC and des-cbc-crc", "body": "Andrew,\n\n> I've been chasing down the issue raised on samba-technical, where  \n> kinit\n> from Heimdal 0.6.3 does not pass against Samba4.\n>\n> The issue is that in getting a TGT, we create and sign a PAC.  But the\n> test in pac.c:\n>\n> pac_checksum():819\n>     if (krb5_checksum_is_keyed(context, cktype) == FALSE) {\n> \tkrb5_set_error_string(context, \"PAC checksum type is not keyed\");\n> \treturn EINVAL;\n>     }\n>\n> Fails, because crc isn't a keyed checksum.\n>\n> Does windows just blindly create a PAC for these keytypes, or not  \n> send a\n> PAC, or should we just fail more gracefully?\n>\n> For some reason, the error string doens't make it to the client or the\n> logs, just 'invalid argument'.\n\nI've not looked at what windows does with the pac if the checksum\nisn't an keyed checksum, but having a unkeyed check on the pac\ndoes seem like a bad idea.\n\nWill try to fix the bad error to the client.\n\nLove\n\n\n"}