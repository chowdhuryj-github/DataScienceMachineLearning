{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"joey repice\" <fireseedmusic@gmail.com>", "subject": "[R] R:Maximum likelihood estimation using BHHH and BFGS", "body": "Dear R users,\n\nI am new to R. I would like to find *maximum likelihood estimators for psi\nand alpha* based on the following *log likelihood function*, c is\nconsumption data comprising 148 entries:\n\nfn<-function(c,psi,alpha)\n\n{\n\ns1<-sum(for(i in 1:n){(c[i]-(psi^(-1/alpha)*(lag(c[i],-1))))^2*\n\n(lag(c[i],-1)^((-2)*(alpha+1))\n\n)});\n\ns2<- sum(for(m in 1:n){log(lag(c[m],-1)^(((2)*alpha)+2))});\n\nconstant-(74*s1)-(1/2)*s2}\n\n\n\nIn particular I want to use the BHHH and the BFGS algorithms. I have found\nthe following packages that can be used for the task:  *mle{stats4},\noptim{stats}, maxBHHH{micEcon}, maxBFGS{micEcon}*. I have documented some of\nmy attempts below ((a) package name (b) usage (c) my attempt and\ncorresponding error). In all humility I apologise for any bad coding, and\nask if anyone can *direct me in finding these estimators*.\n\n\n\nYours sincerely.\n\n\n\n\n\n*(1a)  mle{stats4}\n\n(b)  Usage:\n\n     mle(minuslogl, start = formals(minuslogl), method = \"BFGS\",\n\n     fixed = list(), ...)\n\n(For this I use the negative of the log-likelihood function,bn)*\n\n*(c)  >mle(start=list(psi=1,alpha=0),fn, method=\"BFGS\",fixed=list(c=c))*\n\nError in optim(start, f, method = method, hessian = TRUE, ...) :\n\n        non-finite finite-difference value [1]\n\n\n\n*(2a)  optim{stats}\n\n\n\n(b)  optim(par, fn, gr = NULL,\n\n      method = c(\"Nelder-Mead\", \"BFGS\", \"CG\", \"L-BFGS-B\", \"SANN\"),*\n\n*\n\n      lower = -Inf, upper = Inf,\n\n      control = list(), hessian = FALSE, ...)\n\n\n\n(c)  > optim(c(c,1,0),fn, method=\"BFGS\", control=list(c=c))*\n\nError: argument \"psi\" is missing, with no default\n\n\n\n*(3a)     maxBHHH{micEcon}\n\n(b)     Usage: maxBHHH(fn, grad = NULL, hess=NULL, theta, print.level\n= 0, iterlim = 100,   ...)*\n\n* *\n\n*(c) > maxBHHH(fn(c,psi,alpha),theta=list(psi=1,alpha=0))*\n\n Error in psi^(-1/alpha) * (lag(c[i], -1)) :\n\n        time-series/vector length mismatch\n\n\n\n(4a)  maxBFGS{micEcon}\n\n\n\n(b)  Usage: maxBFGS(fn, grad = NULL, theta, print.level = 0, iterlim = 200,\n\n     tol = 1e-06, ... )\n\n*(ci) >  maxBFGS(fn(c,psi,alpha),theta=list(psi=1,alpha=0))*\n\nError in psi^(-1/alpha) * (lag(c[i], -1)) :\n\n        time-series/vector length mismatch\n\n\n\n*(cii)> maxBFGS(fn,theta=list(psi=1,alpha=0))*\n\nError: argument \"psi\" is missing, with no default\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}