{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Thomas Pujol <thomas.pujol@yahoo.com>", "subject": "[R] shoudl I use apply, sapply, etc instead of a \"for loop\"?", "body": "I have been trying to learn the various \"apply\" functions but am still learning their appropriate use.  I appreciate any help the R community can offer me.  Sorry for the length of this post.\n\nBackground:\n\nI have data on my hard drive organized in the following manner:\n\nThe data pertains to many different \"samples\" of data. (e.g. sample 001, sample, 002, sample 003, etc.)\n\nEach \"sample\" contains many different \"data frames\" for a large number of different data-items. \n(e.g. sat score, median income of zip-code, gender, GPA, etc)\n\nThe data frames and files are each named with the data-item name as the \"prefix\" of the name and the \"sample number\" as the suffix of the name.\ne.g. sat.001, income.001, sat.002, income.002\n\nEach data frame has approximately 5,000 rows, 1 for each \"person\".\n\nNote: The files are somehat large, and most of my analysis will be completed within each \"sample\" .  (Thus, I think that I should probably keep the files stored as separate files, and not combine them into a larger list or data frames. I also do not think I want to load all the files for multiple samples at once, as this mayy take up too much memory.)  Also, I have similar simplified description of the files; many contain multiple columns of data.\n\n\n###############\nI have written a \"for\" loop that does the following:\n\na. For each \"sample period\" I load two files.\nb. I perform a function on the data contain din these two files.\nc. I take the results and save them as a new file.\nI proceed to the next sample.\n\nIs there a \"better\" (i.e. more elegant and/or efficient) way to do this, perhaps with one of the \"apply\" functions? (e.g. apply, sapply, lapply, tapply?)\n\n#e.g. my simplified code\n\n#this creates example data:\nsat.001=c(500,400,750)\nsat.002=c(245,455,767)\n\nincome.001=c(5020,4200,7250)\nincome.002=c(2425,4525,7627)\n\nfilenames=c('sat.001', 'sat.002', 'income.001', 'income.002')\nsapply(filenames,function(x) { save( list=x , file = paste(x ,'.r', sep ='')  ) })\nrm(sat.001,sat.002,income.001,income.002,filenames)\nls() #\n##############\n#my for loop\n\ndivide = function(x,y) {x/y} \n#creates a custom function\n\n\n#inputs to my loop:\nsamplenames=c('001','002')\nx.name='sat'\ny.name='income'\nfun='divide'\n\nfor (i in 1:length(samplenames) ) {\n\nx.name.suf = paste(x.name,samplenames[i],sep='.') \n#name of x file on hrd drive\n\ny.name.suf = paste(y.name,samplenames[i],sep='.') \n#name of y file on hrd drive\n\nx=get(load(file = paste(x.name.suf ,'r', sep ='.')  , envir = .GlobalEnv) ) \n#loads and gets the x file\n\ny=get(load(file = paste(y.name.suf ,'r', sep ='.')  , envir = .GlobalEnv) ) \n#loads and gets the y file\n\ntemp=get(fun)(x,y) \n#applies custom function specified in arguments above\n# to data  contained in x and y files\n\nsave( list='temp' , file = paste(fun,x.name ,y.name,samplenames[i],sep='.') ) \n#save the results in files with name that specifies \n#name of function, name of x, name of y, and sample number\n#files will be used for later analysis\n\nrm(list=paste(x.name.suf , sep ='.'))\nrm(list=paste(y.name.suf , sep ='.'))\nrm(x.name.suf,y.name.suf,x,y,temp)\n}\n\nrm(divide,samplenames,x.name,y.name,fun,i)\nls()\n\n\n \n---------------------------------\nBored stiff? Loosen up...\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}