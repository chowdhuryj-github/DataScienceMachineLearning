{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jra@samba.org", "subject": "svn commit: samba r23577 - in branches: SAMBA_3_0/source/nsswitch\n\tSAMBA_3_0_25/source/nsswitch SAMBA_3_0_26/source/nsswitch", "body": "Author: jra\nDate: 2007-06-21 22:10:41 +0000 (Thu, 21 Jun 2007)\nNew Revision: 23577\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23577\n\nLog:\nFix winbindd (sorry). Ensure I set the new child_pid\nvariable at the correct point just before the write\ncall is scheduled.\nJeremy.\n\nModified:\n   branches/SAMBA_3_0/source/nsswitch/winbindd_dual.c\n   branches/SAMBA_3_0_25/source/nsswitch/winbindd_dual.c\n   branches/SAMBA_3_0_26/source/nsswitch/winbindd_dual.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/nsswitch/winbindd_dual.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/winbindd_dual.c\t2007-06-21 21:17:06 UTC (rev 23576)\n+++ branches/SAMBA_3_0/source/nsswitch/winbindd_dual.c\t2007-06-21 22:10:41 UTC (rev 23577)\n@@ -131,7 +131,6 @@\n \tstate->response = response;\n \tstate->continuation = continuation;\n \tstate->private_data = private_data;\n-\tstate->child_pid = child->pid;\n \n \tDLIST_ADD_END(child->requests, state, struct winbindd_async_request *);\n \n@@ -306,6 +305,9 @@\n \t\treturn;\n \t}\n \n+\t/* Now we know who we're sending to - remember the pid. */\n+\trequest->child_pid = child->pid;\n+\n \tsetup_async_write(&child->event, request->request,\n \t\t\t  sizeof(*request->request),\n \t\t\t  async_main_request_sent, request);\n\nModified: branches/SAMBA_3_0_25/source/nsswitch/winbindd_dual.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/nsswitch/winbindd_dual.c\t2007-06-21 21:17:06 UTC (rev 23576)\n+++ branches/SAMBA_3_0_25/source/nsswitch/winbindd_dual.c\t2007-06-21 22:10:41 UTC (rev 23577)\n@@ -131,7 +131,6 @@\n \tstate->response = response;\n \tstate->continuation = continuation;\n \tstate->private_data = private_data;\n-\tstate->child_pid = child->pid;\n \n \tDLIST_ADD_END(child->requests, state, struct winbindd_async_request *);\n \n@@ -306,6 +305,9 @@\n \t\treturn;\n \t}\n \n+\t/* Now we know who we're sending to - remember the pid. */\n+\trequest->child_pid = child->pid;\n+\n \tsetup_async_write(&child->event, request->request,\n \t\t\t  sizeof(*request->request),\n \t\t\t  async_main_request_sent, request);\n\nModified: branches/SAMBA_3_0_26/source/nsswitch/winbindd_dual.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/nsswitch/winbindd_dual.c\t2007-06-21 21:17:06 UTC (rev 23576)\n+++ branches/SAMBA_3_0_26/source/nsswitch/winbindd_dual.c\t2007-06-21 22:10:41 UTC (rev 23577)\n@@ -131,7 +131,6 @@\n \tstate->response = response;\n \tstate->continuation = continuation;\n \tstate->private_data = private_data;\n-\tstate->child_pid = child->pid;\n \n \tDLIST_ADD_END(child->requests, state, struct winbindd_async_request *);\n \n@@ -306,6 +305,9 @@\n \t\treturn;\n \t}\n \n+\t/* Now we know who we're sending to - remember the pid. */\n+\trequest->child_pid = child->pid;\n+\n \tsetup_async_write(&child->event, request->request,\n \t\t\t  sizeof(*request->request),\n \t\t\t  async_main_request_sent, request);\n\n"}