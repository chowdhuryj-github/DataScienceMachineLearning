{"category": "ham", "to_address": "Chris Myers <chris.myers.314159@gmail.com>", "from_address": "\"Francisco J. Zagmutt\" <gerifalte28@hotmail.com>", "subject": "Re: [R] nlme trouble", "body": "I didn't look at your code closely but I suspect you are taking the log \nof zeros, hence the  NA/NaN/Inf error you are getting...\n\nFrancisco\n\n\nChris Myers wrote:\n> I am not certain how nlme works so I followed an example from the web (\n> http://www.menne-biomed.de/gastempt/gastempt1.html). I was able to\n> successfully reproduce the example. However, when I modified my the example\n> to use my data and with my formula, I get a set of errors having to do with\n> the log() function. I get 10 of them (all exactly the same) and there are 10\n> levels in my factor variable. This seems significant to me.\n> \n> Below is a list of the code I modified with comments that should help\n> understand what I am trying to do. If you enter the code in order from top\n> to bottom you will recreate what I did. If you think that the data is at\n> fault and want to see it, I can provide it. Also, under the code is the\n> errors that I get when I run the nlsList function.\n> \n> Also, can nlme handle more than one independent at a time?\n> And I was wondering what the \"model=as.character(mCall[[1]])\" line in the\n> code did. Removing it does not seem to change the error that I receive.\n> \n> My OS is WinXP.\n> \n> Thank You in advance,\n> Chris\n> \n> \n> \n> ###########List of the code that I modified with comments##########\n> \n> library(nlme)\n> \n> BiLinInit0= function(mCall,LHS,data)\n> {\n>   model=as.character(mCall[[1]])        #I don't know what this does\n> \n>   a <- tan(pi/4)                # 45 degree angle (rising slope)\n>   b <- -tan(pi/4)                # 45 degree angle (desending slope)\n>   c <- 0                    # intercept\n>   nu <- 0.434\n>   xy <- sortedXyData(mCall[[\"x\"]], LHS, data)\n>   x <- xy[[\"x\"]]\n>   x0 <- (min(x)+max(x))/2 + nu*((log(a, exp(1)) - log(b, exp(1))))/(a+b)\n>  #log defaults to base e\n> \n>   value = c(nu,a,b,c,x0)\n>   names(value)=mCall[c(\"nu\",\"a\",\"b\",\"c\",\"x0\")]\n>   value\n> }\n> \n> SSBiLin=selfStart(~-nu*log(exp(-a*(x-x0)/nu)+exp(b*(x-x0))/nu, exp(1))+c,\n>   initial=BiLinInit0, parameters= c(\"nu\",\"a\",\"b\",\"c\",\"x0\"))            #log\n> defaults to base e, but I used exp(1) just to be sure (tried with just\n> log(x) as well)\n> \n> ge = read.table(\"G:\\\\SSNon-Linear\\\\BINDING DATA fixed DESCRIPTORS\n> ONLY.csv\",sep=\",\",header=TRUE)\n>  #Load in my data set\n> \n> ge$study = as.factor(ge$study)                            #Force study to be\n> a factor variable\n> \n> gelist = nlsList(RBA~SSBiLin(Molecular.Volume,nu,a,b,c,x0)|study,data=ge)\n>  #This is where I get the error\n> \n> contr = nlmeControl(pnlsTol=0.3)\n> ge0.nlme=nlme(gelist,control=contr,verbose=F)\n> \n> \n> ##########Errors#######################\n> \n>> gelist = nlsList(RBA~SSBiLin(Molecular.Volume,nu,a,b,c,x0)|study,data=ge)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> Error in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n> (arg 1)\n> In addition: Warning message:\n> NaNs produced in: log(x, base)\n> \n> \t[[alternative HTML version deleted]]\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}