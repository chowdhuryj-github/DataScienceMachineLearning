{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 249: added a ctdb control for enabling the tdb seqnum in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 249\nrevision-id: tridge@samba.org-20070504053328-94qersgg4p3pmr1r\nparent: tridge@samba.org-20070504052910-297ykux8e77ka6p0\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Fri 2007-05-04 15:33:28 +1000\nmessage:\n  added a ctdb control for enabling the tdb seqnum\nmodified:\n  common/ctdb_control.c          ctdb_control.c-20070426122724-j6gkpiofhbwdin63-1\n  include/ctdb_private.h         ctdb_private.h-20061117234101-o3qt14umlg9en8z0-13\n=== modified file 'common/ctdb_control.c'\n--- a/common/ctdb_control.c\t2007-05-04 01:41:29 +0000\n+++ b/common/ctdb_control.c\t2007-05-04 05:33:28 +0000\n@@ -395,6 +395,16 @@\n \tcase CTDB_CONTROL_DEREGISTER_SRVID:\n \t\treturn daemon_deregister_message_handler(ctdb, client_id, srvid);\n \n+\tcase CTDB_CONTROL_ENABLE_SEQNUM: {\n+\t\tuint32_t db_id;\n+\t\tstruct ctdb_db_context *ctdb_db;\n+\t\tCHECK_CONTROL_DATA_SIZE(sizeof(db_id));\n+\t\tctdb_db = find_ctdb_db(ctdb, db_id);\n+\t\tif (!ctdb_db) return -1;\n+\t\ttdb_enable_seqnum(ctdb_db->ltdb->tdb);\n+\t\treturn 0;\n+\t}\n+\n \tdefault:\n \t\tDEBUG(0,(__location__ \" Unknown CTDB control opcode %u\\n\", opcode));\n \t\treturn -1;\n\n=== modified file 'include/ctdb_private.h'\n--- a/include/ctdb_private.h\t2007-05-04 01:41:29 +0000\n+++ b/include/ctdb_private.h\t2007-05-04 05:33:28 +0000\n@@ -282,6 +282,7 @@\n \t\t    CTDB_CONTROL_TRAVERSE_DATA,\n \t\t    CTDB_CONTROL_REGISTER_SRVID,\n \t\t    CTDB_CONTROL_DEREGISTER_SRVID,\n+\t\t    CTDB_CONTROL_ENABLE_SEQNUM,\n };\n \n \n\n"}