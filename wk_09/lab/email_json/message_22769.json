{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22659 - in\n\tbranches/SAMBA_3_0/source/lib/replace: . test", "body": "Author: metze\nDate: 2007-05-04 06:59:26 +0000 (Fri, 04 May 2007)\nNew Revision: 22659\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22659\n\nLog:\nmerge from SAMBA_4_0:\n\n- add AC_GNU_SOURCE macro for systems which don't have it\n  (sles8)\n- fix compiler warning on some systems\n\nmetze\nModified:\n   branches/SAMBA_3_0/source/lib/replace/autoconf-2.60.m4\n   branches/SAMBA_3_0/source/lib/replace/test/testsuite.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/lib/replace/autoconf-2.60.m4\n===================================================================\n--- branches/SAMBA_3_0/source/lib/replace/autoconf-2.60.m4\t2007-05-04 06:59:02 UTC (rev 22658)\n+++ branches/SAMBA_3_0/source/lib/replace/autoconf-2.60.m4\t2007-05-04 06:59:26 UTC (rev 22659)\n@@ -1,3 +1,16 @@\n+# AC_GNU_SOURCE\n+# --------------\n+AC_DEFUN([AC_GNU_SOURCE],\n+[AH_VERBATIM([_GNU_SOURCE],\n+[/* Enable GNU extensions on systems that have them.  */\n+#ifndef _GNU_SOURCE\n+# undef _GNU_SOURCE\n+#endif])dnl\n+AC_BEFORE([$0], [AC_COMPILE_IFELSE])dnl\n+AC_BEFORE([$0], [AC_RUN_IFELSE])dnl\n+AC_DEFINE([_GNU_SOURCE])\n+])\n+\n # _AC_C_STD_TRY(STANDARD, TEST-PROLOGUE, TEST-BODY, OPTION-LIST,\n #\t\tACTION-IF-AVAILABLE, ACTION-IF-UNAVAILABLE)\n # --------------------------------------------------------------\n\nModified: branches/SAMBA_3_0/source/lib/replace/test/testsuite.c\n===================================================================\n--- branches/SAMBA_3_0/source/lib/replace/test/testsuite.c\t2007-05-04 06:59:02 UTC (rev 22658)\n+++ branches/SAMBA_3_0/source/lib/replace/test/testsuite.c\t2007-05-04 06:59:26 UTC (rev 22659)\n@@ -511,7 +511,7 @@\n \t\t       \"\\tptr: %p - %p = %d != %d\\n\" \\\n \t\t       \"]\\n\", \\\n \t\t       __STRING(func), __location__, __STRING(func), \\\n-\t\t       str, diff, base, res, _v, _ep, _p, diff - (_ep - _p), diff); \\\n+\t\t       str, diff, base, res, _v, _ep, _p, (int)(diff - (_ep - _p)), diff); \\\n \t\treturn false; \\\n \t} \\\n } while (0)\n\n"}