{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Laurence Amilhat <Laurence.Amilhat@toulouse.inra.fr>", "subject": "[R] multiple plot in odfWeave", "body": "Hello R users,\n\n\nI found the odfWeave package to create an odf document. It seems to be a \nvery nice tool.\nSo i tried to used it to create a report with multiple plot:\n\nI create an odt file with some code inside:\nI connect to a mysql database\nI get a list of projects\nforeach project I would like to make a plot (a map exactly)\n\nthen in a R console I use the odfweave (inFile, outFile) function.\n\n\nWhen I try this, with only one program without the loop on the program \nnames, it\ndraw a map on my odt file, but when i a m doing the loop it doesn't work.\n\nWhen i try to launch the plot (using the loop) in R console directly, \nwithout odfweave, it also works.\n\nDo you know if it is possible to make successive plot in odfWeave document?\n\nThank you for your help,\n\n\nLaurence.\n\n\nHere the code:\n\nMy odt file: test2.odt\n\n<>=\n\n@\n\n<>=\n\nlibrary(\"RMySQL\")\nlibrary(maps)\nlibrary(mapdata)\nlibrary(spmaps)\nlibrary(grid)\nlibrary(plotrix)\n\ndrv <- dbDriver(\"MySQL\")\ncon <- dbConnect(drv, user=\"lamilhat\", password=\"******\", \ndbname=\"Aquagenome\", host=\"mymachine.toulouse.inra.fr\")\n\n@\n\nListe des projets:\n\n<>=\n\nlp <- dbSendQuery(con, \"SELECT nom FROM projets\")\nprojets <- fetch(lp)\nnbr=dim(projets)[1]\nfor (i in 1:nbr)\n{\n    monprojet=(projets)[i,1]\n    myquery=paste(\"SELECT s.longitude, s.latitude, o.orgashort FROM \norganisme o JOIN scientist s ON o.codeorga=s.codeorga JOIN partenaire p \nON p.codescientist=s.codescientist JOIN projets ON \nprojets.codeproj=p.codeproj WHERE projets.nom LIKE \\\"\",monprojet,\"\\\" \nORDER BY s.longitude\", sep=\"\")\n\n    rs <- dbSendQuery(con, myquery )\n    df <- fetch(rs)\n\n    print(df)\n\n    map(database=\"world\", xlim=c(-15,40),ylim=c(27,71), fill=TRUE, \ncol=\"#FFFFCC\")\n    points(df$longitude,df$latitude, col=\"red\", pch=16)    \n                                                 \nspread.labels(df$longitude,df$latitude,df$orgashort,0,bg=\"#CCFFFF\", \nborder=TRUE, cex=0.8, xpad=0.5, ypad=0.8, font=6)\n}\n\n@\n\n\n\nThen in the R console:\n\n >library (odfWeave)\n >inFile <- \"/home/lamilhat/AQUAGENOME/PRESENTATION/RAPPORTS/test_2.odt\"\n >outFile <- \n\"/home/lamilhat/AQUAGENOME/PRESENTATION/RAPPORTS/test_2_out.odt\"\n\n >imageDefs <- getImageDefs()\n >imageDefs$dispWidth <- 7\n >imageDefs$dispHeight <- 6\n >setImageDefs(imageDefs)\n\n >odfWeave(inFile, outFile)\n\n\n\n\n\n\n\n\n\n-- \n====================================================================\n= Laurence Amilhat    INRA Toulouse 31326 Castanet-Tolosan     \t   = \n= Tel: 33 5 61 28 53 34   Email: laurence.amilhat@toulouse.inra.fr =\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}