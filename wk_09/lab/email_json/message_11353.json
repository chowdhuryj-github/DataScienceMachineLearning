{"category": "ham", "to_address": "andreas.danis@univie.ac.at, r-help@stat.math.ethz.ch", "from_address": "rolf@math.unb.ca", "subject": "Re: [R] Estimating a Normal Mixture Distribution", "body": "andreas.danis@univie.ac.at wrote:\n\n        \n\n> mix.gr<-function(p,x){\n> \tp<-p[1]\n> \tu1<-p[2]\n> \ts1<-p[3]\n> \tu2<-p[4]\n> \ts2<-p[5]\n> \tcolSums(attr(lmix2a(x,p,u1,s1,u2,s2),\"gradient\"))}\n> \n          \n\nThe problem is with the position of ``p <- p[1]''.\nAfterwards ``p'' is a scalar and so p[2] etc. are NA.\nAs a result the gradient that is calculated is all NAs.\n\nIf you change the code for mix.gr to\n\nmix.gr<-function(p,x){\n\tu1<-p[2]\n\ts1<-p[3]\n\tu2<-p[4]\n\ts2<-p[5]\n\tp<-p[1]\n\tcolSums(attr(lmix2a(x,p,u1,s1,u2,s2),\"gradient\"))}\n\nthen your procedure seems to work --- at least it gives an answer\ndifferent from the starting values.\n\n                                cheers,\n\n                                        Rolf Turner\n                                        rolf@math.unb.ca\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}