{"category": "ham", "to_address": "\"Albert Pang\" <albert.pang@mac.com>", "from_address": "\"jim holtman\" <jholtman@gmail.com>", "subject": "Re: [R] Looking for the first observation within the month", "body": "Here is one way of doing it:\n\n> x <- \"Date                    Observation\n+ 2007-05-23              20\n+ 2007-05-22              30\n+ 2007-05-21              10\n+ 2007-04-10              50\n+ 2007-04-09              40\n+ 2007-04-07              30\n+ 2007-03-05              10\"\n> x <- read.table(textConnection(x), header=TRUE,\n+     colClasses=c(\"POSIXct\", \"integer\"))\n> # split the data by year-month and find the minimum day\n> minDay <- lapply(split(x, cut(x$Date, breaks='month')), function(month){\n+     month[which.min(month$Date),]   # minimum date in the month\n+ })\n> do.call('rbind', minDay)  # put it back together in a dataframe\n                 Date Observation\n2007-03-01 2007-03-05          10\n2007-04-01 2007-04-07          30\n2007-05-01 2007-05-21          10\n>\n\n\n\nOn 5/27/07, Albert Pang  wrote:\n>\n> Hi all, I have a simple data frame, first list is a list of dates (in\n> \"%Y-%m-%d\" format) and second list an observation on that particular\n> date.  There might not be observations everyday.  Let's just say\n> there are no observations on saturdays and sundays.  Now I want to\n> select the first observation of every month into a list.  Is there an\n> easy way to do that?\n>\n> Date                    Observation\n> ----                    -----------\n> 2007-05-23              20\n> 2007-05-22              30\n> 2007-05-21              10\n>\n> 2007-04-10              50\n> 2007-04-09              40\n> 2007-04-07              30\n>\n> 2007-03-05              10\n>\n> The result I need is the data frame\n>\n> 2007-05-21              10\n> 2007-04-07              30\n> 2007-03-05              10\n>\n> or I am equally happy with just the vector c(10, 30, 10)\n>\n> I am new to R and after going through the manuals and the\n> documentation I can gather, I have come up with a convoluted way of\n> doing it\n>\n> 1)  I first get the Date into a vector.  (I am articificially\n> reproducing this vector below and call it A)\n>\n> > A<-c( as.Date(\"2007-05-23\"), as.Date(\"2007-05-22\"), as.Date\n> (\"2007-05-21\"), as.Date(\"2007-04-10\"), as.Date(\"2007-04-09\"), as.Date\n> (\"2007-04-07\"), as.Date(\"2007-03-05\"))\n> > A\n> [1] \"2007-05-23\" \"2007-05-22\" \"2007-05-21\" \"2007-04-10\" \"2007-04-09\"\n> [6] \"2007-04-07\" \"2007-03-05\"\n>\n>\n> 2)  use cut with breaks falling on the months\n>\n> > B<-cut(A, breaks=\"month\")\n> > B\n> [1] 2007-05-01 2007-05-01 2007-05-01 2007-04-01 2007-04-01 2007-04-01\n> [7] 2007-03-01\n> Levels: 2007-03-01 2007-04-01 2007-05-01\n>\n>\n> 3)  then split to get a list of vectors group by the boundary of the\n> date\n>\n> > C<-split(A, B)\n> > C\n> $`2007-03-01`\n> [1] \"2007-03-05\"\n>\n> $`2007-04-01`\n> [1] \"2007-04-10\" \"2007-04-09\" \"2007-04-07\"\n>\n> $`2007-05-01`\n> [1] \"2007-05-23\" \"2007-05-22\" \"2007-05-21\"\n>\n>\n> 4)  in a for loop I loop through the elements within the list (the\n> elements are vectors of dates) with each vector I find the minimum\n> and concatentate it to a final vector D\n>\n> > D<-numeric()\n> > for ( i in 1:length(C)){ D <- c( D, min(C[[i]]))}\n> > class(D)<-\"Date\"\n> > D\n> [1] \"2007-03-05\" \"2007-04-07\" \"2007-05-21\"\n>\n> Next with D, I then go back and find out the positions of the\n> elements in D within A.  And then use the result as an index vector\n> into the vector of observations (which is not shown here)  I feel\n> sure I am doing it the stupid way (or the procedural way)\n>\n> Is there a more declarative way of doing it?  Any pointers will be\n> greatly appreciated!\n>\n> Thanks a lot in advance,\n>\n> Albert Pang\n>\n>\n>\n>\n>\n>        [[alternative HTML version deleted]]\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n\n\n-- \nJim Holtman\nCincinnati, OH\n+1 513 646 9390\n\nWhat is the problem you are trying to solve?\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}