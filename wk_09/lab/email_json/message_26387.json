{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "\"Aravinda Guzzar\" <aguzzar@gmail.com>", "subject": "Registry.tdb and tdb functionality document", "body": "Hi,\n\nI see a difference in the way the registry.tdb is handled in the samba code.\n\n\nWhile all the permanent TDBs viz. gencache.tdb, group_mapping.tdb,\naccount_policy.tdb, share_info.tdb, secrets.tdb.\nschannel_store.tdb etc. are opend with O_RDWR|O_CREAT flags, registry.tdb is\nuniquely been tried to open first with O_RDWR flag and if fails then tried\nwith O_RDWR|O_CREAT flag.\n\n--------------------------\n if ( !(tdb_reg = tdb_open_log(lock_path(\"registry.tdb\"), 0, TDB_DEFAULT,\nO_RDWR, 0600)) )\n {\n  tdb_reg = tdb_open_log(lock_path(\"registry.tdb\"), 0, TDB_DEFAULT,\nO_RDWR|O_CREAT, 0600);\n  if ( !tdb_reg ) {\n   DEBUG(0,(\"regdb_init: Failed to open registry %s (%s)\\n\",\n    lock_path(\"registry.tdb\"), strerror(errno) ));\n   return False;\n  }\n\n  DEBUG(10,(\"regdb_init: Successfully created registry tdb\\n\"));\n }\n\n--------------------------\n\nIs there any special reason/history behind this way of handling this TDB\nfile.\n\nI bumped on this while understanding the way TDBs are designed in samba. Is\nthere any special document to understand the internals of its operations\napart fromt the code study.\n\nThanks in advance for any information regarding this.\nregards\nAravind\n\n"}