{"category": "ham", "to_address": "R-help@stat.math.ethz.ch", "from_address": "\"Robert A. LaBudde\" <ral@lcfltd.com>", "subject": "[R] Curve crosses back to origin in plot", "body": "Another sample problem: In the Windows version of R-2.5.0,\n\ndata(GHQ,package='HSAUR')\nlayout(1)\nGHQ_glm_1<- glm(cbind(cases,non.cases) ~ GHQ, data=GHQ, family=binomial())\nsummary(GHQ_glm_1)\nyfit_glm_1<- predict(GHQ_glm_1, type='response')\nlayout(1)\nplot(probs ~ GHQ,pch=1,col=1,ylab='Probability(Case)', data=GHQ)\nlines(yfit_glm_1 ~ GHQ, pch=3,col=3, data=GHQ)\nlegend(\"topleft\", c(\"linear\", \"logistic\"), pch=c(2,3), col=c(2,3))\n\nEverything is fine, but the predicted values curve in the lines() \nstatement becomes closed by a straight line segment connecting the \nlast point to the first.\n\nHow can this be avoided? It appears to be wrapping due to the change \nfrom GHQ=10 for female to GHQ=0 again for male, bring the curve back \nto the beginning value.\n\nOne way to avoid this is to plot each sex's data in a separate lines() call.\n\nIs there a way of doing this in a single lines() statement? If not, \nI'd like to know. If two lines() are needed, I'd like to know an \nefficient syntax. My attempt would be\n\nlines(yfit_glm_1[0:10] ~ GHQ[0:10], pch=3,col=3, data=GHQ)\nlines(yfit_glm_1[11:22] ~ GHQ[11:22], pch=3,col=3, data=GHQ)\n\nwhich seems inelegant, as it involves numerical ranges that have to \nbe determined by inspection.\n\nThanks again for answering these simple questions that seem to be the \nhardest to find answers for.\n================================================================\nRobert A. LaBudde, PhD, PAS, Dpl. ACAFS  e-mail: ral@lcfltd.com\nLeast Cost Formulations, Ltd.            URL: http://lcfltd.com/\n824 Timberlake Drive                     Tel: 757-467-0954\nVirginia Beach, VA 23464-3239            Fax: 757-467-2947\n\n\"Vere scire est per causas scire\"\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}