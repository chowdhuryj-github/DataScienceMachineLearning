{"category": "ham", "to_address": "beginners@perl.org", "from_address": "Gary Stainburn <gary.stainburn@ringways.co.uk>", "subject": "SOLVED - Re: Tie::Handle::CSV", "body": "Hi folks\n\nThe problem was that the files I'm reading are generated on M$ servers in DOS \nformat.\n\nThis meant that at the end of the file is a line containing the DOS EOF char \n^Z.  Using grep to remove this before reading the file has fixed the problem.\n\nThe error's gone and my program continues as it should.\n\nThanks for your help.\n\nGary\n\nOn Wednesday 27 June 2007 19:49, Chas Owens wrote:\n> On 6/27/07, Jay Savage  wrote:\n> snip\n>\n> > Make sure that the last record in your file is correctly terminated\n> > (i.e. there are no unclosed quotes), and that the last record is\n> > followed immediately by the final newline, which is alos the last\n> > character of the file.\n>\n> snip\n>\n> Try applying the following patch against\n> $YOUR_PERL_DIR/Tie/Handle/CSV.pm.  It extends the error message on a\n> bad parse to make it more readable.\n>\n> --- CSV.pm.bak  2007-06-27 14:39:54.000000000 -0400\n> +++ CSV.pm      2007-06-27 14:46:10.000000000 -0400\n> @@ -151,7 +151,7 @@\n>        if (defined $csv_line)\n>           {\n>           $opts->{'csv_parser'}->parse($csv_line)\n> -            || croak $opts->{'csv_parser'}->error_input();\n> +            || croak \"could not parse: [\" .\n> $opts->{'csv_parser'}->error_input() . \"]\";\n>           if ( $opts->{'header'} )\n>              {\n>              my $parsed_line = $opts->{'simple_reads'}\n\n-- \nGary Stainburn\n \nThis email does not contain private or confidential material as it\nmay be snooped on by interested government parties for unknown\nand undisclosed purposes - Regulation of Investigatory Powers Act, 2000     \n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}