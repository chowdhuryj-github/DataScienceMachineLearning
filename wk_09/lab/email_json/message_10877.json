{"category": "ham", "to_address": "\"Alberto Monteiro\" <albmont@centroin.com.br>", "from_address": "Hans-Peter <gchappi@gmail.com>", "subject": "Re: [R] importing excel-file", "body": "> This is Windows XP, Excel 2003, R 2.4.1.\n> Maybe the problem is with Windows XP. I know that it locks some\n> files, even when I open for reading. For example, if I open 'test.xls'\n> file, then I can't issue the DOS command 'copy test.xls new_test.xls'.\n\nThanks for your information. Will test sometimes later.\n\n\n> I added colClasses = \"double\", and now it works - but I lose all\n> strings, that become NAs (they don't matter - maybe if they matter,\n> I just have to call read.xls twice). Without colClasses = \"double\",\n> the numbers become meaningless stuff.\n\nIf a scalar colClasses argument is given, it will be recycled for all\ncolumns (see help). Thus a character value will be coerced to double\nand becomes NA.\n\nI don't understand though what is the matter with teh numbers becoming\nmeaningless stuff. With:\n\ntest9 <- read.xls( filename, sheet = \"sheet name\", rowNames = FALSE )\n # (dateTimeAs argument default, i.e. \"numeric\")\ndateTimeToStr( test9$NumberColumn )\n\nyou should get valid numbers (and dates). With\ndateTimeAs=\"isodatetime\" there could be localization issues (i.e. the\ndate time formatting of the cell is not recognized). But I'd need a\ntest file to say for sure.\n\n\n-- \nRegards,\nHans-Peter\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}