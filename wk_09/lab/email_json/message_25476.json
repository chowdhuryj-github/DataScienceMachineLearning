{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "William Revelle <wr@revelle.net>", "subject": "[R] strange behavior in data frames with duplicated column names", "body": "Dear R gurus,\n\nThere is an interesting problem with accessing specific items in a \ncolumn of data frame that has incorrectly been given a duplicate \nname, even though addressing the item by row and column number.\nAlthough the column is correctly listed, an item addressed by row and \ncolumn number gives the item with the correct row and the original \nnot the duplicated column.\n\nHere are the instructions to get this problem\n\nx <- matrix(seq(1:12),ncol=3)\ncolnames(x) <- c(\"A\",\"B\",\"A\")   #a redundant name for column 2\nx.df <- data.frame(x)\nx.df        #the redundant name is corrected\nx.df[,3]    #show the column -- this always works\nx.df[2,3]   #this works here\n#now incorrectly label the columns with a duplicate name\ncolnames(x.df) <- c(\"A\",\"B\",\"A\")  #the redundant name is not detected\nx.df\nx.df[,3]     #this works as above and shows the column\nx.df[2,3]    #but this gives the value of the first column, not the third  <---\nrownames(x.df) <- c(\"First\",\"Second\",\"Third\",\"Third\")  #detects duplicate name\nx.df\nx.df[4,]     #correct second row and corrected column names!\nx.df[4,3]    #wrong column\nx.df         #still has the original names with the duplication\n\n\nand corresponding output:\n\n>  x <- matrix(seq(1:12),ncol=3)\n>  colnames(x) <- c(\"A\",\"B\",\"A\")   #a redundant name for column 2\n>  x.df <- data.frame(x)\n>  x.df        #the redundant name is corrected\n   A B A.1\n1 1 5   9\n2 2 6  10\n3 3 7  11\n4 4 8  12\n>  x.df[,3]    #show the column -- this always works\n[1]  9 10 11 12\n>  x.df[2,3]   #this works here\n[1] 10\n>  #now incorrectly label the columns with a duplicate name\n>  colnames(x.df) <- c(\"A\",\"B\",\"A\")  #the redundant name is not detected\n>  x.df\n   A B  A\n1 1 5  9\n2 2 6 10\n3 3 7 11\n4 4 8 12\n>  x.df[,3]     #this works as above and shows the column\n[1]  9 10 11 12\n>  x.df[2,3]    #but this gives the value of the first column, not the \n>third  <---\n[1] 2\n>  rownames(x.df) <- c(\"First\",\"Second\",\"Third\",\"Third\")  #detects \n>duplicate name\nError in `row.names<-.data.frame`(`*tmp*`, value = c(\"First\", \"Second\",  :\n\tduplicate 'row.names' are not allowed\n>  x.df\n   A B  A\n1 1 5  9\n2 2 6 10\n3 3 7 11\n4 4 8 12\n>  x.df[4,]     #correct second row and corrected column names!\n   A B A.1\n4 4 8  12\n>  x.df[4,3]    #wrong column\n[1] 4\n>  x.df         #still has the original names with the duplication\n\n>  unlist(R.Version())\n                                      platform \narch                                            os\n                      \"i386-apple-darwin8.9.1\" \n\"i386\"                                 \"darwin8.9.1\"\n                                        system \nstatus                                         major\n                           \"i386, darwin8.9.1\" \n\"Patched\"                                           \"2\"\n                                         minor \nyear                                         month\n                                         \"5.0\" \n\"2007\"                                          \"04\"\n                                           day \nsvn rev                                      language\n                                          \"25\" \n\"41315\"                                           \"R\"\n                                version.string\n\"R version 2.5.0 Patched (2007-04-25 r41315)\"\n>\n\n\nBill\n\n-- \nWilliam Revelle\t\thttp://personality-project.org/revelle.html\nProfessor\t\t\thttp://personality-project.org/personality.html\nDepartment of Psychology       http://www.wcas.northwestern.edu/psych/\nNorthwestern University\thttp://www.northwestern.edu/\nUse R for statistics:                 http://personality-project.org/r\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}