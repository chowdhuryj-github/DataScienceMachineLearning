{"category": "ham", "to_address": "Perl Beginners <beginners@perl.org>", "from_address": "Goksie <myklass@gmail.com>", "subject": "Re: creating hash from scalar variable", "body": "Matthew J. Avitable wrote:\n> Unf.  Got the picture!  I'll spend my night in the stockades :)\n>\n> -m\n>\n> Rob Dixon wrote:\n>> Matthew J. Avitable wrote:\n>>>\n>>> Given the original string ...\n>>>> my $test =\n>>>>   'NAS-IP-Address = 192.168.42.1\n>>>>   .......\n>>>>   Acct-Unique-Session-Id = \"87d380e1881d226c\"\n>>>>   Timestamp = 1177282824';\n>>>>\n>>>\n>>> You could also invoke perl 5.8's ability to treat an in-memory\n>>> string as a file:\n>>>\n>>> ## get a filehandle on $test\n>>> open(my $fh, '<', \\$test) or die \"Unable to open scalar ref for\n>>> reading: $!\";\n>>>\n>>> while (my $line = <$fh>) {\n>>\n>> Hmm. I don't feel this is an improvement over just\n>>\n>>  foreach (split /\\n/, $line) {\n>>    :\n>>  }\n>>\n>> or even\n>>\n>>  while ($test =~ /(.*\\n?)/g) {\n>>    my $line = $1;\n>>    :\n>>  }\n>>\n>> to avoid duplicating the whole string at once.\n>>\n>>>    ## split on '=' with a max of two resulting fields, clear spaces\n>>> adjacent to '='.\n>>>    ## clear newlines as well.\n>>>    chomp ( my ($k, $v) = split(/\\s*=\\s*/, $line, 2) );\n>>\n>> Why chomp here? You're chomping $k, which /can't/ end in a record, as\n>> well as $v.\n>> Just\n>>\n>>  chomp $line;\n>>  my ($k, $v) = split /\\s*=\\s*/, $line, 2;\n>>\n>> is more appropriate.\n>>\n>>>\n>>>    ## clear out the quotes in the value\n>>>    $v =~ s/\"//og;\n>>\n>> Why use the /o modifier when there are no variables being\n>> interpolated into\n>> the regex?\n>>\n>> Even better (in terms of speed) would be\n>>\n>>  $v =~ tr/\"//d;\n>>\n>> although I admit I tend to use s/// exclusively myself.\n>>\n>> Also why remove the quotes when the OP didn't say he wanted to, and\n>> may actually\n>> need them?\n>>\n>>>    ## do something with your key and value:\n>>>    print \"Key is $k,  Value is: $v\\n\";\n>>>\n>>> }\n>>>\n>>> close $fh;\n>>>\n>>>\n>>> Reading a file line by line is a fairly recognizable pattern to perl\n>>> programmers of all levels, so it may assist future maintainers.\n>>\n>> ...unless it stops working, when opening a string on a filehandle is a\n>> fairly /unrecognisable/ pattern, and the maintainer may be stumped!\n>>\n>> Cheers,\n>>\n>> Rob\n>>\n>\n>\nyes... to apply my code to the actual file....\neverything was printed okay.. using the code below...\nbut i need to separate each entry so that when inserting into mysql db,\nthere wound be mismatch.\n\n#!/usr/bin/perl\n#use strict;\nuse warnings;\n\nmy $fn = 'detail-20070423_1.txt';\nopen $fh,'<', $fn or die $!;\nmy @array;\nwhile(<$fh>){\n  if (/^[A-Za-z]{3}\\s{1}Apr\\s{1}\\d{2}\\s{1}(\\d{2}:?){3}\\d{4}/){\n  print \"\\n\\n\\n\";\n  }else{\n  #if ( !/(^\\s+$){2}/ ){\n      act();\n    }\n}\n\nsub act{\n  my %h;\n foreach (split /\\n/, $_) {\n   my ($key, $val) = split /=/;\n   $h{$key} = $val;\n   print \"$val\";\n }\n}\n\nthanks for the past help.\n\nGoksie.\n\nEXTRACT OF THE detail-20070423_1.txt  is :\n\nMon Apr 23 00:00:24 2007\n    NAS-IP-Address = 10.220.42.41\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    NAS-Port-Type = Async\n    User-Name = \"10.220.42.38\"\n    Called-Station-Id = \"8613508208079\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Stop\n    Acct-Delay-Time = 0\n    Acct-Input-Octets = 0\n    Acct-Output-Octets = 0\n    Acct-Session-Id = \"000000C0000012F5\"\n    Acct-Session-Time = 0\n    Acct-Input-Packets = 0\n    Acct-Output-Packets = 0\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:8613508208079\"\n    Quintum-h323-conf-id = \"34363262 65383833 32656366 00340000\"\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65383833 32656366\n00340000\"\n    Quintum-h323-gw-id = \"mygate\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-setup-time = \"22:58:10.220 UTC Sun Apr 22 2007\"\n    Quintum-h323-connect-time = \"22:59:09.550 UTC Sun Apr 22 2007\"\n    Quintum-h323-disconnect-time = \"22:59:09.550 UTC Sun Apr 22 2007\"\n    Quintum-h323-remote-address = \"10.220.42.38\"\n    Quintum-h323-disconnect-cause = \"1f\"\n    Quintum-h323-voice-quality = \"0\"\n    Quintum-Trunkid-In = \"10.220.42.38\"\n    Quintum-Trunkid-Out = \"10.15.115.79\"\n    h323-incoming-conf-id = \"34363262 65383833 32656366 00340000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"87d380e1881d226c\"\n    Timestamp = 1177282824\n\nMon Apr 23 00:00:39 2007\n    NAS-IP-Address = 10.220.42.41\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    NAS-Port-Type = Async\n    User-Name = \"10.220.42.38\"\n    Called-Station-Id = \"12508632152\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Stop\n    Acct-Delay-Time = 0\n    Acct-Input-Octets = 0\n    Acct-Output-Octets = 0\n    Acct-Session-Id = \"000000C0000012F4\"\n    Acct-Session-Time = 0\n    Acct-Input-Packets = 0\n    Acct-Output-Packets = 0\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:12508632152\"\n    Quintum-h323-conf-id = \"34363262 65383765 32656364 00000000\"\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65383765 32656364\n00000000\"\n    Quintum-h323-gw-id = \"mygate\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-setup-time = \"22:58:05.000 UTC Sun Apr 22 2007\"\n    Quintum-h323-connect-time = \"22:59:24.910 UTC Sun Apr 22 2007\"\n    Quintum-h323-disconnect-time = \"22:59:24.910 UTC Sun Apr 22 2007\"\n    Quintum-h323-remote-address = \"10.220.42.38\"\n    Quintum-h323-disconnect-cause = \"1f\"\n    Quintum-h323-voice-quality = \"0\"\n    Quintum-Trunkid-In = \"10.220.42.38\"\n    Quintum-Trunkid-Out = \"10.128.75.204\"\n    h323-incoming-conf-id = \"34363262 65383765 32656364 00000000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"2f13e58684844468\"\n    Timestamp = 1177282839\n\nMon Apr 23 00:00:41 2007\n    User-Name = \"\"\n    NAS-IP-Address = 10.220.42.41\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65386430 32656431\n00000000\"\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:13013393338\"\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    Quintum-h323-conf-id = \"34363262 65386430 32656431 00000000\"\n    Quintum-h323-setup-time = \"22:59:26.975 UTC Sun Apr 22 2007\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-gw-id = \"mygate\"\n    Called-Station-Id = \"13013393338\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Start\n    Acct-Delay-Time = 0\n    Acct-Session-Id = \"000000C0000012F6\"\n    NAS-Port-Type = Async\n    h323-incoming-conf-id = \"34363262 65386430 32656431 00000000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"e0f0037503ecd771\"\n    Timestamp = 1177282841\n\nMon Apr 23 00:00:50 2007\n    User-Name = \"\"\n    NAS-IP-Address = 10.220.42.41\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65386438 32656433\n00340000\"\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:12508632152\"\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    Quintum-h323-conf-id = \"34363262 65386438 32656433 00340000\"\n    Quintum-h323-setup-time = \"22:59:35.665 UTC Sun Apr 22 2007\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-gw-id = \"mygate\"\n    Called-Station-Id = \"12508632152\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Start\n    Acct-Delay-Time = 0\n    Acct-Session-Id = \"000000C0000012F7\"\n    NAS-Port-Type = Async\n    h323-incoming-conf-id = \"34363262 65386438 32656433 00340000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"a93366b14fa83a3e\"\n    Timestamp = 1177282850\n\nMon Apr 23 00:01:26 2007\n    NAS-IP-Address = 10.220.42.41\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    NAS-Port-Type = Async\n    User-Name = \"10.220.42.38\"\n    Called-Station-Id = \"12508632152\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Stop\n    Acct-Delay-Time = 0\n    Acct-Input-Octets = 0\n    Acct-Output-Octets = 0\n    Acct-Session-Id = \"000000C0000012F7\"\n    Acct-Session-Time = 0\n    Acct-Input-Packets = 0\n    Acct-Output-Packets = 0\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:12508632152\"\n    Quintum-h323-conf-id = \"34363262 65386438 32656433 00340000\"\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65386438 32656433\n00340000\"\n    Quintum-h323-gw-id = \"mygate\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-setup-time = \"22:59:35.665 UTC Sun Apr 22 2007\"\n    Quintum-h323-connect-time = \"23:00:11.755 UTC Sun Apr 22 2007\"\n    Quintum-h323-disconnect-time = \"23:00:11.755 UTC Sun Apr 22 2007\"\n    Quintum-h323-remote-address = \"10.220.42.38\"\n    Quintum-h323-disconnect-cause = \"1f\"\n    Quintum-h323-voice-quality = \"0\"\n    Quintum-Trunkid-In = \"10.220.42.38\"\n    Quintum-Trunkid-Out = \"10.128.75.204\"\n    h323-incoming-conf-id = \"34363262 65386438 32656433 00340000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"69512c19e7769b31\"\n    Timestamp = 1177282886\n\nMon Apr 23 00:03:10 2007\n    NAS-IP-Address = 10.220.42.41\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    NAS-Port-Type = Async\n    User-Name = \"10.220.42.38\"\n    Called-Station-Id = \"13013393338\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Stop\n    Acct-Delay-Time = 0\n    Acct-Input-Octets = 0\n    Acct-Output-Octets = 0\n    Acct-Session-Id = \"000000C0000012F6\"\n    Acct-Session-Time = 125\n    Acct-Input-Packets = 0\n    Acct-Output-Packets = 0\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:13013393338\"\n    Quintum-h323-conf-id = \"34363262 65386430 32656431 00000000\"\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65386430 32656431\n00000000\"\n    Quintum-h323-gw-id = \"mygate\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-setup-time = \"22:59:26.975 UTC Sun Apr 22 2007\"\n    Quintum-h323-connect-time = \"22:59:50.700 UTC Sun Apr 22 2007\"\n    Quintum-h323-disconnect-time = \"23:01:55.980 UTC Sun Apr 22 2007\"\n    Quintum-h323-remote-address = \"10.220.42.38\"\n    Quintum-h323-disconnect-cause = \"10\"\n    Quintum-h323-voice-quality = \"0\"\n    Quintum-Trunkid-In = \"10.220.42.38\"\n    Quintum-Trunkid-Out = \"10.128.75.204\"\n    h323-incoming-conf-id = \"34363262 65386430 32656431 00000000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"e9566869177bba83\"\n    Timestamp = 1177282990\n\nMon Apr 23 00:03:50 2007\n    User-Name = \"\"\n    NAS-IP-Address = 10.220.42.41\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65393863 32656435\n00000000\"\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:13074370862\"\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    Quintum-h323-conf-id = \"34363262 65393863 32656435 00000000\"\n    Quintum-h323-setup-time = \"23:02:35.570 UTC Sun Apr 22 2007\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-gw-id = \"mygate\"\n    Called-Station-Id = \"13074370862\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Start\n    Acct-Delay-Time = 0\n    Acct-Session-Id = \"000000C0000012F8\"\n    NAS-Port-Type = Async\n    h323-incoming-conf-id = \"34363262 65393863 32656435 00000000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"efed98c811238af1\"\n    Timestamp = 1177283030\n\nMon Apr 23 00:04:06 2007\n    NAS-IP-Address = 10.220.42.41\n    Quintum-NAS-Port = \"0 0/0/c1dc2a26\"\n    NAS-Port-Type = Async\n    User-Name = \"10.220.42.38\"\n    Called-Station-Id = \"13074370862\"\n    Calling-Station-Id = \"\"\n    Acct-Status-Type = Stop\n    Acct-Delay-Time = 0\n    Acct-Input-Octets = 0\n    Acct-Output-Octets = 0\n    Acct-Session-Id = \"000000C0000012F8\"\n    Acct-Session-Time = 0\n    Acct-Input-Packets = 0\n    Acct-Output-Packets = 0\n    Service-Type = Login-User\n    Quintum-AVPair = \"h323-ivr-out=ACCESSCODE:13074370862\"\n    Quintum-h323-conf-id = \"34363262 65393863 32656435 00000000\"\n    Quintum-AVPair = \"h323-incoming-conf-id=34363262 65393863 32656435\n00000000\"\n    Quintum-h323-gw-id = \"mygate\"\n    Quintum-h323-call-origin = \"answer\"\n    Quintum-h323-call-type = \"VoIP\"\n    Quintum-h323-setup-time = \"23:02:35.570 UTC Sun Apr 22 2007\"\n    Quintum-h323-connect-time = \"23:02:51.445 UTC Sun Apr 22 2007\"\n    Quintum-h323-disconnect-time = \"23:02:51.445 UTC Sun Apr 22 2007\"\n    Quintum-h323-remote-address = \"10.220.42.38\"\n    Quintum-h323-disconnect-cause = \"1f\"\n    Quintum-h323-voice-quality = \"0\"\n    Quintum-Trunkid-In = \"10.220.42.38\"\n    Quintum-Trunkid-Out = \"10.128.75.204\"\n    h323-incoming-conf-id = \"34363262 65393863 32656435 00000000\"\n    Client-IP-Address = 10.220.42.41\n    Acct-Unique-Session-Id = \"c494daaf7b7d55c4\"\n    Timestamp = 1177283046\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}