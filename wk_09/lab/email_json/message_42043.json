{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 458: allow setting of variables at startup in config file in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 458\nrevision-id: tridge@samba.org-20070604100531-doyjw8gu3hnyvvug\nparent: tridge@samba.org-20070604095319-jm896xka6pchh1tf\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Mon 2007-06-04 20:05:31 +1000\nmessage:\n  allow setting of variables at startup in config file\nmodified:\n  config/ctdb.sysconfig          ctdb.sysconfig-20070527204758-biuh7znabuwan3zn-7\n  config/events                  events-20070529030121-04fjh63cxfh8v1pj-1\n=== modified file 'config/ctdb.sysconfig'\n--- a/config/ctdb.sysconfig\t2007-06-04 05:44:52 +0000\n+++ b/config/ctdb.sysconfig\t2007-06-04 10:05:31 +0000\n@@ -51,6 +51,14 @@\n # the default is 0\n # CTDB_DEBUGLEVEL=0\n \n+# set any default tuning options for ctdb\n+# use CTDB_SET_XXXX=value where XXXX is the name of the tuning\n+# variable\n+# for example\n+#    CTDB_SET_TRAVERSETIMEOUT=60\n+# you can get a list of variables using \"ctdb listvars\"\n+\n+\n # any other options you might want. Run ctdbd --help for a list\n # CTDB_OPTIONS=\n \n\n=== modified file 'config/events'\n--- a/config/events\t2007-06-04 05:09:03 +0000\n+++ b/config/events\t2007-06-04 10:05:31 +0000\n@@ -21,6 +21,15 @@\n         # make sure we have a blank state directory for the scripts to work with\n \t/bin/rm -rf /etc/ctdb/state\n \t/bin/mkdir -p /etc/ctdb/state\n+\n+\t# set any tunables from the config file\n+\tset | grep ^CTDB_SET_ | cut -d_ -f3- | \n+\twhile read v; do\n+\t    varname=`echo $v | cut -d= -f1`\n+\t    value=`echo $v | cut -d= -f2`\n+\t    ctdb setvar $varname $value || exit 1\n+\t    echo \"`date` Set $varname to $value\"\n+\tdone\n \t;;\n esac\n \n\n"}