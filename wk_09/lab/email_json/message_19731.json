{"category": "ham", "to_address": "R-help@stat.math.ethz.ch", "from_address": "Jarrett Byrnes <jebyrnes@ucdavis.edu>", "subject": "[R] Going from Coda Files to R2WinBUGS", "body": "I'm currently using JAGS as my Bayesian program of choice due to  \nworking off of an older mac running OSX.  I'd like to utilize some of  \nthe functions from R2WinBUGS, however.  As such, I'm attempting to  \nwrite something to go from coda output dumped by JAGS into the bugs  \nobject format - I've looked for functions that will convert from an  \nmcmc object to a bugs object, but have had no luck as of yet.  I've  \nattempted to adapt Yu-Sung Su's method over at http:// \nyusung.blogspot.com/2007/01/analyzing-coda-statistics-produced- \nby.html .  However, whenever I run it for a coda file set generated  \nby jags, I get the following error:\n\n\nError in if (trans[i] == \"log\") { : missing value where TRUE/FALSE  \nneeded\n\nThis is for a run whose jags.ind is as follows\n\ncypraea.effect\t1\t10000\nintercept\t10001\t20000\nsponge.sd\t20001\t30000\ndeviance\t30001\t40000\n\nWhen I debuged R2WinBUGS:::monitor, which is where the whole thing  \nborks, I found that trans is as follows\n\ncypraea.effect      intercept      sponge.sd       deviance\n             \"\"           \t  NA\t\t             NA             \t\tNA\n\nAnd the error comes when first looking at intercept, which is NA, not  \n\"\".  I am somewhat unclear as to why this is so.\n\nThe code for the method is as follows.  Any thoughts would be greatly  \nappreciated, and if this works out, feel free to use it yourself!   \nCould be quite useful!\n\n-Jarrett\n\n\n#note, the test run was something along the lines of c.bugs<-coda2bugs \n(n.burnin=1000)\n\ncoda2bugs<-function(codafile=\"jags.out\", indexfile=\"jags.ind\",  \nn.chains=1,\n\t\t\t\t\tn.iter=NA, n.burnin=NA, n.thin=1, DIC=FALSE, file.rm=T, ...){\n\n\t\trequire(R2WinBUGS)\n\t\t\n\n\t\t#first, split up the coda file for R2WinBUGS\n\t\tcodaSplit(codafile, indexfile)\n\t\t\n\t\t#get the parameter names\n\t\tindex.table<-read.table(indexfile)\n\t\t\n\t\tvarNames<-as.vector(index.table[,1])\n\n\t\t#determine the n.iter\n\t\tif(is.na(n.iter)){n.iter<-index.table[1,3]}\n\t\t\n\t\t#you will need to put the n.burnin in yourself\n\t\t#for the cypraea example, it is 1000\n\t\t\n\t\tbugs.fit <- R2WinBUGS:::bugs.sims(varNames, n.chains=n.chains,\n\t\t\t\t n.iter=n.iter, n.burnin=n.burnin, n.thin=n.thin, DIC = DIC)\n\t\t\n\t\tclass(bugs.fit)<-\"bugs\"\n\t\t\n\t\tbugs.fit$isDIC <- FALSE\n\t\t\n\t\t#clean up the new coda files\n\t\tif(file.rm==T){\n\t\t\tfile.remove(\"codaIndex.txt\")\n\t\t\tfor(i in rownames(index.table)){\n\t\t\t\tfile.remove(paste(\"coda\",i,\".txt\",sep=\"\"))\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\treturn(bugs.fit)\n}\n\ncodaSplit<-function(codafile=\"jags.out\", indexfile=\"jags.ind\"){\n\tindex.table<-read.table(indexfile)\n\twrite.table(index.table, \"codaIndex.txt\", quote=F, row.names=F,  \ncol.names=F, sep=\"\\t\")\n\tcoda.table<-read.table(codafile)\n\t\n\t#write the new coda files\n\tfor(i in rownames(index.table)){\n\t\tnew.file=paste(\"coda\",i,\".txt\", sep=\"\")\n\t\tnew.out<-coda.table[index.table[i,2]:index.table[i,3],]\n\t\twrite.table(new.out, new.file, row.names=F, col.names=F, sep=\"\\t\")\n\t}\n}\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}