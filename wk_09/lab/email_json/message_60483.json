{"category": "ham", "to_address": "Jeremy Allison <jra@samba.org>", "from_address": "simo <idra@samba.org>", "subject": "Re: [Samba] Support for multiple file streams?", "body": "On Mon, 2007-07-02 at 09:53 -0700, Jeremy Allison wrote:\n> On Mon, Jul 02, 2007 at 04:50:54PM +0000, simo wrote:\n> \n> > I was thinking if it couldn't be better to use just one directory in the\n> > root of the filesystem and within it create a directory for each file\n> > where we want to write an alternate stream. The idea would be to use the\n> > files inode as the dir name 0x123456 and inside it the stream name as\n> > file name for the stream. This way renaming or moving the file wouldn't\n> > loose the streams. Does it make sense?\n> \n> That's a pretty good idea - we'd have to do some recursing up the\n> tree to find the filesystem root of each share - maybe we could\n> do this at share connection time....\n\nOr it could be an option.\nIt should be noted that admins should add a cron job to clean up, in\ncase someone unlinks the original file from the unix side without going\nthrough samba.\nUnlink is the only operation that comes to mind, the other risk is\ncreating a new file after another has been unilinked and getting the\nsame inode number. But I guess these are corner cases, and if we are\nreally paranoid I guess we can find a way to make sure some other\nmetadata is used to detect such condition.\n\nThe biggest problem is leaking streams from one user to another:\nuserA delete fileA with streamA\nuserB create fileB\naccidentally fileB inode == fileA\nuserB has streamA data in fileB\n\nSimo.\n\n-- \nSimo Sorce\nSamba Team GPL Compliance Officer\nemail: idra@samba.org\nhttp://samba.org\n\n"}