{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r22953 - in branches/SAMBA_3_0/source/auth: .", "body": "Author: vlendec\nDate: 2007-05-16 20:02:32 +0000 (Wed, 16 May 2007)\nNew Revision: 22953\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22953\n\nLog:\nWell, this apparently has never been tested. But *this* code never saw a\nrelease yet .... ;-))\n\nModified:\n   branches/SAMBA_3_0/source/auth/auth_server.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/auth/auth_server.c\n===================================================================\n--- branches/SAMBA_3_0/source/auth/auth_server.c\t2007-05-16 19:23:08 UTC (rev 22952)\n+++ branches/SAMBA_3_0/source/auth/auth_server.c\t2007-05-16 20:02:32 UTC (rev 22953)\n@@ -254,7 +254,7 @@\n ****************************************************************************/\n \n static NTSTATUS check_smbserver_security(const struct auth_context *auth_context,\n-\t\t\t\t\t void *my_private_data, \n+\t\t\t\t\t void *private_data, \n \t\t\t\t\t TALLOC_CTX *mem_ctx,\n \t\t\t\t\t const auth_usersupplied_info *user_info, \n \t\t\t\t\t auth_serversupplied_info **server_info)\n@@ -266,6 +266,7 @@\n \tstatic BOOL bad_password_server = False;\n \tNTSTATUS nt_status = NT_STATUS_NOT_IMPLEMENTED;\n \tBOOL locally_made_cli = False;\n+\tstruct server_security_state *state;\n \n \t/* \n \t * Check that the requested domain is not our own machine name.\n@@ -273,12 +274,10 @@\n \t * password file.\n \t */\n \n-\tif(is_myname(user_info->domain)) {\n-\t\tDEBUG(3,(\"check_smbserver_security: Requested domain was for this machine.\\n\"));\n-\t\treturn nt_status;\n-\t}\n+\tstate = talloc_get_type_abort(\n+\t\tprivate_data, struct server_security_state);\n \n-\tcli = (struct cli_state *)my_private_data;\n+\tcli = state->cli;\n \t\n \tif (cli) {\n \t} else {\n\n"}