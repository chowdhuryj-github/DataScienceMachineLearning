{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Michael Kubovy <kubovy@virginia.edu>", "subject": "[R] Example of mcmcsamp() failing with lmer() output", "body": "Hi,\n\nI would appreciate help with the following model\n\n<<1>>=\ngunload <- read.table(hh('datasets/gunload.dat'), header = T)\ngunload$method <- factor(gunload$method, labels = c('new', 'old'))\ngunload$physique <- factor(gunload$group, labels = c('slight',  \n'average', 'heavy'))\ngunload$team9 <- factor(rep(1:9, each = 2))\n@\n\nThis is a split plot design with randomly selected teams for each  \nphysique, which was crossed with two methods.\n\nFollowing the Oats example in chap. 1 of MEMSS, and adapting to lmer:\n\n<<2>>=\nrequire(lme4)\ngl.lmer <- lmer(rounds ~ method * physique + (1 | physique/team),  \ndata = gunload)\nmcmcsamp(gl.lmer)\n@\nlmer runs as expected, but mcmcsamp() gives:\nError: Leading minor of order 1 in downdated X'X is not positive  \ndefinite\nError in t(.Call(mer_MCMCsamp, object, saveb, n, trans, verbose,  \ndeviance)) :\n\terror in evaluating the argument 'x' in selecting a method for  \nfunction 't'\n\nI tried:\n\n<<3>>=\nrequire(nlme)\ngl.lme <- lme(rounds ~ method * physique, random = ~1 | physique/ \nteam, data = gunload)\n@\nwhich gave all the expected output except that two p-values were NaN.\n\nWhich aspect of the data is making the simulation fail, and is there  \nanything to be done about it?\n\n_____________________________\nProfessor Michael Kubovy\nUniversity of Virginia\nDepartment of Psychology\nUSPS:     P.O.Box 400400    Charlottesville, VA 22904-4400\nParcels:    Room 102        Gilmer Hall\n         McCormick Road    Charlottesville, VA 22903\nOffice:    B011    +1-434-982-4729\nLab:        B019    +1-434-982-4751\nFax:        +1-434-982-4766\nWWW:    http://www.people.virginia.edu/~mk9y/\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}