{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22538 - in\n\tbranches/SAMBA_4_0/source/torture/rpc: .", "body": "Author: metze\nDate: 2007-04-27 17:35:15 +0000 (Fri, 27 Apr 2007)\nNew Revision: 22538\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22538\n\nLog:\nsame day late at night in au...:-)\n\nfix the strcasecmp_m() returns 0 for a match\n\nalso use the correct array element to fill priv->dcinfo\n\nthe fixes the problems where ldb changes the order of the search results\nwhen changing the main dc netbios name from \"localhost\" to \"localtest\"\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/torture/rpc/drsuapi.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/torture/rpc/drsuapi.c\n===================================================================\n--- branches/SAMBA_4_0/source/torture/rpc/drsuapi.c\t2007-04-27 15:26:40 UTC (rev 22537)\n+++ branches/SAMBA_4_0/source/torture/rpc/drsuapi.c\t2007-04-27 17:35:15 UTC (rev 22538)\n@@ -139,19 +139,18 @@\n \t\t\tcase 1:\n \t\t\t\tfor (k=0; k < r.out.ctr.ctr1.count; k++) {\n \t\t\t\t\tif (strcasecmp_m(r.out.ctr.ctr1.array[k].netbios_name, \n-\t\t\t\t\t\t\t torture_join_netbios_name(priv->join))) {\n+\t\t\t\t\t\t\t torture_join_netbios_name(priv->join)) == 0) {\n \t\t\t\t\t\tfound = True;\n+\t\t\t\t\t\tbreak;\n \t\t\t\t\t}\n \t\t\t\t}\n \t\t\t\tbreak;\n \t\t\tcase 2:\n-\t\t\t\tif (r.out.ctr.ctr2.count > 0) {\n-\t\t\t\t\tpriv->dcinfo\t= r.out.ctr.ctr2.array[0];\n-\t\t\t\t}\n \t\t\t\tfor (k=0; k < r.out.ctr.ctr2.count; k++) {\n \t\t\t\t\tif (strcasecmp_m(r.out.ctr.ctr2.array[k].netbios_name, \n-\t\t\t\t\t\t\t torture_join_netbios_name(priv->join))) {\n+\t\t\t\t\t\t\t torture_join_netbios_name(priv->join)) == 0) {\n \t\t\t\t\t\tfound = True;\n+\t\t\t\t\t\tpriv->dcinfo\t= r.out.ctr.ctr2.array[k];\n \t\t\t\t\t\tbreak;\n \t\t\t\t\t}\n \t\t\t\t}\n\n"}