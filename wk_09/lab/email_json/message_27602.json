{"category": "ham", "to_address": "\"Rick DeShon\" <deshon@msu.edu>", "from_address": "\"Dimitris Rizopoulos\" <dimitris.rizopoulos@med.kuleuven.be>", "subject": "Re: [R] Create an AR(1) covariance matrix", "body": "one option is the following:\n\ntimes <- 1:5\nrho <- 0.5\nsigma <- 2\n###############\nH <- abs(outer(times, times, \"-\"))\nV <- sigma * rho^H\np <- nrow(V)\nV[cbind(1:p, 1:p)] <- V[cbind(1:p, 1:p)] * sigma\nV\n\n\nI hope it helps.\n\nBest,\nDimitris\n\n----\nDimitris Rizopoulos\nPh.D. Student\nBiostatistical Centre\nSchool of Public Health\nCatholic University of Leuven\n\nAddress: Kapucijnenvoer 35, Leuven, Belgium\nTel: +32/(0)16/336899\nFax: +32/(0)16/337015\nWeb: http://med.kuleuven.be/biostat/\n     http://www.student.kuleuven.be/~m0390867/dimitris.htm\n\n\n----- Original Message ----- \nFrom: \"Rick DeShon\" \nTo: \nSent: Friday, May 11, 2007 4:29 PM\nSubject: [R] Create an AR(1) covariance matrix\n\n\n> Hi All.\n>\n> I need to create a first-order autoregressive covariance matrix\n> (AR(1)) for a longitudinal mixed-model simulation.  I can do this\n> using nested \"for\" loops but I'm trying to improve my R coding\n> proficiency and am curious how it might be done in a more elegant\n> manner.\n>\n> To be clear, if there are 5 time points then the AR(1) matrix is 5x5\n> where the diagonal is a constant variance (sigma^2) and the\n> covariances depend on the number of \"steps\" between trials.  So, the\n> first off-diagonal of the matrix is sigma*rho, the second \n> off-diagonal\n> is sigma*rho^2, the third off-diagonal is sigma*rho^3, and so forth.\n>\n> Any suggestions for an elegant method to flexibly create this \n> matrix?\n>\n> Rick DeShon\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide \n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n> \n\n\nDisclaimer: http://www.kuleuven.be/cwis/email_disclaimer.htm\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}