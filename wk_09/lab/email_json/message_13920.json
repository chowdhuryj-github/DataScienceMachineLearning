{"category": "ham", "to_address": "chromatic <chromatic@wgz.org>", "from_address": "\"Matt Diephouse\" <mddiep@gmail.com>", "subject": "Re: [PATCH] Re-work Parrot_process_args", "body": "chromatic  wrote:\n> On Sunday 22 April 2007 17:38, Matt Diephouse wrote:\n>\n> > The attached patch completely reworks Parrot_process_args. The changes\n> > are extensive and I think they make the code much clearer. Rather than\n> > just check it in, I thought I'd try to get feedback here to make sure\n> > that it is clearer to everyone else and not just to myself.\n>\n> It's a lot clearer.\n\nGood.\n\n> > This patch also fixes a few bugs:\n> >     #40490: Flat/Slurpy Named Parameter Passing Errors\n>\n> Yay!\n\nI thought you might like that. :)\n\n> >     A couple todo'd error condition tests\n> >\n> > I'm sure there is more that can be done to clean things up, but this\n> > is at least a start. I've already spent 15+ hours on this patch, so\n> > I'm ready to check things in and leave further improvements for\n> > another time.\n>\n> I only noticed one thing (besides large swaths of removed code, which is\n> always nice).  This code occurs multiple times:\n>\n> +                /* if the :flat arg is empty, just go to the next arg */\n> +                if (!st->src.slurp_n) {\n> +                    st->src.mode &= ~CALL_STATE_FLATTEN;\n> +                    st->src.i++;\n> +                }\n>\n> It's three lines; is it worth extracting somehow?\n\nIt could definitely be placed inside start_flatten(), but that would\nmake the code a little misleading, I think. I'm not sure it's worth\nplacing it in a function of its own; the transparency may be worth\nsomething in this case. Having said that, I think this section of the\ncode could be cleaned up more with further refactoring down the road.\n\nThere's also a large ~20 line section of code that is repeated in this\npatch that I'll move to a function before I commit.\n\n-- \nMatt Diephouse\nhttp://matt.diephouse.com\n\n"}