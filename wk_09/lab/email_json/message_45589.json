{"category": "ham", "to_address": "R-help@stat.math.ethz.ch", "from_address": "Robert A LaBudde <ral@lcfltd.com>", "subject": "Re: [R] What ECDF function?", "body": "At 12:57 PM 6/9/2007, Marco wrote:\n>\n>2.I found various version of P-P plot  where instead of using the\n>\"ecdf\" function use ((1:n)-0.5)/n\n>   After investigation I found there're different definition of ECDF\n>(note \"i\" is the rank):\n>   * Kaplan-Meier: i/n\n>   * modified Kaplan-Meier: (i-0.5)/n\n>   * Median Rank: (i-0.3)/(n+0.4)\n>   * Herd Johnson i/(n+1)\n>   * ...\n>   Furthermore, similar expressions are used by \"ppoints\".\n>   So,\n>   2.1 For P-P plot, what shall I use?\n>   2.2 In general why should I prefer one kind of CDF over another one?\n>\n\nThis is an age-old debate in statistics. There are many different \nformulas, some of which are optimal for particular distributions.\n\nUsing i/n (which I would call the Kolmogorov method), (i-1)/n or \ni/(n+1) is to be discouraged for general ECDF modeling. These \ncorrespond in quality to the rectangular rule method of integration \nof the bins, and assume only that the underlying density function is \npiecewise constant. There is no disadvantage to using these methods, \nhowever, if the pdf has multiple discontinuities.\n\nI tend to use (i-0.5)/n, which corresponds to integrating with the \n\"midpoint rule\", which is a 1-point Gaussian quadrature, and which is \nexact for linear behavior with derivative continuous. It's simple, \nit's accurate, and it is near optimal for a wide range of continuous \nalternatives.\n\nThe formula (i- 3/8)/(n + 1/4) is optimal for the normal \ndistribution. However, it is equal to (i-0.5)/n to order 1/n^3, so \nthere is no real benefit to using it. Similarly, there is a formula \n(i-.44)/(N+.12) for a Gumbel distribution. If you do know for sure \n(don't need to test) the form of the distribution, you're better off \nfitting that distribution function directly and not worrying about the edf.\n\nAlso remember that edfs are not very accurate, so the differences \nbetween these formulae are difficult to justify in practice.\n\n================================================================\nRobert A. LaBudde, PhD, PAS, Dpl. ACAFS  e-mail: ral@lcfltd.com\nLeast Cost Formulations, Ltd.            URL: http://lcfltd.com/\n824 Timberlake Drive                     Tel: 757-467-0954\nVirginia Beach, VA 23464-3239            Fax: 757-467-2947\n\n\"Vere scire est per causas scire\"\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}