{"category": "ham", "to_address": "\"'Adaikalavan Ramasamy'\" <ramasamy@cancer.org.uk>", "from_address": "\"John Fox\" <jfox@mcmaster.ca>", "subject": "Re: [R] Weighted least squares", "body": "Dear Adai,\n\n> -----Original Message-----\n> From: Adaikalavan Ramasamy [mailto:ramasamy@cancer.org.uk] \n> Sent: Tuesday, May 08, 2007 8:38 PM\n> To: S Ellison\n> Cc: h.wickham@gmail.com; jfox@mcmaster.ca; R-help@stat.math.ethz.ch\n> Subject: Re: [R] Weighted least squares\n> \n> http://en.wikipedia.org/wiki/Weighted_least_squares gives a \n> formulaic description of what you have said.\n> \n> I believe the original poster has converted something like this\n> \n> \ty\t  x\n> \t0\t1.1\n> \t0\t2.2\n> \t0\t2.2\n> \t0\t2.2\n> \t1\t3.3\n> \t1\t3.3\n> \t2\t4.4\n>          ...\n> \n> into something like the following\n> \n> \ty\t  x\tfreq\n> \t0\t1.1\t   1\n> \t0\t2.2\t   3\n> \t1\t3.3        2\n> \t2\t4.4        1\n>          ...\n> \n> Now, the variance of means of each row in table above is ZERO \n> because the individual elements that comprise each row are \n> identical. Therefore your method of using inverse-variance \n> will not work here.\n> \n> Then is it valid then to use lm( y ~ x, weights=freq ) ?\n\nNo, because the weights argument gives inverse-variance weights not case\nweights.\n\nRegards,\n John\n\n> \n> Regards, Adai\n> \n> \n> \n> S Ellison wrote:\n> > Hadley,\n> > \n> > You asked\n> >> .. what is the usual way to do a linear regression when you have \n> >> aggregated data?\n> > \n> > Least squares generally uses inverse variance weighting. \n> For aggregated data fitted as mean values, you just need the \n> variances for the _means_. \n> > \n> > So if you have individual means x_i and sd's s_i that arise \n> from aggregated data with n_i observations in group i, the \n> natural weighting is by inverse squared standard error of the \n> mean. The appropriate weight for x_i would then be \n> n_i/(s_i^2). In R, that's n/(s^2), as n and s would be \n> vectors with the same length as x. If all the groups had the \n> same variance, or nearly so, s is a scalar; if they have the \n> same number of observations, n is a scalar. \n> > \n> > Of course, if they have the same variance and same number \n> of observations, they all have the same weight and you \n> needn't weight them at all: see previous posting!\n> > \n> > Steve E\n> > \n> > \n> > \n> > *******************************************************************\n> > This email and any attachments are confidential. Any use, \n> > co...{{dropped}}\n> > \n> > ______________________________________________\n> > R-help@stat.math.ethz.ch mailing list\n> > https://stat.ethz.ch/mailman/listinfo/r-help\n> > PLEASE do read the posting guide \n> > http://www.R-project.org/posting-guide.html\n> > and provide commented, minimal, self-contained, reproducible code.\n> > \n> > \n> > \n> \n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}