{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r23420 - in\n\tbranches/SAMBA_4_0/source/lib/socket_wrapper: .", "body": "Author: metze\nDate: 2007-06-11 14:41:14 +0000 (Mon, 11 Jun 2007)\nNew Revision: 23420\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23420\n\nLog:\ntry to make the IBM checker happy\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/lib/socket_wrapper/socket_wrapper.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/lib/socket_wrapper/socket_wrapper.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/socket_wrapper/socket_wrapper.c\t2007-06-11 14:40:23 UTC (rev 23419)\n+++ branches/SAMBA_4_0/source/lib/socket_wrapper/socket_wrapper.c\t2007-06-11 14:41:14 UTC (rev 23420)\n@@ -174,7 +174,7 @@\n \t}\n }\n \n-static int socket_length(int family)\n+static size_t socket_length(int family)\n {\n \tswitch (family) {\n \tcase AF_INET:\n@@ -184,7 +184,7 @@\n \t\treturn sizeof(struct sockaddr_in6);\n #endif\n \t}\n-\treturn -1;\n+\treturn 0;\n }\n \n \n@@ -788,6 +788,9 @@\n \t\twire_hdr_len = sizeof(packet->ip.hdr) + sizeof(packet->ip.p.udp);\n \t\twire_len = wire_hdr_len + payload_len;\n \t\tbreak;\n+\n+\tdefault:\n+\t\treturn NULL;\n \t}\n \n \tif (unreachable) {\n@@ -1231,10 +1234,12 @@\n \t\tif (type == SOCK_STREAM) {\n \t\t\tbreak;\n \t\t}\n+\t\t/*fall through*/\n \tcase 17:\n \t\tif (type == SOCK_DGRAM) {\n \t\t\tbreak;\n \t\t}\n+\t\t/*fall through*/\n \tdefault:\n \t\terrno = EPROTONOSUPPORT;\n \t\treturn -1;\n@@ -1278,7 +1283,7 @@\n \t * socket family\n \t */\n \tmy_addrlen = socket_length(parent_si->family);\n-\tif (my_addrlen < 0) {\n+\tif (my_addrlen <= 0) {\n \t\terrno = EINVAL;\n \t\treturn -1;\n \t}\n\n"}