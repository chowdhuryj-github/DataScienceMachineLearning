{"category": "ham", "to_address": "Spielas Bates <bates@stat.wisc.edu>", "from_address": "Spencer Graves <spencer.graves@pdf.com>", "subject": "[R] 'varFunc' class with additive variance? (was: can I get same\n results using lme and gls?)", "body": "Hi, Spie and others: \n\n      What might be the best tools for modeling an additive variance \nstructure for residuals, something like the following: \n\n           var(resid) = s0.2*(1+var.pred) + daysFromTraining*var(process \nmigration per day),\n\n      where var.pred = relative variance of prediction error = something \nroughly like crossprod(x, solve(crossprod(X), x)),\n      and var(process migration per day) = the variance of a random walk \nof some process characteristic. \n\n      My data are residuals from predictions from models produced by a \ndata mining algorithm with various choices for training and test sets.  \nI've been using 'gls' to fit models using 'varFunc' classes.  However, \n'varComb' models the relative standard deviation as a product of \ncomponents from different sources.  I'm thinking of creating 'varSumSq' \nfunctions by modifying your 'varComb' code to model an additive (not \nmultiplicative) variance structure. \n\n      Might there be other tools for modeling an additive variance \nstructure?  Alternatively, does it sound sensible to create 'varSumSq' \nfunctions similar to 'varComb'? \n\n      Thanks,\n      Spencer Graves    \n\nSpielas Bates wrote:\n> On 5/20/07, toby909@gmail.com  wrote:\n>\n>   \n>> I was wondering how to get the same results with gls and lme. In my lme, the\n>> design matrix for the random effects is (should be) a identity matrix and\n>> therefore G should add up with R to produce the R matrix that gls would report\n>> (V=ZGZ'+R). Added complexity is that I have 3 levels, so I have R, G and say H\n>> (V=WHW'+ZGZ'+R). The lme is giving me the correct results, I am having trouble\n>> finding the right corresponding specification for the gls.\n>>     \n>\n> Thanks for including a reproducible example.  However, I'm a bit at a\n> loss as to why you would want to try to create a gls model that fits a\n> mixed-effects model that has random effects for intercept and slope at\n> two nested levels.  I don't think that corCompSymm will do what you\n> want but, to tell the truth, I have difficulty in thinking of the\n> model in that form.  I much prefer the mixed-effects form.\n>\n>\n>   \n>> Thanks for your help.\n>>\n>> Toby\n>>\n>>\n>> dtaa =\n>> read.table(\"http://www.ats.ucla.edu/stat/mplus/examples/ma_snijders/mlbook1.dat\",\n>> sep=\",\")\n>> dta1 = reshape(dtaa, list(c(\"V10\",\"V12\")), \"score\", direction=\"long\",\n>> drop=c(\"V2\",\"V3\",\"V4\",\"V5\",\"V6\",\"V7\",\"V8\",\"V9\",\"V11\",\"V13\",\"V14\",\"V15\",\"V16\",\"V17\",\"V18\",\"V19\",\"V20\",\"V21\",\"V22\",\"V23\",\"V24\",\"V25\"))\n>> colnames(dta1)[1] = \"schoolNR\"\n>> dta2 = dta1[order(dta1$id),]\n>> head(dta2)\n>> timef = factor(dta2$time)\n>>\n>> summary(mdl1l <- lme(score~timef-1, dta2, ~timef-1|schoolNR/id,,,,\"ML\"))\n>> summary(mdl1g <- gls(score~timef-1, dta2, corCompSymm(, ~timef|schoolNR/id),\n>> varIdent(, ~1|id*timef),,\"ML\"))\n>>\n>> ______________________________________________\n>> R-help@stat.math.ethz.ch mailing list\n>> https://stat.ethz.ch/mailman/listinfo/r-help\n>> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n>> and provide commented, minimal, self-contained, reproducible code.\n>>\n>>     \n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}