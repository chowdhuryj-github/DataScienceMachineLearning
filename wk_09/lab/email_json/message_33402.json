{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "toby909@gmail.com", "subject": "[R] can I get same results using lme and gls?", "body": "Hi All\n\nI was wondering how to get the same results with gls and lme. In my lme, the \ndesign matrix for the random effects is (should be) a identity matrix and \ntherefore G should add up with R to produce the R matrix that gls would report \n(V=ZGZ'+R). Added complexity is that I have 3 levels, so I have R, G and say H \n(V=WHW'+ZGZ'+R). The lme is giving me the correct results, I am having trouble \nfinding the right corresponding specification for the gls.\n\nThanks for your help.\n\nToby\n\n\ndtaa = \nread.table(\"http://www.ats.ucla.edu/stat/mplus/examples/ma_snijders/mlbook1.dat\", \nsep=\",\")\ndta1 = reshape(dtaa, list(c(\"V10\",\"V12\")), \"score\", direction=\"long\", \ndrop=c(\"V2\",\"V3\",\"V4\",\"V5\",\"V6\",\"V7\",\"V8\",\"V9\",\"V11\",\"V13\",\"V14\",\"V15\",\"V16\",\"V17\",\"V18\",\"V19\",\"V20\",\"V21\",\"V22\",\"V23\",\"V24\",\"V25\"))\ncolnames(dta1)[1] = \"schoolNR\"\ndta2 = dta1[order(dta1$id),]\nhead(dta2)\ntimef = factor(dta2$time)\n\nsummary(mdl1l <- lme(score~timef-1, dta2, ~timef-1|schoolNR/id,,,,\"ML\"))\nsummary(mdl1g <- gls(score~timef-1, dta2, corCompSymm(, ~timef|schoolNR/id), \nvarIdent(, ~1|id*timef),,\"ML\"))\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}