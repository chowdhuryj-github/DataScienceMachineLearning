{"category": "ham", "to_address": "Eric Thompson <ericthompso@gmail.com>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] error returned by \"make check\" in R-2.5.0", "body": "How big is abs(lam - lam2[i])/Meps ?\n\nThis could be one of those cases where your system (which CPU, what \ncompilers?) is unusually inaccurate, but Linux systems do not usually \ndiffer much in their accuracies on the same CPU.\n\nI've checked several systems, as see maximum values of around 40.\n\nR 2.5.0 has an updated LAPACK so it will be different from 2.4.1.  My \nhunch is that this is a compiler optimization bug, so you could see what \nhappens at lower optimization levels.\n\n\nOn Fri, 27 Apr 2007, Eric Thompson wrote:\n\n> Today I tried to install the R-2.5.0 (currently running R-2.4.1) on\n> Mandriva Linux. The ./configure and make commands seem to run fine,\n> but \"make check\" gives the following messages:\n>\n> running regression tests\n> make[3]: Entering directory `/home/ethomp04/R-2.5.0/tests'\n> running code in 'reg-tests-1.R' ...make[3]: *** [reg-tests-1.Rout] Error 1\n> make[3]: Leaving directory `/home/ethomp04/R-2.5.0/tests'\n> make[2]: *** [test-Reg] Error 2\n> make[2]: Leaving directory `/home/ethomp04/R-2.5.0/tests'\n> make[1]: *** [test-all-basics] Error 1\n> make[1]: Leaving directory `/home/ethomp04/R-2.5.0/tests'\n> make: *** [check] Error 2\n>\n> Regarding \"make check\", the R-admin.html page says \"Failures are not\n> necessarily problems as they might be caused by missing\n> functionality...\"\n>\n> So, looking at the \"reg-tests-1.Rout.fail\" file, I see that the error\n> occurs here:\n>\n>> ## eigen\n>> Meps <- .Machine$double.eps\n>> set.seed(321, kind = \"default\")\t # force a particular seed\n>> m <- matrix(round(rnorm(25),3), 5,5)\n>> sm <- m + t(m) #- symmetric matrix\n>> em <- eigen(sm); V <- em$vect\n>> print(lam <- em$values) # ordered DEcreasingly\n> [1]  5.1738946  3.1585064  0.6849974 -1.6299494 -2.5074489\n>>\n>> stopifnot(\n> +  abs(sm %*% V - V %*% diag(lam))\t  < 60*Meps,\n> +  abs(sm\t      - V %*% diag(lam) %*% t(V)) < 60*Meps)\n>>\n>> ##------- Symmetric = FALSE:  -- different to above : ---\n>>\n>> em <- eigen(sm, symmetric = FALSE); V2 <- em$vect\n>> print(lam2 <- em$values) # ordered decreasingly in ABSolute value !\n> [1]  5.1738946  3.1585064 -2.5074489 -1.6299494  0.6849974\n>> print(i <- rev(order(lam2)))\n> [1] 1 2 5 4 3\n>> stopifnot(abs(lam - lam2[i]) < 60 * Meps)\n> Error: abs(lam - lam2[i]) < 60 * Meps is not all TRUE\n> Execution halted\n>\n>\n> Interestingly, running these same tests on R-2.4.1 on the same system\n> does not give an error:\n>\n>> Meps <- .Machine$double.eps\n>> set.seed(321, kind = \"default\") # force a particular seed\n>> m <- matrix(round(rnorm(25),3), 5,5)\n>> sm <- m + t(m) #- symmetric matrix\n>> em <- eigen(sm); V <- em$vect\n>> print(lam <- em$values) # ordered DEcreasingly\n> [1]  5.17389456321  3.15850637323  0.68499738238 -1.62994940108 -2.50744891774\n>> stopifnot(\n> +  abs(sm %*% V - V %*% diag(lam))  < 60*Meps,\n> +  abs(sm      - V %*% diag(lam) %*% t(V)) < 60*Meps)\n>>\n>> ##------- Symmetric = FALSE:  -- different to above : ---\n>>\n>> em <- eigen(sm, symmetric = FALSE); V2 <- em$vect\n>> print(lam2 <- em$values) # ordered decreasingly in ABSolute value !\n> [1]  5.17389456321  3.15850637323 -2.50744891774 -1.62994940108  0.68499738238\n>> print(i <- rev(order(lam2)))\n> [1] 1 2 5 4 3\n>> stopifnot(abs(lam - lam2[i]) < 60 * Meps)\n>> abs(lam - lam2[i]) < 60 * Meps\n> [1] TRUE TRUE TRUE TRUE TRUE\n>\n> I'm not sure what to do next, or how serious of a problem this might\n> be. I would appreciate any suggestions or advice. I thought maybe this\n> was due to something about how my system is setup, but since I don't\n> get the error in R-2.4.1, that seems to imply to me that there is\n> something different in R-2.5.0 that is causing it.\n>\n> Thanks.\n>\n> Eric Thompson\n> Tufts University\n> Civil & Environmental Engineering\n>\n>> sessionInfo()\n> R version 2.4.1 (2006-12-18)\n> i686-pc-linux-gnu\n>\n> locale:\n> LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=C;LC_ADDRESS=C;LC_TELEPHONE=C;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=C\n>\n> attached base packages:\n> [1] \"datasets\"  \"utils\"     \"stats\"     \"graphics\"  \"grDevices\" \"methods\"\n> [7] \"base\"\n>\n> other attached packages:\n>    MASS\n> \"7.2-31\"\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}