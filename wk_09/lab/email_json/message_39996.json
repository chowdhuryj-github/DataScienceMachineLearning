{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Inman, Brant A.   M.D.\" <Inman.Brant@mayo.edu>", "subject": "[R] Using MIcombine for coxph fits", "body": "\nR-helpers:\n\nI am using R 2.5 on Windows XP, packages all up to date.  I have run\ninto an issue with the MIcombine function of the mitools package that I\nhoped some of you might be able to help with.  I will work through a\nreproducible example to demonstrate the issue.\n\nFirst, make a dataset from the pbc dataset in the survival package\n\n---------------\n# Make a dataset\nlibrary(survival)\nd <- pbc[,c('time','status','age','sex','hepmeg','platelet', \n\t'trt', 'trig')]\nd[d==-9] <- NA \nd[,c(4,5,7)] <- lapply(d[,c(4,5,7)], FUN=as.factor)\nstr(d)\nsummary(d)\n---------------\n\nSecond, since there is missing data for several (but not all) of the\nvariables, investigate the patterns.\n\n---------------\nlibrary(Hmisc)\nna.pattern(d)\t\t\t\t\t\nclus <- naclus(d, method='complete')\npar(mfrow=c(2,2))\nnaplot(clus, which='all')\nprint(clus)\ndetach(package: Hmisc)\n---------------\n\nAfter examining the missing data patterns, impute 10 datasets using the\namelia function from the Amelia package. Check the densities of the\ncontinuous variables to make sure they make sense. \n\n---------------\nlibrary(Amelia)\nam.imp <- amelia(d, m=10, p2s=1, startvals=1, write.out=F,\n\tnoms=c('status','sex','hepmeg','trt'))\ncompare.density(data=d, output=am.imp, var='trig')\ncompare.density(data=d, output=am.imp, var='platelet')\n---------------\n\nSince everything looks ok, fit Cox models to each of the 10 imputed\ndatasets using the functions of the mitools package.\n\n---------------\nlibrary(mitools)\nmiset  <- imputationList(list(am.imp[[1]],am.imp[[2]],am.imp[[3]],\n\tam.imp[[4]],am.imp[[5]],am.imp[[6]],am.imp[[7]],am.imp[[8]],\n\tam.imp[[9]],am.imp[[10]]))\nmifit  <- with(miset, coxph(Surv(time, status) ~ age + sex + \n\thepmeg + platelet + trt + trig))\nmifit\n---------------\n\nThe \"mifit\" object shows the individual coxph fits for each imputed\ndataset.  Now we have to pool these fitted models  to obtain an overall\nmodel. The code and result are shown below.\n\n---------------\nfit.am <- MIcombine(mifit)\nsummary(fit.am) \n\nMultiple imputation results:\n      with.imputationList(miset, coxph(Surv(time, status) ~ age + sex + \n    hepmeg + platelet + trt + trig))\n      MIcombine.default(mifit)\n              results           se       (lower       upper) missInfo\nage       0.035548792 0.0082506946  0.019373545 0.0517240397      4 %\nsex1     -0.070760613 0.2563372831 -0.580309741 0.4387885156     34 %\nhepmeg1   0.932378808 0.2026274576  0.532555416 1.3322021993     23 %\nplatelet -0.001757899 0.0009480636 -0.003620446 0.0001046469     14 %\ntrt2      0.137413162 0.1924230007 -0.243815288 0.5186416117     29 %\ntrig      0.003979287 0.0012010053  0.001607266 0.0063513078     25 %\n---------------\n\nThe question I have concerns the meaning of this result.  The missInfo\ncolumn of the summary function suggests that age was missing data, when\nin fact it was not. Is there a different interpretation for the missInfo\ncolumn?\n\nThanks in advance for any help.\n\nBrant Inman\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}