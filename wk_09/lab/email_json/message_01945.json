{"category": "ham", "to_address": "\"'John Smith'\" <ld7631@yahoo.com>", "from_address": "\"John Fox\" <jfox@mcmaster.ca>", "subject": "Re: [R] sem vs. LISREL: sem fails", "body": "Dear Dimitri,\n\nUsing the tools provided in the sem package [e.g., the debug argument to\nsem()], I took a closer look at this convergence problem, which arises\nbecause of poor start values selected for the variances of the latent\nvariables. It turns out that you can get a solution for your original model\nfit to the covariance matrix by setting the argument par.size to\n\"startvalues\" (as suggested in ?sem): \n\nsem.anxiety <- sem(model, COVAR, N=150, par.size=\"startvalues\")\n\nRegards,\n John\n\n--------------------------------\nJohn Fox\nDepartment of Sociology\nMcMaster University\nHamilton, Ontario\nCanada L8S 4M4\n905-525-9140x23604\nhttp://socserv.mcmaster.ca/jfox \n-------------------------------- \n\n> -----Original Message-----\n> From: John Fox [mailto:jfox@mcmaster.ca] \n> Sent: Monday, April 09, 2007 9:46 PM\n> To: 'John Smith'\n> Cc: 'r-help@stat.math.ethz.ch'\n> Subject: RE: [R] sem vs. LISREL: sem fails\n> \n> Dear Dimitri,\n> \n> You haven't done anything wrong: Your model is a \n> straightforward confirmatory factor analysis and it is \n> correctly specified. I suspect that sem() is picking poor \n> start values.\n> \n> I can get a solution by specifying two alternative models \n> that are equivalent to yours:\n> \n> (1) Rescaling the problem by using correlation-matrix input:\n> \n> sem.anxiety <- sem(model, KM, N=150)\n> \n> (2) Fixing the variances of the factors (latent variables) \n> rather than using reference indicators:\n> \n> model.2 <- specify.model()\n> ANXIETY -> a1,      lam_anx_1,  NA\n> ANXIETY -> a2,      lam_anx_2,  NA\n> ANXIETY -> a3,      lam_anx_3,  NA\n> DEPRESS -> d1,      lam_dep_1,  NA\n> DEPRESS -> d2,      lam_dep_2,  NA\n> DEPRESS -> d3,      lam_dep_3,  NA\n> FEAR -> f1,         lam_fear_1, NA\n> FEAR -> f2,         lam_fear_2, NA\n> FEAR -> f3,         lam_fear_3, NA\n> a1 <-> a1,          theta_a1,   NA\n> a2 <-> a2,          theta_a2,   NA\n> a3 <-> a3,          theta_a3,   NA\n> d1 <-> d1,          theta_d1,   NA\n> d2 <-> d2,          theta_d2,   NA\n> d3 <-> d3,          theta_d3,   NA\n> f1 <-> f1,          theta_f1,   NA\n> f2 <-> f2,          theta_f2,   NA\n> f3 <-> f3,          theta_f3,   NA\n> ANXIETY <-> ANXIETY,NA,         1\n> DEPRESS <-> DEPRESS,NA,         1\n> FEAR <-> FEAR,      NA,         1\n> ANXIETY <-> FEAR,   phi_AF,     NA\n> ANXIETY <-> DEPRESS,phi_AD,     NA\n> DEPRESS <-> FEAR,   phi_DF,     NA\n> \n> # Running the estimation using sem:\n> sem.anxiety.2 <- sem(model.2, COVAR, N=150)\n> \n> \n> A couple of small points unrelated to the problem you \n> experienced: (1) You didn't need to load the MASS package, \n> since you didn't appear to use anything in it; (2) comments \n> in R are prefixed by #, not !.\n> \n> I hope this helps,\n>  John\n> \n> --------------------------------\n> John Fox\n> Department of Sociology\n> McMaster University\n> Hamilton, Ontario\n> Canada L8S 4M4\n> 905-525-9140x23604\n> http://socserv.mcmaster.ca/jfox\n> -------------------------------- \n> \n> > -----Original Message-----\n> > From: r-help-bounces@stat.math.ethz.ch \n> > [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of John Smith\n> > Sent: Monday, April 09, 2007 5:28 PM\n> > To: r-help@stat.math.ethz.ch\n> > Subject: [R] sem vs. LISREL: sem fails\n> > \n> > I am new to R. \n> > I just tried to recreate in R (using sem package and the identical \n> > input data) a solution for a simple measurment model I have found \n> > before in LISREL. LISREL had no problems and converged in just 3 \n> > iterations.\n> > In sem, I got no solution, just the warning message:\n> > \n> > \"Could not compute QR decomposition of Hessian.\n> > Optimization probably did not converge.\n> >  in: sem.default(ram = ram, S = S, N = N, param.names = pars, \n> > var.names = vars, \"\n> > \n> > What does it mean? Maybe I am doing something wrong?\n> > \n> > I have 3 latent factors (Anxiety, Depression, and Fear) - \n> each of them \n> > has 3 observed indicators (a1, a2, a3; d1, d2, d3, and f1, f2, f3) \n> > Below is my script in R:\n> > \n> > ! ANALYSIS OF ANXIETY, DEPRESSION, AND FEAR - LISREL P.31\n> > \n> > ! Creating the ANXIETY, DEPRESSION, AND FEAR \n> intercorrelation matrix \n> > (KM):\n> > KM<-matrix(\n> > c(1,.8,.83,.2,.21,.19,.18,.18,.18,\n> > 0,1,.81,.22,.24,.18,.19,.19,.21,\n> > 0,0,1,.22,.19,.2,.2,.2,.22,\n> > 0,0,0,1,.84,.82,.22,.22,.21,\n> > 0,0,0,0,1,.84,.19,.18,.19,\n> > 0,0,0,0,0,1,.18,.18,.18,\n> > 0,0,0,0,0,0,1,.84,.82,\n> > 0,0,0,0,0,0,0,1,.81,\n> > 0,0,0,0,0,0,0,0,1), 9, 9)\n> > \n> > ! Creating the ANXIETY, DEPRESSION, AND FEAR Standard Deviations \n> > vector (SD):\n> > SD<-c(1.5, 2.4, 3.2, 2.3, 2.3, 2.6, 4.5, 4.7, 5.6)\n> > \n> > ! Calculating the Var-Covar matrix based on correlations and SDs:\n> > library(MASS)\n> > COVAR<-outer(SD, SD) * KM\n> > \n> > ! Creating variable names\n> > rownames(COVAR)<-colnames(COVAR)<-c('a1','a2','a3','d1','d2','\n> > d3','f1','f2','f3')\n> > \n> > ! Specifying the measurement model to estimate:\n> > model<-specify.model()\n> > ANXIETY -> a1,     NA, 1\n> > ANXIETY -> a2,     lam_anx_2, NA \n> > ANXIETY -> a3,     lam_anx_3, NA\n> > DEPRESS -> d1,     NA, 1\n> > DEPRESS -> d2,     lam_dep_2, NA\n> > DEPRESS -> d3,     lam_dep_3, NA\n> > FEAR -> f1,             NA, 1\n> > FEAR -> f2,             lam_fear_2, NA\n> > FEAR -> f3,             lam_fear_3, NA\n> > a1 <-> a1,                theta_a1, NA\n> > a2 <-> a2,                theta_a2, NA\n> > a3 <-> a3,                theta_a3, NA\n> > d1 <-> d1,               theta_d1, NA\n> > d2 <-> d2,               theta_d2, NA\n> > d3 <-> d3,               theta_d3, NA\n> > f1 <-> f1,                 theta_f1, NA\n> > f2 <-> f2,                 theta_f2, NA\n> > f3 <-> f3,                 theta_f3, NA\n> > ANXIETY <-> ANXIETY,   phi_AA, NA\n> > DEPRESS <-> DEPRESS,     phi_DD, NA\n> > FEAR <-> FEAR,                  phi_FF, NA\n> > ANXIETY <-> FEAR,           phi_AF, NA\n> > ANXIETY <-> DEPRESS,    phi_AD, NA\n> > DEPRESS <-> FEAR,            phi_DF, NA\n> > \n> > ! Running the estimation using sem:\n> > sem.anxiety<-sem(model, COVAR, N=150)\n> > \n> > Thank you very much for your advice!\n> > Dimitri\n> > \n> >\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}