{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "svn commit: samba r23143 - in\n\tbranches/SAMBA_4_0/source/torture/raw: .", "body": "Author: tridge\nDate: 2007-05-25 12:35:03 +0000 (Fri, 25 May 2007)\nNew Revision: 23143\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23143\n\nLog:\nerror found by valgrind\n\nModified:\n   branches/SAMBA_4_0/source/torture/raw/lockbench.c\n   branches/SAMBA_4_0/source/torture/raw/openbench.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/torture/raw/lockbench.c\n===================================================================\n--- branches/SAMBA_4_0/source/torture/raw/lockbench.c\t2007-05-25 12:21:29 UTC (rev 23142)\n+++ branches/SAMBA_4_0/source/torture/raw/lockbench.c\t2007-05-25 12:35:03 UTC (rev 23143)\n@@ -274,15 +274,16 @@\n \tfflush(stdout);\n \tevent_add_timed(ev, state, timeval_current_ofs(1, 0), report_rate, state);\n \n-\tif (!state[i].tree) {\n-\t\treturn;\n-\t}\n-\n \t/* send an echo on each interface to ensure it stays alive - this helps\n \t   with IP takeover */\n \tfor (i=0;i<nprocs;i++) {\n \t\tstruct smb_echo p;\n \t\tstruct smbcli_request *req;\n+\n+\t\tif (!state[i].tree) {\n+\t\t\tcontinue;\n+\t\t}\n+\n \t\tp.in.repeat_count = 1;\n \t\tp.in.size = 0;\n \t\tp.in.data = NULL;\n\nModified: branches/SAMBA_4_0/source/torture/raw/openbench.c\n===================================================================\n--- branches/SAMBA_4_0/source/torture/raw/openbench.c\t2007-05-25 12:21:29 UTC (rev 23142)\n+++ branches/SAMBA_4_0/source/torture/raw/openbench.c\t2007-05-25 12:35:03 UTC (rev 23143)\n@@ -314,15 +314,16 @@\n \tfflush(stdout);\n \tevent_add_timed(ev, state, timeval_current_ofs(1, 0), report_rate, state);\n \n-\tif (!state[i].tree) {\n-\t\treturn;\n-\t}\n-\n \t/* send an echo on each interface to ensure it stays alive - this helps\n \t   with IP takeover */\n \tfor (i=0;i<nprocs;i++) {\n \t\tstruct smb_echo p;\n \t\tstruct smbcli_request *req;\n+\n+\t\tif (!state[i].tree) {\n+\t\t\tcontinue;\n+\t\t}\n+\n \t\tp.in.repeat_count = 1;\n \t\tp.in.size = 0;\n \t\tp.in.data = NULL;\n\n"}