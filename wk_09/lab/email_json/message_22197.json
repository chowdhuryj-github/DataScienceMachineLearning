{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "gd@samba.org", "subject": "svn commit: samba r22644 - in branches: SAMBA_3_0/source/libsmb\n\tSAMBA_3_0_25/source/libsmb", "body": "Author: gd\nDate: 2007-05-03 11:49:32 +0000 (Thu, 03 May 2007)\nNew Revision: 22644\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22644\n\nLog:\nFix memleak.\n\nGuenther\n\nModified:\n   branches/SAMBA_3_0/source/libsmb/cliconnect.c\n   branches/SAMBA_3_0_25/source/libsmb/cliconnect.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/libsmb/cliconnect.c\n===================================================================\n--- branches/SAMBA_3_0/source/libsmb/cliconnect.c\t2007-05-03 11:44:18 UTC (rev 22643)\n+++ branches/SAMBA_3_0/source/libsmb/cliconnect.c\t2007-05-03 11:49:32 UTC (rev 22644)\n@@ -536,6 +536,7 @@\n \tint32 cur = 0;\n \tDATA_BLOB send_blob = data_blob(NULL, 0);\n \tint32 max_blob_size = 0;\n+\tDATA_BLOB receive_blob = data_blob(NULL, 0);\n \n \tif (cli->max_xmit < BASE_SESSSETUP_BLOB_PACKET_SIZE + 1) {\n \t\tDEBUG(0,(\"cli_session_setup_blob: cli->max_xmit too small \"\n@@ -575,7 +576,8 @@\n \t\t\treturn False;\n \t\t}\n \n-\t\tcli_session_setup_blob_receive(cli);\n+\t\treceive_blob = cli_session_setup_blob_receive(cli);\n+\t\tdata_blob_free(&receive_blob);\n \n \t\tif (cli_is_error(cli) &&\n \t\t\t\t!NT_STATUS_EQUAL( cli_get_nt_error(cli), \n\nModified: branches/SAMBA_3_0_25/source/libsmb/cliconnect.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/libsmb/cliconnect.c\t2007-05-03 11:44:18 UTC (rev 22643)\n+++ branches/SAMBA_3_0_25/source/libsmb/cliconnect.c\t2007-05-03 11:49:32 UTC (rev 22644)\n@@ -536,6 +536,7 @@\n \tint32 cur = 0;\n \tDATA_BLOB send_blob = data_blob(NULL, 0);\n \tint32 max_blob_size = 0;\n+\tDATA_BLOB receive_blob = data_blob(NULL, 0);\n \n \tif (cli->max_xmit < BASE_SESSSETUP_BLOB_PACKET_SIZE + 1) {\n \t\tDEBUG(0,(\"cli_session_setup_blob: cli->max_xmit too small \"\n@@ -575,7 +576,8 @@\n \t\t\treturn False;\n \t\t}\n \n-\t\tcli_session_setup_blob_receive(cli);\n+\t\treceive_blob = cli_session_setup_blob_receive(cli);\n+\t\tdata_blob_free(&receive_blob);\n \n \t\tif (cli_is_error(cli) &&\n \t\t\t\t!NT_STATUS_EQUAL( cli_get_nt_error(cli), \n\n"}