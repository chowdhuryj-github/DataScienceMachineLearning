{"category": "ham", "to_address": "Volker.Lendecke@SerNet.DE", "from_address": "Ignacio Coupeau <icoupeau@unav.es>", "subject": "Re: [CTDB and GFS] some troubles joining domain", "body": "Volker Lendecke wrote:\n> On Wed, Jun 27, 2007 at 10:32:47AM +0200, Ignacio Coupeau wrote:\n>> I tested with all the netbios name to \"piedra\" and \"use mmap = no\" but \n>> the results are the same... the \"Segmentation fault\" ended the join.\n> \n> If you can't get the line number for the tdb_transaction\n> part of the backtrace, maybe you can get us a strace of the\n> join attempt with \"use mmap = no\".\n\nI added some debug lines to libsmb/trusts_util.c (see below), and the \nproblem comes in the call:\n\nif (!secrets_store_machine_password(new_trust_passwd, domain, \nsec_channel_type)) {...\n\nthen I think that tdb is not initialized and tdb-> points nothing:\n\n/*\n   start a tdb transaction. No token is returned, as only a single\n   transaction is allowed to be pending per tdb_context\n*/\nint tdb_transaction_start(struct tdb_context *tdb)\n{\n         /* some sanity checks */\n         if (tdb->read_only || (tdb->flags & TDB_INTERNAL) || \ntdb->traverse_read) {...\n\n-- \n________________________________________________________\nDr. Ignacio Coupeau\nSystems and Network Services Director\nIT Services\nUniversity of Navarra           http://www.unav.edu/\nPamplona, SPAIN                 http://www.unav.es/SI/\n\n"}