{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Tyler Smith <tyler.smith@mail.mcgill.ca>", "subject": "[R] manova permutations and pair-wise contrasts", "body": "Hi,\n\nI have a function for doing permutation tests for Manovas, written\nwith the help of folks here on the list. It seems to work ok, and I've\nfound that there is indeed a significant difference among groups in my\nanalysis. I want to follow up on this by testing for which pairs of\ngroups are significantly different. Reasoning that since Wilks Lambda\nis a generalization of the Hotelling T test, it should be appropriate\nfor testing difference between two groups as well as between many\ngroups, I used the same function. \n\nThis appears to work, with one exception. For one pair of groups the\nresiduals have rank 14 < 15. Reading through the archives I see that\nthis problem comes up with permutation tests on occassion. My question\nis, does this problem indicate a mistaken assumption or faulty code on\nmy part, and is there anyway to address it, either with a different\napproach or a change to my function?\n\nThe actual function I use is:\n\nwilks.perm <- function(data.mat, cat.vect, n=999){\n  res.vect <- numeric(n+1)\n\n  for (i in 1:n){\n    wilks <- summary(manova(data.mat ~ sample(cat.vect)),\n                     test=\"Wilks\")$stats[1,2]\n    res.vect[i] <- wilks\n  }\n\n  res.vect[n+1] <- obs <-\n    summary(manova(data.mat~cat.vect), test=\"Wilks\")$stats[1,2]\n\n  return(sum(res.vect <= res.vect[n+1])/(n+1))\n\n}\n\nThanks!\n\nTyler\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}