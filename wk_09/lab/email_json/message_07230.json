{"category": "ham", "to_address": "jadamson@partners.org", "from_address": "\"Weiwei Shi\" <helprhelp@gmail.com>", "subject": "Re: [R] My First Function: cryptic error message", "body": "Hi, Joel:\n\nI cannot reproduce the error w/o the data called probands but I assume\nthe line in bagger function\nbootsamples <- rmultinom (length(trees), n,\n                           rep(1,n)/n)\n\nmight not succeed so that it complains bootsamples not found.\n\ntry to add one line like print(dim(bootsamples)) after the above line\nin your codes to see if there is a problem there.\n\nHTH,\n\nWeiwei\n\nOn 4/16/07, Joel J. Adamson  wrote:\n> Dear List,\n> My first R function is a rip-off bagging algorithm from pg. 138 of\n> Everitt and Hothorn's \"Handbook of Statistical Analyses using R\"\n> (HSAUR).  I'm using recursive partitioning to develop a set of useful\n> variables in diagnosing ADHD.\n>\n> I'm running this in ESS in XEmacs 21.4.19, R 2.4.1 on Slackware Linux\n> 11.0 with a 2.6 kernel.\n>\n> This is almost an entire script, although I've removed or disguised\n> parts that would reveal my plans for world domination.  The function\n> is right here at the top:\n>\n> ####################\n> # bagging function:\n> bagger <- function (length = 25, formula, dataframe) {\n>   trees <- vector(mode = \"list\", length = length)\n>   n <- nrow(dataframe)\n>   bootsamples <- rmultinom (length(trees), n,\n>                             rep(1,n)/n)\n>   mod <- rpart(formula, data = dataframe,\n>                control = rpart.control(xval = 0))\n>   for (i in 1:length(trees)) {\n>     trees[[i]] <- update(mod,\n>                          weights = bootsamples[, i])\n>   }\n> }\n>\n> #bring in data\n> [snip]\n> #Recursive partitioning:\n> library(\"rpart\")\n> # get a 2/3 random sample of ids\n> ids <- sample(probands$id,\n>                    size = 2*(length(probands$id))/3,\n>                    replace = FALSE)\n> # now I want a logical vector telling me which sample to put the\n> # subjects in:\n> #training_true <- probands$id %in% ids\n> training <- subset(probands, probands$id %in% ids)\n> testing <- subset(probands, ! probands$id %in% ids)\n>\n> # formula for the rpart model\n> adhdcbin <- factor(probands$adhdcbin, ordered = TRUE,\n>                    labels = cbind(\"Control\",\"ADHD\" ))\n> cbs38s <- as.formula(paste(\"adhdcbin ~\",\n>                      paste(names(probands[grep(\"cbs38_..*\",names(probands))]),\n>                            collapse = \"+\")))\n>\n> # fitting the rpart model\n> rpart_training <- rpart(cbs38s,\n>                         data = training,\n>                         method = \"class\")\n> X11 (); plot(rpart_training);text(rpart_training)\n> rpart_training.bagged <- bagger(length = 100, formula = cbs38s, training)\n> X11 (); plot(rpart_training.bagged);text(rpart_training.bagged)\n> ####################\n>\n> The second-to-last line gives me the following error:\n>\n> Error in eval(expr, envir, enclos) : object \"bootsamples\" not found\n>\n> I've used backtrace(), debug(bagger) and options(error=recover ()) and\n> nothing seems to make sense.  What should I be looking for?\n> \"bootsamples\" is there at every time except ...\n>\n> I've tried this with other formulas, I've tried typing in\n> the function vs. reading it in by source(); I've re-formatted the top\n> line to read with the brace on the same line as the declaration or on\n> the next line.  EVerything produces the same message.  Am I binding\n> the variables correctly?  Am I declaring the arguments correctly?\n>\n> The most irritating part is that this worked last week ;)  I swear.\n>\n> Thanks,\n> Joel\n> --\n> Joel J. Adamson\n> Biostatistician\n> Pediatric Psychopharmacology Research Unit\n> Massachusetts General Hospital\n> Boston, MA  02114\n> (617) 643-1432\n> (303) 880-3109\n>\n>\n>\n>\n>\n> The information transmitted in this electronic communication...{{dropped}}\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n\n-- \nWeiwei Shi, Ph.D\nResearch Scientist\nGeneGO, Inc.\n\n\"Did you always know?\"\n\"No, I did not. But I believed...\"\n---Matrix III\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}