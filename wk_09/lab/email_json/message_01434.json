{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 83: make some functions static,\n\tand remove an unused structure in http://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 83\nrevision-id: tridge@samba.org-20070410094029-2b9561032c749c8a\nparent: tridge@samba.org-20070410093521-faf87738c5a369a7\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Tue 2007-04-10 19:40:29 +1000\nmessage:\n  make some functions static, and remove an unused structure\nmodified:\n  common/ctdb_daemon.c           ctdb_daemon.c-20070409200331-3el1kqgdb9m4ib0g-1\n  tcp/tcp_connect.c              tcp_connect.c-20061128004937-x70q1cu5xzg5g2tm-1\n  tcp/tcp_init.c                 tcp_init.c-20061128004937-x70q1cu5xzg5g2tm-2\n=== modified file 'common/ctdb_daemon.c'\n--- a/common/ctdb_daemon.c\t2007-04-10 09:33:21 +0000\n+++ b/common/ctdb_daemon.c\t2007-04-10 09:40:29 +0000\n@@ -417,16 +417,10 @@\n }\n \n \n-struct ctdbd_queue_packet {\n-\tstruct ctdbd_queue_packet *next, *prev;\n-\tuint8_t *data;\n-\tuint32_t length;\n-};\n-\n /*\n   queue a packet for sending\n */\n-int ctdbd_queue_pkt(struct ctdb_context *ctdb, struct ctdb_req_header *hdr)\n+static int ctdbd_queue_pkt(struct ctdb_context *ctdb, struct ctdb_req_header *hdr)\n {\n \treturn ctdb_queue_send(ctdb->daemon.queue, (uint8_t *)hdr, hdr->length);\n }\n\n=== modified file 'tcp/tcp_connect.c'\n--- a/tcp/tcp_connect.c\t2007-04-10 09:33:21 +0000\n+++ b/tcp/tcp_connect.c\t2007-04-10 09:40:29 +0000\n@@ -37,7 +37,7 @@\n /*\n   called when a complete packet has come in - should not happen on this socket\n  */\n-void ctdb_tcp_tnode_cb(uint8_t *data, size_t cnt, void *private)\n+static void ctdb_tcp_tnode_cb(uint8_t *data, size_t cnt, void *private)\n {\n \tstruct ctdb_node *node = talloc_get_type(private, struct ctdb_node);\n \tstruct ctdb_tcp_node *tnode = talloc_get_type(node->private, \n\n=== modified file 'tcp/tcp_init.c'\n--- a/tcp/tcp_init.c\t2007-04-10 02:39:25 +0000\n+++ b/tcp/tcp_init.c\t2007-04-10 09:40:29 +0000\n@@ -29,7 +29,7 @@\n /*\n   start the protocol going\n */\n-int ctdb_tcp_start(struct ctdb_context *ctdb)\n+static int ctdb_tcp_start(struct ctdb_context *ctdb)\n {\n \tint i;\n \n@@ -59,7 +59,7 @@\n /*\n   initialise tcp portion of a ctdb node \n */\n-int ctdb_tcp_add_node(struct ctdb_node *node)\n+static int ctdb_tcp_add_node(struct ctdb_node *node)\n {\n \tstruct ctdb_tcp_node *tnode;\n \ttnode = talloc_zero(node, struct ctdb_tcp_node);\n@@ -74,7 +74,7 @@\n /*\n   transport packet allocator - allows transport to control memory for packets\n */\n-void *ctdb_tcp_allocate_pkt(struct ctdb_context *ctdb, size_t size)\n+static void *ctdb_tcp_allocate_pkt(struct ctdb_context *ctdb, size_t size)\n {\n \t/* tcp transport needs to round to 8 byte alignment to ensure\n \t   that we can use a length header and 64 bit elements in\n\n"}