{"category": "ham", "to_address": "Ben Bolker <bolker@ufl.edu>", "from_address": "Thomas Lumley <tlumley@u.washington.edu>", "subject": "Re: [R] extract index during execution of sapply", "body": "On Fri, 22 Jun 2007, Ben Bolker wrote:\n\n> Christian Bieli  unibas.ch> writes:\n>\n>>\n>> Hi there\n>> During execution of sapply I want to extract the number of times the\n>> function given to supply has been executed. I came up with:\n>>\n>> mylist <- list(a=3,b=6,c=9)\n>> sapply(mylist,function(x)as.numeric(gsub(\"[^0-9]\",\"\",deparse(substitute(x)))))\n>>\n>> This works fine, but looks quite ugly. I'm sure that there's a more\n>> elegant way to do this.\n>>\n>> Any suggestion?\n>>\n>> Christian\n>>\n>\n>   I would love to have an answer to this -- when I run\n> into this kind of problem I usually end up using mapply:\n> e.g., suppose I have\n>\n> mylist <- replicate(5,list(x=runif(10),y=runif(10)),simplify=FALSE)\n>\n> and I want to plot each element in a different color.  I'd like\n> to be able to do\n>\n> plot(0:1,0:1,type=\"n\")\n> lapply(mylist,plot,col=i)\n>\n> but instead I do\n>\n> mapply(function(x,i) points(x,col=i),mylist,1:5)\n>\n> would it be too ugly to have a special variable called INDEX\n> that could be used within an sapply/lapply statement?\n>\n\nThere are two distinct suggestions here: a variable that says *how many* \ntimes the function has been called, and a variable that say *which \nelement* is currently being operated on.   The first seems undesirable as \norder of evaluation really should not matter in the apply functions.\n\nThe second makes more sense but is still a little tricky. AFAICS there is \nno way for lapply() to find out whether FUN will accept an argument INDEX \nwithout an \"unused argument(s)\" error, so it can't just be passed as an \nargument.  This suggests having yet another apply function, that would \nassume an INDEX argument and might be written\n   yapply<-function(X,FUN, ...) {\n \tindex<-seq(length.out=length(X))\n         mapply(FUN,X,INDEX=index,MoreArgs=list(...))\n        }\n\nHowever, I think it would be preferable in many cases for INDEX to be \nnames(X) if it exists, rather than 1:n.  In any case, it is easy  to write \nthe function.\n\n \t-thomas\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}