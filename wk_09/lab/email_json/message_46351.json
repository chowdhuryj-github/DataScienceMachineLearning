{"category": "ham", "to_address": "\"'Martin Henry H. Stevens'\" <HStevens@muohio.edu>,\n   \"'Spencer Graves'\" <spencer.graves@pdf.com>", "from_address": "\"Ravi Varadhan\" <rvaradhan@jhmi.edu>", "subject": "Re: [R] Fwd: Using odesolve to produce non-negative solutions", "body": "Hi Jeremy,\n\nA smaller step size may or may not help.  If the issue is simply truncation\nerror, that is the error involved in discretizing the differential\nequations, then a smaller step size would help.  If, however, the true\nsolution to the differential equation is negative, for some t, then the\nnumerical solution should also be negative.  If the negative solution does\nnot make sense, then the system of equation needs to be examined to see when\nand why negative solutions arise.  Perhaps, I am just making this up - there\nneeds to be a \"barrier function\" that slows down the trajectory as it\napproaches zero from its initial value. It is also possible that only\ncertain regions of the parameter space are allowed in the sense that only\nthere the solution is feasible for all t.  So, in your example, the\nparameters might not be realistic.  In short, if you are sure that the\nnumerical solution is accurate, then you need to go back to your system of\nequations and analyze them carefully.\n\n\nRavi.\n\n\n----------------------------------------------------------------------------\n-------\n\nRavi Varadhan, Ph.D.\n\nAssistant Professor, The Center on Aging and Health\n\nDivision of Geriatric Medicine and Gerontology \n\nJohns Hopkins University\n\nPh: (410) 502-2619\n\nFax: (410) 614-9625\n\nEmail: rvaradhan@jhmi.edu\n\nWebpage:  http://www.jhsph.edu/agingandhealth/People/Faculty/Varadhan.html\n\n \n\n----------------------------------------------------------------------------\n--------\n\n\n-----Original Message-----\nFrom: r-help-bounces@stat.math.ethz.ch\n[mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Martin Henry H.\nStevens\nSent: Monday, June 11, 2007 1:03 PM\nTo: Spencer Graves\nCc: Jeremy Goldhaber-Fiebert; R-Help; Setzer.Woodrow@epamail.epa.gov\nSubject: Re: [R] Fwd: Using odesolve to produce non-negative solutions\n\nHi Spencer,\nI have copied Woody Setzer. I have no idea whether lsoda can estimate  \nparameters that could take imaginary values.\nHank\nOn Jun 11, 2007, at 12:52 PM, Spencer Graves wrote:\n\n> \n>\n> Martin Henry H. Stevens wrote:\n>> Hi Jeremy,\n>> First, setting hmax to a small number could prevent a large step, if\n>> you think that is a problem. Second, however, I don't see how you can\n>> get a negative population size when using the log trick.\n> SG:  Can lsoda estimate complex or imaginary parameters?\nHmm. I have no idea.\n>\n>> I would think that that would prevent completely any negative values\n>> of N (i.e. e^-100000 > 0). Can you explain? or do you want to a void\n>> that trick? The only other solver I know of is rk4 and it is not\n>> recommended.\n>> Hank\n>> On Jun 11, 2007, at 11:46 AM, Jeremy Goldhaber-Fiebert wrote:\n>>\n>>> Hi Spencer,\n>>>\n>>> Thank you for your response. I also did not see anything on the  \n>>> lsoda\n>>> help page which is the reason that I wrote to the list.\n>>>\n>>>> From your response, I am not sure if I asked my question clearly.\n>>>\n>>> I am modeling a group of people (in a variety of health states)\n>>> moving through time (and getting infected with an infectious\n>>> disease). This means that the count of the number of people in each\n>>> state should be positive at all times.\n>>>\n>>> What appears to happen is that lsoda asks for a derivative at a  \n>>> given\n>>> point in time t and then adjusts the state of the population.\n>>> However, perhaps due to numerical instability, it occasionally lower\n>>> the population count below 0 for one of the health states (perhaps\n>>> because it's step size is too big or something).\n>>>\n>>> I have tried both the logarithm trick\n> \n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting- \n> guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n\n\nDr. Hank Stevens, Assistant Professor\n338 Pearson Hall\nBotany Department\nMiami University\nOxford, OH 45056\n\nOffice: (513) 529-4206\nLab: (513) 529-4262\nFAX: (513) 529-4243\nhttp://www.cas.muohio.edu/~stevenmh/\nhttp://www.muohio.edu/ecology/\nhttp://www.muohio.edu/botany/\n\n\"E Pluribus Unum\"\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}