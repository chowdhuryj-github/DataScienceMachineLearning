{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Daniel Bolnick <danbolnick@mail.utexas.edu>", "subject": "[R] ANOVA results in R conflicting with results in other software\n packages", "body": "Hi,\n\nI'm wrestling with an analysis of a dataset, which I previously \nanalyzed in SYSTAT, but am now converting to R and was doing a \nre-analysis. I noticed, however, that the same model yields different \nresults (different sums of squares) from the two programs. I first \nthought this might be because the two programs use different \ncalculations to get the sums of squares, but the problem persisted \neven after I specified type III sums of squares. Can anyone help me \nby clarifying why there is this discrepancy?\n\nThe data table is:\n\nhost    size2   maladapt        increase\nA       yes      35      21\nA       yes      30      13\nA       no       73     -6\nA       yes     22       3\nC       yes      19     -1\nA       no      53      1\nC       no       48     -27\nA       yes      32      26\nA       yes     14       1\nA       no       83     42\nA       yes      19     -3\nA       no      66       -7\nC       no      69      -14\nA       yes      30     30\nC       no       69     -22\nA       yes      10      6\nC       no      65      -15\nA       yes      11     4\nA       yes      15     15\nA       no      77      30\nC       yes     11       11\nA       no      48       -4\nC       yes     29      -4\nA       yes     0       0\nC       no      69       -2\nA       yes     10       -40\nC       yes      8      -6\nC       no       91     -2\nC       no      65      13\nA       yes     12       0\nC       yes     16       -26\nC       yes     38      -12\nA       no      43      20\nC       no      81       -7\nA       yes      9      9\nC       no      100     25\nA       yes     18       12\nC       yes     27       -6\nA       yes     11       -3\n\nThe dialogue in R is as follows:\n> > library(car)\n>\n> > read.table(file=\"/Users/lukeharmon/Desktop/glmnosil.txt\",\n>header=T)->nn\n> > attach(nn)\n> > ls(2)\n>[1] \"host\"     \"increase\" \"maladapt\" \"size2\"    \"size4\"\n> > lm(maladapt~host*increase*size2)\n>\n>Call:\n>lm(formula = maladapt ~ host * increase * size2)\n>\n>Coefficients:\n>             (Intercept)                    hostC\n>increase                 size2yes\n>                59.54144                 17.13828\n>0.34487                -44.41381\n>          hostC:increase           hostC:size2yes\n>increase:size2yes  hostC:increase:size2yes\n>                 0.30449                -12.50558\n>0.03766                 -0.90697\n>\n> > lm(maladapt~host*increase*size2)->fm\n> > Anova(fm, type=\"III\")\n>Anova Table (Type III tests)\n>\n>Response: maladapt\n>                      Sum Sq Df  F value    Pr(>F)\n>(Intercept)         18348.5  1 152.9683 1.595e-13 ***\n>host                  920.9  1   7.6774  0.009366 **\n>increase              278.4  1   2.3210  0.137773\n>size2                7447.0  1  62.0841 6.806e-09 ***\n>host:increase         105.1  1   0.8758  0.356584\n>host:size2            266.9  1   2.2252  0.145880\n>increase:size2          2.0  1   0.0171  0.896902\n>host:increase:size2   332.3  1   2.7703  0.106108\n>Residuals            3718.4 31\n>---\n>Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nContrast this with the results from SYSTAT\n\n\nSourceSum-of-SquaresdfMean-SquareF-ratioP\nHOST$808.9491808.9496.7440.014\nSIZE2$17525.418117525.418146.1060.000\nINCREASE540.5791540.5794.5070.042\nSIZE2$*HOST$266.9151266.9152.2250.146\nSIZE2$*INCREASE279.3891279.3892.3290.137\nHOST$*INCREASE35.869135.8690.2990.588\nSIZE2$*HOST$*INCREASE332.2931332.2932.7700.106\nError3718.44131119.950\n\n\nI've been trying to find anything in the documentation for anova() \nthat would give a default that is different from what is in SYSTAT, \nbut part of the problem is that SYSTAT is somewhat opaque as to its \ncalculations, so it is hard to contrast the two. I would really \nreally welcome feedback as to what may cause this discrepancy.\n\nThanks very much for your help,\n\nDan Bolnick\nSection of Integrative Biology\nUniversity of Texas at Austin \n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}