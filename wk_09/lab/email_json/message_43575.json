{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r23368 - in branches: SAMBA_3_0/source/nsswitch\n\tSAMBA_3_0/source/param SAMBA_3_0_26/source/nsswitch\n\tSAMBA_3_0_26/source/param", "body": "Author: vlendec\nDate: 2007-06-06 13:02:24 +0000 (Wed, 06 Jun 2007)\nNew Revision: 23368\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23368\n\nLog:\nMake \"winbind:rpc only\" a full blown parameter. Thanks to Karolin for\nthe patch :-)\n\nModified:\n   branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\n   branches/SAMBA_3_0/source/param/loadparm.c\n   branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n   branches/SAMBA_3_0_26/source/param/loadparm.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\t2007-06-06 13:02:14 UTC (rev 23367)\n+++ branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\t2007-06-06 13:02:24 UTC (rev 23368)\n@@ -170,7 +170,7 @@\n \n \t\tif ((our_domain->active_directory || IS_DC)\n \t\t    && domain->active_directory\n-\t\t    && !lp_parm_bool(-1, \"winbind\", \"rpc only\", False)) {\n+\t\t    && !lp_winbind_rpc_only()) {\n \t\t\tDEBUG(5,(\"get_cache: Setting ADS methods for domain %s\\n\", domain->name));\n \t\t\tdomain->backend = &ads_methods;\n \t\t} else {\n\nModified: branches/SAMBA_3_0/source/param/loadparm.c\n===================================================================\n--- branches/SAMBA_3_0/source/param/loadparm.c\t2007-06-06 13:02:14 UTC (rev 23367)\n+++ branches/SAMBA_3_0/source/param/loadparm.c\t2007-06-06 13:02:24 UTC (rev 23368)\n@@ -180,6 +180,7 @@\n \tBOOL bWinbindRefreshTickets;\n \tBOOL bWinbindOfflineLogon;\n \tBOOL bWinbindNormalizeNames;\n+\tBOOL bWinbindRpcOnly;\n \tchar **szIdmapDomains;\n \tchar **szIdmapBackend; /* deprecated */\n \tchar *szIdmapAllocBackend;\n@@ -1289,6 +1290,7 @@\n \t{\"winbind refresh tickets\", P_BOOL, P_GLOBAL, &Globals.bWinbindRefreshTickets, NULL, NULL, FLAG_ADVANCED}, \n \t{\"winbind offline logon\", P_BOOL, P_GLOBAL, &Globals.bWinbindOfflineLogon, NULL, NULL, FLAG_ADVANCED},\n \t{\"winbind normalize names\", P_BOOL, P_GLOBAL, &Globals.bWinbindNormalizeNames, NULL, NULL, FLAG_ADVANCED},\n+\t{\"winbind rpc only\", P_BOOL, P_GLOBAL, &Globals.bWinbindRpcOnly, NULL, NULL, FLAG_ADVANCED},\n \n \t{NULL,  P_BOOL,  P_NONE,  NULL,  NULL,  NULL,  0}\n };\n@@ -1899,6 +1901,7 @@\n FN_GLOBAL_BOOL(lp_winbind_refresh_tickets, &Globals.bWinbindRefreshTickets)\n FN_GLOBAL_BOOL(lp_winbind_offline_logon, &Globals.bWinbindOfflineLogon)\n FN_GLOBAL_BOOL(lp_winbind_normalize_names, &Globals.bWinbindNormalizeNames)\n+FN_GLOBAL_BOOL(lp_winbind_rpc_only, &Globals.bWinbindRpcOnly)\n \n FN_GLOBAL_LIST(lp_idmap_domains, &Globals.szIdmapDomains)\n FN_GLOBAL_LIST(lp_idmap_backend, &Globals.szIdmapBackend) /* deprecated */\n\nModified: branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-06-06 13:02:14 UTC (rev 23367)\n+++ branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-06-06 13:02:24 UTC (rev 23368)\n@@ -170,7 +170,7 @@\n \n \t\tif ((our_domain->active_directory || IS_DC)\n \t\t    && domain->active_directory\n-\t\t    && !lp_parm_bool(-1, \"winbind\", \"rpc only\", False)) {\n+\t\t    && !lp_winbind_rpc_only()) {\n \t\t\tDEBUG(5,(\"get_cache: Setting ADS methods for domain %s\\n\", domain->name));\n \t\t\tdomain->backend = &ads_methods;\n \t\t} else {\n\nModified: branches/SAMBA_3_0_26/source/param/loadparm.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/param/loadparm.c\t2007-06-06 13:02:14 UTC (rev 23367)\n+++ branches/SAMBA_3_0_26/source/param/loadparm.c\t2007-06-06 13:02:24 UTC (rev 23368)\n@@ -181,6 +181,7 @@\n \tBOOL bWinbindRefreshTickets;\n \tBOOL bWinbindOfflineLogon;\n \tBOOL bWinbindNormalizeNames;\n+\tBOOL bWinbindRpcOnly;\n \tchar **szIdmapDomains;\n \tchar **szIdmapBackend; /* deprecated */\n \tchar *szIdmapAllocBackend;\n@@ -1290,6 +1291,7 @@\n \t{\"winbind refresh tickets\", P_BOOL, P_GLOBAL, &Globals.bWinbindRefreshTickets, NULL, NULL, FLAG_ADVANCED}, \n \t{\"winbind offline logon\", P_BOOL, P_GLOBAL, &Globals.bWinbindOfflineLogon, NULL, NULL, FLAG_ADVANCED},\n \t{\"winbind normalize names\", P_BOOL, P_GLOBAL, &Globals.bWinbindNormalizeNames, NULL, NULL, FLAG_ADVANCED},\n+\t{\"winbind rpc only\", P_BOOL, P_GLOBAL, &Globals.bWinbindRpcOnly, NULL, NULL, FLAG_ADVANCED},\n \n \t{NULL,  P_BOOL,  P_NONE,  NULL,  NULL,  NULL,  0}\n };\n@@ -1896,6 +1898,7 @@\n FN_GLOBAL_BOOL(lp_winbind_refresh_tickets, &Globals.bWinbindRefreshTickets)\n FN_GLOBAL_BOOL(lp_winbind_offline_logon, &Globals.bWinbindOfflineLogon)\n FN_GLOBAL_BOOL(lp_winbind_normalize_names, &Globals.bWinbindNormalizeNames)\n+FN_GLOBAL_BOOL(lp_winbind_rpc_only, &Globals.bWinbindRpcOnly)\n \n FN_GLOBAL_LIST(lp_idmap_domains, &Globals.szIdmapDomains)\n FN_GLOBAL_LIST(lp_idmap_backend, &Globals.szIdmapBackend) /* deprecated */\n\n"}