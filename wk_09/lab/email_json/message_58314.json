{"category": "ham", "to_address": "Markus Loecher <markus@insightfromdata.com>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] align() function missing in R ?", "body": "On Fri, 29 Jun 2007, Markus Loecher wrote:\n\n> Thank you for your responses, I should have given an example of the \n> functionality I am looking for, here are three typical scenarios that I deal \n> with a lot in my work:\n>\n> - a regular timeseries with lots of missing values that I want to convert to \n> the corresponding regular time series with mssing values replaced by NAs, \n> e.g.:\n>        x = timeSeries(c(0.5,0.2,0.3,0.4,0.3,0.2,0.3), pos = \n> c(1,2,5,8,9,12,14));\n>        x.align = align(x, pos = 1:14, method = \"NA\");\n> - a regular timeseries at a coarse scale which I want to linearly interpolate \n> to a finer time scale:\n>        x = ts(1:10, frequency = 4);\n>        x.align = align(x, frequency = 8, method = \"interp\")\n> - an irregular timeseries which I want to linearly interpolate to a regular \n> time grid:\n>        x = timeSeries(c(0.5,0.2,0.3,0.4,0.3,0.2,0.3), pos = \n> c(1,2.5,3.2,4.1,5.7,6.5,7.3));\n>        x.align = align(x, pos = 1:7, method = \"interp\");\n>\n> I am wondering how to easily code such a function using only window, ts.union \n> and ts.intersect.\n\nWell, the first and third are using timeSeries which is not in R, and more \nto the point there is no support for irregular time series in R itself.\nBut they seem nothing to do with alignment!\n\nThe first is easy by indexing\n\nx.align <- ts(NA_real_, start=1, end=14)\nx.align[c(1,2,5,8,9,12,14)] <- c(0.5,0.2,0.3,0.4,0.3,0.2,0.3)\n\nThe second and third you can do via approx:\n\nx <- ts(1:10, frequency = 4)\nx.align <- ts(approx(unclass(x), xout=seq(1, 10, 0.5))$y, frequency = 8)\n\npos <- c(1,2.5,3.2,4.1,5.7,6.5,7.3)\nx <- c(0.5,0.2,0.3,0.4,0.3,0.2,0.3)\nts(approx(pos, x, 1:7)$y)\n\nI suspect the first can also be done via package 'zoo', which is the sort \nof place I would expect to find this functionality.\n\n>\n> Thanks again,\n> Markus\n>\n> At 03:52 AM 6/29/2007, Prof Brian Ripley wrote:\n>> On Fri, 29 Jun 2007, Martin Maechler wrote:\n>> \n>>> Hi Markus,\n>>> \n>>> You can't assume that a typical R users knows much about S+.\n>>> \"R has been beyond S+ for a long time\"\n>>>   {{ :-) :-) please Insightful staff, don't start to jump at me !}}\n>>> Even I, as a very long time S and Splus user (of the past:\n>>> 1987--~1997), have never, I think, used align().\n>>> \n>>> Can you give *reproducible examples* of what  align() does for you?\n>>> Then, kind R users will typically show you simple ways to achieve the\n>>> same.\n>>> \n>>> Also: R is Free Software (i.e. open source and more), so\n>>>      we'd be happy to accept offers of an align() function that\n>>>      behaved compatibly (``or better'') than the S-plus one.\n>>> Note however that you'd typically not be allowed to copy the\n>>> S-plus implementation.\n>> \n>> align() relates to the S4 time series classes introduced in S-PLUS 5 (or \n>> so, after 1997).  There are no comparable classes in base R, but there are \n>> in some of the addon packages - fCalendar has already been mentioned and \n>> there are others (see the CRAN Econometric task view).\n>> \n>> window, ts.union and ts.intersect have done all the alignment on regular \n>> time series (class \"ts\") I have ever needed.\n>> \n>>> \n>>> Martin\n>>> \n>>> \n>>>>>>>> \"ML\" == Markus Loecher \n>>>>>>>>     on Thu, 28 Jun 2007 11:10:51 -0400 writes:\n>>>\n>>>    ML> Dear list members, I switched from Splus to R a few\n>>>    ML> years ago and so far found no functionality missing.\n>>>    ML> However, I am struggling to find the equivalent align()\n>>>    ML> function for time series. I did find some reduced\n>>>    ML> functionality such as alignDailySeries in\n>>>    ML> package:fCalendar but the full capability of aligning\n>>>    ML> two timeseries seems to be missing.  Could this be true\n>>>    ML> ? I am sure there must be a need for this useful\n>>>    ML> function.  Any help would be greatly appreciated.\n>>>\n>>>    ML> Thanks !\n>>>\n>>>    ML> Markus\n>>> \n>>> ______________________________________________\n>>> R-help@stat.math.ethz.ch mailing list\n>>> https://stat.ethz.ch/mailman/listinfo/r-help\n>>> PLEASE do read the posting guide \n>>> http://www.R-project.org/posting-guide.html\n>>> and provide commented, minimal, self-contained, reproducible code.\n>> \n>> --\n>> Brian D. Ripley,                  ripley@stats.ox.ac.uk\n>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\n>> University of Oxford,             Tel:  +44 1865 272861 (self)\n>> 1 South Parks Road,                     +44 1865 272866 (PA)\n>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595\n>\n>\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}