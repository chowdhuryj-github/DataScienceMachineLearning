{"category": "ham", "to_address": "perl6-internals@perl.org", "from_address": "chromatic <chromatic@wgz.org>", "subject": "Re: [perl #43218] Memory leaks (compreg, invokecc)", "body": "On Thursday 14 June 2007 14:42:31 Jurosz Michal wrote:\n\n> Attached test use compreg P1, \"PASM\" and invokecc it 100,000 times.\n> On win32 (mingw32) it consumes 70MB of RAM with r18834 (107 MB of RAM\n> with r11704).\n\nWith Linux at r19010, the memory use jumped up to 62 MB for me.\n\nHowever, Valgrind says:\n\n==24190== LEAK SUMMARY:\n==24190==    definitely lost: 128 bytes in 2 blocks.\n==24190==    indirectly lost: 208 bytes in 1 blocks.\n==24190==      possibly lost: 0 bytes in 0 blocks.\n==24190==    still reachable: 0 bytes in 0 blocks.\n==24190==         suppressed: 0 bytes in 0 blocks.\n\n==24190== 252 (44 direct, 208 indirect) bytes in 1 blocks are definitely lost \nin loss record 1 of 3\n==24190==    at 0x4006620: malloc (vg_replace_malloc.c:149)\n==24190==    by 0x41A1170: mem_sys_allocate \n==24190==    by 0x41AF37E: parrot_new_pmc_hash_x \n==24190==    by 0x41AF45E: parrot_new_pmc_hash \n==24190==    by 0x424930A: Parrot_Hash_init \n==24190==    by 0x4203715: Parrot_default_thaw \n==24190==    by 0x424934B: Parrot_Hash_thaw \n==24190==    by 0x41AD9C0: visit_todo_list_thaw \n==24190==    by 0x41AD703: visit_loop_todo_list \n==24190==    by 0x41AE1EB: run_thaw \n==24190==    by 0x419B518: init_world \n\n==24190== 84 bytes in 1 blocks are definitely lost in loss record 2 of 3\n==24190==    at 0x4006620: malloc (vg_replace_malloc.c:149)\n==24190==    by 0x41A1170: mem_sys_allocate \n==24190==    by 0x41EC1DB: queue_init \n==24190==    by 0x41ED08B: Parrot_init_events \n==24190==    by 0x419F464: make_interpreter \n==24190==    by 0x41D3BEB: Parrot_new \n==24190==    by 0x8048860: main\n\n==24190== 208 bytes in 1 blocks are indirectly lost in loss record 3 of 3\n==24190==    at 0x4006620: malloc (vg_replace_malloc.c:149)\n==24190==    by 0x41A1170: mem_sys_allocate \n==24190==    by 0x41AF2C9: init_hash \n==24190==    by 0x41AF45E: parrot_new_pmc_hash \n==24190==    by 0x424930A: Parrot_Hash_init \n==24190==    by 0x4203715: Parrot_default_thaw \n==24190==    by 0x424934B: Parrot_Hash_thaw \n==24190==    by 0x41AD9C0: visit_todo_list_thaw \n==24190==    by 0x41AD703: visit_loop_todo_list \n==24190==    by 0x41AE1EB: run_thaw \n==24190==    by 0x419B518: init_world \n\nI realize the numbers don't add up, but I'm not sure that this is an actual \nleak.\n\n-- c\n\n"}