{"category": "ham", "to_address": "speakup@braille.uwo.ca", "from_address": "Jude DaShiell <jdashiel@shellworld.net>", "subject": "what door or window did I leave open this time?", "body": "A debian system I had running was very badly hacked.  This was debian \nspeakup 2.6.18 kernel.  I decided to write a cs script to run clamscan and \nfound a really easy way to write that script and was planning on sharing \nthat technique until I had a listen of part of the log file I had the \nscript make for me.  Then it was time to preserve what I could and erase \npartitions and install a new system.  I'm most interested in what door or \nwindow I had left open for this hack to have happened.  Activity on the \nsystem was downloading podcasts which were preserved and also doing some \nssh connections but sshd_config and ssh_config had been modified to not \nlisten on any port; permit root login was disabled, and X11-forwarding was \nalso turned off.\nWhat follows is the part of the log I preserved:\n\n\n\n-------------------------------------------------------------------------------\n\n\nUnpacker process 11675 stopped due to exceeded limits\n//usr/share/doc/lg/108/misc/laundrette/laundrette-108.txt: HTML.Phishing.Bank-1 FOUND\n//usr/share/doc/lg/112/lg_laundrette.html: HTML.Phishing.Bank-164 FOUND\n//usr/share/doc/lg/issue85/misc/mahoney/c.img.gz: GZip.ExceededFileSize FOUND\n//usr/share/doc/lg/issue86/TWDT.txt.gz: Exploit.IFrame.Gen FOUND\n\nBeyond that, here's a copy of cs script used with clamscan:\n#!/bin/bash\n# file: cs - clamscan script\nclamscan -l clamscan`date -I`.log -r --bell --exclude=/dev --exclude=/proc --exclude=/pts --exclude=/tmp -i --detect-broken --block-encrypted --block-max --max-files=500 --max-space=10M --max-recursion=8 --max-ratio=250 --max-mail-recursion=8 --max-dir-recursion=15 --deb=/usr/bin/dpkg-deb / *\n\nHow I found that script so easy to write was I put each command line \noption on its own line after clamscan and when the several lines had all \nof those options I used the join command in ex to join those lines into \nthe clamscan command you find in that script.\n\n\n_______________________________________________\nSpeakup mailing list\nSpeakup@braille.uwo.ca\nhttp://speech.braille.uwo.ca/mailman/listinfo/speakup\n\n"}