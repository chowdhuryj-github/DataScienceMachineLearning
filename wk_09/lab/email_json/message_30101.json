{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Vladimir Eremeev <wl2776@gmail.com>", "subject": "[R] qr.solve and lm", "body": "\nDear R experts,\n\nI have a Matlab code which I am translating to R in order to examine and\nenhance it.\nFirst of all, I need to reproduce in R the results which were already\nobtained in Matlab (to make sure that everything is correct).\n\nThere are some matrix manipulations and '\\' operation among them in the\ncode.\n\nI have the following data frame\n\n> ABS.df\n           Pro        syn             unk                 Chl                 \nY                  Nh            V1\n1  0.056524968 0.04387755 -0.073925372 0.026477146 0.083527021 0.0031950622 \n0.02164793\n2  0.066456284 0.05992579 -0.094609497 0.031772575 0.054881164 0.0022078221 \n0.01358594\n3  0.036383887 0.04601113 -0.061213302 0.021181717 0.026713530 0.0011716424 \n0.00824816\n4  0.020419528 0.03803340 -0.044517584 0.013935340 0.019204991 0.0008763467 \n0.00577604\n5  0.010209764 0.02968460 -0.030418334 0.009476031 0.013806924 0.0006554761 \n0.00376991\n6  0.006033043 0.02666976 -0.025735131 0.006967670 0.009778344 0.0004838437 \n0.00441753\n7  0.004733618 0.01168831 -0.009732966 0.006688963 0.002351775 0.0001380701 \n0.00403229\n8  0.000000000 0.00000000  0.000000000 0.000000000 0.000000000 0.0000000000\n-0.00060456\n9  0.000000000 0.00000000  0.000000000 0.000000000 0.000000000 0.0000000000\n-0.00000003\n11 0.241505077 0.45843930 -0.611308847 0.000000000 0.000000000 0.0584138174 \n0.07397018\n21 0.226065730 0.41703452 -0.558270870 0.000000000 0.000000000 0.0516895121 \n0.07460447\n31 0.211956969 0.37139373 -0.495174662 0.000000000 0.000000000 0.0426347324 \n0.07189945\n41 0.206558807 0.35022863 -0.466337208 0.000000000 0.000000000 0.0392775042 \n0.06943217\n51 0.197535970 0.33100673 -0.441656561 0.000000000 0.000000000 0.0363102112 \n0.06912282\n61 0.186798904 0.31656506 -0.416287992 0.000000000 0.000000000 0.0335613531 \n0.06595377\n71 0.156005203 0.24868275 -0.329660100 0.000000000 0.000000000 0.0250152915 \n0.06399879\n81 0.153751864 0.23900952 -0.324902567 0.000000000 0.000000000 0.0232553862 \n0.05981515\n91 0.144414605 0.22782217 -0.297243170 0.000000000 0.000000000 0.0209515025 \n0.05981442\n\n> qr.solve(ABS.df[,1:6],ABS.df[,7])\n       Pro        syn        unk        Chl          Y         Nh \n 0.3877544  0.4282277  0.2221960 -0.8668715  0.2821082 -1.3696411 \n\nThis reproduces the Matlab's numbers \nHowever, I used to lm, its syntax seems to me more clear.\n\n?lm says that it uses QR decomposition to fit the model.\nTrying it:\n\n>  coef(lm(V1~Pro+syn+unk+Chl+Y+Nh,data=ABS.df))\n (Intercept)          Pro          syn          unk          Chl           \nY           Nh \n 0.001640184  0.417253116  0.351472810  0.196977369 -0.899729874 \n0.265585292 -1.181526491 \n\nNumbers differ.\nObviously, I don't understand something. \nPlease, could you clarify, what?\nThank you.\n\n-- \nView this message in context: http://www.nabble.com/qr.solve-and-lm-tf3757650.html#a10620299\nSent from the R help mailing list archive at Nabble.com.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}