{"category": "ham", "to_address": "Perl beginners <beginners@perl.org>", "from_address": "\"John W. Krahn\" <krahnj@telus.net>", "subject": "Re: Perl directory listing program", "body": "sintral@gmail.com wrote:\n> Looking for some help here you perl geniuses you : )\n> \n> I need a program that will list all of the files in a directory.\n> Without any arguments the program will list only the files (not\n> directories) in the current directory.  But I must have some command\n> line options:\n> \n> -d  if no argument is given, the cwd\n> is used.  If the argument given is not a directory an error is thrown.\n> The output needs to have the following headers:\n> File Name | Size | Owner | Group ( with no pipes)\n> \n> -l displays a long listing (can be used with -d as \"script.pl -l -d\n> \")\n> The output needs to have the following headers:\n> File Name | Size | Owner | Group (with no pipes)\n> \n> no parameters - show the files in the cwd\n> The output needs to have the following header:\n> File Name\n\nJust off the top of my head, season to taste:\n\n#!/usr/bin/perl\nuse warnings;\nuse strict;\nuse Getopt::Std;\n\ngetopt 'hl', \\my %opt;\n\nexists $opt{ h } && die <<HELP;\nusage: $0 [-h] [-l] [directory]\n      -h    this message\n      -l    long listing\nHELP\n\nmy $dir    = shift || '.';\nmy $format = \"%-25s %10s %-8s %-8s\\n\";\n\nopendir my $dh, $dir or die \"Cannot open '$dir' $!\";\n\nif ( exists $opt{ l } ) {\n     printf $format, 'File Name', 'Size', 'Owner', 'Group'\n     }\nelse {\n     print \"File Name\\n\"\n     }\n\nwhile ( my $file = readdir $dh ) {\n     my ( $uid, $gid, $size ) = ( lstat \"$dir/$file\" )[ 4, 5, 7 ] or die \n\"Cannot stat '$dir' $!\";\n     next unless -f _;\n     if ( exists $opt{ l } ) {\n         printf $format, $file, $size, scalar getpwuid $uid, scalar \ngetgrgid $gid\n         }\n     else {\n         print \"$file\\n\"\n         }\n     }\n\n\n\n\nJohn\n-- \nuse Perl;\nprogram\nfulfillment\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}