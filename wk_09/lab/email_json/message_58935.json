{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"stefan lhachimi\" <stefan.duke@gmail.com>", "subject": "[R] Importing Excel file that has merged cells", "body": "Dear all,\n\nI have a problem with importing an excel file into R. I can open the\nfile easily (either saving it as a CSV or using RODBC). But the\noriginal file is using merged cell in its first column, which gives\nthe name of the observation. (I am dealing with repeated measurements\nfor the same observation)\nSo when I open the dataframe in R it looks like this\n\nCol1    Col2 Col3\nname1 val1 val2\n         val3 val4\n....\nname2  val5  val6\n           val7  val8\n\nEverything is fine, except that the name of the observation is on the\nfirst line and the following are empty. Until a new observation\nstarts, where a new name appears in the respective row and the\nfollowing rows are empty and so on.\n\nThe number of rows is fixed for each observation. How can I fill the\ncolumn with the proper name (eg take the first string in this column\nuntil you hit a row with a new string, then take this string and go on\nuntil the next string).\n\nOr read the excel file in such a way, that when cells are merged that\nwhen importing it to R all cells created from this merged cell should\nhave the same content.\n\nUnfortunately, I cannot change the lay-out of the original excel file\nas it comes from an commercial data-base and I will have to use it\nquite often.\n\nI have the gut feeling that there might be an easy solution out there\nas it does not seem to be an uncommon problem.\n\nSo if you have  hint or a solution I greatly appreciated it.\nThanks and a nice weekend,\nStefan\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}