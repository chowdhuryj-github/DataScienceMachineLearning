{"category": "ham", "to_address": "\"Patnaik, Tirthankar\" <tirthankar.patnaik@citi.com>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] Quick question on merging two time-series of different\n\tfrequencies", "body": "Its not clear to me what you want but play around with these\nforms of merge.zoo:\n\nmerge(x, y) # all = TRUE\nmerge(x, y, all = FALSE)\nmerge(x, y, all = c(TRUE, FALSE))\nmerge(x, y, all = c(FALSE, TRUE))\n\n\nOn 5/11/07, Patnaik, Tirthankar  wrote:\n> Achim,\n>        Thanks so much! I should've probably explained what I was trying\n> to do better (Just an LOCF!). As you've correctly pointed out I'm trying\n> to merge two time series where the first series is daily (price data),\n> and the second series is irregular (earnings, balance-sheet data).\n>\n> While using an LOCF would certainly solve my problem (In SAS, one used\n> the DOW (Dorfman-Whitlock) loop for this purpose, but I didn't know it\n> existed in R), to account for the possibility of a timestamp in the\n> irregular times series _not_ having an equivalent in the regular series\n> (wherein the na.locf would introduce an NA in the regular series), I\n> just inner-join the regular series with the result.\n>\n> > x <- zoo(rnorm(11), as.Date(\"2000-01-01\") + c(1:6,8:10))\n>\n> Regular series: Doesn't have 7.\n>\n> > y <- zoo(rnorm(4), as.Date(\"2000-01-01\") + c(0, 3, 7, 10))\n>\n> Irregular series: Has 7.\n>\n> > z <- merge(x, y)\n>\n> Full join between x and y.\n>\n> > z1 <- na.locf(z)\n>\n> The LOCF. Fills up the regular series too.\n>\n> > z2 <- merge(x,na.locf(merge(x,y))[,2],all=FALSE)\n>\n> Getting rid of the extraneous observation in x.\n>\n> Results:\n>\n> > x\n> 2000-01-02 2000-01-03 2000-01-04 2000-01-05 2000-01-06 2000-01-07\n> 2000-01-09\n>  1.2194692 -0.6081166 -1.1852422  1.0577249  0.3940365 -0.1742952\n> -0.8321219\n> 2000-01-10 2000-01-11\n> -0.8628410  1.5109680\n> > y\n>  2000-01-01  2000-01-04  2000-01-08  2000-01-11\n> -0.03331723  0.04525300 -0.68003282  0.20282930\n> > z\n>                    x           y\n> 2000-01-01         NA -0.03331723\n> 2000-01-02  1.2194692          NA\n> 2000-01-03 -0.6081166          NA\n> 2000-01-04 -1.1852422  0.04525300\n> 2000-01-05  1.0577249          NA\n> 2000-01-06  0.3940365          NA\n> 2000-01-07 -0.1742952          NA\n> 2000-01-08         NA -0.68003282\n> 2000-01-09 -0.8321219          NA\n> 2000-01-10 -0.8628410          NA\n> 2000-01-11  1.5109680  0.20282930\n> > z1\n>                    x           y\n> 2000-01-02  1.2194692 -0.03331723\n> 2000-01-03 -0.6081166 -0.03331723\n> 2000-01-04 -1.1852422  0.04525300\n> 2000-01-05  1.0577249  0.04525300\n> 2000-01-06  0.3940365  0.04525300\n> 2000-01-07 -0.1742952  0.04525300\n> 2000-01-08 -0.1742952 -0.68003282\n> 2000-01-09 -0.8321219 -0.68003282\n> 2000-01-10 -0.8628410 -0.68003282\n> 2000-01-11  1.5109680  0.20282930\n> attr(,\"na.action\")\n> [1] 1\n> attr(,\"class\")\n> [1] \"omit\"\n> > z2\n>                    x na.locf(merge(x, y))[, 2]\n> 2000-01-02  1.2194692               -0.03331723\n> 2000-01-03 -0.6081166               -0.03331723\n> 2000-01-04 -1.1852422                0.04525300\n> 2000-01-05  1.0577249                0.04525300\n> 2000-01-06  0.3940365                0.04525300\n> 2000-01-07 -0.1742952                0.04525300\n> 2000-01-09 -0.8321219               -0.68003282\n> 2000-01-10 -0.8628410               -0.68003282\n> 2000-01-11  1.5109680                0.20282930\n>\n> Could you also give a quick example of a left- and right join in zoo? I\n> tried all.x=TRUE, and all.y=FALSE but they don't seem to work.\n>\n> Best,\n> -Tir\n>\n> --\n> Tirthankar Patnaik\n> India Strategy\n> Citigroup Investment Research\n> +91-22-6631 9887\n>\n>\n> -----Original Message-----\n> From: Achim Zeileis [mailto:Achim.Zeileis@wu-wien.ac.at]\n> Sent: Thursday, May 10, 2007 10:42 PM\n> To: Patnaik, Tirthankar [GWM-CIR]\n> Cc: r-help@stat.math.ethz.ch\n> Subject: Re: [R] Quick question on merging two time-series of different\n> frequencies\n>\n> On Thu, 10 May 2007, Patnaik, Tirthankar  wrote:\n>\n> > Hi,\n> >       A quick beginner's question. I have two time series, A with\n> daily\n> > data, and another B with data at varying frequencies, but mostly\n> > annual. Both the series are sorted ascending.\n> >\n> > I need to merge these two series together in the following way: For\n> > any entry of A, the lookup should match with B until we find an entry\n> > of B that's larger than A's.\n>\n> I'm not sure what exactly you want. I assume that A and B are not the\n> observations but the corresponding time stamps, right?\n>\n> In any case, I guess that the \"zoo\" package will have some useful\n> functionality for what you want, e.g., if you have data like\n>  library(\"zoo\")\n>  set.seed(123)\n>  x <- zoo(rnorm(11), as.Date(\"2000-01-01\") + 0:10)\n>  y <- zoo(rnorm(4), as.Date(\"2000-01-01\") + c(0, 3, 7, 10)) then you\n> can merge them with\n>  z <- merge(x, y)\n> and then eliminate NAs, e.g. by\n>  na.locf(z)\n> or you could aggregate() the \"x\" series so that it becomes a monthly\n> series or something like that.\n>\n> See\n>  vignette(\"zoo\", package = \"zoo\")\n> for more information.\n>\n> Best,\n> Z\n>\n> > For all A[i], i = 1,...,N and B[j], j=1,...M\n> >\n> > Match with B[j] where A[i] <= B[j]\n> >\n> > When A[i] > B[j], match with B[j+1] where A[i] <= B[j+1]\n> >\n> > Basically the less-frequent attributes stay true for a stock while the\n>\n> > daily prices change.\n> >\n> > One example of this is the vlookup function in Excel with the TRUE\n> > option.\n> >\n> > So we have an implementation of this in R?\n> >\n> > TIA and best,\n> > -Tir\n> >\n> > ______________________________________________\n> > R-help@stat.math.ethz.ch mailing list\n> > https://stat.ethz.ch/mailman/listinfo/r-help\n> > PLEASE do read the posting guide\n> > http://www.R-project.org/posting-guide.html\n> > and provide commented, minimal, self-contained, reproducible code.\n> >\n> >\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}