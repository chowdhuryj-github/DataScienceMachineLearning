{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Shiazy <shiazy@gmail.com>", "subject": "[R] Kolmogorov-Smirnov GoF test", "body": "Hi!\nI want to do a ks.test of some sample data, say \"x\", against a \ntheoretical distribution, e.g. a Weibull.\n\nSo suppose we have these data:\n\nset.seed(1);\nx <- rweibull( 200, 1.3, 8.7 );\n\n1. Is it better to do a 1-sample or a 2-sample test?\n\n    ks.test( x, \"pweibull\", 1.3, 8.7 ); # 1-sample\n    ks.test( x, rweibull( 200, 1.3, 8.7 ); # 2-samples\n\n2. If I perform a 2 sample test, what I thought to do was using some \nkind of resampling from the theoretical distribution and then averages \nall ks statistic obtained on each sampling:\n\n    n <- 1000; # number of resampling\n    mean <- 0; # KS statistic mean\n    sd <- 0; # KS statistc std-err\n    for ( k in 1:n )\n    {\n      ks <- ks.test( x, rweribull( 200, 1.3, 8.7 ) );\n      mean <- mean + ks.statistic;\n      sd <- sd + ks.statistic^2;\n    }\n    ks.mean <- ks.mean/n\n    ks.sd <- sqrt( (ks.sd - n*ks.mean^2)/(n-1) );\n\n    # Calculate p-value with Marsaglia K(n,d) function (used by R)\n    #p.value <- 1-K(200, ks.mean);\n\n    cat( paste( \"KS statistic: \", ks.mean ) );\n    cat( paste( \"Standard Error: \", ks.sd ) );\n    cat( paste( \"p-value: \", p.value ) );\n\nHas this any sense?\n\nAny other critic/suggestion is appreciated.\n\nThank you very much!\n\n-- Marco\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}