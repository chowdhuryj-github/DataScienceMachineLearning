{"category": "ham", "to_address": "<h.wickham@gmail.com>, <jfox@mcmaster.ca>", "from_address": "\"S Ellison\" <S.Ellison@lgc.co.uk>", "subject": "Re: [R] Weighted least squares", "body": "Hadley,\n\nYou asked\n> .. what is the usual way to do a linear \n> regression when you have aggregated data?\n\nLeast squares generally uses inverse variance weighting. For aggregated data fitted as mean values, you just need the variances for the _means_. \n\nSo if you have individual means x_i and sd's s_i that arise from aggregated data with n_i observations in group i, the natural weighting is by inverse squared standard error of the mean. The appropriate weight for x_i would then be n_i/(s_i^2). In R, that's n/(s^2), as n and s would be vectors with the same length as x. If all the groups had the same variance, or nearly so, s is a scalar; if they have the same number of observations, n is a scalar. \n\nOf course, if they have the same variance and same number of observations, they all have the same weight and you needn't weight them at all: see previous posting!\n\nSteve E\n\n\n\n*******************************************************************\nThis email and any attachments are confidential. Any use, co...{{dropped}}\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}