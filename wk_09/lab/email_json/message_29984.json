{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jpeach@samba.org", "subject": "svn commit: samba r22880 - in branches/SAMBA_3_0_26/source: .", "body": "Author: jpeach\nDate: 2007-05-15 05:38:33 +0000 (Tue, 15 May 2007)\nNew Revision: 22880\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22880\n\nLog:\nMerger r22877:22879 from SAMBA_3_0.\n\nModified:\n   branches/SAMBA_3_0_26/source/Makefile.in\n   branches/SAMBA_3_0_26/source/configure.in\n\n\nChangeset:\nModified: branches/SAMBA_3_0_26/source/Makefile.in\n===================================================================\n--- branches/SAMBA_3_0_26/source/Makefile.in\t2007-05-15 05:25:10 UTC (rev 22879)\n+++ branches/SAMBA_3_0_26/source/Makefile.in\t2007-05-15 05:38:33 UTC (rev 22880)\n@@ -132,15 +132,19 @@\n FLAGS5 = $(FLAGS1) $(FLAGS2) $(FLAGS3) $(FLAGS4)\n FLAGS  = $(ISA) $(FLAGS5) -I$(srcdir)/lib -D_SAMBA_BUILD_=3\n \n-PASSWD_FLAGS = -DSMB_PASSWD_FILE=\\\"$(SMB_PASSWD_FILE)\\\" -DPRIVATE_DIR=\\\"$(PRIVATE_DIR)\\\"\n-PATH_FLAGS1 = -DCONFIGFILE=\\\"$(CONFIGFILE)\\\"  -DSBINDIR=\\\"$(SBINDIR)\\\"\n-PATH_FLAGS2 = $(PATH_FLAGS1) -DBINDIR=\\\"$(BINDIR)\\\"\n-PATH_FLAGS3 = $(PATH_FLAGS2) -DLMHOSTSFILE=\\\"$(LMHOSTSFILE)\\\"\n-PATH_FLAGS4 = $(PATH_FLAGS3) -DSWATDIR=\\\"$(SWATDIR)\\\"  -DLOCKDIR=\\\"$(LOCKDIR)\\\" -DPIDDIR=\\\"$(PIDDIR)\\\"\n-PATH_FLAGS5 = $(PATH_FLAGS4) -DLIBDIR=\\\"$(LIBDIR)\\\" \\\n-\t      -DLOGFILEBASE=\\\"$(LOGFILEBASE)\\\" -DSHLIBEXT=\\\"@SHLIBEXT@\\\"\n-PATH_FLAGS6 = $(PATH_FLAGS5) -DCONFIGDIR=\\\"$(CONFIGDIR)\\\"\n-PATH_FLAGS = $(PATH_FLAGS6) $(PASSWD_FLAGS)\n+PATH_FLAGS = -DSMB_PASSWD_FILE=\\\"$(SMB_PASSWD_FILE)\\\" \\\n+\t-DPRIVATE_DIR=\\\"$(PRIVATE_DIR)\\\" \\\n+\t-DCONFIGFILE=\\\"$(CONFIGFILE)\\\" \\\n+\t-DSBINDIR=\\\"$(SBINDIR)\\\" \\\n+\t-DBINDIR=\\\"$(BINDIR)\\\" \\\n+\t-DLMHOSTSFILE=\\\"$(LMHOSTSFILE)\\\" \\\n+\t-DSWATDIR=\\\"$(SWATDIR)\\\" \\\n+\t-DLOCKDIR=\\\"$(LOCKDIR)\\\" \\\n+\t-DPIDDIR=\\\"$(PIDDIR)\\\" \\\n+\t-DLIBDIR=\\\"$(LIBDIR)\\\" \\\n+      \t-DLOGFILEBASE=\\\"$(LOGFILEBASE)\\\" \\\n+\t-DSHLIBEXT=\\\"@SHLIBEXT@\\\" \\\n+\t-DCONFIGDIR=\\\"$(CONFIGDIR)\\\"\n \n # Note that all executable programs now provide for an optional executable suffix.\n \n@@ -909,6 +913,9 @@\n \t  mkdir \"$$dir\" || \\\n \t  exec false; fi || exec false\n \n+# Compile a source file with the installation paths defined.\n+COMPILE_CC_PATH = $(CC) -I. -I$(srcdir) $(PATH_FLAGS) $(FLAGS) $(PICFLAG) -c $< -o $@\n+\n .c.o:\n \t@if (: >> $@ || : > $@) >/dev/null 2>&1; then rm -f $@; else \\\n \t dir=`echo $@ | sed 's,/[^/]*$$,,;s,^$$,.,'` $(MAKEDIR); fi\n@@ -937,22 +944,31 @@\n \n dynconfig.o: dynconfig.c Makefile\n \t@echo Compiling $*.c\n-\t@$(CC) $(FLAGS) $(PATH_FLAGS) $(PICFLAG) -c $(srcdir)/dynconfig.c -o $@ && exit 0;\\\n+\t@$(COMPILE_CC_PATH) && exit 0;\\\n \t\techo \"The following command failed:\" 1>&2;\\\n-\t\techo \"$(CC) $(FLAGS) $(PATH_FLAGS) $(PICFLAG) -c $(srcdir)/dynconfig.c -o $@\" 1>&2;\\\n-\t\t$(CC) $(FLAGS) $(PATH_FLAGS) $(PICFLAG) -c $(srcdir)/dynconfig.c -o $@ >/dev/null 2>&1\n+\t\techo \"$(COMPILE_CC_PATH)\" 1>&2;\\\n+\t\t$(COMPILE_CC_PATH) >/dev/null 2>&1\n \n lib/pidfile.o: lib/pidfile.c\n \t@echo Compiling $*.c\n-\t@$(CC) -I. -I$(srcdir) $(FLAGS) $(PATH_FLAGS) $(PICFLAG) -c $(srcdir)/lib/pidfile.c -o $@\n+\t@$(COMPILE_CC_PATH) && exit 0;\\\n+\t\techo \"The following command failed:\" 1>&2;\\\n+\t\techo \"$(COMPILE_CC_PATH)\" 1>&2;\\\n+\t\t$(COMPILE_CC_PATH) >/dev/null 2>&1\n \n lib/version.o: lib/version.c include/version.h\n \t@echo Compiling $*.c\n-\t@$(CC) -I. -I$(srcdir) $(FLAGS) $(PATH_FLAGS) $(PICFLAG) -c $(srcdir)/lib/version.c -o $@\n+\t@$(COMPILE_CC_PATH) && exit 0;\\\n+\t\techo \"The following command failed:\" 1>&2;\\\n+\t\techo \"$(COMPILE_CC_PATH)\" 1>&2;\\\n+\t\t$(COMPILE_CC_PATH) >/dev/null 2>&1\n \n smbd/build_options.o: smbd/build_options.c Makefile include/config.h include/build_env.h include/proto.h\n \t@echo Compiling $*.c\n-\t@$(CC) $(FLAGS) $(PATH_FLAGS) $(PICFLAG) -c smbd/build_options.c -o $@\n+\t@$(COMPILE_CC_PATH) && exit 0;\\\n+\t\techo \"The following command failed:\" 1>&2;\\\n+\t\techo \"$(COMPILE_CC_PATH)\" 1>&2;\\\n+\t\t$(COMPILE_CC_PATH) >/dev/null 2>&1\n \n smbd/build_options.c: include/config.h.in script/mkbuildoptions.awk\n \t@echo Generating $@\n\nModified: branches/SAMBA_3_0_26/source/configure.in\n===================================================================\n--- branches/SAMBA_3_0_26/source/configure.in\t2007-05-15 05:25:10 UTC (rev 22879)\n+++ branches/SAMBA_3_0_26/source/configure.in\t2007-05-15 05:38:33 UTC (rev 22880)\n@@ -6,6 +6,12 @@\n AC_CONFIG_HEADER(include/config.h)\n AC_DEFINE(CONFIG_H_IS_FROM_SAMBA,1,[Marker for samba's config.h])\n \n+case \"$PATH\" in\n+    */usr/ucb*)\n+\tAC_MSG_WARN([\\$PATH contains /usr/ucb - build errors may follow])\n+\t;;\n+esac \n+\n SMB_VERSION_STRING=`cat $srcdir/include/version.h | grep 'SAMBA_VERSION_OFFICIAL_STRING' | cut -d '\"' -f2`\n echo \"SAMBA VERSION: ${SMB_VERSION_STRING}\"\n \n\n"}