{"category": "ham", "to_address": "\"Booman, M\" <m.booman@path.umcg.nl>, <r-help@stat.math.ethz.ch>", "from_address": "\"ONKELINX, Thierry\" <Thierry.ONKELINX@inbo.be>", "subject": "Re: [R] Help on averaging sets of rows defined by row name", "body": "Dear Marije,\n\nI think that aggregate() would make your life a lot easier.\n\naggregate(table.imputed, by = table.imputed[, 1], FUN = \"mean\")\n\nCheers,\n\nThierry\n\n------------------------------------------------------------------------\n----\nir. Thierry Onkelinx\nInstituut voor natuur- en bosonderzoek / Reseach Institute for Nature\nand Forest\nCel biometrie, methodologie en kwaliteitszorg / Section biometrics,\nmethodology and quality assurance\nGaverstraat 4\n9500 Geraardsbergen\nBelgium\ntel. + 32 54/436 185\nThierry.Onkelinx@inbo.be\nwww.inbo.be \n\nDo not put your faith in what statistics say until you have carefully\nconsidered what they do not say.  ~William W. Watt\nA statistical analysis, properly conducted, is a delicate dissection of\nuncertainties, a surgery of suppositions. ~M.J.Moroney\n\n \n\n> -----Oorspronkelijk bericht-----\n> Van: r-help-bounces@stat.math.ethz.ch \n> [mailto:r-help-bounces@stat.math.ethz.ch] Namens Booman, M\n> Verzonden: vrijdag 20 april 2007 15:27\n> Aan: r-help@stat.math.ethz.ch\n> Onderwerp: [R] Help on averaging sets of rows defined by row name\n> \n> Dear all,\n> \n> This is my problem: I have a table of gene expression data, \n> where 1st column is gene name, and 2nd -39th columns each are \n> exression data for 38 samples. There are multiple \n> measurements per sample for each gene, so there are multiple \n> rows for each gene name. I want to average these measurements \n> so i end up with one value per sample for each gene name. The \n> output data frame (table.averaged) is further used in other R \n> script. The code I use now (see below) takes 20 secs for each \n> loop, so it takes 45 minutes to average my files of 13500 \n> unique genes. Can anyone help me do this faster?\n> \n> Cheers, marije\n> \n> Code I use: \n> \n> \n> table.imputed[,1] <- as.character(table.imputed[,1])    \n> #table.imputed is data.frame,1st column = gene name (class \n> factor), rest of columns = expression data (class numeric)\n> \n> genesunique <- unique(table.imputed[,1])                   \n> #To make list of unique genes in the set\n> \n> table.averaged <- NULL\n>   for (j in 1:length(genesunique)) {\n>      if (j%%100 == 0){                                        \n>            #To report progress\n>        cat(j, \"genes finished\", sep=\" \", fill=TRUE)\n>        }\n>      \n> table.averaged<-rbind(table.averaged,givemean(genesunique[j], \n> table.imputed))   #collects all rows of average values and \n> binds them back into one data frame\n>   }\n> \n> givemean <- function (gene, table.imputed) {\n>    thisgene<-table.imputed[table.imputed[,1]==gene,]          \n>                              #make a subset containing only \n> the rows for one gene name\n>    data.frame(gene,t(sapply(thisgene[,2:ncol(thisgene)],mean, \n> na.rm=TRUE)))     #calculates average for each sample \n> (column) and outputs one row of average values and the gene name\n> }\n> \n> \n> De inhoud van dit bericht is vertrouwelijk en alleen bestemd \n> voor de geadresseerde(n). Anderen dan de geadresseerde mogen \n> geen gebruik maken van dit bericht, het openbaar maken of op \n> enige wijze verspreiden of vermenigvuldigen. Het UMCG kan \n> niet aansprakelijk gesteld worden voor een incomplete \n> aankomst of vertraging van dit verzonden bericht.\n> \n> The contents of this message are confidential and only \n> intended for the eyes of the addressee(s). Others than the \n> addressee(s) are not allowed to use this message, to make it \n> public or to distribute or multiply this message in any way. \n> The UMCG cannot be held responsible for incomplete reception \n> or delay of this transferred message.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}