{"category": "ham", "to_address": "perl6-internals@perl.org", "from_address": "Jonathan Worthington <jonathan@jnthn.net>", "subject": "Re: [perl #43048] imcc constant folding div by zero bug", "body": "Will Coleda (via RT) wrote:\n> This doesn't:\n>\n> .sub zero_check\n>\n>    push_eh one\n>      $N1 = 3 / 0.0\n>\n> \n>\n> Guessing that imcc is doing constant folding without the guards that  \n> the ops use.\n>   \nAye, and the trouble is, I think, that we don't actually have ops that \nonly take two constants; if I remember correctly, they were tossed in \nfavor of the folding inside IMCC.\n\nI suspect you need to detect conditions like this and either emit \nsomething more like:\n\n$N99999 = 3.0\n$N1 = $N99999 / 0\n\nSince we do have ops like this. Less ugly solutions preferred (still a \ntiny bit lagged from my travels).\n\nJonathan\n\n"}