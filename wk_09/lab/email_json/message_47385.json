{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "James Peach <jpeach@samba.org>", "subject": "kerberos auth account restrictions", "body": "hi all,\n\nIn check_sam_security(), we check whether the account is locked out  \nlike this:\n\n/* see if autolock flag needs to be updated */\nif (pdb_get_acct_ctrl(sampass) & ACB_NORMAL)\n\tpdb_update_autolock_flag(sampass, &updated_autolock);\n/* Quit if the account was locked out. */\nif (pdb_get_acct_ctrl(sampass) & ACB_AUTOLOCK) {\n\tDEBUG(3,(\"check_sam_security: Account for user %s was locked out.\\n\",  \n\t\t\tpdb_get_username(sampass)));\n\treturn NT_STATUS_ACCOUNT_LOCKED_OUT;\n}\n\nIs there a good reason that we don't do this for Kerberos auth in  \nreply_spnego_kerberos()?\n\n--\nJames Peach | jpeach@samba.org\n\n"}