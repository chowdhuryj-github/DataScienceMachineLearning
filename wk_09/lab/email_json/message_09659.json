{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22359 - in\n\tbranches/SAMBA_4_0/source/script/tests: .", "body": "Author: metze\nDate: 2007-04-19 07:39:45 +0000 (Thu, 19 Apr 2007)\nNew Revision: 22359\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22359\n\nLog:\ntry to fix the start failures in the build-farm by creating the prefix dir\nbefore using abs_path()\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/script/tests/selftest.pl\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/script/tests/selftest.pl\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/selftest.pl\t2007-04-19 01:26:38 UTC (rev 22358)\n+++ branches/SAMBA_4_0/source/script/tests/selftest.pl\t2007-04-19 07:39:45 UTC (rev 22359)\n@@ -444,19 +444,20 @@\n $prefix =~ s+/./+/+;\n $prefix =~ s+/$++;\n \n+die(\"using an empty prefix isn't allowed\") unless $prefix ne \"\";\n+\n+#Ensure we have the test prefix around\n+mkdir $prefix unless -d $prefix;\n+\n my $prefix_abs = abs_path($prefix);\n my $srcdir_abs = abs_path($srcdir);\n \n-die(\"using an empty prefix isn't allowed\") unless $prefix ne \"\";\n die(\"using an empty absolute prefix isn't allowed\") unless $prefix_abs ne \"\";\n die(\"using '/' as absolute prefix isn't allowed\") unless $prefix_abs ne \"/\";\n \n $ENV{PREFIX} = $prefix;\n $ENV{SRCDIR} = $srcdir;\n \n-#Ensure we have the test prefix around\n-mkdir $prefix unless -d $prefix;\n-\n my $tls_enabled = not $opt_quick;\n my $from_build_farm = (defined($ENV{RUN_FROM_BUILD_FARM}) and \n                       ($ENV{RUN_FROM_BUILD_FARM} eq \"yes\"));\n\n"}