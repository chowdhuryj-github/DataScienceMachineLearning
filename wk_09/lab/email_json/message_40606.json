{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jpeach@samba.org", "subject": "svn commit: samba r23299 - in branches: SAMBA_3_0/source/smbd\n\tSAMBA_3_0_26/source/smbd", "body": "Author: jpeach\nDate: 2007-06-01 19:34:08 +0000 (Fri, 01 Jun 2007)\nNew Revision: 23299\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23299\n\nLog:\nFix the build for !WITH_SENDFILE.\n\nModified:\n   branches/SAMBA_3_0/source/smbd/reply.c\n   branches/SAMBA_3_0_26/source/smbd/reply.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/smbd/reply.c\n===================================================================\n--- branches/SAMBA_3_0/source/smbd/reply.c\t2007-06-01 19:28:13 UTC (rev 23298)\n+++ branches/SAMBA_3_0/source/smbd/reply.c\t2007-06-01 19:34:08 UTC (rev 23299)\n@@ -2246,11 +2246,10 @@\n \n \t\treturn;\n \t}\n-\n-  normal_readbraw:\n-\n #endif\n \n+normal_readbraw:\n+\n \tif (nread > 0) {\n \t\tret = read_file(fsp,outbuf+4,startpos,nread);\n #if 0 /* mincount appears to be ignored in a W2K server. JRA. */\n@@ -2646,7 +2645,7 @@\n \n #endif\n \n-  normal_read:\n+normal_read:\n \n \tif ((smb_maxcnt & 0xFF0000) > 0x10000) {\n \t\tint sendlen = setup_readX_header(inbuf,outbuf,smb_maxcnt) - smb_maxcnt;\n\nModified: branches/SAMBA_3_0_26/source/smbd/reply.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/smbd/reply.c\t2007-06-01 19:28:13 UTC (rev 23298)\n+++ branches/SAMBA_3_0_26/source/smbd/reply.c\t2007-06-01 19:34:08 UTC (rev 23299)\n@@ -2246,10 +2246,10 @@\n \t\treturn;\n \t}\n \n-  normal_readbraw:\n-\n #endif\n \n+normal_readbraw:\n+\n \tif (nread > 0) {\n \t\tret = read_file(fsp,outbuf+4,startpos,nread);\n #if 0 /* mincount appears to be ignored in a W2K server. JRA. */\n@@ -2641,11 +2641,10 @@\n \t\t/* Returning -1 here means successful sendfile. */\n \t\treturn -1;\n \t}\n-\n-  normal_read:\n-\n #endif\n \n+normal_read:\n+\n \tif ((smb_maxcnt & 0xFF0000) > 0x10000) {\n \t\tint sendlen = setup_readX_header(outbuf,smb_maxcnt) - smb_maxcnt;\n \t\t/* Send out the header. */\n\n"}