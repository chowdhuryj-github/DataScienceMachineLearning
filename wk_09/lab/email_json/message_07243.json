{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 118: fixed crash bug - thanks volker in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 118\nrevision-id: tridge@samba.org-20070416231052-ba2859722685ae37\nparent: tridge@samba.org-20070416214127-25dea7f95ada8a59\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Tue 2007-04-17 09:10:52 +1000\nmessage:\n  fixed crash bug - thanks volker\nmodified:\n  common/ctdb_lockwait.c         ctdb_lockwait.c-20070416214118-n1aeonljj3vpdd9q-1\n=== modified file 'common/ctdb_lockwait.c'\n--- a/common/ctdb_lockwait.c\t2007-04-16 21:41:27 +0000\n+++ b/common/ctdb_lockwait.c\t2007-04-16 23:10:52 +0000\n@@ -43,11 +43,12 @@\n \t\t\t\t\t\t     struct lockwait_handle);\n \tvoid (*callback)(void *) = h->callback;\n \tvoid *p = h->private_data;\n+\tpid_t child = h->child;\n \ttalloc_set_destructor(h, NULL);\n \tclose(h->fd[0]);\n \ttalloc_free(h);\t\n \tcallback(p);\n-\twaitpid(h->child, NULL, 0);\n+\twaitpid(child, NULL, 0);\n }\n \n static int lockwait_destructor(struct lockwait_handle *h)\n\n"}