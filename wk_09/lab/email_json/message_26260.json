{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Bart Joosen\" <bartjoosen@hotmail.com>", "subject": "[R] Fitting model with response and day bias", "body": "Hi,\n\nI'm trying to fit a model which has a response bias, but also a day to day \nbias.\nIf I try to simulate the data, I don't get the right values with optim, and \nalso I can't\nuse the function to give a prediction interval.\n\nMy simulated data are:\n\nDF <- as.data.frame(cbind(x=rep(1:10,2),dag=rep(1:2,each=10)))\nbias <- c(-0.2,0.5)\nDF$y <- ((DF$x-0.1) * 5)+2 + bias[DF$dag]+rnorm(20,0,sd=0.5)\n\n\nWhich I try to fit with:\nfn <- function(x){\n    a <- x[1]\n    b <- x[2]\n    c <- x[2]\n    sum((DF$y - (((DF$x-c)*a)+b + x[DF$dag+2]))^2)\n    }\noptim(c(1,1,1,1,1),fn)\n\nBut with poor succes.\n\nAlso, in the real model, I have a response which is y/time (like in \nlm(y/time~x1 + x2,...) ) , but if I put the time variable at the right side \n(lm(y~I(x1 + x2)*time) , it gets an coefficient.\nIs there a way to avoid this?\n\nThanks\n\n\nBart\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}