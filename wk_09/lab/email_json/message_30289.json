{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "Bjoern Jacke <bjoern@j3e.de>", "subject": "hunting \"Unaligned Access\" errors", "body": "Hi all,\n\nwhile I was cleaning up and bringing my Tru64 build machine in a proper\nstate I saw several warnings on the console about Unaligned memory accesses:\n\nUnaligned access pid=260838  va=0x141b04d6c pc=0x120264c7c\nra=0x120518f04 inst=0xa6940000\n\nUnaligned access is something RISC machines' memory controllers usually\ncan't handle. CISC machines usually *can* handle it but it slows things\ndown. In the case of Tru64/AXP this is automatically fixed by the\noperating system but the behaviour can be customized. I changed the\nsettings on that machine for the build user so that not just a warning\nis printed on the console but that also a SIGBUS is produced (by putting\nthe \"uac p sigbus\" command into build_test.settings.local). In the\nbuildfarm you then see a PANIC for the SerNet-Tru64 machine:\n\nhttp://build.samba.org/?function=View+Build;host=SerNet-Tru64;tree=samba4;compiler=cc\n\nAs metze wrote a customized error handling script using the ladebug\ndebugger on Tru64 there is also a nice traceback which points to the\nplace where is Unaligned Access is being done:\n\n...\n#5  0x120264e80 in pvfs_wait_dispatch() \"ntvfs/posix/pvfs_wait.c\":69\n...\n\nHere are a few links to documents describing how to prevent Unaligned\nAccesses and how to debug this:\n\nhttp://www.arm.com/support/faqdev/1469.html\nhttp://h21007.www2.hp.com/dspp/files/unprotected/tru64/tips.pdf\nhttp://www.hmi.de/it/software/tru64-faq.html#P7\nhttp://en.wikipedia.org/wiki/Data_structure_alignment\n\nI hope you find this usefull. Any feedback about this welcome.\n\nCheers\nBjoern\n\n"}