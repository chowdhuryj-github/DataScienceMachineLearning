{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Alberto Monteiro\" <albmont@centroin.com.br>", "subject": "[R] Fat tails", "body": "I have a process that generates distributions that look like normal, \nbut with fat tails. I would like to model them as if they were\na mix of two normals (with zero mean). Is there any function that\nrecovers the standard deviations and the probability based on a \nsample?\n\nI would like to generate a sample like this:\n\nr.mydist <- function(n, prob, mean1, sd1=1, mean2, sd2=1) {\n  # aesthetical stuff\n  if (missing(mean1) & missing(mean2)) mean1 <- 0\n  if (missing(mean1)) mean1 <- mean2\n  if (missing(mean2)) mean2 <- mean1\n\n  # now, let's work\n  # test is true if we must use the first normal (mean1, sd1)\n  test <- runif(n) < prob\n\n  # create the return value\n  rval <- 0\n  rval[n] <- 0\n\n  # generate the first normal when appropriate\n  if (any(test))\n    rval[test] <- rnorm(sum(test), mean1, sd1)\n\n  # generate the second normal when appropriate\n  if (any(!test))\n    rval[!test] <- rnorm(sum(!test), mean2, sd2)\n\n  # game over\n  return(rval)\n}\n\n# test\nx <- r.mydist(1000, 0.1, 0, 1, 0, 5)\nhist(x)\nif (require(fBasics))\n  cat(\"the sample kurtosis is\", kurtosis(x), \"\\n\")\n\nNow, with this sample x, how can I get back sd1, sd2 and prob?\n\nAlberto Monteiro\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}