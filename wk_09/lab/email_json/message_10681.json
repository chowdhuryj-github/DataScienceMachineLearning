{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22400 - in\n\tbranches/SAMBA_4_0/source/build/smb_build: .", "body": "Author: metze\nDate: 2007-04-20 07:36:21 +0000 (Fri, 20 Apr 2007)\nNew Revision: 22400\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22400\n\nLog:\nonly add srcdir and builddir path if they differ\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/build/smb_build/cflags.pm\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/build/smb_build/cflags.pm\n===================================================================\n--- branches/SAMBA_4_0/source/build/smb_build/cflags.pm\t2007-04-20 06:57:07 UTC (rev 22399)\n+++ branches/SAMBA_4_0/source/build/smb_build/cflags.pm\t2007-04-20 07:36:21 UTC (rev 22400)\n@@ -15,6 +15,9 @@\n \n \topen(CFLAGS_TXT,\">$file\") || die (\"Can't open `$file'\\n\");\n \n+\tmy $src_ne_build = 0;\n+\t$src_ne_build = 1 unless ($srcdir eq $builddir);\n+\n \tforeach my $key (values %{$CTX}) {\n \t\tnext unless defined ($key->{OBJ_LIST});\n \n@@ -26,7 +29,7 @@\n \t\tmy $cflags = \"\";\n \t\tforeach my $flag (@{$key->{FINAL_CFLAGS}}) {\n \t\t\tmy $dir;\n-\t\t\tif (($dir) = ($flag =~ /^-I([^\\/].*)$/)) {\n+\t\t\tif ($src_ne_build and ($dir) = ($flag =~ /^-I([^\\/].*)$/)) {\n \t\t\t\t$cflags .= \" -I$builddir/$dir\";\n \t\t\t\t$cflags .= \" -I$srcdir/$dir\";\n \t\t\t} else {\n\n"}