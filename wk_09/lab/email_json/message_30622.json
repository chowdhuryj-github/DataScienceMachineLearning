{"category": "ham", "to_address": "\"Waichler, Scott R\" <Scott.Waichler@pnl.gov>", "from_address": "\"Deepayan Sarkar\" <deepayan.sarkar@gmail.com>", "subject": "Re: [R] Getting default aspect ratio from lattice", "body": "On 5/15/07, Waichler, Scott R  wrote:\n> > > How can I get the value of the aspect ratio that is used in\n> > a lattice\n> > > plot?  In a levelplot for instance, the native units per cm of my x\n> > > and y axes are different, and I need to know the aspect\n> > ratio so that\n> > > I can correctly plot vectors.  I know how to set the aspect in a\n> > > high-level lattice function but I can't quite figure out how to get\n> > > it.  I would like call to levelplot() without printing\n> > anything, get\n> > > the aspect ratio, use it to create my vector arrows, then call\n> > > levelplot() again with print() to create the final figure.\n> >\n> > Your question doesn't necessarily have a well defined answer,\n> > because the aspect ratio may be computed only on printing\n> > (and not even then, as the aspect ratio may change after\n> > printing if you resize the device). In fact, this is the\n> > default behaviour (aspect = \"fill\").\n>\n> Thanks for the help, Deepayan.  Yes, I guess what I am looking for is\n> the actual numerical value for aspect.ratio that is used when aspect =\n> \"fill\".  My device is a pdf and I don't resize it.  Could I execute the\n> whole plot, including printing it, while saving the aspect.ratio that\n> was used, then create the plot again?\n\nSort of, if you use something like:\n\ngetAspect <-\n    function(obj)\n{\n    print(obj)\n    trellis.focus(\"panel\", 1, 1, highlight = FALSE)\n    cpl <- current.panel.limits(unit = \"inches\")\n    ans <- diff(cpl$ylim) / diff(cpl$xlim)\n    trellis.unfocus()\n    ans\n}\n\nUsing this, I get:\n\n> foo <- levelplot(volcano, aspect = \"fill\")\n> x11()\n> getAspect(foo)\n[1] 1.096661\n> dev.off()\n> x11(\"\", 5, 9)\n> getAspect(foo)\n[1] 2.342152\n> dev.off()\n\nBut if you know the size of your device, you won't do much worse if\nyou supply a numeric aspect based on that (unless you have a\nmultipanel plot and the automatic layout calculation is important to\nyou).\n\n-Deepayan\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}