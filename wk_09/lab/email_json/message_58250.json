{"category": "ham", "to_address": "Jason Barnhart <jasoncbarnhart@msn.com>,\n   R R-help <r-help@stat.math.ethz.ch>", "from_address": "John Kane <jrkrideau@yahoo.ca>", "subject": "Re: [R] Function call within a function.", "body": "\n--- Jason Barnhart  wrote:\n\n> The problem isn't the function call.\n> \n> First, list1 returned by lstfun does not name its\n> elements so nts$cda \n> won't work. See code change in lstfun.\n\nI missed that entirely.  I was groggier than I\nrealised yesterday afternoon. I had at least once left\nnts in existance in the same environment where ukn is\ncalled, thus getting an intermitant error. In that\nenvironment nts$cda was named!\n\n> \n> Second, specifying nts$cda as the nam1 argument\n> tells R to look for \n> the nts object in the environment in which ukn is\n> called.  However, \n> the nts object is not created in the parent\n> environment, it is created \n> in the ukn's environment.\n\nYes.  I had already tried calling it within the ukn\nenvironment not realising that I had not named the\nelements so this was my last try.  \n\n> \n> Third, nam1[,3] should be nam1[2] as there is no\n> third element to this \n> list (although and this doesn't resolve the\n> environment issue).\n\nOops, typo when creating the simple example.  Sorry. \n> \n> I've modified your code below to work, but there are\n> better ways to go \n> about this.  Thomas Lumley has a famous quote\n> regarding parse.  See \n>\nhttp://tolstoy.newcastle.edu.au/R/e2/help/07/01/8059.html\n> among  others.\n> \n> I was once referred to Patrick Burns' S Poetry to\n> learn about the \n> \"eval(parse(text=)))\" paradigm which was very\n> helpful. You may also \n> want to brush up on environments (see ?environment)\n> to learn more \n> about lexical scoping.\n> \n> Hope this helps.\n> -jason\n\nThis has been very helpful though I still do not\nunderstand why one must call nts$cda using the\neval(parse()) command.  Is it because nts is created\nwithin the ukn environment?  \n\nI have had a look at S-Poetry but will need to spend a\nlot more time on this.  \n\nI thought that this was not the best way to do things\nbut I wanted to avoid doing a lot of earlier\nmanipulations to my data files and so decided to go\nwith what I had. \n\n\n> \n> #MODIFIED CODE\n> # create data.frame\n> cata <- c( 1,1,6,1,1,4)\n> catb <- c( 1,2,3,4,5,6)\n> id <- c('a', 'b', 'b', 'a', 'a', 'b')\n> dd1 <- data.frame(id, cata,catb)\n> \n> # function to create list from data.frame\n> lstfun <- function(file, alpha , beta ) {\n> cda <- subset(file, file[,1] == alpha)\n> cdb <- subset (file, file[,1]== beta)\n> ### CODE ADDED HERE\n> list1 <- list(cda=cda,cdb=cdb)\n> }\n> \n> # funtion to operate on list\n> ukn <- function(file, alpha, beta, nam1){\n> aa <- alpha\n> bb <- beta\n> myfile <- file\n> nts <- lstfun(myfile, aa, bb)\n> ### CODE ADDED HERE\n> mysum <- eval(parse(text=nam1))\n> #mysum <- nam1[,3]*5\n> return(mysum)\n> }\n> \n> results <- ukn(dd1, \"a\", \"b\", \"nts$cda\") ###\n> modified how called.\n> \n> ----- Original Message ----- \n> From: \"John Kane\" \n> To: \"R R-help\" \n> Sent: Thursday, June 28, 2007 12:03 PM\n> Subject: [R] Function call within a function.\n> \n> \n> >I am trying to call a funtion within another\n> function\n> > and I clearly am misunderstanding what I should\n> do.\n> > Below is a simple example.\n> > I know lstfun works on its own but I cannot seem\n> to\n> > figure out how to get it to work within ukn.\n> Basically\n> > I need to create the variable \"nts\". I have\n> probably\n> > missed something simple in the Intro or FAQ.\n> >\n> > Any help would be much appreciated.\n> >\n> > EXAMPLE\n> >\n>\n-------------------------------------------------------------------------------\n> > # create data.frame\n> > cata <- c( 1,1,6,1,1,4)\n> > catb <- c( 1,2,3,4,5,6)\n> > id <- c('a', 'b', 'b', 'a', 'a', 'b')\n> > dd1  <-  data.frame(id, cata,catb)\n> >\n> > # function to create list from data.frame\n> > lstfun  <- function(file, alpha , beta ) {\n> > cda  <-  subset(file, file[,1] == alpha)\n> > cdb  <-  subset (file, file[,1]== beta)\n> > list1 <- list(cda,cdb)\n> > }\n> >\n> > # funtion to operate on list\n> > ukn  <-  function(file, alpha, beta, nam1){\n> > aa  <- alpha\n> > bb  <- beta\n> > myfile  <- file\n> > nts <- lstfun(myfile, aa, bb)\n> > mysum <- nam1[,3]*5\n> > return(mysum)\n> > }\n> >\n> > results <- ukn(dd1, \"a\", \"b\", nts$cda)\n> >\n> > ______________________________________________\n> > R-help@stat.math.ethz.ch mailing list\n> > https://stat.ethz.ch/mailman/listinfo/r-help\n> > PLEASE do read the posting guide \n> > http://www.R-project.org/posting-guide.html\n> > and provide commented, minimal, self-contained,\n> reproducible code.\n> > \n> \n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}