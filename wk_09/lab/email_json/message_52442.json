{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r23579 - in branches: SAMBA_3_0/source/param\n\tSAMBA_3_0_26/source/param", "body": "Author: obnox\nDate: 2007-06-21 23:11:21 +0000 (Thu, 21 Jun 2007)\nNew Revision: 23579\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23579\n\nLog:\nUp to now, the \"allparameters\" argument to lp_next_parameter was\nnot effective for the global section (snum < 0). This checkin\nmakes it effective for the global section, too.\n\nThis does not produce changes in the results of the present calls of\nlp_next_parameter: Beside the new use in utils/net_conf.c (which is\nhereby fixed), the only calls of lp_next_parameter are in web/swat.c, \nwhere it is effectively always called with allparameters == 1.\n\nMichael\n\n\nModified:\n   branches/SAMBA_3_0/source/param/loadparm.c\n   branches/SAMBA_3_0_26/source/param/loadparm.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/param/loadparm.c\n===================================================================\n--- branches/SAMBA_3_0/source/param/loadparm.c\t2007-06-21 22:18:42 UTC (rev 23578)\n+++ branches/SAMBA_3_0/source/param/loadparm.c\t2007-06-21 23:11:21 UTC (rev 23579)\n@@ -4308,6 +4308,9 @@\n \t\t\t    && (parm_table[*i].ptr ==\n \t\t\t\tparm_table[(*i) - 1].ptr))\n \t\t\t\tcontinue;\n+\t\t\t\n+\t\t\tif (is_default(*i) && !allparameters)\n+\t\t\t\tcontinue;\n \n \t\t\treturn &parm_table[(*i)++];\n \t\t}\n\nModified: branches/SAMBA_3_0_26/source/param/loadparm.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/param/loadparm.c\t2007-06-21 22:18:42 UTC (rev 23578)\n+++ branches/SAMBA_3_0_26/source/param/loadparm.c\t2007-06-21 23:11:21 UTC (rev 23579)\n@@ -4311,6 +4311,9 @@\n \t\t\t    && (parm_table[*i].ptr ==\n \t\t\t\tparm_table[(*i) - 1].ptr))\n \t\t\t\tcontinue;\n+\t\t\t\n+\t\t\tif (is_default(*i) && !allparameters)\n+\t\t\t\tcontinue;\n \n \t\t\treturn &parm_table[(*i)++];\n \t\t}\n\n"}