{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Kevin Sorensen <ksorensen84@yahoo.com>", "subject": "[R] gam function & time trend splines", "body": "I've been doing a simple time-series analysis looking\nat the relationship between daily pneumonia\nhospitalizations and daily temperature.  To mimic some\nof the literature, I've been including a time-trend to\ntry to account for normal cyclical trends in\nhospitalization.  So I've been using a function that\nlooks something like this:\n\ngam(pneucount ~ temp_f +\ns(day,bs=\"cr\",k=(4*totalyears)+1),\n\nday being the enumerated day in the analysis (1-365\nfor a 1 year analysis). \n\nThis seems to work well enough.  What troubles me is\nwhen I think about doing an analysis focusing on\nwinter days using more than one year of data.  If I\njust delete the summer days from the dataset, the time\ntrend spline is trying to anneal counts from the end\nof one winter with the beginning of another, which\ndoesn't seem right to me.  \n\nWhat's the route to a statistically defensible result?\n Is it as simple as using the subset option?  Or would\nI need to create indicator variables for each winter\nI'm interested and work in a by statement somehow\n(with an extra term for the levels of that indicator,\nI assume)?  \n\nThanks in advance for helping a Epi student who's\nbeing exposed to all this for the first time.\n\nSincerely,\n\nKevin Sorensen \n\n\n      ____________________________________________________________________________________\nPark yourself in front of a world of choices in alternative vehicles. Visit the Yahoo! Auto Green Center.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}