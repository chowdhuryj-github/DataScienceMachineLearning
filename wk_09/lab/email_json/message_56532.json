{"category": "ham", "to_address": "beginners@perl.org", "from_address": "Gary Stainburn <gary.stainburn@ringways.co.uk>", "subject": "Tie::Handle::CSV", "body": "Hi folks.\n\nI've got the following script which works until it reaches the end of the \ninput file. It processes the last line and prints out the contents, but then \nthe program terminates with the unhelpful error:\n\nManufacturers Ref.:     L53522  Status: 5290    (Work not pulled)\nComments:       ''\n\n\n at ../bin/walon4 line 25\n\nLine 25 is the last print statement within the while loop. If I delete that \nline and re-run the script it then complains about line 24. Either way, the \nprogram terminates before printing 'Hello World'\n\nAnyone got any ideas?\n\n#!/usr/bin/perl -w\n\nuse strict;\nuse warnings;\n\nuse Tie::Handle::CSV;\nmy $csv_fh = Tie::Handle::CSV->new($ARGV[0], header => 1);\n\nwhile (my $csv_line = <$csv_fh>) {\n  print \"Arrival Date:\\t\",$csv_line->{\"Arrival Date\"}, \"\\t\";\n  print \"Chassis:\\t\",$csv_line->{\"Chassis\"}, \"\\t\";\n  print \"Walon Ref.:\\t\",$csv_line->{\"Walon Ref.\"}, \"\\t\";\n  print \"Radio Code:\\t\",$csv_line->{\"Radio Code\"}, \"\\t\";\n  print \"Key No.:\\t\",$csv_line->{\"Key No.\"}, \"\\n\";\n  print \"Inspection 1:\\t\",$csv_line->{\"Inspection 1\"}, \"\\t\";\n  print \"Parts Ordered:\\t\",$csv_line->{\"Parts Ordered\"}, \"\\t\";\n  print \"Parts Received:\\t\",$csv_line->{\"Parts Received\"}, \"\\n\";\n  print \"Estimate Sent:\\t\",$csv_line->{\"Estimate Sent\"}, \"\\t\";\n  print \"Authorised:\\t\",$csv_line->{\"Authorised\"}, \"\\t\";\n  print \"Repaired:\\t\",$csv_line->{\"Repaired\"}, \"\\n\";\n  print \"Manufacturers Ref.:\\t\",$csv_line->{\"Manufacturers Ref.\"}, \"\\t\";\n  print \"Status:\\t\",$csv_line->{\"Status\"}, \"\\t\";\n  print \"(\",$csv_line->{\".\"}, \")\\n\";\n  print \"Comments:\\t'\",$csv_line->{\"Comments\"}, \"'\\n\";\n  print \"\\n\\n\";\t\t# ******* this is line 25 ********\n}\n\nprint \"Hello World\\n\";\nclose $csv_fh;\n-- \nGary Stainburn\n \nThis email does not contain private or confidential material as it\nmay be snooped on by interested government parties for unknown\nand undisclosed purposes - Regulation of Investigatory Powers Act, 2000     \n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}