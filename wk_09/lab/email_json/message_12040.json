{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "idra@samba.org", "subject": "svn commit: samba r22426 - in branches/SAMBA_3_0_25/source/libsmb: .", "body": "Author: idra\nDate: 2007-04-21 20:44:19 +0000 (Sat, 21 Apr 2007)\nNew Revision: 22426\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22426\n\nLog:\n\nAvoid to segfault if we only have the realm\n\n\nModified:\n   branches/SAMBA_3_0_25/source/libsmb/namequery_dc.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0_25/source/libsmb/namequery_dc.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/libsmb/namequery_dc.c\t2007-04-21 20:43:54 UTC (rev 22425)\n+++ branches/SAMBA_3_0_25/source/libsmb/namequery_dc.c\t2007-04-21 20:44:19 UTC (rev 22426)\n@@ -215,6 +215,11 @@\n \tif ( (our_domain && lp_security()==SEC_ADS) || realm ) {\n \t\tret = ads_dc_name(domain, realm, &dc_ip, srv_name);\n \t}\n+\n+\tif (!domain) {\n+\t\t/* if we have only the realm we can't do anything else */\n+\t\treturn False;\n+\t}\n \t\n \tif (!ret) {\n \t\t/* fall back on rpc methods if the ADS methods fail */\n\n"}