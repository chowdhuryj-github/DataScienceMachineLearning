{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jelmer@samba.org", "subject": "svn commit: samba r22583 - in branches/SAMBA_3_0/source: .", "body": "Author: jelmer\nDate: 2007-04-29 21:44:48 +0000 (Sun, 29 Apr 2007)\nNew Revision: 22583\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22583\n\nLog:\nSupport non-Linux GNU systems (such as Debians' GNU with FreeBSD kernel and \nHurd systems).\n\nPatch by the Samba packaging team for Debian.\n\nModified:\n   branches/SAMBA_3_0/source/configure.in\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/configure.in\n===================================================================\n--- branches/SAMBA_3_0/source/configure.in\t2007-04-29 21:40:48 UTC (rev 22582)\n+++ branches/SAMBA_3_0/source/configure.in\t2007-04-29 21:44:48 UTC (rev 22583)\n@@ -820,6 +820,15 @@\n       fi\n     ;;\n \n+# Systems with LFS support.\n+#\n+    gnu* | k*bsd*-gnu)\n+\tCPPFLAGS=\"-D_LARGEFILE64_SOURCE -D_FILE_OFFSET_BITS=64 -D_GNU_SOURCE $CPPFLAGS\"\n+\tAC_DEFINE(_LARGEFILE64_SOURCE, 1, [Whether to enable large file support])\n+\tAC_DEFINE(_FILE_OFFSET_BITS, 64, [File offset bits])\n+\tAC_DEFINE(_GNU_SOURCE, 1, [Whether to use GNU libc extensions])\n+\t;;\n+\n # Tests for linux LFS support. Need kernel 2.4 and glibc2.2 or greater support.\n #\n     *linux*)\n@@ -1443,7 +1452,7 @@\n #\n #\n case \"$host_os\" in\n-    *linux*)\n+    linux*-gnu* | gnu* | k*bsd*-gnu)\n        # glibc <= 2.3.2 has a broken getgrouplist\n     AC_CACHE_CHECK([for a broken Linux getgrouplist API],\n \t    linux_getgrouplist_ok,\n@@ -1756,7 +1765,10 @@\n \n # and these are for particular systems\n case \"$host_os\" in\n-\t\t*linux*)   AC_DEFINE(LINUX,1,[Whether the host os is linux])\n+ \t\tlinux*-gnu* | gnu* | k*bsd*-gnu)\n+\t\t\tcase \"$host_os\" in \n+\t\t\t\tlinux*)   AC_DEFINE(LINUX,1,[Whether the host os is linux]) ;;\n+\t\t\tesac\n \t\t\tBLDSHARED=\"true\"\n \t\t\tif test \"${ac_cv_gnu_ld_no_default_allow_shlib_undefined}\" = \"yes\"; then\n \t\t\t\tLDSHFLAGS=\"-shared -Wl,-Bsymbolic -Wl,--allow-shlib-undefined\"\n@@ -5533,7 +5545,7 @@\n \tAC_MSG_RESULT(yes);\n \n \tcase \"$host_os\" in\n-\t*linux*)\n+\tlinux*-gnu* | gnu* | k*bsd*-gnu)\n \t\tAC_CACHE_CHECK([for linux sendfile64 support],samba_cv_HAVE_SENDFILE64,[\n \t\tAC_TRY_LINK([#include ],\n [\\\n@@ -5838,11 +5850,11 @@\n SMB_KRB5_LOCATOR=\"bin/smb_krb5_locator.$SHLIBEXT\"\n \n case \"$host_os\" in\n-\t*linux*)\n+\tlinux*-gnu* | gnu* | k*bsd*-gnu)\n \t\tNSSSONAMEVERSIONSUFFIX=\".2\"\n \t\tWINBIND_NSS_EXTRA_OBJS=\"nsswitch/winbind_nss_linux.o\"\n \t\t;;\n-\t*freebsd[[5-9]]*)\n+\tfreebsd5*|*freebsd[[6-9]]*)\n \t\t# FreeBSD winbind client is implemented as a wrapper around\n \t\t# the Linux version.\n \t\tNSSSONAMEVERSIONSUFFIX=\".1\"\n\n"}