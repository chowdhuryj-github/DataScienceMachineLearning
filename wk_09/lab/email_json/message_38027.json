{"category": "ham", "to_address": "jim holtman <jholtman@gmail.com>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] where did the factor name go", "body": "Yes, dump() does not dump the attributes of language objects of type \nLANGSXP.\n\nI don't know if that is deliberate or not, but in this case it would not \nbe possible for dump to capture all the information, for note\n\n>  .. ..- attr(*, \".Environment\")=\n\nand hence if you adopt Jim's suggestion, be aware that you will save() the \nwhole of the workspace in order to capture the environment of the formula.\n\n\nOn Mon, 28 May 2007, jim holtman wrote:\n\n> Don't know what it happening, but when I compared the output of 'str(tmp.aov)'\n> before and after the 'source', I saw at least the following differences:\n>\n> before:\n> $ terms        :Classes 'terms', 'formula' length 3 y ~ a\n>  .. ..- attr(*, \"variables\")= language list(y, a)\n>  .. ..- attr(*, \"factors\")= int [1:2, 1] 0 1\n>  .. .. ..- attr(*, \"dimnames\")=List of 2\n>  .. .. .. ..$ : chr [1:2] \"y\" \"a\"\n>  .. .. .. ..$ : chr \"a\"\n>  .. ..- attr(*, \"term.labels\")= chr \"a\"\n>  .. ..- attr(*, \"order\")= int 1\n>  .. ..- attr(*, \"intercept\")= int 1\n>  .. ..- attr(*, \"response\")= int 1\n>  .. ..- attr(*, \".Environment\")=\n>  .. ..- attr(*, \"predvars\")= language list(y, a)\n>  .. ..- attr(*, \"dataClasses\")= Named chr [1:2] \"numeric\" \"factor\"\n>  .. .. ..- attr(*, \"names\")= chr [1:2] \"y\" \"a\"\n>\n> after:\n> $ terms        : language y ~ a\n>\n>\n> So it would seem some of the attributes are not being saved.\n>\n> You might want to use 'save' instead.  Here is the output:\n>\n>> tmp <- data.frame(y=rnorm(12), a=factor(rep(letters[1:4],3)))\n>> tmp\n>             y a\n> 1   0.61982575 a\n> 2  -0.05612874 b\n> 3  -0.15579551 c\n> 4  -1.47075238 d\n> 5  -0.47815006 a\n> 6   0.41794156 b\n> 7   1.35867955 c\n> 8  -0.10278773 d\n> 9   0.38767161 a\n> 10 -0.05380504 b\n> 11 -1.37705956 c\n> 12 -0.41499456 d\n>> tmp.aov <- aov(y ~ a, data=tmp)\n>> summary(tmp.aov)\n>            Df Sum Sq Mean Sq F value Pr(>F)\n> a            3 1.3068  0.4356   0.622 0.6204\n> Residuals    8 5.6031  0.7004\n>> save(tmp.aov, file=\"dumpdata.R\")\n>> rm(tmp.aov)\n>> load(\"dumpdata.R\")\n>> ls()\n>\n>> summary(tmp.aov)\n>            Df Sum Sq Mean Sq F value Pr(>F)\n> a            3 1.3068  0.4356   0.622 0.6204\n> Residuals    8 5.6031  0.7004\n>>\n>\n>\n>\n> On 5/28/07, Richard M. Heiberger  wrote:\n>>\n>>> tmp <- data.frame(y=rnorm(12), a=factor(rep(letters[1:4],3)))\n>>> tmp\n>>             y a\n>> 1  -0.60866099 a\n>> 2   0.55500538 b\n>> 3   0.12231693 c\n>> 4  -0.24613790 d\n>> 5  -0.09253593 a\n>> 6  -1.54652581 b\n>> 7   0.17204210 c\n>> 8  -1.22778942 d\n>> 9   1.22151194 a\n>> 10 -0.43982577 b\n>> 11 -1.25444287 c\n>> 12 -0.97251060 d\n>>> tmp.aov <- aov(y ~ a, data=tmp)\n>>> summary(tmp.aov)\n>>            Df Sum Sq Mean Sq F value Pr(>F)\n>> a            3 1.5220  0.5073  0.6973 0.5794\n>> Residuals    8 5.8209  0.7276\n>>> dump(\"tmp.aov\")\n>>> rm(tmp.aov)\n>>> source(\"dumpdata.R\")\n>>> ls()\n>> [1] \"tmp\"     \"tmp.aov\"\n>>> summary(tmp.aov)\n>>            Df Sum Sq Mean Sq F value Pr(>F)\n>> NA           3 1.5220  0.5073  0.6973 0.5794\n>> Residuals    8 5.8209  0.7276\n>>>\n>>\n>>\n>> The factor name in the summary() after dumping and sourcing the\n>> aov object is missing.\n>>\n>>\n>>> version\n>>               _\n>> platform       i386-pc-mingw32\n>> arch           i386\n>> os             mingw32\n>> system         i386, mingw32\n>> status\n>> major          2\n>> minor          5.0\n>> year           2007\n>> month          04\n>> day            23\n>> svn rev        41293\n>> language       R\n>> version.string R version 2.5.0 (2007-04-23)\n>>>\n>>\n>> ______________________________________________\n>> R-help@stat.math.ethz.ch mailing list\n>> https://stat.ethz.ch/mailman/listinfo/r-help\n>> PLEASE do read the posting guide\n>> http://www.R-project.org/posting-guide.html\n>> and provide commented, minimal, self-contained, reproducible code.\n>>\n>\n>\n>\n>\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}