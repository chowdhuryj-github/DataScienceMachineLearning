{"category": "ham", "to_address": "Vladimir Eremeev <wl2776@gmail.com>", "from_address": "Sundar Dorai-Raj <sundar.dorai-raj@pdf.com>", "subject": "Re: [R] determining a parent function name", "body": "Hi, Vladimir,\n\nIn general, this won't work since traceback only contains the stack from \nthe last uncaught error (see ?traceback). When traceback is called below \nit would be from the previous error, not the current one.\n\nerror <- function() {\n   parent <- tail(capture.output(traceback()), n = 1)\n   parent <- sub(\"^.*:[ ]+\", \"\", parent)\n   stop(parent)\n}\nfoo <- function() error()\nbar <- function() error()\n\n > foo()\nError in error() : No traceback available\n > bar()\nError in error() : foo()\n\nThanks,\n\n--sundar\n\nVladimir Eremeev said the following on 5/31/2007 4:57 AM:\n> Does\n>   tail(capture.output(traceback()),n=1)\n> do what you want?\n> \n> that is \n> \n> error <- function(...) {\n>    msg <- paste(..., sep = \"\")\n>    if(!length(msg)) msg <- \"\"\n>    if(require(tcltk, quiet = TRUE)) {\n>      tt <- tktoplevel()\n>      tkwm.title(tt, \"Error\")\n>      tkmsg <- tktext(tt, bg = \"white\")\n> \n>      parent<-tail(capture.output(traceback()),n=1)\n>      parent<-gsub(\"[0-9]: \",\"\",parent) # deleting 1: from the captured\n> string\n> \n>      tkinsert(tkmsg, \"end\", sprintf(\"Error in %s: %s\", parent , msg))\n>      tkconfigure(tkmsg, state = \"disabled\", font = \"Tahoma 12\",\n>                  width = 50, height = 3)\n>      tkpack(tkmsg, side = \"bottom\", fill = \"y\")\n>    }\n>    stop(msg)\n> }\n> \n> \n> Sundar Dorai-Raj wrote:\n>> Hi, All,\n>>\n>> I'm writing a wrapper for stop that produces a popup window using tcltk. \n>> Something like:\n>>\n>> error <- function(...) {\n>>    msg <- paste(..., sep = \"\")\n>>    if(!length(msg)) msg <- \"\"\n>>    if(require(tcltk, quiet = TRUE)) {\n>>      tt <- tktoplevel()\n>>      tkwm.title(tt, \"Error\")\n>>      tkmsg <- tktext(tt, bg = \"white\")\n>>      tkinsert(tkmsg, \"end\", sprintf(\"Error in %s: %s\", \"???\", msg))\n>>      tkconfigure(tkmsg, state = \"disabled\", font = \"Tahoma 12\",\n>>                  width = 50, height = 3)\n>>      tkpack(tkmsg, side = \"bottom\", fill = \"y\")\n>>    }\n>>    stop(msg)\n>> }\n>>\n>> But, I would like to know from which function error() is called. For \n>> example, if I have\n>>\n>> foo <- function() stop()\n>> bar <- function() error()\n>>  > foo()\n>> Error in foo() :\n>>  > bar()\n>> Error in error() :\n>>\n>> and in the tk window I get\n>>\n>> Error in ???:\n>>\n>> I need the output of bar (in the tk window only) to be\n>>\n>> Error in bar():\n>>\n>> then it's clear where error is called. I'm not worried about the output \n>> bar() produces on the console.\n>>\n>> Hope this makes sense.\n>>\n>> Thanks,\n>>\n>>\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}