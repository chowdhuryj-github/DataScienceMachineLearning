{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Marco B\" <tymester@gmail.com>", "subject": "[R] Some questions on repeated measures (M)ANOVA & mixed models\n\twith lme4", "body": "Dear R Masters,\n\nI'm an anesthesiology resident trying to make his way through basic\nstatistics. Recently I have been confronted with longitudinal data in\na treatment vs. control analysis. My dataframe is in the form of:\n\nsubj | group | baseline | time | outcome (long)\nor\nsubj | group | baseline | time1 |...| time6 | (wide)\n\nThe measured variable is a continuous one. The null hypothesis in this\nanalysis is that the Group factor does not significantly influence the\noutcome variable. A secondary null hypothesis is that the Group x Time\ninteraction is not significant, either. Visual of the group means\nindicates the outcome measure decreases linearly (more or less) over\ntime from baseline values. The time==1...time==6 intervals are\nequally-spaced and we have equal sample sizes for the groups.\n\nI've done a little reading around and found (at least) four possible approaches:\n\nA. Linear mixed model using lme4 with random intercept and slope with\nlmer() or lme()\n\nB. Repeated measures ANOVA using aov() with Error() stratification\n(found in Baron & Li, 2006), something along the lines of:\naov(outcome ~ group * time + baseline + Error(subj+subj:time))\n\n(from: http://cran.r-project.org/doc/contrib/Baron-rpsych.pdf, p. 41)\n\nC. \"Repeated measures\" MANOVA as follows (using data in wide format):\nresponse <- cbind(time1,time2,time3,time4,time5,time6)\nmlmfit <- lm(response ~ group)\nmlmfit1 <- lm(response ~ 1)\nmlmfit0 <- lm(response ~ 0)\n# Test time*group effect\nanova.mlm(mlmfit, mlmfit1, X=~1, test=\"Spherical\")\n# Test overall group effect\nanova.mlm(mlmfit, mlmfit1, M=~1)\n# Test overall time effect\nanova.mlm(mlmfit1, mlmfit0, X=~1, test=\"Spherical\")\n\n(taken from http://tolstoy.newcastle.edu.au/R/help/05/11/15744.html)\n\nNow, on with the questions:\n\n1. This is really a curiosity. I find lmer() easier to use than lme(),\nbut the former does not allow the user to model the correlation\nstructure of the data. I figure lmer() is presently assuming no\nwithin-group correlation for the data, which I guess is unlikely in my\nexample. Is there a way to compare directly (maybe in terms of\nlog-likelihood?) similar models fitted in lme() and lmer()?\n\n2. Baron & Li suggest a painful (at least for me) procedure to obtain\nGreenhouse-Geisser or Huyn-Feldt correction for the ANOVA analysis\nthey propose. Is there a package or function which simplifies the\nprocedure?\n\n3. I must admit that I don't understand solution C. I can \"hack\" it to\nfit my model, and it seems to work, but I can't seem to grasp the\noverall concept, especially regarding the outer and/or inner\nprojection matrices (M & X). Could anyone point me to a basic\nexplanation of the procedure?\n\n4. Provided the assumptions for ANOVA hold, or that deviations from\nthem are not horrible, am I correct in saying that this procedure\nwould be the most powerful one? How would you choose solution A over\nsolution B (or viceversa)?\n\nMy sincerest gratitude to anyone who will take the time to answer my questions!\n\nBest Regards,\n\nMarco\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}