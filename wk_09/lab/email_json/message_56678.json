{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r23637 - in branches/SAMBA_4_0/source/build/m4: .", "body": "Author: metze\nDate: 2007-06-27 19:46:53 +0000 (Wed, 27 Jun 2007)\nNew Revision: 23637\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23637\n\nLog:\nfix detection of visibility attribute support\n\nJames: AC_TRY_LINK() has a different syntax as AC_TRY_RUN() :-)\n       so this was wrong:\n       http://websvn.samba.org/cgi-bin/viewcvs.cgi?rev=20697&view=rev\n\nmetze\nModified:\n   branches/SAMBA_4_0/source/build/m4/check_cc.m4\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/build/m4/check_cc.m4\n===================================================================\n--- branches/SAMBA_4_0/source/build/m4/check_cc.m4\t2007-06-27 18:28:18 UTC (rev 23636)\n+++ branches/SAMBA_4_0/source/build/m4/check_cc.m4\t2007-06-27 19:46:53 UTC (rev 23637)\n@@ -71,12 +71,11 @@\n \tOLD_CFLAGS=\"$CFLAGS\"\n \n \tCFLAGS=\"$CFLAGS $VISIBILITY_CFLAGS\"\n-\tAC_TRY_LINK([],\n-\t[\n+\tAC_TRY_LINK([\n \t\tvoid vis_foo1(void) {}\n \t\t__attribute__((visibility(\"default\"))) void vis_foo2(void) {}\n-\t\t#include \"${srcdir-.}/build/tests/trivial.c\"\n \t],[\n+\t],[\n \t\tAC_MSG_RESULT(yes)\n \t\tAC_DEFINE(HAVE_VISIBILITY_ATTR,1,[Whether the C compiler supports the visibility attribute])\n \t\tvisibility_attribute=yes\n\n"}