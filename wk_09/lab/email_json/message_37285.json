{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Shiazy Fuzzy\" <shiazy@gmail.com>", "subject": "[R] Parametric bootstrapped Kolmogorov-Smirnov GoF: what's wrong", "body": "Dear R-users,\n\nI want to perform a One-Sample parametric bootstrapped Kolmogorov-Smirnov\nGoF test (note package \"Matching\" provides \"ks.boot\" which is a 2-sample\nnon-parametric bootstrapped K-S version).\nSo I wrote this code:\n\n---[R Code] ---\nks.test.bootnp <- function( x, dist, ..., alternative=c(\"two.sided\", \"less\",\n\"greater\"), B = 1000 )\n{\n        n.x <- length(x);\n\n        cdf <- paste( \"p\", dist, sep=\"\" );\n        rvg <- paste( \"r\", dist, sep=\"\" ) ;\n        rvg <- get( rvg, mode = \"function\" );\n\n        ks <- ks.test( x, cdf, ..., alternative = alternative ); # KS stat\nfrom sample\n\n        # bootstrapping K-S ...\n        ks.pval <- 0;\n        for ( i in 1:B )\n        {\n                # Samples from the theoretical distribution\n                y <- rvg( n.x, ... );\n\n                # Performs a K-S test\n                ks.boot <- ks.test( x, y, alternative = alternative );\n\n                # Updates p-value\n                if ( ks.boot$statistic >= ks$statistic )\n                {\n                        ks.pval <- ks.pval + 1;\n                }\n        }\n        ks.pval <- ks.pval / B;\n\n        return( list( statistic = ks$statistic, p.value = ks$p.value,\np.value.boot = ks.pval ) );\n}\n---[/R Code] ---\n\nIf you try to run:\n\n---[R Code] ---\nset.seed(1);\nx <- rweibull( 200, 1.3, 8.7 );\nks.test.bootnp(x,\"norm\",100,10,B=1000);\n---[/R Code] ---\n\nyou obtain something like this:\n\n---[R Code] ---\n$statistic\nD\n1\n\n$p.value\n[1] 0\n\n$p.value.boot\n[1] 1\n---[/R Code] ---\n\nvery bad!!!!\n\nSo what's wrong?!?\n\nThank you very much!\n\nBest Regards,\n\n-- Marco\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}