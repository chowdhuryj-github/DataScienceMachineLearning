{"category": "ham", "to_address": "\"Sebastian Bauer\" <Sebastian.Bauer@charite.de>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] QR Decompositon and qr.qty", "body": "You need complete = TRUE.  See ?qr.Q\n\n> m <- matrix(c(1,0,0,0,1,0,0,0,1,0,0,1), ncol = 3)\n> y <- matrix(c(1,2,3,4,2,3,4,5,1,1,1,1,2,2,2,2), nrow = 4)\n> t(qr.Q(qr(m), complete = TRUE)) %*% y\n     [,1] [,2] [,3] [,4]\n[1,]   -1   -2   -1   -2\n[2,]   -4   -5   -1   -2\n[3,]    3    4    1    2\n[4,]   -2   -3   -1   -2\n> qr.qty(qr(m), y)\n     [,1] [,2] [,3] [,4]\n[1,]   -1   -2   -1   -2\n[2,]   -4   -5   -1   -2\n[3,]    3    4    1    2\n[4,]   -2   -3   -1   -2\n\n\nOn 5/15/07, Sebastian Bauer  wrote:\n> Dear R people,\n>\n> I do not have much knowledge about linear algebra but currently I need\n> to understand what the function qr.qty is actually doing. The\n> documentation states that it calculates t(Q) %*% y via a previously\n> performed QR matrix decomposition.\n>\n> In order to do that, I tried following basic example:\n>\n> m<-matrix(c(1,0,0,0,1,0,0,0,1,0,0,1),ncol=3) # 4x3 matrix\n> qr.qty(qr(m),matrix(c(1,2,3,4,2,3,4,5,1,1,1,1,2,2,2,2),nrow=4))\n>\n>      [,1] [,2] [,3] [,4]\n> [1,]   -1   -2   -1   -2\n> [2,]   -4   -5   -1   -2\n> [3,]    3    4    1    2\n> [4,]   -2   -3   -1   -2\n>\n> As far as I understood the documentation a call such as\n>\n> t(qr.Q(qr(m)))%*%matrix(c(1,2,3,4,2,3,4,5,1,1,1,1,2,2,2,2),nrow=4)\n>\n> should produce the same result, but this produces a 3 by 4 rather than a\n> four by four matrix as t(qr.Q(qr(m))) has only three rows.\n>\n>      [,1] [,2] [,3] [,4]\n> [1,]   -1   -2   -1   -2\n> [2,]   -4   -5   -1   -2\n> [3,]    3    4    1    2\n>\n>\n> So the last line is missing. Any hints how R adds the last line would be\n> appreciated.\n>\n> Regards,\n> Sebastian\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}