{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 352: show op type of badly aligned packets in tcp layer in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 352\nrevision-id: tridge@samba.org-20070526063541-ejidxmkfrpxmu0hz\nparent: tridge@samba.org-20070526063232-f11jm7mw39jlmq8o\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Sat 2007-05-26 16:35:41 +1000\nmessage:\n  show op type of badly aligned packets in tcp layer\nmodified:\n  tcp/tcp_io.c                   tcp_io.c-20061128004937-x70q1cu5xzg5g2tm-3\n=== modified file 'tcp/tcp_io.c'\n--- a/tcp/tcp_io.c\t2007-05-26 06:32:32 +0000\n+++ b/tcp/tcp_io.c\t2007-05-26 06:35:41 +0000\n@@ -85,5 +85,12 @@\n {\n \tstruct ctdb_tcp_node *tnode = talloc_get_type(node->private_data,\n \t\t\t\t\t\t      struct ctdb_tcp_node);\n+\tstruct ctdb_req_header *hdr = (struct ctdb_req_header *)data;\n+\n+\tif (length & (CTDB_TCP_ALIGNMENT-1)) {\n+\t\tDEBUG(0,(__location__ \" Length 0x%x not multiple of alignment op %d\\n\", \n+\t\t\t length, hdr->operation));\n+\t}\n+\n \treturn ctdb_queue_send(tnode->queue, data, length);\n }\n\n"}