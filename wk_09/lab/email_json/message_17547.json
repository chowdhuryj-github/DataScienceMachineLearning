{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Finny Kuruvilla <kuruvill@fas.harvard.edu>", "subject": "Re: [R] Randomising matrices", "body": "Hi Nick,\n\nThis way isn't the most elegant but works well, especially if the\nmatrices aren't too large:\n\n# This function works on 2x2 arrays, randomizing them, but\n# preserving row and column totals\nshuffle_matrix <- function(x) {\n   nrow = dim(x)[1]\n   ncol = dim(x)[2]\n   rmargins <- apply(x,1,sum)\n   cmargins <- apply(x,2,sum)\n\n   while(1) {\n     shuffled <- array(sample(x,length(x),replace=TRUE),dim=c(nrow,ncol))\n     if(all(apply(shuffled,1,sum) == rmargins)) {\n       if(all(apply(shuffled,2,sum) == cmargins)) {\n         break\n       }\n     }\n   }\n   shuffled\n}\n\nExample:\n\n> a=array(sample(c(0,1),10,replace=TRUE),dim=c(5,2))\n> a\n      [,1] [,2]\n[1,]    0    1\n[2,]    1    1\n[3,]    0    1\n[4,]    0    1\n[5,]    1    0\n> shuffle_matrix(a)\n      [,1] [,2]\n[1,]    0    1\n[2,]    1    1\n[3,]    1    0\n[4,]    0    1\n[5,]    0    1\n\nBest,\nFinny Kuruvilla\n\n*****************************************************************\nFinny Kuruvilla, MD, PhD\nHarvard Medical School Fellowship Program in Transfusion Medicine\nBroad Institute of MIT and Harvard\nHomepage: http://www.people.fas.harvard.edu/~kuruvill/home/\n\n\nOn Fri, 27 Apr 2007, Nick Cutler wrote:\n\n> I would like to be able to randomise presence-absence (i.e. binary)\n> matrices whilst keeping both the row and column totals constant. Is\n> there a function in R that would allow me to do this?\n>\n> I'm working with vegetation presence-absence matrices based on field\n> observations. The matrices are formatted to have sites as rows and\n> species as columns. The presence of a species on a site is indicated\n> with a 1 (absence is obviously indicated with a 0).\n>\n> I would like to randomise the matrices many times in order to construct\n> null models. However, I cannot identify a function in R to do this, and\n> the programming looks tricky for someone of my limited skills.\n>\n> Can anybody help me out?\n>\n> Many thanks,\n>\n> Nick Cutler\n>\n> Institute of Geography\n> School of Geosciences\n> University of Edinburgh\n> Drummond Street\n> Edinburgh EH8 9XP\n> United Kingdom\n>\n> Tel: 0131 650 2532\n> Web: http://www.geos.ed.ac.uk/homes/s0455078\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}