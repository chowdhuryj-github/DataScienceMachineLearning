{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "James Peach <jpeach@samba.org>", "subject": "Re: svn commit: samba r23689 - in branches/SAMBA_3_0/source: .\n\texports", "body": "\nOn Jul 3, 2007, at 12:55 PM, jerry@samba.org wrote:\n\n> Author: jerry\n> Date: 2007-07-03 19:55:02 +0000 (Tue, 03 Jul 2007)\n> New Revision: 23689\n>\n> WebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23689\n>\n> Log:\n> Squashed commit of the following:\n>\n> commit 0d4bbd197198a94bf4e29e0ccd175a40a60097f3\n> Author: Gerald (Jerry) Carter \n> Date:   Mon Jul 2 20:08:19 2007 -0500\n>\n>    Introduce GNU ld linker export-script for hiding non-public symbols\n>    in shared libraries.\n>\n>    Based on initial patch from Julien Cristau \n>    and suggestions from James Peach .  Currently\n>    the libsmbsharemodes libraries still exports *.  Signed off on\n>    my Derrell as well.\n>\n> Added:\n>   branches/SAMBA_3_0/source/exports/\n>   branches/SAMBA_3_0/source/exports/libsmbclient.syms\n>   branches/SAMBA_3_0/source/exports/libsmbsharemodes.syms\n>   branches/SAMBA_3_0/source/library-versions.in\n> Modified:\n>   branches/SAMBA_3_0/source/Makefile.in\n>   branches/SAMBA_3_0/source/configure.in\n>\n>\n> Changeset:\n> Modified: branches/SAMBA_3_0/source/Makefile.in\n> ===================================================================\n> --- branches/SAMBA_3_0/source/Makefile.in\t2007-07-03 18:00:54 UTC  \n> (rev 23688)\n> +++ branches/SAMBA_3_0/source/Makefile.in\t2007-07-03 19:55:02 UTC  \n> (rev 23689)\n> @@ -21,6 +21,12 @@\n> CC=@CC@\n> SHLD=@SHLD@\n>\n> +## Dynamic shared libraries build settings\n> +DSO_EXPORTS_CMD=-Wl,--version-script,exports/`basename $@ | sed 's/ \n> @SHLIBEXT@$$/syms/'`\n> +DSO_EXPORTS=@DSO_EXPORTS@\n> +SONAME_VER=`grep ^$@ $(srcdir)/library-versions | cut -d: -f2`\n> +SHLD_DSO = $(SHLD) $(LDSHFLAGS) $(DSO_EXPORTS)\n\nYou should be able to make this\n\nSHLD_DSO = $(SHLD) $(LDSHFLAGS) $(LDFLAGS) $(DSO_EXPORTS) -o $@\n\n--\nJames Peach | jpeach@samba.org\n\n"}