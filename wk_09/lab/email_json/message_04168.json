{"category": "ham", "to_address": "Jeremy Allison <jra@samba.org>", "from_address": "tridge@samba.org", "subject": "Re: svn commit: samba r22202 - in\n\tbranches/SAMBA_3_0/source/nsswitch: .", "body": "Jeremy,\n\n > Paranoid thinking, that's all. Haven't got a corrupt\n > file that shows it - but I will try and create one :-).\n\nok, thanks :)\n\nYou could also consider using transactions on this tdb. Transactions\nonly affect write speed, and I suspect write speed isn't so critical\non this tdb, as we should only be writing to the tdb after we've done\nan operation on a remote DC, so I'd guess the speed of the remote\noperation will swamp the transaction fsync/msync time.\n\nIdeally we would use transactions (or ldb which uses transactions\nunderneath) on all long lived databases in Samba. Then we can have a\nsmb.conf parameter which enables the TDB_NOSYNC flag in tdb_open calls\nfor people who want speed instead of safety. \n\nThat flag leaves the same transaction API, but just disables the\nfsync/msync calls, so it means we are safe against kill -9, but not\nsafe against system crashes. It also makes it fast again :)\n\nCheers, Tridge\n\n"}