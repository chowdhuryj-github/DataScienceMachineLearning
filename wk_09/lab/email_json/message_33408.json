{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"=?GB2312?B?wO6/ob3c?=\" <klijunjie@gmail.com>", "subject": "[R]  Is this a bug in cv.lm(DAAG) ?", "body": "Dear R-list,\n\nI'm not sure what I've found about a function in DAAG package is a bug.\n\nWhen I was using cv.lm(DAAG) , I found there might be something wrong with\nit. The problem is that we can't use it to deal with a linear model with\nmore than one predictor variable. But the usage documentation\nhasn't informed us about this.\n\nThe code illustrates my discovery:\n\n> library(DAAG)\n> xx=matrix(rnorm(20*3),ncol=3)\n> bb=c(1,2,0)\n> yy=xx%*%bb+rnorm(20,0,10)\n>\n> data=data.frame(y=yy,x=xx)\n> myformula=formula(\"y ~ x.1 + x.2 + x.3\")\n> cv.lm(data,myformula,plotit=F, printit=TRUE)\nAnalysis of Variance Table\n\nResponse: yv\n          Df Sum Sq Mean Sq F value Pr(>F)\nxv         1     37      37    0.29    0.6\nResiduals 18   2288     127\n\n\nfold 1\nObservations in test set: 4 6 7 9 10 19\n                X1      X2     X3    X4      X5     X6\nx.1        -0.0316  -0.342  -1.44  1.42  -0.446  0.042\nPredicted  -1.6335  -0.990   1.29 -4.64  -0.773 -1.786\ny         -16.7876 -25.954 -14.67 -2.29 -28.118  7.731\nResidual  -15.1541 -24.964 -15.96  2.35 -27.344  9.517\n\nSum of squares = 1951    Mean square = 325    n = 6\n\nfold 2\nObservations in test set: 5 11 12 14 15 16 20\n              X1     X2    X3    X4      X5      X6      X7\nx.1        0.472  0.282  2.20  1.75   0.253 -0.0938  0.1543\nPredicted -5.089 -5.385 -2.40 -3.10  -5.431 -5.9707 -5.5842\ny         -5.894 -8.855 -7.32  2.88 -16.414 -3.0530  0.0434\nResidual  -0.805 -3.470 -4.92  5.97 -10.983  2.9177  5.6276\n\nSum of squares = 233    Mean square = 33.3    n = 7\n\nfold 3\nObservations in test set: 1 2 3 8 13 17 18\n              X1     X2    X3       X4     X5      X6        X7\nx.1        0.429  1.925  0.31  -0.0194  -1.45  -0.836   0.00308\nPredicted -8.592 -0.873 -9.20 -10.9030 -18.28 -15.117 -10.78682\ny         11.045 -8.562  6.64 -14.6833   6.95   0.873   1.41586\nResidual  19.637 -7.689 15.84  -3.7803  25.23  15.990  12.20268\n\nSum of squares = 1751    Mean square = 250    n = 7\nOverall ms\n       197 ######################################################## Note the\nmodel (\"y ~ x.1 + x.2 + x.3\") produces an Overall ms, 197\n> myformula=formula(\"y ~ x.1 + x.2\")\n> cv.lm(data,myformula,plotit=F, printit=TRUE)\nAnalysis of Variance Table\n\nResponse: yv\n          Df Sum Sq Mean Sq F value Pr(>F)\nxv         1     37      37    0.29    0.6\nResiduals 18   2288     127\n\n\nfold 1\nObservations in test set: 4 6 7 9 10 19\n                X1      X2     X3    X4      X5     X6\nx.1        -0.0316  -0.342  -1.44  1.42  -0.446  0.042\nPredicted  -1.6335  -0.990   1.29 -4.64  -0.773 -1.786\ny         -16.7876 -25.954 -14.67 -2.29 -28.118  7.731\nResidual  -15.1541 -24.964 -15.96  2.35 -27.344  9.517\n\nSum of squares = 1951    Mean square = 325    n = 6\n\nfold 2\nObservations in test set: 5 11 12 14 15 16 20\n              X1     X2    X3    X4      X5      X6      X7\nx.1        0.472  0.282  2.20  1.75   0.253 -0.0938  0.1543\nPredicted -5.089 -5.385 -2.40 -3.10  -5.431 -5.9707 -5.5842\ny         -5.894 -8.855 -7.32  2.88 -16.414 -3.0530  0.0434\nResidual  -0.805 -3.470 -4.92  5.97 -10.983  2.9177  5.6276\n\nSum of squares = 233    Mean square = 33.3    n = 7\n\nfold 3\nObservations in test set: 1 2 3 8 13 17 18\n              X1     X2    X3       X4     X5      X6        X7\nx.1        0.429  1.925  0.31  -0.0194  -1.45  -0.836   0.00308\nPredicted -8.592 -0.873 -9.20 -10.9030 -18.28 -15.117 -10.78682\ny         11.045 -8.562  6.64 -14.6833   6.95   0.873   1.41586\nResidual  19.637 -7.689 15.84  -3.7803  25.23  15.990  12.20268\n\nSum of squares = 1751    Mean square = 250    n = 7\nOverall ms\n       197 ######################################################## Note the\nmodel (\"y ~ x.1 + x.2 \") also produces an Overall ms, 197\n> myformula=formula(\"y ~ x.1 \")\n> cv.lm(data,myformula,plotit=F, printit=TRUE)\nAnalysis of Variance Table\n\nResponse: yv\n          Df Sum Sq Mean Sq F value Pr(>F)\nxv         1     37      37    0.29    0.6\nResiduals 18   2288     127\n\n\nfold 1\nObservations in test set: 4 6 7 9 10 19\n                X1      X2     X3    X4      X5     X6\nx.1        -0.0316  -0.342  -1.44  1.42  -0.446  0.042\nPredicted  -1.6335  -0.990   1.29 -4.64  -0.773 -1.786\ny         -16.7876 -25.954 -14.67 -2.29 -28.118  7.731\nResidual  -15.1541 -24.964 -15.96  2.35 -27.344  9.517\n\nSum of squares = 1951    Mean square = 325    n = 6\n\nfold 2\nObservations in test set: 5 11 12 14 15 16 20\n              X1     X2    X3    X4      X5      X6      X7\nx.1        0.472  0.282  2.20  1.75   0.253 -0.0938  0.1543\nPredicted -5.089 -5.385 -2.40 -3.10  -5.431 -5.9707 -5.5842\ny         -5.894 -8.855 -7.32  2.88 -16.414 -3.0530  0.0434\nResidual  -0.805 -3.470 -4.92  5.97 -10.983  2.9177  5.6276\n\nSum of squares = 233    Mean square = 33.3    n = 7\n\nfold 3\nObservations in test set: 1 2 3 8 13 17 18\n              X1     X2    X3       X4     X5      X6        X7\nx.1        0.429  1.925  0.31  -0.0194  -1.45  -0.836   0.00308\nPredicted -8.592 -0.873 -9.20 -10.9030 -18.28 -15.117 -10.78682\ny         11.045 -8.562  6.64 -14.6833   6.95   0.873   1.41586\nResidual  19.637 -7.689 15.84  -3.7803  25.23  15.990  12.20268\n\nSum of squares = 1751    Mean square = 250    n = 7\nOverall ms\n       197 ######################################################## Note the\nmodel (\"y ~ x.1 + x.2 \") ALSO produces an Overall ms, 197\n\n3 different linear model give three equal mss(mean squared error)!?\nThen I was eager to know why 3 different linear model gave three equal\nmss(mean squared error). I checked the code of function cv.lm(DAAG), then\nfound the residues were all derived from a model with only one predictor.\n\nIs this a bug? Or is it because of my misunderstanding of somthing about\ncv.lm(DAAG)?\n\nLi Junjie\n-- \nJunjie Li,                  klijunjie@gmail.com\nUndergranduate in DEP of Tsinghua University,\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}