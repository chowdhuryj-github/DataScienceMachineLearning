{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jpeach@samba.org", "subject": "svn commit: samba r23093 - in branches: SAMBA_3_0/source/script\n\tSAMBA_3_0_26/source/script", "body": "Author: jpeach\nDate: 2007-05-23 19:10:04 +0000 (Wed, 23 May 2007)\nNew Revision: 23093\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23093\n\nLog:\nAllow modules with the same name but different types.\n\nModified:\n   branches/SAMBA_3_0/source/script/installmodules.sh\n   branches/SAMBA_3_0_26/source/script/installmodules.sh\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/script/installmodules.sh\n===================================================================\n--- branches/SAMBA_3_0/source/script/installmodules.sh\t2007-05-23 15:28:47 UTC (rev 23092)\n+++ branches/SAMBA_3_0/source/script/installmodules.sh\t2007-05-23 19:10:04 UTC (rev 23093)\n@@ -19,11 +19,19 @@\n fi\n done\n \n+# We expect the last component of LIBDIR to be the module type, eg. idmap,\n+# pdb. By stripping this from the installation name, you can have multiple\n+# modules of the same name but different types by creating eg. idmap_foo\n+# and pdb_foo. This makes the most sense for idmap and pdb module, where\n+# they need to be consistent.\n+mtype=`basename $LIBDIR`\n+\n for p in $*; do\n  p2=`basename $p`\n- echo Installing $p as $DESTDIR/$LIBDIR/$p2\n- cp -f $p $DESTDIR/$LIBDIR/\n- chmod $INSTALLPERMS $DESTDIR/$LIBDIR/$p2\n+ name=`echo $p2 | sed -es/${mtype}_//`\n+ echo Installing $p as $DESTDIR/$LIBDIR/$name\n+ cp -f $p $DESTDIR/$LIBDIR/$name\n+ chmod $INSTALLPERMS $DESTDIR/$LIBDIR/$name\n done\n \n exit 0\n\nModified: branches/SAMBA_3_0_26/source/script/installmodules.sh\n===================================================================\n--- branches/SAMBA_3_0_26/source/script/installmodules.sh\t2007-05-23 15:28:47 UTC (rev 23092)\n+++ branches/SAMBA_3_0_26/source/script/installmodules.sh\t2007-05-23 19:10:04 UTC (rev 23093)\n@@ -19,11 +19,19 @@\n fi\n done\n \n+# We expect the last component of LIBDIR to be the module type, eg. idmap,\n+# pdb. By stripping this from the installation name, you can have multiple\n+# modules of the same name but different types by creating eg. idmap_foo\n+# and pdb_foo. This makes the most sense for idmap and pdb module, where\n+# they need to be consistent.\n+mtype=`basename $LIBDIR`\n+\n for p in $*; do\n  p2=`basename $p`\n- echo Installing $p as $DESTDIR/$LIBDIR/$p2\n- cp -f $p $DESTDIR/$LIBDIR/\n- chmod $INSTALLPERMS $DESTDIR/$LIBDIR/$p2\n+ name=`echo $p2 | sed -es/${mtype}_//`\n+ echo Installing $p as $DESTDIR/$LIBDIR/$name\n+ cp -f $p $DESTDIR/$LIBDIR/$name\n+ chmod $INSTALLPERMS $DESTDIR/$LIBDIR/$name\n done\n \n exit 0\n\n"}