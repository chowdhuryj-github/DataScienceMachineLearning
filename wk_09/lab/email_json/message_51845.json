{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Dieter Menne <dieter.menne@menne-biomed.de>", "subject": "[R] User Defined R Functions in Sweave/Latex", "body": "M. Jankowski  gmail.com> writes:\n\n> My Sweave code is intended to make lots of plots and create a *.pdf\n> document. Sweave is perfect for this. The only problem is that  I find\n> myself using the same R code, within my Sweave input file over an\n> over. \n....\n \n> This is the R function:\n> basicplot <- function(x, nplots, sectionname){\n> # Begin to make figure here\n> file = paste(\"scatter\",nplots, \".pdf\", sep=\"\")\n> pdf(file = file,paper=\"special\", width=6, height = 6)\n> plot(x)\n> dev.off()\n> cat(\"\\\\begin{figure}\\n\")\n> cat(\"\\\\includegraphics{\",file,\"}\\n\", sep=\"\")\n> cat(\"\\\\caption{\", sectionname,\"}\\n\", sep = \"\")\n> cat(\"\\\\end{figure}\\n\")\n> #End figure making\n> }\n> \nI don't know if this is exactly what you want, but below an example of using\nincludegraphics in a latex macro. For a real application, I recommend\n\\FloatBarrier instead of \\clearpage when you have lots of figures/tables and\nlittle text, as it's common in technical stuff.\n\nDieter\n\n% -- Begin Sweave example\n\\documentclass[a4paper]{article}\n\\usepackage{Sweave}\n\\SweaveOpts{engine=R,eval=TRUE,eps=FALSE,pdf=TRUE, strip.white=TRUE}\n\\SweaveOpts{echo=FALSE,results=hide,width=6,height=4}\n\n\\bibliography{menne}\n\\begin{document}\n\\section{Hello}\n\n\\newcommand\\doaplot[3]{\n\n\\begin{figure}\n  \\centering\n\\subsection{ #1}\n\\includegraphics{#2}\n  \\caption{3}\n  \\label{fig:#2}\n\\end{figure}\nThe meaning of life is The meaning of life is\nThe meaning of life is\nThe meaning of life is\nThe meaning of life is\n\\clearpage\n\n}\n\n<>=\n for (nplots in 1:3) {\n   file = paste(\"scatter\",nplots, \".pdf\", sep=\"\")\n   pdf(file = file,paper=\"special\", width=6, height = 6)\n   plot(rnorm(100),rnorm(100),main=paste(\"Plot\",nplots))\n   dev.off()\n   cat(\"\\\\doaplot{Section\",nplots,\"}{scatter\",nplots,\"}{My caption for \",\n     nplots,\"}\\n\",sep=\"\")\n }\n@\n\n\\end{document}\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}