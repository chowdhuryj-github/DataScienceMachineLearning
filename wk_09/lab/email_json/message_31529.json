{"category": "ham", "to_address": "Karl Knoblick <karlknoblich@yahoo.de>", "from_address": "Frank E Harrell Jr <f.harrell@vanderbilt.edu>", "subject": "Re: [R] How to analyse simple study: Placebo-controlled (2 groups)\n repeated measurements (ANOVA, ANCOA???)", "body": "Karl Knoblick wrote:\n> Hallo!\n> \n> I have two groups (placebo/verum), every subject is measured at 5 times, the first time t0 is the baseline measurement, t1 to t4 are the measurements after applying the medication (placebo or verum). The question is, if there is a significant difference in the two groups and how large the differnce is (95% confidence intervals).\n> \n> Let me give sample data\n> # Data\n> ID<-factor(rep(1:50,each=5)) # 50 subjects\n> GROUP<-factor(c(rep(\"Verum\", 115), rep(\"Placebo\", 135)))\n> TIME<-factor(rep(paste(\"t\",0:4,sep=\"\"), 50))\n> set.seed(1234)\n> Y<-rnorm(250)\n> # to have an effect:\n> Y[GROUP==\"Verum\" & TIME==\"t1\"]<-Y[GROUP==\"Verum\" & TIME==\"t1\"] + 0.6 \n> Y[GROUP==\"Verum\" & TIME==\"t2\"]<-Y[GROUP==\"Verum\" & TIME==\"t2\"] + 0.3 \n> Y[GROUP==\"Verum\" & TIME==\"t3\"]<-Y[GROUP==\"Verum\" & TIME==\"t3\"] + 0.9 \n> Y[GROUP==\"Verum\" & TIME==\"t4\"]<-Y[GROUP==\"Verum\" & TIME==\"t4\"] + 0.9 \n> DF<-data.frame(Y, ID, GROUP, TIME)\n> \n> I have heard of different ways to analyse the data\n> 1) Comparing the endpoint t4 between the groups (t-test), ignoring baseline\n\nDon't even consider this\n\n> 2) Comparing the difference t4 minus t0 between the two groups (t-test)\n\nThis is not optimal\n\n> 3) Comparing the endpoint t4 with t0 as a covariate between the groups (ANOVA - how can this model be calculated in R?)\n\nUsing t0 as a covariate is the way to go.  A question is whether to just \nuse t4.  Generally this is not optimum.\n\n> 4) Taking a summary score (im not sure but this may be a suggestion of Altman) istead of t4\n> 5) ANOVA (repeated measurements) times t0 to t5, group placebo/verum), subject as random factor - interested in interaction times*groups (How to do this in R?)\n> 6) as 5) but times t1 to t5, ignoring baseline (How to do this in R?)\n> 7) as 6) but additional covariate baseline t0 (How to do this in R?)\n> \n> What will be best? - (Advantages / disadvantages?)\n> How to analyse these models in R with nested and random effects and possible covariate(ID, group - at least I think so) and random parameter ID)? Or is there a more simple possibility?\n\nIt's not obvious that random effects are needed if you take the \ncorrelation into account in a good way.  Generalized least squares using \nfor example an AR1 correlation structure (and there are many others) is \nsomething I often prefer.  A detailed case study with R code (similar to \nyour situation) is in http://biostat.mc.vanderbilt.edu/FrankHarrellGLS . \n  This includes details about why t0 is best to consider as a covariate. \n  One reason is that the t0 effect may not be linear.\n\nIf you want to focus on t4 it is easy to specify a contrast (after \nfitting is completed) that tests t4.  If time is continuous this \ncontrast would involve predicted values at the 4th time, otherwise \ntesting single parameters.\n\nFrank Harrell\n\n> \n> Perhaps somebody can recommend a book or weblink where these different strategies of analysing are discussed - preferable with examples with raw data which I can recalculate. And if there is the R syntax includede - this would be best!\n> \n> Any help will be appreciate!\n> \n> Thanks!\n> Karl\n\n-- \nFrank E Harrell Jr   Professor and Chair           School of Medicine\n                      Department of Biostatistics   Vanderbilt University\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}