{"category": "ham", "to_address": "Matthew Neilson <matt@gneilson.plus.com>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] Unwanted white borders on semi-transparent polygons?", "body": "On Fri, 27 Apr 2007, Matthew Neilson wrote:\n\n> Hey again,\n>\n> Just to let you know that I managed to test out R-2.5.0, and the transparency \n> glitch has thankfully disappeared. I apologise for wasting your time with \n> this.\n>\n> One final question, though. Did you mean to say that the known transparency \n> bug was fixed in version 2.5.0? Or was it fixed in a patched version of \n> R-2.4.0? Only asking because, if the final Panther binary (version 2.4.0) \n> available on CRAN doesn't fix the bug, there's no point in me installing this \n> on top of my happily working (and otherwise fully functional) version of R.\n\nI meant to say '2.4.0 patched', which became 2.4.1.  The release of 2.4.0 \nhas the bug: NEWS says\n\n     o\tA request for an opaque colour in the pdf() device after a\n \ttranslucent one did not set the transparency back to opaque in\n \t2.4.0.\n\n \tSemi-transparent background colours were not being plotted on\n \tthe pdf() device.\n\n\n\n>\n> Many thanks,\n>\n>\n> -Matt\n>\n>\n>\n> On 27 Apr 2007, at 13:35, Matthew Neilson wrote:\n>\n>> Hi Brian,\n>> \n>> Terribly sorry if I accidentally broke a rule. sessionInfo() produces the \n>> following:\n>> \n>>> sessionInfo()\n>> R version 2.2.1, 2005-12-20, powerpc-apple-darwin7.9.0\n>> \n>> attached base packages:\n>> [1] \"methods\"   \"stats\"     \"graphics\"  \"grDevices\" \"utils\"     \"datasets\"\n>> [7] \"base\"\n>> \n>> I cannot upgrade to the latest version of R, since I'm using OS X 10.3.9 \n>> (Panther) and the latest builds require 10.4.4 (Tiger) or greater. It's \n>> interesting to know that R version 2.4.0\n>> contains a transparency bug, though - I'll ask IT Services to install the \n>> latest version of R on the G5 and see if that helps.\n>> \n>> Many thanks for all your help,\n>> \n>> \n>> -Matt\n>> \n>> \n>> \n>> On Fri Apr 27 12:58 , Prof Brian Ripley  sent:\n>> \n>>> The posting guide says\n>>>\n>>>   For questions about unexpected behavior or a possible bug, you should,\n>>>   at a minimum, copy and paste the output from sessionInfo() into your \n>>> message.\n>>>\n>>>   If you are using an old version of R and think it does not work\n>>>   properly, upgrade to the latest version and try that, before posting.\n>>> \n>>> [There is a known bug in 2.4.0 related to semi-transparency, fixed in\n>>> 2.4.0.  I would not have attempted to answer a question about 2.1.1, and\n>>> we do rely on people seeking free technical assistance doing their bit.]\n>>> \n>>> \n>>> On Fri, 27 Apr 2007, Matthew Neilson wrote:\n>>> \n>>>> Thanks for your fast response.\n>>>> \n>>>> I'm using R version 2.1.1 on OS X 10.3.9 to create the pdfs. I have tried \n>>>> viewing the pdf output in both Acrobat 6 and 7 (both display a white \n>>>> border around each polygon) as well\n>> as\n>>>> Preview (displays fine). I have emailed the pdf file to some \n>>>> correspondents running Windows, and they also see white borders when \n>>>> viewing with Acrobat (version unspecified).\n>>>> \n>>>> I have tried using R version 2.4.0 on a G5 machine (which I can access \n>>>> remotely) running OS X 10.4.8, but the resulting pdf renders incorrectly \n>>>> (i.e. with a white border around\n>> each\n>>>> polygon) in both Acrobat *and* Preview. So it would appear that the \n>>>> combination of R 2.1.1 and OS X 10.3.9 gives slightly better results - \n>>>> although plots still appear incorrect\n>> when\n>>>> printed or viewed in Acrobat.\n>>>> \n>>>> Unfortunately, I don't have access to a Windows machine to test this out. \n>>>> Even if I did, many of my scripts include various Unix system calls so I \n>>>> don't think that would be a viable\n>>>> solution. Could this be a bug in the OS X pdf driver?\n>>> \n>>> The R pdf() device is the same on all platforms.\n>>> \n>>>> Many thanks,\n>>>> \n>>>> \n>>>> -Matt\n>>>> \n>>>> \n>>>> \n>>>> On 27 Apr 2007, at 06:42, Prof Brian Ripley wrote:\n>>>> \n>>>>> What version of R, what OS, what version of Acrobat?\n>>>>> \n>>>>> I don't see this in 2.5.0 on Windows (using Acrobat 7: Acrobat does not\n>>>>> exist on Linux, AFAIK).  And reading the PDF produced shows no sign of \n>>>>> an\n>>>>> extra object for the border.\n>>>>> \n>>>>> On Fri, 27 Apr 2007, Matthew Neilson wrote:\n>>>>> \n>>>>>> Hey all,\n>>>>>> \n>>>>>> I'm trying to create a plot of two semi-transparent regions. The reason \n>>>>>> they need to be partially transparent is so that I can see if there's \n>>>>>> any overlap. Here's some example\n>> code:\n>>>>>> \n>>>>>> # BEGIN\n>>>>>> \n>>>>>> pdf(file=\"test.pdf\",version=\"1.4\")\n>>>>>> plot(0,0,type=\"l\",ylim=range(-3,3),xlim=range(-1,5))\n>>>>>> polygon(c(0,1,2,3,4,3,2,1,0), c(0,1,2,1,0,-1,-2,-1,0), \n>>>>>> col=rgb(1,0,0,0.5),\n>>>>>> border=NA)\n>>>>>> polygon(c(1,2,3,4,5,4,3,2,1), c(0,1,2,1,0,-1,-2,-1,0), \n>>>>>> col=rgb(0,0,1,0.5),\n>>>>>> border=NA)\n>>>>>> dev.off()\n>>>>>> \n>>>>>> # END\n>>>>>> \n>>>>>> The problem with this is that, despite setting \"border = NA\", I get a\n>>>>>> big white border surrounding each polygon!! Funnily enough, setting the\n>>>>>> alpha channel equal to 1 (as opposed to 0.5) *doesn't* give the border,\n>>>>>> but an alpha channel of 1 produces an opaque polygon! :S\n>>>>>> \n>>>>>> I have read the FAQ, and (unfortunately) turning off line-art smoothing\n>>>>>> does not give the desired effect. Furthermore, my pdfs print with a\n>>>>>> white border surrounding each transparent polygon.\n>>>>>> \n>>>>>> Now, here comes the really bizarre part. Whilst Adobe Acrobat displays\n>>>>>> the unwanted white border, Apple Preview respects the \"border=NA\"\n>>>>>> argument and shows the two diamonds as they are intended. However,\n>>>>>> opening up the pdf in Illustrator CS reveals that there is in fact a\n>>>>>> transparent (according to Illustrator) border *on top* of each diamond.\n>>>>>> Deleting these two borders (one for each polygon) and re-saving the pdf\n>>>>>> appears to correct the issue. So the obvious question is: how did the\n>>>>>> surrounding borders get there in the first place? A bug in the polygon\n>>>>>> function, perhaps?\n>>>>>> \n>>>>>> Does anyone have any ideas for preventing these unwanted borders around\n>>>>>> semi-transparent polygons (without having to resort to Illustrator)? \n>>>>>> Has\n>>>>>> anyone else even come across this problem?\n>>>>>> \n>>>>>> Many thanks,\n>>>>>> \n>>>>>> \n>>>>>> -Matt\n>>>>>> \n>>>>> \n>>>>> --\n>>>>> Brian D. Ripley,                  ripley@stats.ox.ac.uk\n>>>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\n>>>>> University of Oxford,             Tel:  +44 1865 272861 (self)\n>>>>> 1 South Parks Road,                     +44 1865 272866 (PA)\n>>>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595\n>>>> \n>>>> ______________________________________________\n>>>> R-help@stat.math.ethz.ch mailing list\n>>>> https://stat.ethz.ch/mailman/listinfo/r-help\n>>>> PLEASE do read the posting guide \n>>>> http://www.R-project.org/posting-guide.html\n>>>> and provide commented, minimal, self-contained, reproducible code.\n>>>> \n>>> \n>>> -- \n>>> Brian D. Ripley,                  ripley@stats.ox.ac.uk\n>>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\n>>> University of Oxford,             Tel:  +44 1865 272861 (self)\n>>> 1 South Parks Road,                     +44 1865 272866 (PA)\n>>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595\n>> \n>> ______________________________________________\n>> R-help@stat.math.ethz.ch mailing list\n>> https://stat.ethz.ch/mailman/listinfo/r-help\n>> PLEASE do read the posting guide \n>> http://www.R-project.org/posting-guide.html\n>> and provide commented, minimal, self-contained, reproducible code.\n>> \n>> \n>\n> --\n> ************************************\n> Matthew Neilson\n> University of Strathclyde\n> Department of Mathematics\n> Livingstone Tower\n> 26 Richmond Street\n> Glasgow G1 1XH\n>\n> Tel : + 44(0)141 548 4559\n> e-mail : rs.mnei@maths.strath.ac.uk\n> ************************************\n>\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}