{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Alex Chen\" <ychen@insightful.com>", "subject": "[R] Calling C routine in anther package in C code\n\t(R_RegisterCCallable)", "body": "Hi, \n\n \n\nI want to make use of some C routines from other packages to write extensions\nin C.\n\n \n\nIn \"Writing R Extensions\", it says there is an experimental interface to\nsupport this in (or from ?) R 2.4.0. \n\n \n\nI had a dummy library containing src/dummy.cpp and R/zzz.R:\n\n \n\n====== src/dummy.cpp ====\n\n#include \n\n#include \n\n#include \n\n \n\nextern \"C\" \n\n{\n\n  void dummy(int *a, int *b)\n\n  {\n\n    printf(\"dummy\\n\");\n\n  }\n\n}\n\n \n\nvoid R_init_dummy(DllInfo *dll)\n\n{\n\n  R_RegisterCCallable(\"dummy\", \"dummy\", (DL_FUNC)dummy);\n\n}\n\n \n\n====== R/zzz.R =========\n\n \n\n.First.lib <- function(lib, pkg) {\n\n  library.dynam(\"dummy\", pkg, lib)\n\n}\n\n \n\n======================\n\n \n\nI can compile this using R 2.5.0 under Linux.\n\n \n\nBut I got the following error when I tried to load the library \n\n \n\n>library(dummy):\n\nError in dyn.load(x, as.logical(local), as.logical(now)) : \n\n        unable to load shared library\n'/homes/ychen/Rlibs/dummy/libs/dummy.so':\n\n  /homes/ychen/Rlibs/dummy/libs/dummy.so: undefined symbol:\n_Z19R_RegisterCCallablePcS_PFPvvE\n\nError in library(dummy) : .First.lib failed for 'dummy'\n\n \n\nCan anyone help me out?\n\n \n\nThanks!\n\n \n\nAlex\n\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}