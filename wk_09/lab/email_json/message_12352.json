{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jerry@samba.org", "subject": "svn commit: samba r22444 - in branches: SAMBA_3_0/packaging/RHEL\n\tSAMBA_3_0/source/nsswitch SAMBA_3_0_25/packaging/RHEL\n\tSAMBA_3_0_25/source/nsswitch SAMBA_3_0_RELEASE/packaging/RHEL\n\tSAMBA_3_0_RELEASE/source/nsswitch", "body": "Author: jerry\nDate: 2007-04-22 09:32:14 +0000 (Sun, 22 Apr 2007)\nNew Revision: 22444\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22444\n\nLog:\n* Validate a SID before trying to convert it to a uid/gid via the public\n  winbindd interface\n\n* Add nss_info/*so files to the RHEL/Fedora packaging\n\n\n\nModified:\n   branches/SAMBA_3_0/packaging/RHEL/samba.spec.tmpl\n   branches/SAMBA_3_0/source/nsswitch/winbindd_sid.c\n   branches/SAMBA_3_0_25/packaging/RHEL/samba.spec.tmpl\n   branches/SAMBA_3_0_25/source/nsswitch/winbindd_sid.c\n   branches/SAMBA_3_0_RELEASE/packaging/RHEL/samba.spec.tmpl\n   branches/SAMBA_3_0_RELEASE/source/nsswitch/winbindd_sid.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/packaging/RHEL/samba.spec.tmpl\n===================================================================\n--- branches/SAMBA_3_0/packaging/RHEL/samba.spec.tmpl\t2007-04-22 09:17:25 UTC (rev 22443)\n+++ branches/SAMBA_3_0/packaging/RHEL/samba.spec.tmpl\t2007-04-22 09:32:14 UTC (rev 22444)\n@@ -372,6 +372,7 @@\n %{_bindir}/eventlogadm\n \n %{_libdir}/samba/idmap/*.so\n+%{_libdir}/samba/nss_info/*.so\n %{_libdir}/samba/vfs/*.so\n %{_libdir}/samba/auth/*.so\n \n\nModified: branches/SAMBA_3_0/source/nsswitch/winbindd_sid.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/winbindd_sid.c\t2007-04-22 09:17:25 UTC (rev 22443)\n+++ branches/SAMBA_3_0/source/nsswitch/winbindd_sid.c\t2007-04-22 09:32:14 UTC (rev 22444)\n@@ -199,7 +199,7 @@\n \t\treturn;\n \t}\n \n-\tif ( (type!=SID_NAME_USER) || (type!=SID_NAME_COMPUTER) ) {\n+\tif ( (type!=SID_NAME_USER) && (type!=SID_NAME_COMPUTER) ) {\n \t\tDEBUG(5,(\"sid2uid_lookupsid_recv: Sid %s is not a user or a computer.\\n\", \n \t\t\t state->request.data.sid));\n \t\trequest_error(state);\n@@ -276,8 +276,8 @@\n \t\treturn;\n \t}\n \n-\tif ( (type!=SID_NAME_DOM_GRP) || \n-\t     (type!=SID_NAME_ALIAS) ||\n+\tif ( (type!=SID_NAME_DOM_GRP) &&\n+\t     (type!=SID_NAME_ALIAS) && \n \t     (type!=SID_NAME_WKN_GRP) ) \n \t{\n \t\tDEBUG(5,(\"sid2gid_lookupsid_recv: Sid %s is not a group.\\n\", \n\nModified: branches/SAMBA_3_0_25/packaging/RHEL/samba.spec.tmpl\n===================================================================\n--- branches/SAMBA_3_0_25/packaging/RHEL/samba.spec.tmpl\t2007-04-22 09:17:25 UTC (rev 22443)\n+++ branches/SAMBA_3_0_25/packaging/RHEL/samba.spec.tmpl\t2007-04-22 09:32:14 UTC (rev 22444)\n@@ -372,6 +372,7 @@\n %{_bindir}/eventlogadm\n \n %{_libdir}/samba/idmap/*.so\n+%{_libdir}/samba/nss_info/*.so\n %{_libdir}/samba/vfs/*.so\n %{_libdir}/samba/auth/*.so\n \n\nModified: branches/SAMBA_3_0_25/source/nsswitch/winbindd_sid.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/nsswitch/winbindd_sid.c\t2007-04-22 09:17:25 UTC (rev 22443)\n+++ branches/SAMBA_3_0_25/source/nsswitch/winbindd_sid.c\t2007-04-22 09:32:14 UTC (rev 22444)\n@@ -199,7 +199,7 @@\n \t\treturn;\n \t}\n \n-\tif ( (type!=SID_NAME_USER) || (type!=SID_NAME_COMPUTER) ) {\n+\tif ( (type!=SID_NAME_USER) && (type!=SID_NAME_COMPUTER) ) {\n \t\tDEBUG(5,(\"sid2uid_lookupsid_recv: Sid %s is not a user or a computer.\\n\", \n \t\t\t state->request.data.sid));\n \t\trequest_error(state);\n@@ -276,8 +276,8 @@\n \t\treturn;\n \t}\n \n-\tif ( (type!=SID_NAME_DOM_GRP) || \n-\t     (type!=SID_NAME_ALIAS) ||\n+\tif ( (type!=SID_NAME_DOM_GRP) &&\n+\t     (type!=SID_NAME_ALIAS) && \n \t     (type!=SID_NAME_WKN_GRP) ) \n \t{\n \t\tDEBUG(5,(\"sid2gid_lookupsid_recv: Sid %s is not a group.\\n\", \n\nModified: branches/SAMBA_3_0_RELEASE/packaging/RHEL/samba.spec.tmpl\n===================================================================\n--- branches/SAMBA_3_0_RELEASE/packaging/RHEL/samba.spec.tmpl\t2007-04-22 09:17:25 UTC (rev 22443)\n+++ branches/SAMBA_3_0_RELEASE/packaging/RHEL/samba.spec.tmpl\t2007-04-22 09:32:14 UTC (rev 22444)\n@@ -372,6 +372,7 @@\n %{_bindir}/eventlogadm\n \n %{_libdir}/samba/idmap/*.so\n+%{_libdir}/samba/nss_info/*.so\n %{_libdir}/samba/vfs/*.so\n %{_libdir}/samba/auth/*.so\n \n\nModified: branches/SAMBA_3_0_RELEASE/source/nsswitch/winbindd_sid.c\n===================================================================\n--- branches/SAMBA_3_0_RELEASE/source/nsswitch/winbindd_sid.c\t2007-04-22 09:17:25 UTC (rev 22443)\n+++ branches/SAMBA_3_0_RELEASE/source/nsswitch/winbindd_sid.c\t2007-04-22 09:32:14 UTC (rev 22444)\n@@ -199,7 +199,7 @@\n \t\treturn;\n \t}\n \n-\tif ( (type!=SID_NAME_USER) || (type!=SID_NAME_COMPUTER) ) {\n+\tif ( (type!=SID_NAME_USER) && (type!=SID_NAME_COMPUTER) ) {\n \t\tDEBUG(5,(\"sid2uid_lookupsid_recv: Sid %s is not a user or a computer.\\n\", \n \t\t\t state->request.data.sid));\n \t\trequest_error(state);\n@@ -276,8 +276,8 @@\n \t\treturn;\n \t}\n \n-\tif ( (type!=SID_NAME_DOM_GRP) || \n-\t     (type!=SID_NAME_ALIAS) ||\n+\tif ( (type!=SID_NAME_DOM_GRP) &&\n+\t     (type!=SID_NAME_ALIAS) && \n \t     (type!=SID_NAME_WKN_GRP) ) \n \t{\n \t\tDEBUG(5,(\"sid2gid_lookupsid_recv: Sid %s is not a group.\\n\", \n\n"}