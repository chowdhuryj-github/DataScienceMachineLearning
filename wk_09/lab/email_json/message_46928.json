{"category": "ham", "to_address": "asb@mail.nih.gov", "from_address": "\"Deepayan Sarkar\" <deepayan.sarkar@gmail.com>", "subject": "Re: [R] 2 Trellis graphics question", "body": "On 6/12/07, Alan S Barnett  wrote:\n> 1) I have a data that includes some \"bad\" data.  I want to make a\n> trellis plot where each panel contains\n> a) A scatter plot of the \"good\" data\n> b) A scatter plot of the \"bad\" data in a different color\n> c) A best fit line of all the data, and\n> d) A best fit line of the \"good\" data.\n>\n> I tried using xyplot and setting the \"group\" argument, but I'm having\n> trouble.  Here is my code:\n>\n> xyplot(y ~ x | status, data=data,groups=good,\n> +  panel=function(x,y,...){\n> +  panel.xyplot(x,y,...)\n> +  panel.lmline(x,y,col = \"red\")\n> +  panel.lmline(x[good],y[good],col = \"blue\")\n> + }\n> + )\n\nYou are close, except the last panel.lmline call is not meaningful\nbecause the 'x' and 'y' in the panel function are not the same length\nas 'good'.  You need to use 'subscripts' for that.\n\nTo fix ideas, here's a concrete example (I've changed the names 'x'\nand 'y' to 'xx' and 'yy' to avoid any confusion):\n\n\nmydata <-\n    data.frame(xx = sample(100),\n               yy = rnorm(100) + rep(c(5, 10), c(80, 20)),\n               status = gl(5, 1, 100),\n               good = rep(c(TRUE, FALSE), c(80, 20)))\n\nThen, what you want can be achieved with:\n\nxyplot(yy ~ xx | status, mydata, groups = good,\n\n       panel = function(x, y, groups, subscripts, ...) {\n           panel.xyplot(x, y,\n                        groups = groups,\n                        subscripts = subscripts,\n                        ...)\n           panel.lmline(x, y, col = \"red\")\n\t   good.id <- groups[subscripts]\n\t   ## good.id: subset of 'good' relevant for this panel\n           panel.lmline(x[good.id], y[good.id], col = \"blue\")\n       })\n\nThis also works if 'good' is globally visible and not in 'mydata'.\n\n[...]\n\n> 2) There are 5 different values of status, but I only want to plot three\n> of them.  Can I do this without copying only the desired elements into a\n> new data frame?\n\nSure, just use the additional argument\n\n  subset = (status %in% c(\"1\", \"3\", \"5\"))\n\nor whatever the appropriate subset is.\n\n-Deepayan\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}