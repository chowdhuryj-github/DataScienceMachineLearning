{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22575 - in branches/SAMBA_4_0/source: . script\n\tscripting/swig selftest selftest/win", "body": "Author: metze\nDate: 2007-04-29 20:37:59 +0000 (Sun, 29 Apr 2007)\nNew Revision: 22575\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22575\n\nLog:\nmove script/tests/ -> selftest/\n\nas discussed with jelmer and abartlet\n\nmetze\nAdded:\n   branches/SAMBA_4_0/source/selftest/\nRemoved:\n   branches/SAMBA_4_0/source/script/tests/\nModified:\n   branches/SAMBA_4_0/source/main.mk\n   branches/SAMBA_4_0/source/scripting/swig/config.mk\n   branches/SAMBA_4_0/source/selftest/Samba3.pm\n   branches/SAMBA_4_0/source/selftest/Samba4.pm\n   branches/SAMBA_4_0/source/selftest/Windows.pm\n   branches/SAMBA_4_0/source/selftest/selftest.pl\n   branches/SAMBA_4_0/source/selftest/test_blackbox.sh\n   branches/SAMBA_4_0/source/selftest/test_s3upgrade.sh\n   branches/SAMBA_4_0/source/selftest/test_samba4.pl\n   branches/SAMBA_4_0/source/selftest/test_win.sh\n   branches/SAMBA_4_0/source/selftest/tests_all.sh\n   branches/SAMBA_4_0/source/selftest/tests_quick.sh\n   branches/SAMBA_4_0/source/selftest/tests_win.sh\n   branches/SAMBA_4_0/source/selftest/tests_win2k3_dc.sh\n   branches/SAMBA_4_0/source/selftest/win/README\n   branches/SAMBA_4_0/source/selftest/win/wintest_base.sh\n   branches/SAMBA_4_0/source/selftest/win/wintest_client.sh\n   branches/SAMBA_4_0/source/selftest/win/wintest_net.sh\n   branches/SAMBA_4_0/source/selftest/win/wintest_raw.sh\n   branches/SAMBA_4_0/source/selftest/win/wintest_rpc.sh\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/main.mk\n===================================================================\n--- branches/SAMBA_4_0/source/main.mk\t2007-04-29 19:54:26 UTC (rev 22574)\n+++ branches/SAMBA_4_0/source/main.mk\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -283,7 +283,7 @@\n \n check:: test\n \n-SELFTEST = $(PERL) $(srcdir)/script/tests/selftest.pl --prefix=${selftest_prefix} \\\n+SELFTEST = $(PERL) $(srcdir)/selftest/selftest.pl --prefix=${selftest_prefix} \\\n     --builddir=$(builddir) --srcdir=$(srcdir) \\\n     --expected-failures=$(srcdir)/samba4-knownfail \\\n     --skip=$(srcdir)/samba4-skip \\\n\nModified: branches/SAMBA_4_0/source/scripting/swig/config.mk\n===================================================================\n--- branches/SAMBA_4_0/source/scripting/swig/config.mk\t2007-04-29 19:54:26 UTC (rev 22574)\n+++ branches/SAMBA_4_0/source/scripting/swig/config.mk\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -27,4 +27,4 @@\n # Swig testing\n \n swigtest: swig\n-\t./script/tests/test_swig.sh\n+\t./selftest/test_swig.sh\n\nCopied: branches/SAMBA_4_0/source/selftest (from rev 22571, branches/SAMBA_4_0/source/script/tests)\n\nModified: branches/SAMBA_4_0/source/selftest/Samba3.pm\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/Samba3.pm\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/Samba3.pm\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -187,8 +187,8 @@\n \tmy $username = `PATH=/usr/ucb:$ENV{PATH} whoami`;\n \tmy $password = \"test\";\n \n-\tmy $srcdir=\"$RealBin/../..\";\n-\tmy $scriptdir=\"$srcdir/script/tests\";\n+\tmy $srcdir=\"$RealBin/..\";\n+\tmy $scriptdir=\"$srcdir/selftest\";\n \tmy $prefix_abs = abs_path($prefix);\n \tmy $shrdir=\"$prefix_abs/tmp\";\n \tmy $libdir=\"$prefix_abs/lib\";\n\nModified: branches/SAMBA_4_0/source/selftest/Samba4.pm\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/Samba4.pm\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/Samba4.pm\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -460,7 +460,7 @@\n \tmy $dnsname = \"samba.example.com\";\n \tmy $basedn = \"dc=samba,dc=example,dc=com\";\n \tmy $root = ($ENV{USER} or $ENV{LOGNAME} or `whoami`);\n-\tmy $srcdir=\"$RealBin/../..\";\n+\tmy $srcdir=\"$RealBin/..\";\n \t-d $prefix or mkdir($prefix, 0777) or die(\"Unable to create $prefix\");\n \tmy $prefix_abs = abs_path($prefix);\n \tmy $tmpdir = \"$prefix_abs/tmp\";\n\nModified: branches/SAMBA_4_0/source/selftest/Windows.pm\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/Windows.pm\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/Windows.pm\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -29,7 +29,7 @@\n \n \tdie (\"$ENV{WINTESTCONF} could not be read.\") if (! -r $ENV{WINTESTCONF});\n \n-\t$ENV{WINTEST_DIR}=\"$ENV{SRCDIR}/script/tests/win\";\n+\t$ENV{WINTEST_DIR}=\"$ENV{SRCDIR}/selftest/win\";\n }\n \n sub setup_env($$)\n\nModified: branches/SAMBA_4_0/source/selftest/selftest.pl\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/selftest.pl\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/selftest.pl\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -470,7 +470,7 @@\n \t$ENV{MALLOC_CHECK_} = 2;\n }\n \n-my $old_pwd = \"$RealBin/../..\";\n+my $old_pwd = \"$RealBin/..\";\n \n # Backwards compatibility:\n if (defined($ENV{TEST_LDAP}) and $ENV{TEST_LDAP} eq \"yes\") {\n@@ -644,7 +644,7 @@\n \n my @todo = ();\n \n-my $testsdir = \"$srcdir/script/tests\";\n+my $testsdir = \"$srcdir/selftest\";\n $ENV{CONFIGURATION} = \"--configfile=$conffile\";\n \n \n\nModified: branches/SAMBA_4_0/source/selftest/test_blackbox.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/test_blackbox.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/test_blackbox.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -16,7 +16,7 @@\n incdir=`dirname $0`\n . $incdir/test_functions.sh\n \n-plantest \"blackbox.smbclient\" dc $incdir/../../../testprogs/blackbox/test_smbclient.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$DOMAIN\" \"$PREFIX\" \"$ADDARGS\"\n-plantest \"blackbox.kinit\" dc $incdir/../../../testprogs/blackbox/test_kinit.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$REALM\" \"$PREFIX\" \"$ADDARGS\"\n+plantest \"blackbox.smbclient\" dc $incdir/../../testprogs/blackbox/test_smbclient.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$DOMAIN\" \"$PREFIX\" \"$ADDARGS\"\n+plantest \"blackbox.kinit\" dc $incdir/../../testprogs/blackbox/test_kinit.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$REALM\" \"$PREFIX\" \"$ADDARGS\"\n \n-plantest \"blackbox.cifsdd\" dc $incdir/../../../testprogs/blackbox/test_cifsdd.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$DOMAIN\" \"$ADDARGS\"\n+plantest \"blackbox.cifsdd\" dc $incdir/../../testprogs/blackbox/test_cifsdd.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$DOMAIN\" \"$ADDARGS\"\n\nModified: branches/SAMBA_4_0/source/selftest/test_s3upgrade.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/test_s3upgrade.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/test_s3upgrade.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -16,7 +16,7 @@\n mkdir -p $PREFIX\n rm -f $PREFIX/*\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n plantest \"parse samba3\" none bin/smbscript ../testdata/samba3/verify $CONFIGURATION ../testdata/samba3\n #plantest \"upgrade\" none bin/smbscript setup/upgrade $CONFIGURATION --verify --targetdir=$PREFIX ../testdata/samba3 ../testdata/samba3/smb.conf\n\nModified: branches/SAMBA_4_0/source/selftest/test_samba4.pl\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/test_samba4.pl\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/test_samba4.pl\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -5,13 +5,12 @@\n use lib $RealBin;\n use Samba4;\n \n-my $s = new Samba4($RealBin.\"/../../bin\", undef, $RealBin.\"/../../setup\");\n+my $s = new Samba4($RealBin.\"/../bin\", undef, $RealBin.\"/../setup\");\n \n ok($s);\n \n-is($RealBin.\"/../../bin\", $s->{bindir});\n+is($RealBin.\"/../bin\", $s->{bindir});\n \n-\n ok($s->write_ldb_file(\"tmpldb\", \"\n dn: a=b\n a: b\n\nModified: branches/SAMBA_4_0/source/selftest/test_win.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/test_win.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/test_win.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -7,7 +7,7 @@\n # Copyright Brad Henry  2006\n # Released under the GNU GPL v2 or later.\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n export SMBTORTURE_REMOTE_HOST=`perl -I$WINTEST_DIR $WINTEST_DIR/vm_get_ip.pl VM_CFG_PATH`\n if [ -z $SMBTORTURE_REMOTE_HOST ]; then\n\nModified: branches/SAMBA_4_0/source/selftest/tests_all.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/tests_all.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/tests_all.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -1,18 +1,18 @@\n #!/bin/sh\n- $SRCDIR/script/tests/test_ejs.sh $CONFIGURATION\n- $SRCDIR/script/tests/test_ldap.sh \n- $SRCDIR/script/tests/test_nbt.sh \"dc\"\n- $SRCDIR/script/tests/test_rpc.sh\n- $SRCDIR/script/tests/test_net.sh\n- $SRCDIR/script/tests/test_session_key.sh\n- $SRCDIR/script/tests/test_binding_string.sh\n- $SRCDIR/script/tests/test_echo.sh\n- $SRCDIR/script/tests/test_posix.sh\n- $SRCDIR/script/tests/test_cifs.sh\n- $SRCDIR/script/tests/test_local.sh\n- $SRCDIR/script/tests/test_pidl.sh\n- $SRCDIR/script/tests/test_blackbox.sh $PREFIX\n- $SRCDIR/script/tests/test_simple.sh\n- $SRCDIR/script/tests/test_s3upgrade.sh $PREFIX/upgrade\n- $SRCDIR/script/tests/test_member.sh\n- $SRCDIR/script/tests/test_nbt.sh \"member\"\n+ $SRCDIR/selftest/test_ejs.sh $CONFIGURATION\n+ $SRCDIR/selftest/test_ldap.sh \n+ $SRCDIR/selftest/test_nbt.sh \"dc\"\n+ $SRCDIR/selftest/test_rpc.sh\n+ $SRCDIR/selftest/test_net.sh\n+ $SRCDIR/selftest/test_session_key.sh\n+ $SRCDIR/selftest/test_binding_string.sh\n+ $SRCDIR/selftest/test_echo.sh\n+ $SRCDIR/selftest/test_posix.sh\n+ $SRCDIR/selftest/test_cifs.sh\n+ $SRCDIR/selftest/test_local.sh\n+ $SRCDIR/selftest/test_pidl.sh\n+ $SRCDIR/selftest/test_blackbox.sh $PREFIX\n+ $SRCDIR/selftest/test_simple.sh\n+ $SRCDIR/selftest/test_s3upgrade.sh $PREFIX/upgrade\n+ $SRCDIR/selftest/test_member.sh\n+ $SRCDIR/selftest/test_nbt.sh \"member\"\n\nModified: branches/SAMBA_4_0/source/selftest/tests_quick.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/tests_quick.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/tests_quick.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -2,8 +2,8 @@\n TORTURE_QUICK=\"yes\"\n export TORTURE_QUICK\n \n-$SRCDIR/script/tests/test_ejs.sh $CONFIGURATION\n-$SRCDIR/script/tests/test_ldap.sh\n-$SRCDIR/script/tests/test_nbt.sh\n-$SRCDIR/script/tests/test_quick.sh\n-$SRCDIR/script/tests/test_rpc_quick.sh\n+$SRCDIR/selftest/test_ejs.sh $CONFIGURATION\n+$SRCDIR/selftest/test_ldap.sh\n+$SRCDIR/selftest/test_nbt.sh\n+$SRCDIR/selftest/test_quick.sh\n+$SRCDIR/selftest/test_rpc_quick.sh\n\nModified: branches/SAMBA_4_0/source/selftest/tests_win.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/tests_win.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/tests_win.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -21,10 +21,10 @@\n        exit 1\n  fi\n \n- export WINTEST_DIR=$SRCDIR/script/tests/win\n+ export WINTEST_DIR=$SRCDIR/selftest/win\n  export TMPDIR=$TMPDIR\n  export NETBIOSNAME=$NETBIOSNAME\n \n  . $WINTESTCONF\n \n- $SRCDIR/script/tests/test_win.sh\n+ $SRCDIR/selftest/test_win.sh\n\nModified: branches/SAMBA_4_0/source/selftest/tests_win2k3_dc.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/tests_win2k3_dc.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/tests_win2k3_dc.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -11,12 +11,12 @@\n \texit 1\n fi\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n export SRCDIR=$SRCDIR\n \n tests=\"RPC-DRSUAPI RPC-SPOOLSS ncacn_np ncacn_ip_tcp\"\n \n for name in $tests; do\n-\ttestit $name rpc $SRCDIR/script/tests/win/wintest_2k3_dc.sh $name\n+\ttestit $name rpc $SRCDIR/selftest/win/wintest_2k3_dc.sh $name\n done\n\nModified: branches/SAMBA_4_0/source/selftest/win/README\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/win/README\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/win/README\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -77,7 +77,7 @@\n Windows tests in the build farm, a .fns file will need to be created for\n your new host that exports a WINTESTCONF environment variable pointing to a\n config file used by 'make wintest'. An example of this config file can be\n-found at source/script/tests/win/test_win.conf in the Samba 4 source tree. \n+found at source/selftest/win/test_win.conf in the Samba 4 source tree. \n \n I've also included the bnhtest.fns file that I'm using for my build farm host\n below, as an example. It was modified from generic.fns.\n\nModified: branches/SAMBA_4_0/source/selftest/win/wintest_base.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/win/wintest_base.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/win/wintest_base.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -1,8 +1,8 @@\n #!/bin/sh\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n-. script/tests/win/wintest_functions.sh\n+. selftest/win/wintest_functions.sh\n \n # This variable is defined in the per-hosts .fns file.\n . $WINTESTCONF\n\nModified: branches/SAMBA_4_0/source/selftest/win/wintest_client.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/win/wintest_client.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/win/wintest_client.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -1,8 +1,8 @@\n #!/bin/sh\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n-. script/tests/win/wintest_functions.sh\n+. selftest/win/wintest_functions.sh\n \n # This variable is defined in the per-hosts .fns file.\n . $WINTESTCONF\n\nModified: branches/SAMBA_4_0/source/selftest/win/wintest_net.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/win/wintest_net.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/win/wintest_net.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -1,8 +1,8 @@\n #!/bin/sh\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n-. script/tests/win/wintest_functions.sh\n+. selftest/win/wintest_functions.sh\n \n # This variable is defined in the per-hosts .fns file.\n . $WINTESTCONF\n\nModified: branches/SAMBA_4_0/source/selftest/win/wintest_raw.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/win/wintest_raw.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/win/wintest_raw.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -1,8 +1,8 @@\n #!/bin/sh\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n-. script/tests/win/wintest_functions.sh\n+. selftest/win/wintest_functions.sh\n \n # This variable is defined in the per-hosts .fns file.\n . $WINTESTCONF\n\nModified: branches/SAMBA_4_0/source/selftest/win/wintest_rpc.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/win/wintest_rpc.sh\t2007-04-29 13:54:51 UTC (rev 22571)\n+++ branches/SAMBA_4_0/source/selftest/win/wintest_rpc.sh\t2007-04-29 20:37:59 UTC (rev 22575)\n@@ -1,8 +1,8 @@\n #!/bin/sh\n \n-. script/tests/test_functions.sh\n+. selftest/test_functions.sh\n \n-. script/tests/win/wintest_functions.sh\n+. selftest/win/wintest_functions.sh\n \n # This variable is defined in the per-hosts .fns file.\n . $WINTESTCONF\n\n"}