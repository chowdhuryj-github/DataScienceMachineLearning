{"category": "ham", "to_address": "Perl beginners <beginners@perl.org>", "from_address": "\"John W. Krahn\" <krahnj@telus.net>", "subject": "Re: grep from one file and write to another", "body": "Vahid Moghaddasi wrote:\n> Hi all,\n\nHello,\n\n> I am trying to read a colon delimited text file (filter.in) then\n> search for each field in another file (/etc/passwd) and if it is found\n> then write that line in the third file (passwd.out). Here is what I\n> have written so far but it is not given me the correct result. Thanks\n> for any help.\n> \n> \n> #!/bin/perl\n> #\n> # the format of filter.in is user1:user2:user3:user4:\n> #\n> use File::Copy;\n> use strict;\n> use warnings;\n> $|=1;           # flush output buffer\n> open (FILTERfh, \"< filter.in\") || die \"Can not open filter.in: $!\\n\";\n> open PASSWDfh, ' open PASSWDFILfh, \">passwd.out\";\n> while () {\n> chomp;\n> my @input = split /:/, $_;\n>    for (my $user = 1; $user <= $#input ; $user++) {\n>        print \"$input[$user] is being added.\\n\";\n>        while () {\n>                my %seen;\n>                next if (m/^#/);        # Skip comments\n>                next if (m/^\\s*$/);     # Skip blank lines\n>                my ($field1) = /([^:]+)/;\n> #      print PASSWDFILfh $_ unless $seen{$field1} or warn\n> #      \"WARNING: User $input[$user] does not exist!\\n\";\n>      print PASSWDFILfh $_ unless $input[$user] or warn\n>      \"WARNING: User $input[$user] does not exist!\\n\";\n> # print PASSWDFILfh $_ if(\"$field1\" eq \"$input[$user]\");\n> #        print PASSWDFILfh $_ if( grep(/$field1:/, $_ )) or warn\n> \"WARNING: User $input[$user] does not exist!\\n\";\n>     } # while\n> } # for\n> } # while\n> close FILTERfh;\n> close PASSWDFILfh;\n> close PASSWDfh;\n\nSomething like this should work:\n\n#!/bin/perl\n#\n# the format of filter.in is user1:user2:user3:user4:\n#\nuse strict;\nuse warnings;\n\nopen FILTERfh,    '<', 'filter.in'  or die \"Can not open filter.in: $!\\n\";\nopen PASSWDFILfh, '>', 'passwd.out' or die \"Can not open passwd.out: $!\\n\";\n\nwhile (  ) {\n     chomp;\n     my @input = split /:/;\n     for ( @input ) {\n         if ( getpwnam $_ ) {\n             print PASSWDFILfh $_;\n             }\n         else {\n             warn \"WARNING: User $_ does not exist!\\n\";\n             }\n         }\n     }\n\nclose FILTERfh;\nclose PASSWDFILfh;\n\n\n\n\nJohn\n-- \nPerl isn't a toolbox, but a small machine shop where you\ncan special-order certain sorts of tools at low cost and\nin short order.                            -- Larry Wall\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}