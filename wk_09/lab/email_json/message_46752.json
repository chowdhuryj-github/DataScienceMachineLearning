{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba r23444 - in\n\tbranches/SAMBA_3_0_26/source/registry: .", "body": "Author: obnox\nDate: 2007-06-12 16:31:03 +0000 (Tue, 12 Jun 2007)\nNew Revision: 23444\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23444\n\nLog:\nMerge r20210 from3_0:\n\n* registry_fetch_values is not needed anymore\n* fix comment typo\n\nMichael\n\n\nModified:\n   branches/SAMBA_3_0_26/source/registry/reg_frontend.c\n   branches/SAMBA_3_0_26/source/registry/reg_printing.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0_26/source/registry/reg_frontend.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/registry/reg_frontend.c\t2007-06-12 16:18:19 UTC (rev 23443)\n+++ branches/SAMBA_3_0_26/source/registry/reg_frontend.c\t2007-06-12 16:31:03 UTC (rev 23444)\n@@ -246,63 +246,6 @@\n \treturn result;\n }\n \n-WERROR registry_fetch_values(TALLOC_CTX *mem_ctx, REGISTRY_KEY *key,\n-\t\t\t     uint32 *pnum_values, char ***pnames,\n-\t\t\t     struct registry_value ***pvalues)\n-{\n-\tREGVAL_CTR *ctr;\n-\tchar **names;\n-\tstruct registry_value **values;\n-\tuint32 i;\n-\n-\tif (!(ctr = TALLOC_ZERO_P(mem_ctx, REGVAL_CTR))) {\n-\t\treturn WERR_NOMEM;\n-\t}\n-\n-\tif (fetch_reg_values(key, ctr) == -1) {\n-\t\tTALLOC_FREE(ctr);\n-\t\treturn WERR_INVALID_PARAM;\n-\t}\n-\n-\tif (ctr->num_values == 0) {\n-\t\t*pnum_values = 0;\n-\t\tTALLOC_FREE(ctr);\n-\t\treturn WERR_OK;\n-\t}\n-\n-\tif ((!(names = TALLOC_ARRAY(ctr, char *, ctr->num_values))) ||\n-\t    (!(values = TALLOC_ARRAY(ctr, struct registry_value *,\n-\t\t\t\t     ctr->num_values)))) {\n-\t\tTALLOC_FREE(ctr);\n-\t\treturn WERR_NOMEM;\n-\t}\n-\n-\tfor (i=0; inum_values; i++) {\n-\t\tREGISTRY_VALUE *val = ctr->values[i];\n-\t\tWERROR err;\n-\n-\t\tif (!(names[i] = talloc_strdup(names, val->valuename))) {\n-\t\t\tTALLOC_FREE(ctr);\n-\t\t\treturn WERR_NOMEM;\n-\t\t}\n-\n-\t\terr = registry_pull_value(values, &values[i],\n-\t\t\t\t\t  val->type, val->data_p,\n-\t\t\t\t\t  val->size, val->size);\n-\t\tif (!W_ERROR_IS_OK(err)) {\n-\t\t\tTALLOC_FREE(ctr);\n-\t\t\treturn err;\n-\t\t}\n-\t}\n-\n-\t*pnum_values = ctr->num_values;\n-\t*pnames = talloc_move(mem_ctx, &names);\n-\t*pvalues = talloc_move(mem_ctx, &values);\n-\n-\tTALLOC_FREE(ctr);\n-\treturn WERR_OK;\n-}\n-\n /***********************************************************************\n  retreive a specific subkey specified by index.  Caller is \n  responsible for freeing memory\n\nModified: branches/SAMBA_3_0_26/source/registry/reg_printing.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/registry/reg_printing.c\t2007-06-12 16:18:19 UTC (rev 23443)\n+++ branches/SAMBA_3_0_26/source/registry/reg_printing.c\t2007-06-12 16:31:03 UTC (rev 23444)\n@@ -478,7 +478,7 @@\n \t/* top level key values stored in the registry has no values */\n \t\n \tif ( !printers_key ) {\n-\t\t/* normalize to the 'HKLM\\SOFTWARE\\...\\Print\\Printers' ket */\n+\t\t/* normalize to the 'HKLM\\SOFTWARE\\...\\Print\\Printers' key */\n \t\treturn regdb_fetch_values( KEY_WINNT_PRINTERS, values );\n \t}\n \t\n\n"}