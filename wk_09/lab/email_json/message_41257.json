{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jpeach@samba.org", "subject": "svn commit: samba r23312 - in branches: SAMBA_3_0/source/nsswitch\n\tSAMBA_3_0_26/source/nsswitch", "body": "Author: jpeach\nDate: 2007-06-02 21:12:47 +0000 (Sat, 02 Jun 2007)\nNew Revision: 23312\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23312\n\nLog:\nAs per Volker, rename the \"windbind:ads\" parameter \"winbind:rpc only\".\n\nModified:\n   branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\n   branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\t2007-06-02 11:38:27 UTC (rev 23311)\n+++ branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\t2007-06-02 21:12:47 UTC (rev 23312)\n@@ -133,9 +133,6 @@\n static struct winbind_cache *get_cache(struct winbindd_domain *domain)\n {\n \tstruct winbind_cache *ret = wcache;\n-#ifdef HAVE_ADS\n-\tstruct winbindd_domain *our_domain = domain;\n-#endif\n \n \t/* We have to know what type of domain we are dealing with first. */\n \n@@ -163,6 +160,8 @@\n \n \tif (!domain->backend) {\n #ifdef HAVE_ADS\n+\t\tstruct winbindd_domain *our_domain = domain;\n+\n \t\t/* find our domain first so we can figure out if we \n \t\t   are joined to a kerberized domain */\n \n@@ -171,7 +170,7 @@\n \n \t\tif ((our_domain->active_directory || IS_DC)\n \t\t    && domain->active_directory\n-\t\t    && lp_parm_bool(-1, \"winbind\", \"ads\", True)) {\n+\t\t    && !lp_parm_bool(-1, \"winbind\", \"rpc only\", False)) {\n \t\t\tDEBUG(5,(\"get_cache: Setting ADS methods for domain %s\\n\", domain->name));\n \t\t\tdomain->backend = &ads_methods;\n \t\t} else {\n\nModified: branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-06-02 11:38:27 UTC (rev 23311)\n+++ branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-06-02 21:12:47 UTC (rev 23312)\n@@ -133,9 +133,6 @@\n static struct winbind_cache *get_cache(struct winbindd_domain *domain)\n {\n \tstruct winbind_cache *ret = wcache;\n-#ifdef HAVE_ADS\n-\tstruct winbindd_domain *our_domain = domain;\n-#endif\n \n \t/* We have to know what type of domain we are dealing with first. */\n \n@@ -163,6 +160,8 @@\n \n \tif (!domain->backend) {\n #ifdef HAVE_ADS\n+\t\tstruct winbindd_domain *our_domain = domain;\n+\n \t\t/* find our domain first so we can figure out if we \n \t\t   are joined to a kerberized domain */\n \n@@ -171,7 +170,7 @@\n \n \t\tif ((our_domain->active_directory || IS_DC)\n \t\t    && domain->active_directory\n-\t\t    && lp_parm_bool(-1, \"winbind\", \"ads\", True)) {\n+\t\t    && !lp_parm_bool(-1, \"winbind\", \"rpc only\", False)) {\n \t\t\tDEBUG(5,(\"get_cache: Setting ADS methods for domain %s\\n\", domain->name));\n \t\t\tdomain->backend = &ads_methods;\n \t\t} else {\n\n"}