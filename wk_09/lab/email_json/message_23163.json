{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "mimir@samba.org", "subject": "svn commit: samba r22672 - in branches/SAMBA_4_0/source/libnet: .", "body": "Author: mimir\nDate: 2007-05-04 18:59:51 +0000 (Fri, 04 May 2007)\nNew Revision: 22672\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22672\n\nLog:\nuse composite_create calls instead of talloc_zero.\n\n\nrafal\n\n\nModified:\n   branches/SAMBA_4_0/source/libnet/libnet_rpc.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/libnet/libnet_rpc.c\n===================================================================\n--- branches/SAMBA_4_0/source/libnet/libnet_rpc.c\t2007-05-04 18:18:53 UTC (rev 22671)\n+++ branches/SAMBA_4_0/source/libnet/libnet_rpc.c\t2007-05-04 18:59:51 UTC (rev 22672)\n@@ -57,15 +57,13 @@\n \tstruct composite_context *pipe_connect_req;\n \n \t/* composite context allocation and setup */\n-\tc = talloc_zero(mem_ctx, struct composite_context);\n-\tif (c == NULL) return NULL;\n+\tc = composite_create(ctx, ctx->event_ctx);\n+\tif (c == NULL) return c;\n \n \ts = talloc_zero(c, struct rpc_connect_srv_state);\n \tif (composite_nomem(s, c)) return c;\n \n-\tc->state = COMPOSITE_STATE_IN_PROGRESS;\n \tc->private_data = s;\n-\tc->event_ctx = ctx->event_ctx;\n \n \ts->ctx = ctx;\n \ts->r = *r;\n@@ -218,15 +216,13 @@\n \tstruct composite_context *lookup_dc_req;\n \n \t/* composite context allocation and setup */\n-\tc = talloc_zero(mem_ctx, struct composite_context);\n-\tif (c == NULL) return NULL;\n+\tc = composite_create(ctx, ctx->event_ctx);\n+\tif (c == NULL) return c;\n \n \ts = talloc_zero(c, struct rpc_connect_dc_state);\n \tif (composite_nomem(s, c)) return c;\n \n-\tc->state = COMPOSITE_STATE_IN_PROGRESS;\n \tc->private_data = s;\n-\tc->event_ctx = ctx->event_ctx;\n \n \ts->ctx = ctx;\n \ts->r   = *r;\n@@ -433,15 +429,13 @@\n \tstruct rpc_connect_dci_state *s;\n \n \t/* composite context allocation and setup */\n-\tc = talloc_zero(mem_ctx, struct composite_context);\n-\tif (c == NULL) return NULL;\n+\tc = composite_create(ctx, ctx->event_ctx);\n+\tif (c == NULL) return c;\n \n \ts = talloc_zero(c, struct rpc_connect_dci_state);\n \tif (composite_nomem(s, c)) return c;\n \n-\tc->state = COMPOSITE_STATE_IN_PROGRESS;\n \tc->private_data = s;\n-\tc->event_ctx = ctx->event_ctx;\n \n \ts->ctx = ctx;\n \ts->r   = *r;\n\n"}