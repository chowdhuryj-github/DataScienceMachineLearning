{"category": "ham", "to_address": "James Peach <jpeach@samba.org>", "from_address": "\"Gerald (Jerry) Carter\" <jerry@samba.org>", "subject": "Re: [patch] hide libsmbclient's private symbols", "body": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\nJames,\n\n> The rules might look like this for a gcc-based toolchain. The only\n> problem remaining is how to express the DSO version number in a generic\n> way.\n> \n> DSO_EXPORTS = -Wl,--version-script,exports/`basename $@ |\\\n>\tsed -e/@SHLIBEXT@/syms/`\n> SHLD_DSO = $(SHLD) $(LDSHFLAGS) $(DSO_EXPORTS) \\\n>\t@SONAMEFLAG@`basename $@`.$(XXXXXX_MAJOR)\n>\n> bin/libsmbclient.@SHLIBEXT@: $(BINARY_PREREQS) $(LIBSMBCLIENT_OBJ)\n>    @echo Linking libsmbclient shared library $@\n>    @$(SHLD_DSO) $(LIBSMBCLIENT_OBJ) $(LIBS) $(KRB5LIBS) \\\n>     $(LDAP_LIBS) $(NSCD_LIBS)\n\nI poked around and the only thing I could think of was\nwas to store the library versions outside of the Makefile\nand read them from the file. For example,\n\n  DSO_EXPORTS = -Wl,--version-script,exports/`basename $@ |\\\n\tsed -e/@SHLIBEXT@/syms/`\n  SONAME_VER = `grep $@ $(srcdir)/library-versions | cut -d: -t2`\n  SHLD_DSO = $(SHLD) $(LDSHFLAGS) $(DSO_EXPORTS) \\\n\t@SONAMEFLAG@`basename $@`.$(SONAME_VER)\n\nand library-versions.in looks like\n\n  # Makefile_target:major:minor\n  bin/libsmbclient.@SHLIBEXT@:0:1\n\nHow about that?\n\n\n\ncheers, jerry\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.6 (GNU/Linux)\nComment: Using GnuPG with Mozilla - http://enigmail.mozdev.org\n\niD8DBQFGiWN1IR7qMdg1EfYRAqOPAJ9BE/KUbfIyOGIaev4QTjfeE3XFyQCfYRXj\n9cpEHlWdrz8HoJL4I1Sp4pc=\n=Znez\n-----END PGP SIGNATURE-----\n\n"}