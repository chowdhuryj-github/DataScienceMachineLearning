{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "adschai@optonline.net", "subject": "[R] Fit sem: problem of 'Error in solve.default(C[ind,\n ind]) : Lapack routine dgesv: system is exactly singular.'", "body": "Hi - I would need help another time. I would the model and wire the correlation matrix into the sem() method. I got the system is exactly singular? Is my model underidentified? Here I have my model below along with the result from traceback() funciton. Any help would be really appreciated. Thank you again!\n\n    Average_Daily_Traffic -> Lat_Env,                     gam1_1,           NA\n    Average_Daily_Truck_Traffic -> Lat_Env,               gam1_2,           NA\n    BridgeAges -> Lat_Env,                                gam1_3,           NA\n    \n    Design_Load -> Lat_Specs,                             gam2_1,           NA\n    Type_of_Service_On_Bridge -> Lat_Specs,               gam2_2,           NA\n    Railroad_Beneath -> Lat_Specs,                        gam2_3,           NA\n    BridgeAges -> Lat_Specs,                              gam2_4,           NA\n    Highway_Beneath -> Lat_Specs,                         gam2_5,           NA\n    \n    Main_Structure_Material -> Lat_Design,                gam3_1,           NA\n    Main_Structure_Design -> Lat_Design,                  gam3_2,           NA\n    Length_of_Maximum_Span -> Lat_Design,                 gam3_4,           NA\n    Number_of_Spans_In_Main_Unit -> Lat_Design,           gam3_5,           NA\n    BridgeAges -> Lat_Design,                             gam3_6,           NA\n    \n    Lat_Env -> Lat_Specs,                                 beta2_1,          NA\n    Lat_Env -> Lat_Design,                                beta3_1,          NA\n    Lat_Specs -> Lat_Env,                                 beta1_2,          NA\n    Lat_Specs -> Lat_Design,                              beta3_2,          NA\n    Lat_Design -> Lat_Env,                                beta1_3,          NA\n    Lat_Design -> Lat_Specs,                              beta1_2,          NA\n    \n    Lat_Env -> Operating_Rating,                          NA,               1\n    Lat_Env -> Deck_Cond_Rating,                          lamy2_1,          NA\n    Lat_Env -> Superstructure_Cond_Rating,                lamy3_1,          NA\n    Lat_Env -> Substructure_Cond_Rating,                  lamy4_1,          NA\n    Lat_Specs -> Operating_Rating,                        NA,               1\n    Lat_Specs -> Deck_Cond_Rating,                        lamy2_2,          NA\n    Lat_Specs -> Superstructure_Cond_Rating,              lamy3_2,          NA\n    Lat_Specs -> Substructure_Cond_Rating,                lamy4_2,          NA\n    Lat_Design -> Operating_Rating,                       NA,               1\n    Lat_Design -> Deck_Cond_Rating,                       lamy2_3,          NA\n    Lat_Design -> Superstructure_Cond_Rating,             lamy3_3,          NA\n    Lat_Design -> Substructure_Cond_Rating,               lamy4_3,          NA\n    \n    Lat_Env <-> Lat_Specs,                                psi2_1,           NA\n    Lat_Env <-> Lat_Design,                               psi3_1,           NA\n    Lat_Specs <-> Lat_Design,                             psi3_2,           NA\n    Lat_Env <-> Lat_Env,                                  psi1_1,           NA\n    Lat_Specs <-> Lat_Specs,                              psi2_2,           NA\n    Lat_Design <-> Lat_Design,                            psi3_3,           NA\n    \n    Operating_Rating <-> Operating_Rating,                thesp1,           NA\n    Deck_Cond_Rating <-> Deck_Cond_Rating,                thesp2,           NA\n    Superstructure_Cond_Rating <-> Superstructure_Cond_Rating,  thesp3,     NA\n    Substructure_Cond_Rating <-> Substructure_Cond_Rating, thesp4,           NA\n    \n    Average_Daily_Traffic <-> Average_Daily_Traffic,      theps5,           NA\n    Average_Daily_Truck_Traffic <-> Average_Daily_Truck_Traffic, thesp6,    NA\n    Design_Load <-> Design_Load,                          thesp7,           NA\n    Type_of_Service_On_Bridge <-> Type_of_Service_On_Bridge, thesp8,        NA\n    Railroad_Beneath <-> Railroad_Beneath,                thesp9,           NA\n    Highway_Beneath <-> Highway_Beneath,                  thesp10,           NA\n    Main_Structure_Material <-> Main_Structure_Material,  thesp11,           NA\n    Main_Structure_Design <-> Main_Structure_Design,      thesp12,           NA\n    Number_of_Spans_In_Main_Unit <-> Number_of_Spans_In_Main_Unit, thesp13,  NA\n    BridgeAges <-> BridgeAges,                            thesp14,          NA\n    Length_of_Maximum_Span <-> Length_of_Maximum_Span,    thesp15,          NA\n\n===================================\nResult from traceback():\n\n observed variables:\n [1] \"1:Type_of_Service_On_Bridge\"     \"2:BridgeAges\"                   \n [3] \"3:Average_Daily_Traffic\"         \"4:Average_Daily_Truck_Traffic\"  \n [5] \"5:Design_Load\"                   \"6:Railroad_Beneath\"             \n [7] \"7:Highway_Beneath\"               \"8:Main_Structure_Material\"      \n [9] \"9:Main_Structure_Design\"         \"10:Length_of_Maximum_Span\"      \n[11] \"11:Number_of_Spans_In_Main_Unit\" \"12:Operating_Rating\"            \n[13] \"13:Deck_Cond_Rating\"             \"14:Superstructure_Cond_Rating\"  \n[15] \"15:Substructure_Cond_Rating\"    \n\n latent variables:\n[1] \"16:Lat_Env\"    \"17:Lat_Specs\"  \"18:Lat_Design\"\n\n parameters:\n [1] \"1:gam1_1\"   \"2:gam1_2\"   \"3:gam1_3\"   \"4:gam2_1\"   \"5:gam2_2\"  \n [6] \"6:gam2_3\"   \"7:gam2_4\"   \"8:gam2_5\"   \"9:gam3_1\"   \"10:gam3_2\" \n[11] \"11:gam3_4\"  \"12:gam3_5\"  \"13:gam3_6\"  \"14:beta2_1\" \"15:beta3_1\"\n[16] \"16:beta1_2\" \"17:beta3_2\" \"18:beta1_3\" \"19:lamy2_1\" \"20:lamy3_1\"\n[21] \"21:lamy4_1\" \"22:lamy2_2\" \"23:lamy3_2\" \"24:lamy4_2\" \"25:lamy2_3\"\n[26] \"26:lamy3_3\" \"27:lamy4_3\" \"28:psi2_1\"  \"29:psi3_1\"  \"30:psi3_2\" \n[31] \"31:psi1_1\"  \"32:psi2_2\"  \"33:psi3_3\"  \"34:thesp1\"  \"35:thesp2\" \n[36] \"36:thesp3\"  \"37:thesp4\"  \"38:theps5\"  \"39:thesp6\"  \"40:thesp7\" \n[41] \"41:thesp8\"  \"42:thesp9\"  \"43:thesp10\" \"44:thesp11\" \"45:thesp12\"\n[46] \"46:thesp13\" \"47:thesp14\" \"48:thesp15\"\n\n RAM:\n      heads to from parameter start\n [1,]     1 16    3         1    NA\n [2,]     1 16    4         2    NA\n [3,]     1 16    2         3    NA\n [4,]     1 17    5         4    NA\n [5,]     1 17    1         5    NA\n [6,]     1 17    6         6    NA\n [7,]     1 17    2         7    NA\n [8,]     1 17    7         8    NA\n [9,]     1 18    8         9    NA\n[10,]     1 18    9        10    NA\n[11,]     1 18   10        11    NA\n[12,]     1 18   11        12    NA\n[13,]     1 18    2        13    NA\n[14,]     1 17   16        14    NA\n[15,]     1 18   16        15    NA\n[16,]     1 16   17        16    NA\n[17,]     1 18   17        17    NA\n[18,]     1 16   18        18    NA\n[19,]     1 17   18        16    NA\n[20,]     1 12   16         0     1\n[21,]     1 13   16        19    NA\n[22,]     1 14   16        20    NA\n[23,]     1 15   16        21    NA\n[24,]     1 12   17         0     1\n[25,]     1 13   17        22    NA\n[26,]     1 14   17        23    NA\n[27,]     1 15   17        24    NA\n[28,]     1 12   18         0     1\n[29,]     1 13   18        25    NA\n[30,]     1 14   18        26    NA\n[31,]     1 15   18        27    NA\n[32,]     2 17   16        28    NA\n[33,]     2 18   16        29    NA\n[34,]     2 18   17        30    NA\n[35,]     2 16   16        31    NA\n[36,]     2 17   17        32    NA\n[37,]     2 18   18        33    NA\n[38,]     2 12   12        34    NA\n[39,]     2 13   13        35    NA\n[40,]     2 14   14        36    NA\n[41,]     2 15   15        37    NA\n[42,]     2  3    3        38    NA\n[43,]     2  4    4        39    NA\n[44,]     2  5    5        40    NA\n[45,]     2  1    1        41    NA\n[46,]     2  6    6        42    NA\n[47,]     2  7    7        43    NA\n[48,]     2  8    8        44    NA\n[49,]     2  9    9        45    NA\n[50,]     2 11   11        46    NA\n[51,]     2  2    2        47    NA\n[52,]     2 10   10        48    NA\nError in solve.default(C[ind, ind]) : Lapack routine dgesv: system is exactly singular\n\n\n \n\n----- Original Message -----\nFrom: adschai@optonline.net\nDate: Sunday, April 15, 2007 1:19 pm\nSubject: Re: [R] Fit sem model with intercept\nTo: r-help@stat.math.ethz.ch\n\n> Thank you John. I got it now. \n> Regarding the model I specified below, I totally agree with you. \n> I listed only portions of my model the illustrate the point of \n> my questions. Therefore, I showed only the arrow part. No \n> correlations are listed here. However, I have those in my \n> complete model.\n> Thank you so much for your help. It was really helpful.\n> \n> - adschai\n> \n> ----- Original Message -----\n> From: John Fox \n> Date: Sunday, April 15, 2007 8:31 am\n> Subject: RE: [R] Fit sem model with intercept\n> To: adschai@optonline.net\n> Cc: r-help@stat.math.ethz.ch\n> \n> > Dear adschai,\n> > \n> > You needn't look too far, since the last example in ?sem is \n> for \n> > a model with\n> > an intercept. One would use the raw-moment matrix as input to \n> > sem(), either\n> > entered directly or calculated with the raw.moments() function \n> > in the sem\n> > package. The row/column of the raw-moment matrix is given a \n> name \n> > just like\n> > the other columns. You could use the name \"1\"; in the example, \n> > the name is\n> > \"UNIT\".\n> > \n> > As you say, however, you're using polychoric and polyserial \n> > correlations as\n> > input. Since the origin and scale of the latent continuous variables\n> > underlying the ordinal variables are entirely arbitrary, I \n> can't \n> > imaginewhat the purpose of a model with an intercept would be, \n> > but it's possible\n> > that I'm missing something. If you think that this makes some \n> > sense, then\n> > you could convert the correlations to raw moments by using the \n> > means and\n> > standard deviations of the observed variables along with the \n> > means and\n> > standard deviations that you assign to the latent variables \n> > derived from the\n> > ordinal variables (the latter on what basis I can't imagine, \n> but \n> > I suppose\n> > you could fix them to 0s and 1s).\n> > \n> > Finally, if the sem model that you show is meant to be a complete\n> > specification, I notice that it includes no covariance \n> > components; moreover,\n> > if this is the complete structural part of the model, then I \n> > think it is\n> > underidentified, and the two parts of the model (those \n> involving \n> > eta1 and\n> > eta2) appear entirely separate.\n> > \n> > I hope this helps,\n> > John\n> > \n> > --------------------------------\n> > John Fox\n> > Department of Sociology\n> > McMaster University\n> > Hamilton, Ontario\n> > Canada L8S 4M4\n> > 905-525-9140x23604\n> > http://socserv.mcmaster.ca/jfox \n> > -------------------------------- \n> > \n> > > -----Original Message-----\n> > > From: r-help-bounces@stat.math.ethz.ch \n> > > [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of \n> > > adschai@optonline.net\n> > > Sent: Sunday, April 15, 2007 4:28 AM\n> > > To: r-help@stat.math.ethz.ch\n> > > Subject: [R] Fit sem model with intercept\n> > > \n> > > Hi - I am trying to fit sem model with intercepts. Here is \n> > > what I have in my model.\n> > > \n> > > Exogeneous vars: x1 (continous), x2 (ordinal), x3 (ordinal), \n> > > x4(continuous) Endogeneous vars: y1 (continuous), y2 \n> > > (ordinal), y3 (ordinal)\n> > > \n> > > SEM model:\n> > > x1 -> eta1; x2 -> eta1; x3 -> eta2; x4 -> eta2; eta1 -> \n> > > y1, eta1 -> y2, eta2 -> y2, eta2 -> y3 \n> > > \n> > > However, in these arrow models, I don't know how to add \n> > > intercept onto it. I am trying to find an example code using \n> > > sem package on how to incorporate intercept but cannot find \n> > > any documents on the web. Or we can simply add something \n> like \n> > > this? '1 -> eta1'? This is my first question. \n> > > \n> > > Also, note that since my y2 and y3 are ordinal, I used the \n> > > 'hetcor' to calculate correlation of observed variables. \n> > > However, from the document, I would need to use the \n> > > covariance matrix rather then the correlation. And I need \n> > > additional column for 1. I am not sure how this matrix \n> should \n> > > look like and how I can obtain this? If there is any example \n> > > you could point me to, I would really appreciate. Thank you.\n> > > \n> > > - adschai\n> > > \n> > > [[alternative HTML version deleted]]\n> > > \n> > > ______________________________________________\n> > > R-help@stat.math.ethz.ch mailing list\n> > > https://stat.ethz.ch/mailman/listinfo/r-help\n> > > PLEASE do read the posting guide \n> > > http://www.R-project.org/posting-guide.html\n> > > and provide commented, minimal, self-contained, reproducible code.\n> > > \n> > \n> > \n> > \n> \n> [[alternative HTML version deleted]]\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-\n> project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n> \n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}