{"category": "ham", "to_address": "Birgit Lemcke <birgit.lemcke@systbot.uzh.ch>", "from_address": "Gavin Simpson <gavin.simpson@ucl.ac.uk>", "subject": "Re: [R] How to extract diagonals", "body": "On Wed, 2007-06-20 at 15:09 +0200, Birgit Lemcke wrote:\n> Hello Gavin and thanks for your answer.\n> \n> Your completely right I dont need the diagonal that is the bisecting  \n> line of the angle.\n> \n> I need another diagonal of the (now) matrix.\n> \n>          A1 A2 A3 A4 B1 B2 B3 B4\n>     A1\n>     A2\n>     A3\n>     A4\n>     B1 X\n>     B2       X\n>     B3            X\n>     B4                 X\n> \n\nNot easily, especially without knowing how many samples are in A or B,\nalthough all that is really needed is some careful subsetting of the\ndist object and a minor amount of programming - unfortunately after\nclose to two weeks intensive teaching my brain isn't up to doing that\njust now.\n\nOne simple way to do this is to use the distance() function in my\nanalogue package (on CRAN). distance() can calculate the dissimilarities\nbetween one group of samples and another. Here is a simple example using\nsome dummy data, from ?distance:\n\n     ## simple example using dummy data\n     train <- data.frame(matrix(abs(runif(200)), ncol = 10))\n     rownames(train) <- LETTERS[1:20]\n     colnames(train) <- as.character(1:10)\n     fossil <- data.frame(matrix(abs(runif(100)), ncol = 10))\n     colnames(fossil) <- as.character(1:10)\n     rownames(fossil) <- letters[1:10]\n\n     ## calculate distances/dissimilarities between train and fossil\n     ## samples\n     test <- distance(train, fossil)\n\ntest is now a matrix, the diagonal elements of which are the values that\nyou appear to want:\n\n     diag(test)\n\nif I'm reading your diagram correctly. Note that for this, you need to\nbe comparing row 1 from matrix A with row 1 from matrix B - if they are\nin some other order, then this won't work.\n\ndistance() has a version of Gower's coefficient for mixed that allows\nyou to specify weights. The function is just about clever enough to\nallow missing values if you use method = \"mixed\" in distance(). Be sure\nto read up about Gower's mixed coefficient in his 1971 paper (Gower,\n1971, Biometrics 23; 623--637) and the use that weights and the range\nparameter Rj are put to, or see the relevant section in Legendre &\nLegendre (1998).\n\n> I need for example the diagonal that compares A1 with B1.\n> Do you have an idea how I can handle this?\n> \n> What is the effect of this code?\n> \n> all.equal(diags, diag(as.matrix(dis.bc)))\n\nThis was showing you that the diagonals of the dissimilarity matrix are\njust a vector of zeroes. all.equal tests equality of its arguments.\n\n> \n> Thanks a lot and sorry for my inability to solve my problems on my own.\n\nYou're welcome. Using R is a learning experience. You only need to\ngrovel and apologise if you have not done your homework before posting\nand not read the FAQ, the documentation or searched the archives, or\nfollowed the posting guide. Which is not the case here.\n\nHTH\n\nG\n\n> \n> Am 20.06.2007 um 14:11 schrieb Gavin Simpson:\n> \n> > On Wed, 2007-06-20 at 13:26 +0200, Birgit Lemcke wrote:\n> >> Hello,\n> >>\n> >> I am using Mac OS X on a power book and R 2.5.0\n> >>\n> >> I try to extract a diagonal from a dissimilarity matrix made with\n> >> dsvdis, with this code:\n> >>\n> >> diag(DiTestRR)\n> >>\n> >> But I get this error message:\n> >>\n> >> Fehler in array(0, c(n, p)) : 'dim' spezifiziert ein zu groes Array\n> >>\n> >> english:\n> >>\n> >> Error in array(0, c(n, p)) : 'dim' specifies a too big array.\n> >>\n> >> Is there a limit to extract diagonals?\n> >\n> > The returned object is not a matrix, but an object of class \"dist\"  \n> > which\n> > doesn't store the diagonals or the upper triangle of the dissimilarity\n> > matrix to save memory. You need to convert the dist object to a matrix\n> > first, then extract the diagonal. But, as this shows:\n> >\n> >> require(labdsv)\n> >> ?dsvdis\n> >> data(bryceveg)\n> >> ?dsvdis\n> >> dis.bc <- dsvdis(bryceveg,index=\"bray/curtis\")\n> > Warning in symbol.For(\"dsvdis\") : 'symbol.For' is not needed: please\n> > remove it\n> >> diag(as.matrix(dis.bc))\n> >\n> > This is meaningless as the diagonals are all zero, as they should be;\n> > this is the distance between a site and itself.\n> >\n> >>\n> >> I hope somebody will help me!\n> >\n> > So perhaps you could explain why you want the diagonal. It would be\n> > easier to just do:\n> >\n> > diags <- rep(0, length = nrow(bryceveg))\n> >\n> > That will be without the sample labels, but that is easily rectified\n> >\n> >> names(diags) <- rownames(bryceveg)\n> >> all.equal(diags, diag(as.matrix(dis.bc)))\n> > [1] TRUE\n> >\n> > So you'll have to reformulate your question if this is not what you\n> > wanted.\n> >\n> > A word of warning, do not do diag(dis.bc)) on the above as it  \n> > brought my\n> > Linux box to it's knees trying to do something silly - easily\n> > recoverable, but beware.\n> >\n> > HTH\n> >\n> > G\n> >\n> >>\n> >> Greetings\n> >>\n> >> Birgit Lemcke\n> >\n> > -- \n> > %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%\n> >  Gavin Simpson                 [t] +44 (0)20 7679 0522\n> >  ECRC, UCL Geography,          [f] +44 (0)20 7679 0565\n> >  Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk\n> >  Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/\n> >  UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk\n> > %~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%\n> >\n> \n> Birgit Lemcke\n> Institut fr Systematische Botanik\n> Zollikerstrasse 107\n> CH-8008 Zrich\n> Switzerland\n> Ph: +41 (0)44 634 8351\n> birgit.lemcke@systbot.uzh.ch\n> \n> \n> \n> \n> \n> \n> \t[[alternative HTML version deleted]]\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n-- \n%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%\n Gavin Simpson                 [t] +44 (0)20 7679 0522\n ECRC, UCL Geography,          [f] +44 (0)20 7679 0565\n Pearson Building,             [e] gavin.simpsonATNOSPAMucl.ac.uk\n Gower Street, London          [w] http://www.ucl.ac.uk/~ucfagls/\n UK. WC1E 6BT.                 [w] http://www.freshwaters.org.uk\n%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%~%\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}