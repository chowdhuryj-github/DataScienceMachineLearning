{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "gd@samba.org", "subject": "svn commit: samba r23563 - in branches: SAMBA_3_0/source/include\n\tSAMBA_3_0/source/utils SAMBA_3_0_26/source/include\n\tSAMBA_3_0_26/source/utils", "body": "Author: gd\nDate: 2007-06-21 13:04:28 +0000 (Thu, 21 Jun 2007)\nNew Revision: 23563\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23563\n\nLog:\nAdd dump-event-list command to smbcontrol.\n\nGuenther\n\nModified:\n   branches/SAMBA_3_0/source/include/messages.h\n   branches/SAMBA_3_0/source/utils/smbcontrol.c\n   branches/SAMBA_3_0_26/source/include/messages.h\n   branches/SAMBA_3_0_26/source/utils/smbcontrol.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/include/messages.h\n===================================================================\n--- branches/SAMBA_3_0/source/include/messages.h\t2007-06-21 13:03:27 UTC (rev 23562)\n+++ branches/SAMBA_3_0/source/include/messages.h\t2007-06-21 13:04:28 UTC (rev 23563)\n@@ -98,6 +98,9 @@\n #define MSG_WINBIND_TRY_TO_GO_ONLINE\t0x0406\n #define MSG_WINBIND_FAILED_TO_GO_ONLINE 0x0407\n \n+/* event messages */\n+#define MSG_DUMP_EVENT_LIST\t\t0x0500\n+\n /*\n  * Special flags passed to message_send. Allocated from the top, lets see when\n  * it collides with the message types in the lower 16 bits :-)\n\nModified: branches/SAMBA_3_0/source/utils/smbcontrol.c\n===================================================================\n--- branches/SAMBA_3_0/source/utils/smbcontrol.c\t2007-06-21 13:03:27 UTC (rev 23562)\n+++ branches/SAMBA_3_0/source/utils/smbcontrol.c\t2007-06-21 13:04:28 UTC (rev 23563)\n@@ -982,7 +982,23 @@\n \treturn num_replies;\n }\n \n+static BOOL do_dump_event_list(struct messaging_context *msg_ctx,\n+\t\t\t       const struct server_id pid,\n+\t\t\t       const int argc, const char **argv)\n+{\n+\tstruct server_id myid;\n \n+\tmyid = pid_to_procid(sys_getpid());\n+\n+\tif (argc != 1) {\n+\t\tfprintf(stderr, \"Usage: smbcontrol  dump-event-list\\n\");\n+\t\treturn False;\n+\t}\n+\n+\treturn send_message(msg_ctx, pid, MSG_DUMP_EVENT_LIST, NULL, 0);\n+}\n+\n+\n static BOOL do_reload_config(struct messaging_context *msg_ctx,\n \t\t\t     const struct server_id pid,\n \t\t\t     const int argc, const char **argv)\n@@ -1079,6 +1095,7 @@\n \t{ \"online\", do_winbind_online, \"Ask winbind to go into online state\"},\n \t{ \"offline\", do_winbind_offline, \"Ask winbind to go into offline state\"},\n \t{ \"onlinestatus\", do_winbind_onlinestatus, \"Request winbind online status\"},\n+\t{ \"dump-event-list\", do_dump_event_list, \"Dump event list\"},\n \t{ \"noop\", do_noop, \"Do nothing\" },\n \t{ NULL }\n };\n\nModified: branches/SAMBA_3_0_26/source/include/messages.h\n===================================================================\n--- branches/SAMBA_3_0_26/source/include/messages.h\t2007-06-21 13:03:27 UTC (rev 23562)\n+++ branches/SAMBA_3_0_26/source/include/messages.h\t2007-06-21 13:04:28 UTC (rev 23563)\n@@ -98,6 +98,9 @@\n #define MSG_WINBIND_TRY_TO_GO_ONLINE\t0x0406\n #define MSG_WINBIND_FAILED_TO_GO_ONLINE 0x0407\n \n+/* event messages */\n+#define MSG_DUMP_EVENT_LIST\t\t0x0500\n+\n /*\n  * Special flags passed to message_send. Allocated from the top, lets see when\n  * it collides with the message types in the lower 16 bits :-)\n\nModified: branches/SAMBA_3_0_26/source/utils/smbcontrol.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/utils/smbcontrol.c\t2007-06-21 13:03:27 UTC (rev 23562)\n+++ branches/SAMBA_3_0_26/source/utils/smbcontrol.c\t2007-06-21 13:04:28 UTC (rev 23563)\n@@ -982,7 +982,23 @@\n \treturn num_replies;\n }\n \n+static BOOL do_dump_event_list(struct messaging_context *msg_ctx,\n+\t\t\t       const struct server_id pid,\n+\t\t\t       const int argc, const char **argv)\n+{\n+\tstruct server_id myid;\n \n+\tmyid = pid_to_procid(sys_getpid());\n+\n+\tif (argc != 1) {\n+\t\tfprintf(stderr, \"Usage: smbcontrol  dump-event-list\\n\");\n+\t\treturn False;\n+\t}\n+\n+\treturn send_message(msg_ctx, pid, MSG_DUMP_EVENT_LIST, NULL, 0);\n+}\n+\n+\n static BOOL do_reload_config(struct messaging_context *msg_ctx,\n \t\t\t     const struct server_id pid,\n \t\t\t     const int argc, const char **argv)\n@@ -1079,6 +1095,7 @@\n \t{ \"online\", do_winbind_online, \"Ask winbind to go into online state\"},\n \t{ \"offline\", do_winbind_offline, \"Ask winbind to go into offline state\"},\n \t{ \"onlinestatus\", do_winbind_onlinestatus, \"Request winbind online status\"},\n+\t{ \"dump-event-list\", do_dump_event_list, \"Dump event list\"},\n \t{ \"noop\", do_noop, \"Do nothing\" },\n \t{ NULL }\n };\n\n"}