{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "Jeremy Allison <jra@samba.org>", "subject": "Re: svn commit: samba r22132 - in branches:\n\tSAMBA_3_0/source/modules SAMBA_3_0/source/smbd\n\tSAMBA_3_0_25/source/modules SAMBA_3_0_25/source/smbd", "body": "On Sun, Apr 08, 2007 at 03:25:55PM -0700, James Peach wrote:\n> On 08/04/2007, at 12:41 PM, jra@samba.org wrote:\n> \n> >Author: jra\n> >Date: 2007-04-08 19:41:47 +0000 (Sun, 08 Apr 2007)\n> >New Revision: 22132\n> >\n> >WebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi? \n> >view=rev&root=samba&rev=22132\n> >\n> >Log:\n> >I hate inefficiency. Don't call conv_str_size()\n> >on every pread/sendfile call, initialize these\n> >variables in an allocated struct at connection\n> >time and just refer to them directly.\n> \n> This code is so close to vfs_cacheprime that I'm tempted to suggest  \n> they should be merged. Was there a particular reason you didn't do this?\n\nYes - mine is much simpler :-). I was just doing\nthe minimal thing that works for Vista.\n\nDoing cacheprime isn't the same as the readahead()\nsystem call on Linux. posix_fadvise is close enough\nthat I could squeeze it in....\n\nThis code gives a marked speed increase for Vista\nclients when using explorer against Linux servers.\n\nJeremy.\n\n"}