{"category": "ham", "to_address": "beginners@perl.org", "from_address": "kens <kenslaterpa@hotmail.com>", "subject": "Re: Problem with runaway format", "body": "On Jul 1, 5:40 am, theill...@yahoo.com (Mathew Snyder) wrote:\n> I have a script which places data 4 levels deep in a HoHoHoH.  It grabs tickets\n> in our ticket system using the systems API and places attributes about each\n> piece of activity into the hash. The has is called %tickets.  It looks like\n>\n> $tickets{action_creator}{ticket_customer}{ticket_number}{ticket_subject}.\n>\n> Each is self explanatory with the value under ticket_subject being the total\n> time the action creator spent on the whole ticket.  The actual code\n>\n> # gather up all of the tickets, transactions, and time for each user and\n> successively place\n> # all data into a HoHoH working down from user to environment to ticket\n> # we go through each date in the range individually so we can make sure we only\n> get the transactions that\n> # have been added during the date range\n> foreach my $date (@searchDate) {\n>         while (my $ticket = $tix->Next) {\n>                 $tikSubj{$ticket->id} = $ticket->Subject;\n>                 my $env = $ticket->FirstCustomFieldValue('Environment');\n>                 my $transactions = $ticket->Transactions;\n>                 while (my $transaction  = $transactions->Next) {\n>                         my $creator     = $transaction->CreatorObj;\n>\n>                         # we need to make sure the transaction is in the date\n> range requested\n>                         # it's set up like this so we can chop the timestamp off\n> of the Created string\n>                         (my $checkDate  = $transaction->Created) =~ s/\\s.*$//;\n>\n>                         # we only want transactions that are within the date\n> range, have TimeWorked\n>                         # set, and the creator of which is one of the actual\n> users and not someone\n>                         # that was created upon ticket submission or Cc addition\n>                         next unless (($checkDate eq $date) &&\n> ($creator->Privileged) && ($transaction->TimeTaken));\n>\n>                         # if all of the above stipulations are met add the time\n> worked to the hash\n>\n> $tickets{$creator->Name}{$env}{$ticket->id}{$ticket->Subject} +=\n> $transaction->TimeTaken;\n>                 }\n>         }\n>\n> }\n>\n> And the formatting\n>\n> foreach my $user (keys %tickets) {\n>         open TIMESHEET,\n> \">/work_reports/ticketlists/ticketlists_$endDate/ticketlist_$user\" . \"_\" .\n> \"$endDate.txt\" or die \"Can't open file: $!\";\n>         print TIMESHEET \"List of tickets worked on by $user during week ending\n> $endDate\", \"\\n\\n\";\n>\n>         foreach my $env (sort keys %{ $tickets{$user} }){\n>\n> format TIMESHEET_TOP =\n> @<<<<<<<<<<<<<<<<<<<<\n> $env\n>  Ticket ID                      Subject                      hh:mm\n> ------------------------------------------------------------------\n> .\n>\n>                 write TIMESHEET_TOP;\n>\n>                 foreach my $id (sort keys %{ $tickets{$user}{$env} }) {\n>                         foreach my $subject (keys %{ $tickets{$user}{$env}{$id} }) {\n> format TIMESHEET =\n> @#########  ^<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<  @>>>>\n>            $id, $tickets{$user}{$env}{$id},\n> $tickets{$user}{$env}{$id}{$subject}\n\nI know little about the 'format' function (never use it) but what is\nit you are trying to print in the above statement? It looks to me like\nyou are trying to print the $id variable and then some hash\nreferences.\n\nKen\n\n> ~~          ^<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<\n>             $tickets{$user}{$env}{$id}\n> .\n>\n>                                 write TIMESHEET;\n>                         }\n>                         print TIMESHEET \"\\n\";\n>                 }\n>         }\n>\n> }\n>\n> The problem didn't surface until I went from using the %tikSubj hash seen near\n> the top of the code snippet to a multi-level hash.  But then, using %tikSubj\n> presents its own bug for some reason.\n>\n> Knowing that you don't know the intricacies of the system I'm working with, I\n> won't be sad if no one has any input ;).\n>\n> Thanks\n> Mathew\n> --\n> Keep up with me and what I'm up to:http://theillien.blogspot.com\n\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}