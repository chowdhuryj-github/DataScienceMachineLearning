{"category": "ham", "to_address": "\"Nordlund, Dan \\(DSHS/RDA\\)\" <NordlDJ@dshs.wa.gov>,\n   R R-help <r-help@stat.math.ethz.ch>", "from_address": "John Kane <jrkrideau@yahoo.ca>", "subject": "Re: [R] Function call within a function.", "body": "Thanks very much.  A very nice solution.  The\nenvironment problem was the result of one last\ndeperate try when the actual problem as Jason pointed\nout was that I was not naming my list elements and\nthought that I had.  \n\nThis looks like it will work quite nicely. I am pretty\nsure that there is a cleaner way to do this but it is\nlikely to mean too much manipulation of data earlier\non.  This is a small attempt to extract data in a new\nway from a larger project. \n\nThis is greatly appreciated.\n\n \n--- \"Nordlund, Dan (DSHS/RDA)\" \nwrote:\n\n> > -----Original Message-----\n> > From: r-help-bounces@stat.math.ethz.ch \n> > [mailto:r-help-bounces@stat.math.ethz.ch] On\n> Behalf Of John Kane\n> > Sent: Thursday, June 28, 2007 12:04 PM\n> > To: R R-help\n> > Subject: [R] Function call within a function.\n> > \n> > I am trying to call a funtion within another\n> function\n> > and I clearly am misunderstanding what I should\n> do. \n> > Below is a simple example.\n> > I know lstfun works on its own but I cannot seem\n> to\n> > figure out how to get it to work within ukn.\n> Basically\n> > I need to create the variable \"nts\". I have\n> probably\n> > missed something simple in the Intro or FAQ.\n> > \n> > Any help would be much appreciated.\n> > \n> > EXAMPLE\n> >\n>\n--------------------------------------------------------------\n> > -----------------\n> > # create data.frame\n> > cata <- c( 1,1,6,1,1,4)\n> > catb <- c( 1,2,3,4,5,6)\n> > id <- c('a', 'b', 'b', 'a', 'a', 'b')\n> > dd1  <-  data.frame(id, cata,catb)\n> > \n> > # function to create list from data.frame\n> > lstfun  <- function(file, alpha , beta ) {\n> > cda  <-  subset(file, file[,1] == alpha)\n> > cdb  <-  subset (file, file[,1]== beta)\n> > list1 <- list(cda,cdb)\n> > }\n> > \n> > # funtion to operate on list\n> > ukn  <-  function(file, alpha, beta, nam1){\n> > aa  <- alpha\n> > bb  <- beta\n> > myfile  <- file\n> > nts <- lstfun(myfile, aa, bb)\n> > mysum <- nam1[,3]*5\n> > return(mysum)\n> > }\n> > \n> > results <- ukn(dd1, \"a\", \"b\", nts$cda)\n> \n> John,\n> \n> The first problem I see is one of scope.  nts$cda\n> refers to an object called nts which does not exist\n> in the calling environment (it is local to the\n> function ukn).  So trying to call ukn() with nts\n> results in an error.  Second, even if you pass the\n> name of the object, you will not be able to use it\n> in ukn() in the manner that you are trying.  Your\n> ukn() function definition also requires that it know\n> the inner workings of function lstfun().  Functions\n> generally shouldn't require knowing how other\n> functions work, they should only rely on what value\n> is returned.\n> \n> You can get what you want by redefining ukn in the\n> following way\n> \n> # funtion to operate on list\n> ukn  <-  function(file, alpha, beta, nam1){\n> aa  <- alpha\n> bb  <- beta\n> myfile  <- file\n> nts <- lstfun(myfile, aa, bb)\n> mysum <- nts[[nam1]][,3]*5\n> return(mysum)\n> }\n> \n> And change the function call to\n> \n> results <- ukn(dd1, \"a\", \"b\", 1) \n> \n> This still leaves the functions coupled in a way\n> that I don't like, but I'm not a good enough R\n> programmer to solve that problem at the moment. \n> Maybe someone else will come along with a better\n> solution.\n> \n> Hope this is helpful,\n> \n> Dan\n> \n> Daniel J. Nordlund\n> Research and Data Analysis\n> Washington State Department of Social and Health\n> Services\n> Olympia, WA  98504-5204\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained,\n> reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}