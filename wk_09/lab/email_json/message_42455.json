{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jra@samba.org", "subject": "svn commit: samba r23346 - in branches: SAMBA_3_0/source/smbd\n\tSAMBA_3_0_25/source/smbd SAMBA_3_0_26/source/smbd", "body": "Author: jra\nDate: 2007-06-04 22:29:23 +0000 (Mon, 04 Jun 2007)\nNew Revision: 23346\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23346\n\nLog:\nFix offline caching with XP/Vista. It was an off-by-one\nin storing the access mask. I shouldn't have made this\nmistake. Damn. Fixes bug #4673.\nJeremy\n\nModified:\n   branches/SAMBA_3_0/source/smbd/nttrans.c\n   branches/SAMBA_3_0_25/source/smbd/nttrans.c\n   branches/SAMBA_3_0_26/source/smbd/nttrans.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/smbd/nttrans.c\n===================================================================\n--- branches/SAMBA_3_0/source/smbd/nttrans.c\t2007-06-04 19:58:11 UTC (rev 23345)\n+++ branches/SAMBA_3_0/source/smbd/nttrans.c\t2007-06-04 22:29:23 UTC (rev 23346)\n@@ -420,7 +420,7 @@\n \tp += 4;\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tSIVAL(p,0,FILE_GENERIC_ALL);\n \t\t/* \n \t\t * For pipes W2K3 seems to return\n@@ -950,7 +950,7 @@\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n \t\tuint32 perms = 0;\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tif (fsp->is_directory || can_write_to_file(conn, fname, &sbuf)) {\n \t\t\tperms = FILE_GENERIC_ALL;\n \t\t} else {\n@@ -1035,7 +1035,7 @@\n \tp += 4;\n \t\n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tSIVAL(p,0,FILE_GENERIC_ALL);\n \t\t/* \n \t\t * For pipes W2K3 seems to return\n@@ -1631,7 +1631,7 @@\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n \t\tuint32 perms = 0;\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tif (fsp->is_directory || can_write_to_file(conn, fname, &sbuf)) {\n \t\t\tperms = FILE_GENERIC_ALL;\n \t\t} else {\n\nModified: branches/SAMBA_3_0_25/source/smbd/nttrans.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/smbd/nttrans.c\t2007-06-04 19:58:11 UTC (rev 23345)\n+++ branches/SAMBA_3_0_25/source/smbd/nttrans.c\t2007-06-04 22:29:23 UTC (rev 23346)\n@@ -414,7 +414,7 @@\n \tp += 4;\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tSIVAL(p,0,FILE_GENERIC_ALL);\n \t\t/* \n \t\t * For pipes W2K3 seems to return\n@@ -944,7 +944,7 @@\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n \t\tuint32 perms = 0;\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tif (fsp->is_directory || can_write_to_file(conn, fname, &sbuf)) {\n \t\t\tperms = FILE_GENERIC_ALL;\n \t\t} else {\n@@ -1029,7 +1029,7 @@\n \tp += 4;\n \t\n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tSIVAL(p,0,FILE_GENERIC_ALL);\n \t\t/* \n \t\t * For pipes W2K3 seems to return\n@@ -1625,7 +1625,7 @@\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n \t\tuint32 perms = 0;\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tif (fsp->is_directory || can_write_to_file(conn, fname, &sbuf)) {\n \t\t\tperms = FILE_GENERIC_ALL;\n \t\t} else {\n\nModified: branches/SAMBA_3_0_26/source/smbd/nttrans.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/smbd/nttrans.c\t2007-06-04 19:58:11 UTC (rev 23345)\n+++ branches/SAMBA_3_0_26/source/smbd/nttrans.c\t2007-06-04 22:29:23 UTC (rev 23346)\n@@ -414,7 +414,7 @@\n \tp += 4;\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tSIVAL(p,0,FILE_GENERIC_ALL);\n \t\t/* \n \t\t * For pipes W2K3 seems to return\n@@ -944,7 +944,7 @@\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n \t\tuint32 perms = 0;\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tif (fsp->is_directory || can_write_to_file(conn, fname, &sbuf)) {\n \t\t\tperms = FILE_GENERIC_ALL;\n \t\t} else {\n@@ -1029,7 +1029,7 @@\n \tp += 4;\n \t\n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tSIVAL(p,0,FILE_GENERIC_ALL);\n \t\t/* \n \t\t * For pipes W2K3 seems to return\n@@ -1625,7 +1625,7 @@\n \n \tif (flags & EXTENDED_RESPONSE_REQUIRED) {\n \t\tuint32 perms = 0;\n-\t\tp += 26;\n+\t\tp += 25;\n \t\tif (fsp->is_directory || can_write_to_file(conn, fname, &sbuf)) {\n \t\t\tperms = FILE_GENERIC_ALL;\n \t\t} else {\n\n"}