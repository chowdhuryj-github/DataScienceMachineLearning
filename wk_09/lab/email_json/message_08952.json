{"category": "ham", "to_address": "jiri sasek - Sun Microsystems - Prague Czech Republic <Jiri.Sasek@sun.com>", "from_address": "James Peach <jpeach@samba.org>", "subject": "Re: NetBench problem", "body": "On 18/04/2007, at 5:08 AM, jiri sasek - Sun Microsystems - Prague  \nCzech Republic wrote:\n\n> Hi all\n>\n> We have the following problem:\n>\n> - QA team using netbench raised a problem to having a >20%  \n> performance regression on samba shares between the 3.0.21c and  \n> 3.0.24 versions of samba.\n\nTry comparing packet traces of 3.0.21c and 3.0.24.\n\n> - we tried to reproduce it by smbtorture using the Tridge's  \n> client.txt and we obtained the performance diffs between the  \n> 3.0.0-3.0.9-3.0.10-3.0.21c-3.0.24 \"flat\" (diffs was no more than 1-2%)\n\nyes, unfortunately this is not always predictive of actual windows  \nperformance.\n\n> - we trying to find a root cause of this different results. We found  \n> the client.txt was obtained snooping the traffic of the NetBench of  \n> the version ~=3.\n>\n> Questions:\n>\n> - is there anybody who has the client.txt derived from the NetBench  \n> v7 traffic or who is experienced with the creating it?\n\nI believe that samba4 has a backend that is capable of creating  \nworkload files, though I've never experimented with it.\n\n> - is anybody know the differences which can cause such performance  \n> drop?\n\nIIRC the default for \"msdfs root\" changed to \"yes\" around this time.  \nWe found that enabling this causes windows clients to do a lot more  \nrequests, with a corresponding drop in (netbench) performance.\n\n--\nJames Peach | jpeach@samba.org\n\n"}