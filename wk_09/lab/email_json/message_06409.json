{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "abartlet@samba.org", "subject": "svn commit: samba r22233 - in\n\tbranches/SAMBA_4_0/source/script/tests: .", "body": "Author: abartlet\nDate: 2007-04-16 03:16:23 +0000 (Mon, 16 Apr 2007)\nNew Revision: 22233\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22233\n\nLog:\nAllow 'REALM' as a global environment variable in the tests.\n\nSet the default socket_wrapper interface inside the test env setup, so\nit actually stays (fixes LOCAL-SOCKET failures).\n\nAndrew Bartlett\n\nModified:\n   branches/SAMBA_4_0/source/script/tests/selftest.pl\n   branches/SAMBA_4_0/source/script/tests/test_blackbox.sh\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/script/tests/selftest.pl\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/selftest.pl\t2007-04-16 00:29:13 UTC (rev 22232)\n+++ branches/SAMBA_4_0/source/script/tests/selftest.pl\t2007-04-16 03:16:23 UTC (rev 22233)\n@@ -556,7 +556,7 @@\n \t}\n \twrite_clientconf($conffile, $testenv_vars);\n \tforeach (\"PASSWORD\", \"DOMAIN\", \"SERVER\", \"USERNAME\", \"NETBIOSNAME\", \n-\t\t\t \"KRB5_CONFIG\") {\n+\t\t\t \"KRB5_CONFIG\", \"REALM\") {\n \t\tif (defined($testenv_vars->{$_})) {\n \t\t\t$ENV{$_} = $testenv_vars->{$_};\n \t\t} else {\n@@ -564,6 +564,8 @@\n \t\t}\n \t}\n \n+\tSocketWrapper::set_default_iface(6);\n+\n \t$running_envs{$envname} = $testenv_vars;\n \treturn $testenv_vars;\n }\n@@ -574,8 +576,8 @@\n \t$target->teardown_env($running_envs{$envname});\n \tdelete $running_envs{$envname};\n }\n-SocketWrapper::set_default_iface(6);\n \n+\n if ($opt_testenv) {\n \tmy $testenv_vars = setup_env(\"dc\");\n \t$ENV{PIDDIR} = $testenv_vars->{PIDDIR};\n\nModified: branches/SAMBA_4_0/source/script/tests/test_blackbox.sh\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/test_blackbox.sh\t2007-04-16 00:29:13 UTC (rev 22232)\n+++ branches/SAMBA_4_0/source/script/tests/test_blackbox.sh\t2007-04-16 03:16:23 UTC (rev 22233)\n@@ -17,4 +17,6 @@\n . $incdir/test_functions.sh\n \n plantest \"blackbox.smbclient\" dc $incdir/../../../testprogs/blackbox/test_smbclient.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$DOMAIN\" \"$PREFIX\" \"$ADDARGS\"\n+plantest \"blackbox.kinit\" dc $incdir/../../../testprogs/blackbox/test_kinit.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$REALM\" \"$PREFIX\" \"$ADDARGS\"\n+\n plantest \"blackbox.cifsdd\" dc $incdir/../../../testprogs/blackbox/test_cifsdd.sh \"\\$NETBIOSNAME\" \"\\$USERNAME\" \"\\$PASSWORD\" \"\\$DOMAIN\" \"$ADDARGS\"\n\n"}