{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Sergey Goriatchev\" <sergeyg@gmail.com>", "subject": "[R] Area() artefacts??", "body": "Hello, everybody\n\nI run the following program, and depending on the size of eps I get\ndifferent results.\nWith eps=1e-05, the program calculates wrong values for x=65:67 and\nothers. The program runs fine with eps=1e-07. Why is this so?\nAlso, I am using area() instead of integrate() because I cannot make\nintegrate to work, especially with imaginary numbers. Maybe someone\ncan show me how to use integrate in this particular code? THanks in\nadvance!\n\n#Computes the p.m.f. via (10.53) of the number of i.i.d. Ber(p) trials\n#required until m consecutive successes occur.\n#Requires MASS package\n\n#==========================================================#\nconsecpmf <- function(xvec, m, p, eps=1e-05){\nlibrary(MASS)\nf<-numeric()\nfor(j in seq(xvec)){\n\tx <- xvec[j]\n\tf[j] <- area(fun, -pi, pi, limit=1000, eps=eps, x, m, p)\n}\nf<-Re(f)\nround(f,4)\n}\n\nfun <- function(t,x,m,p){\nI <- exp(-1i*t*x)*cf(t,m,p)/(2*pi)\nI\n}\n\ncf <- function(t,m,p){\nq <- 1-p\nif(m==1) {g <- p*exp(1i*t)/(1-q*exp(1i*t))} else\n{kk <- exp(1i*t)*cf(t, m-1, p); g <- (p*kk)/(1-q*kk)}\ng\n}\n\n#===================TESTING================================#\nconsecpmf(seq(0,200),3,0.5)\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}