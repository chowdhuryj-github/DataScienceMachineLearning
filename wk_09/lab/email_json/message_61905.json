{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "svn commit: samba r23701 - in branches/SAMBA_4_0/source/lib/socket:\n\t.", "body": "Author: tridge\nDate: 2007-07-04 07:43:26 +0000 (Wed, 04 Jul 2007)\nNew Revision: 23701\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23701\n\nLog:\n\nwhen we create a new socket with socket_accept(), clear any flags that\nwere set in the old one. Otherwise SOCKET_FLAG_NOCLOSE causes a major\nfd leak\n\nModified:\n   branches/SAMBA_4_0/source/lib/socket/socket.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/lib/socket/socket.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/socket/socket.c\t2007-07-04 05:16:19 UTC (rev 23700)\n+++ branches/SAMBA_4_0/source/lib/socket/socket.c\t2007-07-04 07:43:26 UTC (rev 23701)\n@@ -166,6 +166,7 @@\n \n \tif (NT_STATUS_IS_OK(status)) {\n \t\ttalloc_set_destructor(*new_sock, socket_destructor);\n+\t\t(*new_sock)->flags = 0;\n \t}\n \n \treturn status;\n\n"}