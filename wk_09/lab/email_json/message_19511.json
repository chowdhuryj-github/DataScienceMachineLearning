{"category": "ham", "to_address": "\"Michael Kubovy\" <kubovy@virginia.edu>", "from_address": "\"Spielas Bates\" <bates@stat.wisc.edu>", "subject": "Re: [R] Example of mcmcsamp() failing with lmer() output", "body": "On 4/27/07, Michael Kubovy  wrote:\n> Hi,\n>\n> I would appreciate help with the following model\n>\n> <<1>>=\n> gunload <- read.table(hh('datasets/gunload.dat'), header = T)\n> gunload$method <- factor(gunload$method, labels = c('new', 'old'))\n> gunload$physique <- factor(gunload$group, labels = c('slight',\n> 'average', 'heavy'))\n> gunload$team9 <- factor(rep(1:9, each = 2))\n> @\n>\n> This is a split plot design with randomly selected teams for each\n> physique, which was crossed with two methods.\n>\n> Following the Oats example in chap. 1 of MEMSS, and adapting to lmer:\n>\n> <<2>>=\n> require(lme4)\n> gl.lmer <- lmer(rounds ~ method * physique + (1 | physique/team),\n> data = gunload)\n> mcmcsamp(gl.lmer)\n> @\n> lmer runs as expected, but mcmcsamp() gives:\n> Error: Leading minor of order 1 in downdated X'X is not positive\n> definite\n> Error in t(.Call(mer_MCMCsamp, object, saveb, n, trans, verbose,\n> deviance)) :\n>         error in evaluating the argument 'x' in selecting a method for\n> function 't'\n\nI think you are overfitting the model - you have a fixed effect for\nphysique and a random effect for physique.  This is not the same as\nthe Oats example where there is a fixed effect for variety and a\nrandom effect for variety within block, which designates the plot\nwithin the block.\n\nTry fitting the model with the random effects as  (1|physique:team)\nand you will see that you get the same fitted values but you are able\nto run mcmcsamp on this fit.\n\n\n> I tried:\n>\n> <<3>>=\n> require(nlme)\n> gl.lme <- lme(rounds ~ method * physique, random = ~1 | physique/\n> team, data = gunload)\n> @\n> which gave all the expected output except that two p-values were NaN.\n>\n> Which aspect of the data is making the simulation fail, and is there\n> anything to be done about it?\n>\n> _____________________________\n> Professor Michael Kubovy\n> University of Virginia\n> Department of Psychology\n> USPS:     P.O.Box 400400    Charlottesville, VA 22904-4400\n> Parcels:    Room 102        Gilmer Hall\n>          McCormick Road    Charlottesville, VA 22903\n> Office:    B011    +1-434-982-4729\n> Lab:        B019    +1-434-982-4751\n> Fax:        +1-434-982-4766\n> WWW:    http://www.people.virginia.edu/~mk9y/\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}