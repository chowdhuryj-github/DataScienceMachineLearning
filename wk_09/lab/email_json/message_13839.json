{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "abartlet@samba.org", "subject": "svn commit: samba r22494 - in branches/SAMBA_4_0/source:\n\tscript/tests setup", "body": "Author: abartlet\nDate: 2007-04-23 21:56:23 +0000 (Mon, 23 Apr 2007)\nNew Revision: 22494\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22494\n\nLog:\nSkip subSchema again, but we will need to remap this objectClass.\n\nMake the Fedora DS backend test again.\n\nAndrew Bartlett\n\nModified:\n   branches/SAMBA_4_0/source/script/tests/Samba4.pm\n   branches/SAMBA_4_0/source/setup/schema-map-fedora-ds-1.0\n   branches/SAMBA_4_0/source/setup/schema-map-openldap-2.3\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/script/tests/Samba4.pm\n===================================================================\n--- branches/SAMBA_4_0/source/script/tests/Samba4.pm\t2007-04-23 21:40:54 UTC (rev 22493)\n+++ branches/SAMBA_4_0/source/script/tests/Samba4.pm\t2007-04-23 21:56:23 UTC (rev 22494)\n@@ -26,7 +26,7 @@\n         my ($slapd_conf, $uri, $logs) = @_;\n         my $oldpath = $ENV{PATH};\n         $ENV{PATH} = \"/usr/local/sbin:/usr/sbin:/sbin:$ENV{PATH}\";\n-        system(\"slapd -d0 -f $slapd_conf -h $uri > $logs 2>&1 &\");\n+        system(\"slapd -d -f $slapd_conf -h $uri > $logs 2>&1 &\");\n         $ENV{PATH} = $oldpath;\n }\n \n@@ -66,6 +66,7 @@\n \t\tkill 9, ;\n \t\tclose(IN);\n \t}\n+\treturn 1;\n }\n \n sub check_or_start($$$) \n@@ -645,8 +646,6 @@\n \t\tSOCKET_WRAPPER_DEFAULT_IFACE => $swiface\n \t};\n \n-\t$ret->{PROVISION_OPTIONS} = join(' ', @provision_options);\n-\n \tif (defined($self->{ldap})) {\n \n \t        if ($self->{ldap} eq \"openldap\") {\n@@ -659,12 +658,16 @@\n \t\t$self->slapd_start($ret) or \n \t\t\tdie(\"couldn't start slapd\");\n \t\t    \n+\t        $ret->{PROVISION_OPTIONS} = join(' ', @provision_options);\n+\n \t\tprint \"LDAP PROVISIONING...\";\n \t\t$self->provision_ldap($ret);\n \n \t\t$self->slapd_stop($ret) or \n \t\t\tdie(\"couldn't stop slapd\");\n-\t}\n+\t} else {\n+\t        $ret->{PROVISION_OPTIONS} = join(' ', @provision_options);\n+        }\n \treturn $ret; \n }\n \n\nModified: branches/SAMBA_4_0/source/setup/schema-map-fedora-ds-1.0\n===================================================================\n--- branches/SAMBA_4_0/source/setup/schema-map-fedora-ds-1.0\t2007-04-23 21:40:54 UTC (rev 22493)\n+++ branches/SAMBA_4_0/source/setup/schema-map-fedora-ds-1.0\t2007-04-23 21:56:23 UTC (rev 22494)\n@@ -15,7 +15,6 @@\n #This shouldn't make it to the ldap server\n sambaPassword\n #Skip ObjectClasses\n-#\n #MiddleName has a conflicting OID\n 2.16.840.1.113730.3.1.34:1.3.6.1.4.1.7165.4.255.1\n #defaultGroup has a conflicting OID\n\nModified: branches/SAMBA_4_0/source/setup/schema-map-openldap-2.3\n===================================================================\n--- branches/SAMBA_4_0/source/setup/schema-map-openldap-2.3\t2007-04-23 21:40:54 UTC (rev 22493)\n+++ branches/SAMBA_4_0/source/setup/schema-map-openldap-2.3\t2007-04-23 21:56:23 UTC (rev 22494)\n@@ -19,7 +19,7 @@\n #This shouldn't make it to the ldap server\n sambaPassword\n #Skip ObjectClasses\n-#subSchema\n+subSchema\n #MiddleName has a conflicting OID\n 2.16.840.1.113730.3.1.34:1.3.6.1.4.1.7165.4.255.1\n #defaultGroup has a conflicting OID\n\n"}