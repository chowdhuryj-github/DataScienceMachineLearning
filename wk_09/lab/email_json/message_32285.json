{"category": "ham", "to_address": "jiho <jo.irisson@gmail.com>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] lapply not reading arguments from the correct environment", "body": "You need to study carefully what the semantics of 'subset' are.  The \nfunction body of myfun is not in the evaluation environment.  (The issue \nis 'subset', not 'lapply': select is an *expression* and not a value.)\n\nHint: using subset() programmatically is almost always a mistake.  R's \nsubsetting function is '[': subset is a convenience wrapper.\n\nOn Fri, 18 May 2007, jiho wrote:\n\n> Hello,\n>\n> I am facing a problem with lapply which I ''''think''' may be a bug.\n> This is the most basic function in which I can reproduce it:\n>\n> myfun <- function()\n> {\n> \tfoo = data.frame(1:10,10:1)\n> \tfoos = list(foo)\n> \tfooCollumn=2\n> \tcFoo = lapply(foos,subset,select=fooCollumn)\n> \treturn(cFoo)\n> }\n>\n> I am building a list of dataframes, in each of which I want to keep\n> only column 2 (obviously I would not do it this way in real life but\n> that's just to demonstrate the bug).\n> If I execute the commands inline it works but if I clean my\n> environment, then define the function and then execute:\n> \t> myfun()\n> I get this error:\n> \tError in eval(expr, envir, enclos) : object \"fooCollumn\" not found\n> while fooCollumn is defined, in the function, right before lapply. In\n> addition, if I define it outside the function and then execute the\n> function:\n> \t> fooCollumn=1\n> \t> myfun()\n> it works but uses the value defined in the general environment and\n> not the one defined in the function.\n> This is with R 2.5.0 on both OS X and Linux (Fedora Core 6)\n> What did I do wrong? Is this indeed a bug? An intended behavior?\n\nIt is a bug, in your function.\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}