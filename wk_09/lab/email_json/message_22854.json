{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "sally.x.wetten@gsk.com", "subject": "[R] Predicted Cox survival curves - factor coding problems...", "body": "I am trying to use the survfit() function with the newdata argument to \nproduce predicted survivor curves for a particular covariate profile.\n\nThe main purpose of the plot will be to visualise the effect of snp1, \ncoded 0 and 1. In my Cox model I have stratified by one variable, edu, and \nso I know I will automatically get a separate curve for each strata. My \nproblem is how to deal with the variable sitenew, which is a 3 level \nfactor (coded 0,1,2).\n\ncoxsnps$edu <- as.factor(coxsnps$edu)\ncoxsnps$sitenew <- as.factor(coxsnps$sitenew)\n\ntest1 <- coxph(Surv(time,censor) ~ snp1 + sex + sitenew + geno + eth_self \n+ strata(edu), data=coxsnps)\n\n                        coef exp(coef) se(coef)      z       p\n        snp1             -0.4324     0.649   0.1073 -4.031 5.5e-05\n        sex           0.0604     1.062   0.0915  0.660 5.1e-01\n        sitenew1      0.5128     1.670   0.1381  3.712 2.1e-04\n        sitenew2      0.2688     1.308   0.1313  2.047 4.1e-02\n        geno          0.9702     2.639   0.0663 14.630 0.0e+00\n        eth_self      0.0871     1.091   0.1088  0.801 4.2e-01\n\n\nprofile1 <- data.frame(snp1=factor(c(0,1), levels=c(\"0\", \"1\")), sex=0, \nsitenew=0, geno=0, eth_self=0)\nplot(survfit(test1, newdata=profile1))\n\nPutting sitenew=0 in the dataframe produces the error \n\n        Error in x2 %*% coef : non-conformable arguments\n\nimplying the rows and columns of the matrices don't match up. This makes \nsense as R creates dummy variables for sitenew. I naively tried using \nsitenew1=0, sitenew2=0 in the dataframe instead, which produced the same \nerror message.\n\nIs there a way to produce curves by edu and snp1 but just one level of \nsitenew?\n\nIf not, what would be the procedure for producing curves for all of them \n(for reference)?\n\nMany thanks,\nSally\n\n\n\n\n\n\n\n-----------------------------------------------------------\nThis e-mail was sent by GlaxoSmithKline Services Unlimited \n(registered in England and Wales No. 1047315), which is a \nmember of the GlaxoSmithKline group of companies. The \nregistered address of GlaxoSmithKline Services Unlimited \nis 980 Great West Road, Brentford, Middlesex TW8 9GS.\n-----------------------------------------------------------\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}