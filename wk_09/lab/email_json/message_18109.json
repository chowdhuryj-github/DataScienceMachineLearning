{"category": "ham", "to_address": "\"OtherRecipients of perl Ticket #41898\": ;", "from_address": "\"Steve Peters via RT\" <parrotbug-followup@parrotcode.org>", "subject": "[perl #41898] Build error with icc ", "body": "On Sun Mar 18 12:21:18 2007, ptc wrote:\n> I don't know if this is a BUG or what so I'm just sending it plain.\n> I've just tried to build parrot with icc (not 100% sure if my build\n> flags are correct either), and I'm getting this build error:\n> \n> icc -o miniparrot compilers/imcc/main.o \\\n>     -Wl,-rpath=/home/cochrane/sourceforge/parrot_svn/blib/lib\n> -L/home/cochrane/sourceforge/parrot_svn/blib/lib -lparrot -lpthread\n> -lm -L/usr/lib  -licuuc -licudata -lpthread -lm -lpthread -lnsl -ldl\n> -lm -lcrypt -lutil -lrt -lgmp -lreadline -lncurses -L/usr/local/lib\n> src/null_config.o\n> Invoking Parrot to generate runtime/parrot/include/config.fpmc --cross\n> your fingers\n> ./miniparrot config_lib.pasm > runtime/parrot/include/config.fpmc\n> miniparrot: src/mmd.c:1707: Assertion\n> `((UINTVAL)(mmd_table[i].func_ptr) & 3) == 0' failed.\n> /bin/sh: line 1: 30223 Aborted                 ./miniparrot\n> config_lib.pasm > runtime/parrot/include/config.fpmc\n> make: *** [runtime/parrot/include/config.fpmc] Error 134\n> \n> Naive configure settings were (comments welcome as to what I might\n> have done wrong here):\n> \n> perl Configure.pl --cc=icc --cxx=icc --ld=icc\n> \n> Any ideas as to what is going wrong here?\n\nThere appear to be a couple of problems.  First, it appears that icc is optimizing something \nthat causes that assertion to fail.  ifdef'ing the assertion seems to cause no problems.  \nSecond, there appears to be something hateful about the __LINE__ macro in icc.  I've had to \nadjust the location of a few CONST_STRING() macros.\n\nIn the meantime, RT #42768 contains patches necessary to get Intel C++ compiling and \npassing tests on Linux.\n\n\n"}