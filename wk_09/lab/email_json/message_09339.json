{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Deepankar Basu <basu.15@osu.edu>", "subject": "[R] Problems in programming a simple likelihood", "body": "As part of carrying out a complicated maximum likelihood estimation, I\nam trying to learn to program likelihoods in R. I started with a simple\nprobit model but am unable to get the code to work. Any help or\nsuggestions are most welcome. I give my code below:\n\n************************************\nmlogl <- function(mu, y, X) {\nn <- nrow(X)\nzeta <- X%*%mu\nllik <- 0\nfor (i in 1:n) {\n  if (y[i]==1) \n   llik <- llik + log(pnorm(zeta[i,], mean=0, sd=1))\n  else\n   llik <- llik + log(1-pnorm(zeta[i,], mean=0, sd=1))     \n    }\nreturn(-llik)\n}\n\nwomen <- read.table(\"~/R/Examples/Women13.txt\", header=TRUE)  # DATA\n\n# THE DATA SET CAN BE ACCESSED HERE\n# women <-\nread.table(\"http://wps.aw.com/wps/media/objects/2228/2281678/Data_Sets/ASCII/Women13.txt\", header=TRUE)\n# I HAVE CHANGED THE NAMES OF THE VARIABLES\n# J is changed to \"work\"\n# M is changed to \"mar\"\n# S is changed to \"school\"\n\nattach(women)\n\n# THE VARIABLES OF USE ARE\n#   work: binary dependent variable\n#   mar: whether married or not\n#   school: years of schooling\n\nmu.start <- c(3, -1.5, 10)\ndata <- cbind(1, mar, school)\nout <- nlm(mlogl, mu.start, y=work, X=data)\ncat(\"Results\", \"\\n\")\nout$estimate\n\ndetach(women)\n\n*************************************\n\nWhen I try to run the code, this is what I get:\n\n> source(\"probit.R\")\nResults\nWarning messages:\n1: NA/Inf replaced by maximum positive value\n2: NA/Inf replaced by maximum positive value\n3: NA/Inf replaced by maximum positive value\n4: NA/Inf replaced by maximum positive value\n\nThanks in advance.\nDeepankar\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}