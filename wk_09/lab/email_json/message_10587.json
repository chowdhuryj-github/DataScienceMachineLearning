{"category": "ham", "to_address": "debian-laptop@lists.debian.org", "from_address": "\"A. F. Cano\" <afc@shibaya.lonestar.org>", "subject": "sl-modem-daemon and vgetty: supposed to work but how to config?", "body": "\nGreetings:\n\nAfter the sarge->etch upgrade, I noticed that sound card and soft modem\nhardware on this Dell 8600 was properly detected as never before.  After\nnot being able to use the pctel modem with any 2.6 kernel (I'm now running\na locally compiled 2.6.18) I decided I wanted to use the sl-modem-daemon\npackage, which installed perfectly, as a voice modem with mgetty/vgetty.\n\nI had done this years ago with a ZyXel 2864, so the configuration wasn't\nas bad as it could have been and the sl-modem-daemon docs say that it\nworks with vgetty.  It's supposed to be a V253 voice modem.\nThe versions are from etch: sl-modem-daemon and sl-modem-source\n(the kernel driver part) 2.9.9d+e-pre2-7etch2.\n\nI can talk to the modem via kermit and send it AT commands.\nIf I call the modem when kermit is talking to it and I type\nATA (to answer), it does and I hear the modem tone in the calling\nphone.  But obviously something is not set up quite right as when\nI start vgetty I get this:\n\n\n04/19 21:48:31 SL0  reading program vgetty configuration from config file /etc/mgetty/voice.conf\n04/19 21:48:31 SL0  reading port ttySL0 configuration from config file /etc/mgetty/voice.conf\n04/19 21:48:31 SL0  check for lockfiles\n04/19 21:48:31 SL0  locking the line\n04/19 21:48:32 SL0  tio_get_rs232_lines: TIOCMGET failed: Invalid argument\n04/19 21:48:32 SL0  WARNING: DSR is off - modem turned off or bad cable?\n04/19 21:48:32 SL0  lowering DTR to reset Modem\n04/19 21:48:32 SL0  TIOCMBIC failed: Invalid argument\n04/19 21:48:32 SL0  send: AT+FCLASS=8[0d]\n04/19 21:48:32 SL0  waiting for ``OK'' ** found **\n04/19 21:48:32 SL0  send: ATN1S0=0S13=1[0d]\n04/19 21:48:32 SL0  waiting for ``OK'' ** found **\n04/19 21:48:32 SL0  send: AT[0d]\n04/19 21:48:32 SL0  do_stat: expect 'OK' ** found **\n04/19 21:48:32 SL0  send: ATI2[0d]\n04/19 21:48:32 SL0  do_stat: expect 'OK' ** found **\n04/19 21:48:32 SL0  mdm_send: 'AT+FCLASS=2' -> ERROR\n04/19 21:48:32 SL0  detecting voice modem type\n04/19 21:48:34 SL0  V253 modem detected\n04/19 21:48:34 SL0  initializing V253 voice modem\n04/19 21:48:35 SL0  vgetty: Modem returned ERROR\n04/19 21:48:35 SL0  setting ringback delay didn't work\n04/19 21:48:35 SL0  vgetty: Modem returned ERROR\n04/19 21:48:36 SL0  waiting...                   \n\nI don't see where the mdm_send 'AT+FCLASS=2' is configured,  per the\ninit script AT+FCLASS=8 is the proper way to initialize the modem for\nvoice.  Apparently this modem does class 1 fax.  Hopefully this has no\neffect, but the V253 initialization seems more serious.\n\nDoes anyone know what is mis-configured?  Are the TIOCMGET and TIOCMBIC\nerrors fatal?\n\nThe modem never answers.  Anyone using sl-modem-daemon and vgetty?\nI eagerly await any hints, or better, config files.  Thanks!\n\nA.\n\n\n-- \nTo UNSUBSCRIBE, email to debian-laptop-REQUEST@lists.debian.org\nwith a subject of \"unsubscribe\". Trouble? Contact listmaster@lists.debian.org\n\n"}