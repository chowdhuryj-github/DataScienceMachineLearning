{"category": "ham", "to_address": "R-help <R-help@stat.math.ethz.ch>", "from_address": "Ajay Shah <ajayshah@mayin.org>", "subject": "[R] Not able to understand the behaviour of boot", "body": "Folks,\n\nI have a time-series of 875 readings of the weekly returns of a stock\nmarket index (India's Nifty). I am interested in the AR(1)\ncoefficient. When I do arima(r, order=c(1,0,0)) I get a statistically\nsignificant AR1 coefficient.\n\nIf we apply the ordinary bootstrap to this problem, this involves\nsampling with replacement, which destroys the time-series \nstructure. Hence, if we do bootstrap inference (using the ordinary\nbootstrap) we ought to get a 95% confidence interval which is roughly\nsymmetric about zero. Yes?\n\nThe program:\n\n---------------------------------------------------------------------------\n    library(boot)\n    AR1.boot <- function(x, d) { arima(x[d], order=c(1,0,0))$coef[1] }\n    load(url(\"http://www.mayin.org/ajayshah/A/nifty_weekly_returns.rda\"))\n    arima(r, order=c(1,0,0))\n    b <- boot(r, AR1.boot, R=5000)\n    boot.ci(b, type=\"basic\")\n---------------------------------------------------------------------------\n\ngives me:\n\n---------------------------------------------------------------------------\n> arima(r, order=c(1,0,0))\n\nCall:\narima(x = r, order = c(1, 0, 0))\n\nCoefficients:\n         ar1  intercept\n      0.0718     0.3061\ns.e.  0.0337     0.1392\n\nsigma^2 estimated as 14.61:  log likelihood = -2414.86,  aic = 4835.72\n> b <- boot(r, AR1.boot, R=R)\n> boot.ci(b, type=\"basic\")\nBOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS\nBased on 5000 bootstrap replicates\n\nCALL : \nboot.ci(boot.out = b, type = \"basic\")\n\nIntervals : \nLevel      Basic         \n95%   ( 0.0760,  0.2109 )  \nCalculations and Intervals on Original Scale\n---------------------------------------------------------------------------\n\nI find it very strange that the 95% confidence interval runs from\n0.076 to 0.2109. I had expected that it should be symmetric about\n0. What am I missing?\n\nAs an aside, how would you set about using tsboot() to obtain\ninference for this AR(1) coefficient?\n\n-- \nAjay Shah                                      http://www.mayin.org/ajayshah  \najayshah@mayin.org                             http://ajayshahblog.blogspot.com\n<*(:-? - wizard who doesn't know the answer.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}