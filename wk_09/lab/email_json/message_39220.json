{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jerry@samba.org", "subject": "svn commit: samba r23251 - in branches/SAMBA_3_0/source: include\n\tlibads", "body": "Author: jerry\nDate: 2007-05-30 21:55:49 +0000 (Wed, 30 May 2007)\nNew Revision: 23251\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23251\n\nLog:\nwhoops!  Fix compile error\nModified:\n   branches/SAMBA_3_0/source/include/includes.h\n   branches/SAMBA_3_0/source/libads/authdata.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/include/includes.h\n===================================================================\n--- branches/SAMBA_3_0/source/include/includes.h\t2007-05-30 21:46:25 UTC (rev 23250)\n+++ branches/SAMBA_3_0/source/include/includes.h\t2007-05-30 21:55:49 UTC (rev 23251)\n@@ -780,6 +780,9 @@\n \n #include \"nss_info.h\"\n \n+/* generated rpc server implementation functions */\n+#include \"librpc/gen_ndr/srv_echo.h\"\n+\n /***** automatically generated prototypes *****/\n #ifndef NO_PROTO_H\n #include \"proto.h\"\n\nModified: branches/SAMBA_3_0/source/libads/authdata.c\n===================================================================\n--- branches/SAMBA_3_0/source/libads/authdata.c\t2007-05-30 21:46:25 UTC (rev 23250)\n+++ branches/SAMBA_3_0/source/libads/authdata.c\t2007-05-30 21:55:49 UTC (rev 23251)\n@@ -451,10 +451,11 @@\n \t\t\t\t      PAC_SIGNATURE_DATA *data, uint32 length,\n \t\t\t\t      prs_struct *ps, int depth)\n {\n-\tuint32 siglen = length - sizeof(uint32);\n+\tuint32 siglen = 0;\n+\n \tprs_debug(ps, depth, desc, \"pac_io_pac_signature_data\");\n \tdepth++;\n-\t\n+\n \tif (data == NULL)\n \t\treturn False;\n \n@@ -463,6 +464,9 @@\n \tif (!prs_uint32(\"type\", ps, depth, &data->type))\n \t\treturn False;\n \n+\tif ( length > sizeof(uint32) )\n+\t\tsiglen = length - sizeof(uint32);\t\n+\n \tif (UNMARSHALLING(ps) && length) {\n \t\tif (siglen) {\n \t\t\tdata->signature.buffer = PRS_ALLOC_MEM(ps, uint8, siglen);\n\n"}