{"category": "ham", "to_address": "bugs-bitbucket@netlabs.develooper.com", "from_address": "Will Coleda (via RT) <parrotbug-followup@parrotcode.org>", "subject": "[perl #43069] [PATCH] enable -fvisibility-hidden on darwin ", "body": "# New Ticket Created by  Will Coleda \n# Please include the string:  [perl #43069]\n# in the subject line of all future correspondence about this issue. \n# \n\n\nThis depends on being able to config with --parrot_is_shared on darwin \n(which, as of today, fails on my osx/intel box) \n\n=== config/init/hints/darwin.pm\n==================================================================\n --- config/init/hints/darwin.pm (revision 5655)\n+++ config/init/hints/darwin.pm (local)\n@@ -26,6 +26,8 @@\n     $ccflags =~ s/-flat_namespace\\s*//;\n     $ldflags =~ s/-flat_namespace\\s*//;\n     $ldflags .= \" -flat_namespace \";\n+    # hide non-exported symbols\n+    $ccflags .= ' -fvisibility=hidden'; \n\n     $conf->data->set(\n         darwin              => 1,\n@@ -55,7 +57,9 @@\n             . $conf->data->get('lib_dir')\n             . $conf->data->get('slash')\n             . \"libparrot\"\n -            . $conf->data->get('share_ext')\n+            . $conf->data->get('share_ext'),\n+\n+         sym_export      => '__attribute__ ((visibility(\"default\")))',\n     );\n }\n\n"}