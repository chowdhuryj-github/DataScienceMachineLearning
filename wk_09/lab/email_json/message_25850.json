{"category": "ham", "to_address": "Andy Spieherty <spiehera@lafayette.edu>", "from_address": "James Keenan <jkeen@verizon.net>", "subject": "Re:  Re: Odd failure in t/postconfigure/02-revision_no_DEVELOPING.t", "body": "Andy Spieherty wrote:\n > The following oddity turned up today:\n >\n > t/postconfigure/02-revision_no_DEVELOPING........\n > #     Failed test (t/postconfigure/02-revision_no_DEVELOPING.t at  \nline 51)\n > #     '0'\n > #         ne\n > #     '0'\n > # Looks like you failed 1 test of 16.\n > dubious\n > \tTest returned status 1 (wstat 256, 0x100)\n >\n > I really don't understand this message.\n >\n\n1.  Can you say a bit more about the context in which you ran this  \ntest?  'make test'?  'prove t/postconfigure/*.t'?  In particular, did  \nyou run it *before* running Configure.pl or *afterwards*?\n\n2.  If you do 'make clean', then 'svn update', then re-run the test,  \ndo you still get the error?\n\n3.  This test was tricky, and, in the course of developing it, I got  \nthis same error several times.  The trickiness arises from the fact  \nthat the underlying code being tested, lib/Parrot/Revision.pm, has  \nthe name of a file in the Parrot distribution hard-coded into its  \nmajor subroutine:\n\nsub __get_revision {\n     return 0 unless ( -e 'DEVELOPING' );\n     ...\n}\n\nIn my never-ending quest for complete code coverage, I had to devise  \na way to test both branches in that return statement, i.e., test  \nunder circumstances in which 'DEVELOPING' both does and -- here's the  \ntricky part -- does not exist.  The only way I could do the latter  \nwas to copy the relevant files into a temporary directory and, for  \ncertain tests, not copy 'DEVELOPING' along with them.  It's very  \nhackish, but it did enable me to get to full coverage of that statement.\n\nThe fact that this test is in 't/postconfigure/' means that it is  \nmeant to be run only *after* Configure.pl has executed (whether that  \nbe immediately pre-make or as part of 'make test'.  A SKIP block  \nshould come into play if you run this test *before* Configure.pl.\n\nLet me know what further results you get.  Thank you very much.\nkid51\n\n"}