{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jra@samba.org", "subject": "svn commit: samba r23640 - in branches: SAMBA_3_0/source/smbd\n\tSAMBA_3_0_26/source/smbd", "body": "Author: jra\nDate: 2007-06-27 22:45:08 +0000 (Wed, 27 Jun 2007)\nNew Revision: 23640\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23640\n\nLog:\nWhen we support the SeSecurity privilage, this is where\nwe'll check it.\nJeremy.\n\nModified:\n   branches/SAMBA_3_0/source/smbd/nttrans.c\n   branches/SAMBA_3_0_26/source/smbd/nttrans.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/smbd/nttrans.c\n===================================================================\n--- branches/SAMBA_3_0/source/smbd/nttrans.c\t2007-06-27 22:10:25 UTC (rev 23639)\n+++ branches/SAMBA_3_0/source/smbd/nttrans.c\t2007-06-27 22:45:08 UTC (rev 23640)\n@@ -702,6 +702,17 @@\n \t\t}\n \t}\n \n+#if 0\n+\t/* We need to support SeSecurityPrivilege for this. */\n+\tif ((access_mask & SEC_RIGHT_SYSTEM_SECURITY)) && \n+\t\t\t!user_has_privileges(current_user.nt_user_token,\n+\t\t\t\t&se_security)) {\n+\t\trestore_case_semantics(conn, file_attributes);\n+\t\tEND_PROFILE(SMBntcreateX);\n+\t\treturn ERROR_NT(NT_STATUS_PRIVILEGE_NOT_HELD);\n+\t}\n+#endif\n+\n \t/*\n \t * If it's a request for a directory open, deal with it separately.\n \t */\n@@ -1378,6 +1389,16 @@\n \t\t}\n \t}\n \n+#if 0\n+\t/* We need to support SeSecurityPrivilege for this. */\n+\tif ((access_mask & SEC_RIGHT_SYSTEM_SECURITY)) && \n+\t\t\t!user_has_privileges(current_user.nt_user_token,\n+\t\t\t\t&se_security)) {\n+\t\trestore_case_semantics(conn, file_attributes);\n+\t\treturn ERROR_NT(NT_STATUS_PRIVILEGE_NOT_HELD);\n+\t}\n+#endif\n+\n \tif (ea_len) {\n \t\tpdata = data + sd_len;\n \n\nModified: branches/SAMBA_3_0_26/source/smbd/nttrans.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/smbd/nttrans.c\t2007-06-27 22:10:25 UTC (rev 23639)\n+++ branches/SAMBA_3_0_26/source/smbd/nttrans.c\t2007-06-27 22:45:08 UTC (rev 23640)\n@@ -696,6 +696,17 @@\n \t\t}\n \t}\n \n+#if 0\n+\t/* We need to support SeSecurityPrivilege for this. */\n+\tif ((access_mask & SEC_RIGHT_SYSTEM_SECURITY)) && \n+\t\t\t!user_has_privileges(current_user.nt_user_token,\n+\t\t\t\t&se_security)) {\n+\t\trestore_case_semantics(conn, file_attributes);\n+\t\tEND_PROFILE(SMBntcreateX);\n+\t\treturn ERROR_NT(NT_STATUS_PRIVILEGE_NOT_HELD);\n+\t}\n+#endif\n+\n \t/*\n \t * If it's a request for a directory open, deal with it separately.\n \t */\n@@ -1372,6 +1383,16 @@\n \t\t}\n \t}\n \n+#if 0\n+\t/* We need to support SeSecurityPrivilege for this. */\n+\tif ((access_mask & SEC_RIGHT_SYSTEM_SECURITY)) && \n+\t\t\t!user_has_privileges(current_user.nt_user_token,\n+\t\t\t\t&se_security)) {\n+\t\trestore_case_semantics(conn, file_attributes);\n+\t\treturn ERROR_NT(NT_STATUS_PRIVILEGE_NOT_HELD);\n+\t}\n+#endif\n+\n \tif (ea_len) {\n \t\tpdata = data + sd_len;\n \n\n"}