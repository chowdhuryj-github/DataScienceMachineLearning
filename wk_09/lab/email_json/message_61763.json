{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "abartlet@samba.org", "subject": "svn commit: samba r23695 - in branches/SAMBA_4_0/source:\n\tdsdb/schema smbd", "body": "Author: abartlet\nDate: 2007-07-04 03:25:44 +0000 (Wed, 04 Jul 2007)\nNew Revision: 23695\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23695\n\nLog:\nBy not using the NULL context for these large structures, we don't\nfalsely report them as leaked.\n\nAndrew Bartlett\n\nModified:\n   branches/SAMBA_4_0/source/dsdb/schema/schema_init.c\n   branches/SAMBA_4_0/source/smbd/server.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/dsdb/schema/schema_init.c\n===================================================================\n--- branches/SAMBA_4_0/source/dsdb/schema/schema_init.c\t2007-07-04 00:41:58 UTC (rev 23694)\n+++ branches/SAMBA_4_0/source/dsdb/schema/schema_init.c\t2007-07-04 03:25:44 UTC (rev 23695)\n@@ -1061,7 +1061,7 @@\n \t\treturn;\n \t}\n \n-\ttalloc_steal(NULL, schema);\n+\ttalloc_steal(talloc_autofree_context(), schema);\n \tglobal_schema = schema;\n }\n \n\nModified: branches/SAMBA_4_0/source/smbd/server.c\n===================================================================\n--- branches/SAMBA_4_0/source/smbd/server.c\t2007-07-04 00:41:58 UTC (rev 23694)\n+++ branches/SAMBA_4_0/source/smbd/server.c\t2007-07-04 03:25:44 UTC (rev 23695)\n@@ -285,7 +285,7 @@\n \t\n \t/* the event context is the top level structure in smbd. Everything else\n \t   should hang off that */\n-\tevent_ctx = event_context_init(NULL);\n+\tevent_ctx = event_context_init(talloc_autofree_context());\n \n \t/* initialise clustering if needed */\n \tcluster_ctdb_init(event_ctx, model);\n\n"}