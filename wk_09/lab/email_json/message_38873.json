{"category": "ham", "to_address": "Barry Rowlingson <b.rowlingson@lancaster.ac.uk>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] search path question", "body": "I meant essentially the same thing but returning file(fixed_up_name).\nYou can vectorize this BTW:\n\nsearch_file <- function(name, path=getOption(\"scanpath\"))\n{\n     fp <- c(name, file.path(path, name)) # better to use direct name first\n     fp <- fp[file.exists(fp)]\n     if(length(fp)) file(fp[1]) else stop(name, \" not found\")\n}\n\nShortly things like\n\n> read.table(search_file(\"passwd\"))\n\nwill close the unnamed connection for you.\n\nOn Wed, 30 May 2007, Barry Rowlingson wrote:\n\n> Prof Brian Ripley wrote:\n>\n>>\n>> You could do this via a search_file() connection wrapper, but there is a\n>> problem with ensuring connections get closed (which on.exit does here).\n>>\n>\n>  I'm not sure exactly what you mean by a 'search_file() connection\n> wrapper', but I have realised that its probably a better idea to write a\n> function that checks a search path for a file and then returns that file:\n>\n> search_file =\n> function(name,path=options()$scanpath,...){\n> for(p in path){\n>       file=file.path(p,name)\n>       if(file.exists(file)){\n>         return(file)\n>       }\n>     }\n> return(name)\n> }\n>\n>  Then you can use that in any filename-using function:\n>\n>  options(scanpath=c(\"/data1\",\"/data2\",\"/etc\"))\n>\n>  > search_file(\"passwd\")\n>  [1] \"/etc/passwd\"\n>\n>  > passwd = read.table(search_file(\"passwd\"),sep=\":\")\n>  > record = scan(search_file(\"passwd\"),what='')[1]\n>\n> Barry\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}