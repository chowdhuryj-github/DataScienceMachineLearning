{"category": "ham", "to_address": "ronggui <ronggui.huang@gmail.com>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] Question about \"evalq\"", "body": "How about 'traceback'?  (It does not necesssarily show all the frames, but \nit does help and the exceptions are fairly esoteric.)\n\nOn Mon, 28 May 2007, ronggui wrote:\n\n> In that \"the meaning of parent.frame depends on where it is\n> evaluated\", is there a nice way to figure out which frame an express\n> is evaluated? for example, I would like to konw what does\n> parent.frame(2)  refer to.\n>\n>> f1 <- function(x,digits=5) lapply(x, f2)\n>> f2 <- function(x) evalq(print(x+1,digits=digits),list(x=x),parent.frame(2))\n>> f1(list(x1=1))\n> Error in print.default(x + 1, digits = digits) :\n> object \"digits\" not found\n>\n>\n> On 5/27/07, Prof Brian Ripley  wrote:\n>> The meaning of parent.frame depends on where it is evaluated.  So one\n>> should not expect it to do the same thing in two equivalent expressions\n>> (and nor should one expect deparse to do so, for example).\n>> \n>> A pretty close analogy is that using a symbolic link in a file system is\n>> equivalent to using the original file path, at least until you try '..' or\n>> 'pwd' on the path.  (In the case of 'pwd' it depends on the OS: POSIX\n>> only requires '_an_ absolute pathname'.)\n>> \n>> On Sun, 27 May 2007, ronggui wrote:\n>> \n>> > The help page of eval says: The 'evalq' form is equivalent to\n>> > 'eval(quote(expr), ...)'.  But the following is not equivalent.  Can\n>> > anyone give me some explaination? Thanks very much.\n>> >\n>> >> f1 <- function(x,digits=5) lapply(x, f2)\n>> >> f2 <- function(x) \n>> eval(quote(print(x+1,digits=digits)),list(x=x),parent.frame(2))\n>> >> f1(list(x1=1))\n>> > [1] 2\n>> > $x1\n>> > [1] 2\n>> >\n>> >>\n>> >> f1 <- function(x,digits=5) lapply(x, f2)\n>> >> f2 <- function(x) \n>> evalq(print(x+1,digits=digits),list(x=x),parent.frame(2))\n>> >> f1(list(x1=1))\n>> > Error in print.default(x + 1, digits = digits) :\n>> >  object \"digits\" not found\n>> \n>> --\n>> Brian D. Ripley,                  ripley@stats.ox.ac.uk\n>> Professor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\n>> University of Oxford,             Tel:  +44 1865 272861 (self)\n>> 1 South Parks Road,                     +44 1865 272866 (PA)\n>> Oxford OX1 3TG, UK                Fax:  +44 1865 272595\n>> \n>\n>\n>\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}