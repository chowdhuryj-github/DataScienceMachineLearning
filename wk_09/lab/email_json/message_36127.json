{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Colin Beale\" <c.beale@macaulay.ac.uk>", "subject": "[R] Help with complex lme model fit", "body": " Hi R helpers,\n\n I'm trying to fit a rather complex model to some simulated data using\n lme and am not getting the correct results. It seems there might be\nsome\n identifiability issues that could possibly be dealt with by\nspecifying\n starting parameters - but I can't see how to do this. I'm comparing\n results from R to those got when using GenStat...\n\n The raw data are available on the web at\nhttp://cmbeale.freehostia.com/OutData.txt and can be read directly\ninto R using:\n\n gpdat <- read.table(\"http://cmbeale.freehostia.com/OutData.txt\",\nheader = T)\n gpdat$X7 <- as.factor(gpdat$X7)\n gpdat$X4 <- as.factor(gpdat$X4)\n rand_mat <- as.matrix(gpdat[,11:26])\n gpdat <- groupedData(Y1 ~X1 + X2 + X3 + X4 + X5 + m_sum|.g, data =\ngpdat)\n\n\n the model fitted using:\n\n     library(Matrix)\n     library(nlme)\n\n     m_sum <- rowSums(gpdat[,11:27])\n     mod1 <- lme(fixed = Y1 ~ X1 + X2 + X3 + X4 + X5 +  m_sum,\n                   random = pdBlocked(list(pdIdent(~1), pdIdent (~ X6\n-\n 1),\n                   pdIdent (~ X7 - 1), pdIdent(~ rand_mat -1))), data\n=\n gpdat)\n\n Which should recover the variance components:\n\n                 var_label            var_est\n          rand_mat_scalar         0.00021983\n         X6_scalar                       0.62314002\n         X7_scalar        0.03853604\n\n as recovered by GenStat and used to generate the dataset. Instead I\n get:\n\n X6      0.6231819\n X7     0.05221481\n rand_mat    1.377596e-11\n\n However, If I change or drop either of X5 or X6. I then get much\ncloser\n estimates to what is expected. For example:\n\n\n     mod2 <- lme(fixed = Y1 ~ X1 + X2 + X3 + X4 + X5 +  m_sum,\n                   random = pdBlocked(list(pdIdent(~1), pdIdent (~ X6\n-\n 1),\n                   pdIdent (~as.numeric( X7) - 1), pdIdent(~ rand_mat\n -1))), data = gpdat)\n\n returns variance components:\n X6      0.6137986\n X7     Not meaningful\n rand_mat    0.0006119088\n\n which is much closer to those used to generate the dataset for the\n parameters that are now meaningful, and has appropriate random effect\n estimates for the -rand_mat columns (the variable of most interest\n here). This suggests to me that there is some identifiability issue\nthat\n might be helped by giving different starting values. Is this\npossible?\n Or does anyone have any other suggestions?\n\n Thanks,\n\n Colin\n\n sessionInfo:\nR version 2.5.0 (2007-04-23) \ni386-pc-mingw32 \n\nlocale:\nLC_COLLATE=English_United Kingdom.1252;\nLC_CTYPE=English_United Kingdom.1252;\nLC_MONETARY=English_United Kingdom.1252;\nLC_NUMERIC=C;\nLC_TIME=English_United Kingdom.1252\n\nattached base packages:\n[1] \"stats\"     \"graphics\"  \"grDevices\" \"datasets\"  \"tcltk\"     \"utils\"\n    \"methods\"   \"base\"     \n\nother attached packages:\n       nlme      Matrix     lattice    svSocket        svIO      R2HTML\n     svMisc       svIDE \n   \"3.1-80\" \"0.9975-11\"    \"0.15-5\"     \"0.9-5\"     \"0.9-5\"      \"1.58\"\n    \"0.9-5\"     \"0.9-5\" \n\n\n\nDr. Colin Beale\nSpatial Ecologist\nThe Macaulay Institute\nCraigiebuckler\nAberdeen\nAB15 8QH\nUK\n\nTel: 01224 498245 ext. 2427\nFax: 01224 311556\nEmail: c.beale@macaulay.ac.uk \n\n\n\n-- \nPlease note that the views expressed in this e-mail are those of the\nsender and do not necessarily represent the views of the Macaulay\nInstitute. This email and any attachments are confidential and are\nintended solely for the use of the recipient(s) to whom they are\naddressed. If you are not the intended recipient, you should not read,\ncopy, disclose or rely on any information contained in this e-mail, and\nwe would ask you to contact the sender immediately and delete the email\nfrom your system. Thank you.\nMacaulay Institute and Associated Companies, Macaulay Drive,\nCraigiebuckler, Aberdeen, AB15 8QH.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}