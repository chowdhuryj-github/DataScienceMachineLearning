{"category": "ham", "to_address": "r-help <r-help@stat.math.ethz.ch>", "from_address": "gatemaze@gmail.com", "subject": "[R] partial correlation function", "body": "Hi,\n\nafter reading the archives I found some methods... adopted and\nmodified one of them to the following. I think it is correct after\nchecking and comparing the results with other software... but if\npossible someone could have a look and spot any mistakes I would be\ngrateful. Thanks\n\npcor3 <- function (x, test = T, p = 0.05, alternative=\"two.sided\") {\n  nvar <- ncol(x)\n  ndata <- nrow(x)\n  conc <- solve(cor(x))\n  resid.sd <- 1/sqrt(diag(conc))\n  pcc <- -sweep(sweep(conc, 1, resid.sd, \"*\"), 2, resid.sd, \"*\")\n  #colnames(pcc) <- rownames(pcc) <- colnames(x)\n  if (test) {\n    t.df <- ndata - nvar\n    t <- pcc/sqrt((1 - pcc^2)/t.df)\n    #pcc <- list(coefs = pcc, sig = t > qt(1 - (p/2), df = t.df)); #\noriginal statement\n    if (alternative == \"two.sided\") {\n      pcc <- list(coefs = pcc, sig = t > qt(1 - (p/2), df = t.df),\np.value = 2 * pmin(pt(t, t.df), 1-pt(t, t.df))) # two.sided\n    } else if (alternative == \"greater\") {\n      pcc <- list(coefs = pcc, sig = t > qt(1 - p, df = t.df), p.value\n= 1-pt(t, t.df)) # greater\n    } else if (alternative == \"less\") {\n      pcc <- list(coefs = pcc, sig = t > qt(1 - p, df = t.df), p.value\n= 2*(1-pt(t, t.df)))\n    }\n  }\n  str <- sprintf(\"Partial correlation for:\"); print(str, quote=FALSE);\n  str <- sprintf(\"%s\", colnames(x)); print(str, quote=FALSE);\n  str <- sprintf(\"p: %.2f, alternative: %s\", p, alternative);\nprint(str, quote=FALSE);\n  if (test) {\n    str <- sprintf(\"df: %d\", t.df); print(str, quote=FALSE);\n  }\n\n  return(pcc)\n}\n\n\n\nThe function was adopted from the following email:\nhttp://tolstoy.newcastle.edu.au/R/help/00a/0518.html\n\n-- \nyianni\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}