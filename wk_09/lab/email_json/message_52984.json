{"category": "ham", "to_address": "\"Andrej Kastrin\" <andrej.kastrin@siol.net>", "from_address": "\"Chas Owens\" <chas.owens@gmail.com>", "subject": "Re: Count co-occurrences", "body": "On 6/22/07, Andrej Kastrin  wrote:\n> Dear all,\n>\n> I wrote a simple sql querry to count co-occurrences between words but it\n> performs very very slow on large datasets. So, it's time to do it with\n> Perl. I need just a short tip to start out: which structure to use to\n> count all possible occurrences between letters (e.g. A, B and C) under\n> the particular document number. My dataset looks like following:\nsnip\n\nHere is my naive solution.\n\n#!/usr/bin/perl\n\nuse strict;\nuse warnings;\n\nmy %co;\nmy %doc;\nmy $oldid;\n\nwhile () {\n        chomp;\n        my ($id, $val) = split / /;\n        unless ($id eq $oldid or not defined $oldid) {\n                my @vals = sort keys %doc;\n                while (@vals) {\n                        my $val = shift @vals;\n                        for my $other (@vals) {\n                                $co{\"$val $other\"} += $doc{$val} * $doc{$other};\n                        }\n                }\n                %doc = ();\n        }\n        $doc{$val}++;\n        $oldid = $id;\n}\nmy @vals = sort keys %doc;\nwhile (@vals) {\n        my $val = shift @vals;\n        for my $other (@vals) {\n                $co{\"$val $other\"} += $doc{$val} * $doc{$other};\n        }\n}\n\nfor my $co (sort keys %co) {\n        print \"$co $co{$co}\\n\";\n}\n\n__DATA__\n1 A\n1 B\n1 C\n1 B\n2 A\n2 A\n2 B\n2 C\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}