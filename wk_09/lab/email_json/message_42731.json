{"category": "ham", "to_address": "John Sorkin <jsorkin@grecc.umaryland.edu>", "from_address": "Peter Dalgaard <p.dalgaard@biostat.ku.dk>", "subject": "Re: [R] lme vs. SAS proc mixed. Point estimates and SEs are the\n same, DFs are different", "body": "John Sorkin wrote:\n> R 2.3\n> Windows XP\n>\n> I am trying to understand lme. My aim is to run a random effects regression in which the intercept and jweek are random effects. I am comparing output from SAS PROC MIXED with output from R. The point estimates and the SEs are the same, however the DFs and the p values are different. I am clearly doing something wrong in my R code. I would appreciate any suggestions of how I can change the R code to get the same DFs as are provided by SAS.\n>   \nThis has been hashed over a number of times before. In short:\n\n1) You're not necessarily doing anything wrong\n2) SAS PROC MIXED is not necessarily doing it right\n3) lme() is _definitely_ not doing it right in some cases\n4) both work reasonably in large sample cases (but beware that this is \nnot equivalent to having many observation points)\n\nSAS has an implementation of the method by Kenward and Rogers, which \ncould be the most reliable general DF-calculation method around (I don't \ntrust their Satterthwaite option, though). Getting this or equivalent \ninto lme() has been on the wish list for a while, but it is not a \ntrivial thing to do.\n\n> SAS code:\n> proc mixed data=lipids2;\n>   model ldl=jweek/solution;\n>   random int jweek/type=un subject=patient;\n>   where lastvisit ge 4;\n> run;\n>\n> SAS output:\n>                    Solution for Fixed Effects\n>\n>                          Standard\n> Effect       Estimate       Error      DF    t Value    Pr > |t|\n>\n> Intercept      113.48      7.4539      25      15.22      <.0001\n> jweek         -1.7164      0.5153      24      -3.33      0.0028\n>\n>         Type 3 Tests of Fixed Effects\n>\n>               Num     Den\n> Effect         DF      DF    F Value    Pr > F\n> jweek           1      24      11.09    0.0028\n>\n>\n> R code:\n> LesNew3 <- groupedData(LDL~jweek | Patient, data=as.data.frame(LesData3), FUN=mean)\n> fit3    <- lme(LDL~jweek, data=LesNew3[LesNew3[,\"lastvisit\"]>=4,], random=~1+jweek)\n> summary(fit3) \n>\n> R output:\n> Random effects:\n>  Formula: ~1 + jweek | Patient\n>  Structure: General positive-definite, Log-Cholesky parametrization\n>  \n>\n> Fixed effects: LDL ~ jweek \n>                 Value Std.Error DF   t-value p-value\n> (Intercept) 113.47957  7.453921 65 15.224144  0.0000\n> jweek        -1.71643  0.515361 65 -3.330535  0.0014\n>\n> John Sorkin M.D., Ph.D.\n> Chief, Biostatistics and Informatics\n> University of Maryland School of Medicine Division of Gerontology\n> Baltimore VA Medical Center\n> 10 North Greene Street\n> GRECC (BT/18/GR)\n> Baltimore, MD 21201-1524\n> (Phone) 410-605-7119\n> (Fax) 410-605-7913 (Please call phone number above prior to faxing)\n>\n> Confidentiality Statement:\n> This email message, including any attachments, is for the so...{{dropped}}\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}