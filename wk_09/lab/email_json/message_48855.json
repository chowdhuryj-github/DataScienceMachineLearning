{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jra@samba.org", "subject": "svn commit: samba r23512 - in branches: SAMBA_3_0/source/include\n\tSAMBA_3_0/source/registry SAMBA_3_0_26/source/include\n\tSAMBA_3_0_26/source/registry", "body": "Author: jra\nDate: 2007-06-15 23:47:40 +0000 (Fri, 15 Jun 2007)\nNew Revision: 23512\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23512\n\nLog:\nFix conflict in #define for SECDESC_PREFIX. Ensure all\nreg #defines use \"REG_\" prefix. Michael - please check\ngcc warnings on compiles.\nJeremy.\n\nModified:\n   branches/SAMBA_3_0/source/include/reg_db.h\n   branches/SAMBA_3_0/source/registry/reg_db.c\n   branches/SAMBA_3_0_26/source/include/reg_db.h\n   branches/SAMBA_3_0_26/source/registry/reg_db.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/include/reg_db.h\n===================================================================\n--- branches/SAMBA_3_0/source/include/reg_db.h\t2007-06-15 22:06:50 UTC (rev 23511)\n+++ branches/SAMBA_3_0/source/include/reg_db.h\t2007-06-15 23:47:40 UTC (rev 23512)\n@@ -25,7 +25,7 @@\n \n #define REGVER_V1       1       /* first db version with write support */\n \n-#define VALUE_PREFIX    \"SAMBA_REGVAL\"\n-#define SECDESC_PREFIX  \"SAMBA_SECDESC\"\n+#define REG_VALUE_PREFIX    \"SAMBA_REGVAL\"\n+#define REG_SECDESC_PREFIX  \"SAMBA_SECDESC\"\n \n #endif /* _REG_DB_H */\n\nModified: branches/SAMBA_3_0/source/registry/reg_db.c\n===================================================================\n--- branches/SAMBA_3_0/source/registry/reg_db.c\t2007-06-15 22:06:50 UTC (rev 23511)\n+++ branches/SAMBA_3_0/source/registry/reg_db.c\t2007-06-15 23:47:40 UTC (rev 23512)\n@@ -444,7 +444,7 @@\n \t\t\tgoto fail;\n \t\t}\n \t\t\n-\t\tpstr_sprintf( path, \"%s/%s/%s\", VALUE_PREFIX, key,\n+\t\tpstr_sprintf( path, \"%s/%s/%s\", REG_VALUE_PREFIX, key,\n \t\t\t      oldkeyname );\n \t\tnormalize_reg_path( path );\n \n@@ -637,7 +637,7 @@\n \n \tDEBUG(10,(\"regdb_fetch_values: Looking for value of key [%s] \\n\", key));\n \t\n-\tpstr_sprintf( keystr, \"%s/%s\", VALUE_PREFIX, key );\n+\tpstr_sprintf( keystr, \"%s/%s\", REG_VALUE_PREFIX, key );\n \tnormalize_reg_path( keystr );\n \t\n \tdata = tdb_fetch_bystring( tdb_reg->tdb, keystr );\n@@ -682,7 +682,7 @@\n \t\n \tSMB_ASSERT( len == data.dsize );\n \t\n-\tpstr_sprintf( keystr, \"%s/%s\", VALUE_PREFIX, key );\n+\tpstr_sprintf( keystr, \"%s/%s\", REG_VALUE_PREFIX, key );\n \tnormalize_reg_path( keystr );\n \t\n \tret = tdb_trans_store_bystring(tdb_reg->tdb, keystr, data, TDB_REPLACE);\n@@ -701,7 +701,7 @@\n \n \tDEBUG(10, (\"regdb_get_secdesc: Getting secdesc of key [%s]\\n\", key));\n \n-\tif (asprintf(&tdbkey, \"%s/%s\", SECDESC_PREFIX, key) == -1) {\n+\tif (asprintf(&tdbkey, \"%s/%s\", REG_SECDESC_PREFIX, key) == -1) {\n \t\treturn WERR_NOMEM;\n \t}\n \tnormalize_dbkey(tdbkey);\n@@ -744,7 +744,7 @@\n \n \tZERO_STRUCT(ps);\n \n-\tif (!(tdbkey = talloc_asprintf(mem_ctx, \"%s/%s\", SECDESC_PREFIX,\n+\tif (!(tdbkey = talloc_asprintf(mem_ctx, \"%s/%s\", REG_SECDESC_PREFIX,\n \t\t\t\t       key))) {\n \t\tgoto done;\n \t}\n\nModified: branches/SAMBA_3_0_26/source/include/reg_db.h\n===================================================================\n--- branches/SAMBA_3_0_26/source/include/reg_db.h\t2007-06-15 22:06:50 UTC (rev 23511)\n+++ branches/SAMBA_3_0_26/source/include/reg_db.h\t2007-06-15 23:47:40 UTC (rev 23512)\n@@ -25,7 +25,7 @@\n \n #define REGVER_V1       1       /* first db version with write support */\n \n-#define VALUE_PREFIX    \"SAMBA_REGVAL\"\n-#define SECDESC_PREFIX  \"SAMBA_SECDESC\"\n+#define REG_VALUE_PREFIX    \"SAMBA_REGVAL\"\n+#define REG_SECDESC_PREFIX  \"SAMBA_SECDESC\"\n \n #endif /* _REG_DB_H */\n\nModified: branches/SAMBA_3_0_26/source/registry/reg_db.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/registry/reg_db.c\t2007-06-15 22:06:50 UTC (rev 23511)\n+++ branches/SAMBA_3_0_26/source/registry/reg_db.c\t2007-06-15 23:47:40 UTC (rev 23512)\n@@ -444,7 +444,7 @@\n \t\t\tgoto fail;\n \t\t}\n \t\t\n-\t\tpstr_sprintf( path, \"%s/%s/%s\", VALUE_PREFIX, key,\n+\t\tpstr_sprintf( path, \"%s/%s/%s\", REG_VALUE_PREFIX, key,\n \t\t\t      oldkeyname );\n \t\tnormalize_reg_path( path );\n \n@@ -637,7 +637,7 @@\n \n \tDEBUG(10,(\"regdb_fetch_values: Looking for value of key [%s] \\n\", key));\n \t\n-\tpstr_sprintf( keystr, \"%s/%s\", VALUE_PREFIX, key );\n+\tpstr_sprintf( keystr, \"%s/%s\", REG_VALUE_PREFIX, key );\n \tnormalize_reg_path( keystr );\n \t\n \tdata = tdb_fetch_bystring( tdb_reg->tdb, keystr );\n@@ -682,7 +682,7 @@\n \t\n \tSMB_ASSERT( len == data.dsize );\n \t\n-\tpstr_sprintf( keystr, \"%s/%s\", VALUE_PREFIX, key );\n+\tpstr_sprintf( keystr, \"%s/%s\", REG_VALUE_PREFIX, key );\n \tnormalize_reg_path( keystr );\n \t\n \tret = tdb_trans_store_bystring(tdb_reg->tdb, keystr, data, TDB_REPLACE);\n@@ -701,7 +701,7 @@\n \n \tDEBUG(10, (\"regdb_get_secdesc: Getting secdesc of key [%s]\\n\", key));\n \n-\tif (asprintf(&tdbkey, \"%s/%s\", SECDESC_PREFIX, key) == -1) {\n+\tif (asprintf(&tdbkey, \"%s/%s\", REG_SECDESC_PREFIX, key) == -1) {\n \t\treturn WERR_NOMEM;\n \t}\n \tnormalize_dbkey(tdbkey);\n@@ -744,7 +744,7 @@\n \n \tZERO_STRUCT(ps);\n \n-\tif (!(tdbkey = talloc_asprintf(mem_ctx, \"%s/%s\", SECDESC_PREFIX,\n+\tif (!(tdbkey = talloc_asprintf(mem_ctx, \"%s/%s\", REG_SECDESC_PREFIX,\n \t\t\t\t       key))) {\n \t\tgoto done;\n \t}\n\n"}