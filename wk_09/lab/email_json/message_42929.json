{"category": "ham", "to_address": "\"Laurence Amilhat\" <Laurence.Amilhat@toulouse.inra.fr>", "from_address": "\"Sarah Goslee\" <sarah.goslee@gmail.com>", "subject": "Re: [R] odfTable", "body": "Hi,\n\nThere are a couple of steps, and it requires use of the newest version of\nodfWeave.\n\nFirst, you need to set up the table styles in R _before_ you run odfWeave.\n\nHere's an example:\n\n\t# Now to specify the styles themselves\n\t# The default list has 10 styles in it right now.\n\texistingStyles <- getStyleDefs()\n\n\t# Use one of the cell styles as a template for the new cell style\n\t# The style definition contains information on background\n\t# color, alignment, and borders.\n\t# For style 1, I want a background color.\n\t# Colors can be specified in hex format, or as \"transparent\".\n\tnewStyle1 <- existingStyles$noBorder\n\tnewStyle1$backgroundColor <- \"#cccccc\"\n\n\t# Finally, the new styles need to be set.\n\texistingStyles <- c(existingStyles, newStyle1=list(newStyle1))\n\tsetStyleDefs(existingStyles)\n\nAfter that, you can use the new style when defining your table in an\nodfWeave document:\n\n<>=\n\t### Conditional formatting based on the value of the table cell\n\tx <- data.frame(Var1=1:3, Var2=4:6, Var3=7:9, row.names=c(\"A\", \"B\", \"C\"))\n\n\t# Here's a matrix specifying the desired styles for each cell in the table.\n\t# This could be p-values for the correlations in x, for example. For\n\t# this example, I'm just making it up.\n\t# The style matrix must have an additional column for the row names.\n\ty <- matrix(c(0, 0, 0, 1,0,0,3,0,1,2,0,2), byrow=FALSE, nrow=3, ncol=4)\n\ty <- data.frame(y)\n\tcolnames(y) <- c(\"rownames\", \"Var1\", \"Var2\", \"Var3\")\n\n\t# Now, to specify when to use these new styles.\n\t# tableStyles() will provide the default styles for each\n\t# element of x\n\t# note that I'm creating the styles for x based on y,\n\t# which already has the extra column for row names.\n\tx.styles <- tableStyles(y, header=colnames(y))\n\n\t# every element of x has two associated styles\n\t# for the cells, text style is in text and cell style is in cell\n\t# for headers, it is in header and headerCell\n\t\n\t# newStyle1 and newStyle2 are cell styles, so they are set here:\n\tx.styles$cell[y == 1] <- \"newStyle1\"\n\n\todfTable(x, useRowNames = TRUE, styles = x.styles)\n@\n\nI have a more detailed explanation that I can send off-list if you are\ninterested. For your specific problem, you'd need to set the headerCell\nstyle.\n\nSarah\n\n\nOn 6/5/07, Laurence Amilhat  wrote:\n> Hello,\n>\n> I am using the odfWeave packages;\n> I draw a table using the function odfTable:\n>\n> partCols <- gsub(\"\\\\.\", \" \", names(partenaires))\n> odfTable(partenaires, useRowNames = FALSE, colnames=partCols)\n>\n>\n> it's working as I have a table in my output file.\n> I would like to know how to change the background color for the header\n> cells.\n> I assuming i have to use tableStyles, but I don't understand how.\n>\n> Does someone have an idea to help me?\n>\n\n-- \nSarah Goslee\nhttp://www.functionaldiversity.org\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}