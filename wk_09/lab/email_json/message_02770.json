{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Francois Teste <fteste@interchange.ubc.ca>", "subject": "[R] Error with corCompSymm and lme fit for repeated measures", "body": "Dear R Friends,  \nI need help with an error associated with corCompSymm in an lme fit.\nI am using a mixed effects model to analyze a split-plot with\nrepeated measures and would like to fit with the compound symmetry\ncorrelation structure.  This problem doesn't occur when using\ncorAR1 or any of the other structures.  I would greatly appreciate\nhelp on how to solve this issue.  \n\nHere's my data, code lines, and error messages:\n\n> PhotoRed\n   TreeID Block  M    D   Time           y\n1       1   Dgl s1 0.5m   june  2.91130232\n2       1   Dgl s1 1.0m   june  4.92232779\n3       1   Dgl s1 2.5m   june  6.17724409\n4       1   Dgl s1 5.0m   june  3.34278032\n5       1   Dgl s1 0.5m   july  6.30782170\n6       1   Dgl s1 1.0m   july  6.98652976\n7       1   Dgl s1 2.5m   july  8.80715989\n8       1   Dgl s1 5.0m   july  7.19424460\n9       1   Dgl s1 0.5m august  4.46399690\n10      1   Dgl s1 1.0m august 10.63857941\n11      1   Dgl s1 2.5m august  9.84689405\n12      1   Dgl s1 5.0m august 13.15311387\n13      2   Dgl s4 0.5m   june  5.37380975\n14      2   Dgl s4 1.0m   june  4.05953992\n15      2   Dgl s4 2.5m   june  6.53184737\n16      2   Dgl s4 5.0m   june  4.85340448\n17      2   Dgl s4 0.5m   july  3.77109456\n18      2   Dgl s4 1.0m   july  6.64288350\n19      2   Dgl s4 2.5m   july  9.74241641\n20      2   Dgl s4 5.0m   july  5.10884682\n21      2   Dgl s4 0.5m august  8.01357594\n22      2   Dgl s4 1.0m august  5.31430680\n23      2   Dgl s4 2.5m august 10.62809063\n24      2   Dgl s4 5.0m august 10.30284109\n25      3   Dog s1 0.5m   june          NA\n26      3   Dog s1 1.0m   june  3.29442388\n27      3   Dog s1 2.5m   june  1.02478107\n28      3   Dog s1 5.0m   june          NA\n29      3   Dog s1 0.5m   july          NA\n30      3   Dog s1 1.0m   july  2.19628259\n31      3   Dog s1 2.5m   july  1.11794299\n32      3   Dog s1 5.0m   july          NA\n33      3   Dog s1 0.5m august          NA\n34      3   Dog s1 1.0m august  2.44031399\n35      3   Dog s1 2.5m august  0.37264766\n36      3   Dog s1 5.0m august          NA\n37      4   Dog s4 0.5m   june  4.33381487\n38      4   Dog s4 1.0m   june  1.34196737\n39      4   Dog s4 2.5m   june  0.12930756\n40      4   Dog s4 5.0m   june  6.51695980\n41      4   Dog s4 0.5m   july  1.33348150\n42      4   Dog s4 1.0m   july  2.81174115\n43      4   Dog s4 2.5m   july  7.69379970\n44      4   Dog s4 5.0m   july  6.35992462\n45      4   Dog s4 0.5m august  3.66707412\n46      4   Dog s4 1.0m august  0.44732246\n47      4   Dog s4 2.5m august  7.75845348\n48      4   Dog s4 5.0m august  5.96733668\n49      6     F s1 0.5m   june  6.98640483\n50      6     F s1 1.0m   june  8.14953755\n51      6     F s1 2.5m   june  4.50763794\n52      6     F s1 5.0m   june  6.62297344\n53      6     F s1 0.5m   july 13.59516616\n54      6     F s1 1.0m   july  9.31375720\n55      6     F s1 2.5m   july  8.01357856\n56      6     F s1 5.0m   july  3.72542256\n57      6     F s1 0.5m august  2.45468278\n58      6     F s1 1.0m august  2.13440269\n59      6     F s1 2.5m august  0.08347478\n60      6     F s1 5.0m august          NA\n61      7     F s4 0.5m   june          NA\n62      7     F s4 1.0m   june          NA\n63      7     F s4 2.5m   june  6.03948199\n64      7     F s4 5.0m   june  5.73051868\n65      7     F s4 0.5m   july          NA\n66      7     F s4 1.0m   july          NA\n67      7     F s4 2.5m   july 10.27613353\n68      7     F s4 5.0m   july  8.00803252\n69      7     F s4 0.5m august          NA\n70      7     F s4 1.0m august          NA\n71      7     F s4 2.5m august 10.27613353\n72      7     F s4 5.0m august  7.34681883\n\n> lme1 = lme(y ~ M*D*Time, random=~1|Block/M/D/Time, data=PhotoRed, na.action=na.omit)\n> lme2 = update(lme1, correlation=corAR1())\n> lme3 = update(lme1, correlation=corCompSymm())\nError in corMatrix.corCompSymm(object) : NA/NaN/Inf in foreign function call (arg 1)\n> cs = corCompSymm(value=0.5,form=~1|TreeID)\n> lme3 = update(lme1, correlation=cs)\nError in lme.formula(fixed = y ~ M * D * Time, data = PhotoRed, random = ~1 |  : \n\tIncompatible formulas for groups in \"random\" and \"correlation\"\n>\n--\nFrancois Teste (Ph.D. candidate)\nThe University of British Columbia\nDepartment of Forest Sciences\n3041-2424 Main Mall\nVancouver, B.C., Canada, V6T 1Z4\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}