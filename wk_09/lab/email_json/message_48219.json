{"category": "ham", "to_address": "Volker Lendecke <Volker.Lendecke@SerNet.DE>", "from_address": "Jeremy Allison <jra@samba.org>", "subject": "Re: rename_internals and rename_internals_fsp consolidated", "body": "On Fri, Jun 15, 2007 at 12:07:51AM +0200, Volker Lendecke wrote:\n> Hi, Jeremy!\n> \n> Attached find a patch with lots of \"-\" inside: It changes\n> rename_internals to open the file and then calls\n> rename_internals_fsp. This then does not open the file a\n> second time via can_delete, we already checked the share\n> modes in the first open.\n> \n> It does not survive the wildcard part of RAW-RENAME yet and\n> something in RAW-NOTIFY is broken, but I think that can be\n> fixed.\n\nJust one not of caution...\n\nCurrently it doesn't map NT_STATUS_SHARING_VIOLATION into\nNT_STATUS_ACCESS_DENIED as the old code used to do. Do we\nhave a torture test for this case ?\n\nI don't think we have to handle deferred opens (I don't\nthink the old code does) but do we have enough test\ncoverage to be sure ?\n\nJeremy\n\n"}