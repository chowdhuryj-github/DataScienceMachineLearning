{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jerry@samba.org", "subject": "svn commit: samba r22711 - in branches: SAMBA_3_0/source/nsswitch\n\tSAMBA_3_0_26/source/nsswitch", "body": "Author: jerry\nDate: 2007-05-06 20:32:36 +0000 (Sun, 06 May 2007)\nNew Revision: 22711\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22711\n\nLog:\nFix a compile warnign in query_user().  Ensure that user_rid\nis initialized.\n\n\nModified:\n   branches/SAMBA_3_0/source/nsswitch/winbindd_ads.c\n   branches/SAMBA_3_0/source/nsswitch/winbindd_rpc.c\n   branches/SAMBA_3_0_26/source/nsswitch/winbindd_ads.c\n   branches/SAMBA_3_0_26/source/nsswitch/winbindd_rpc.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/nsswitch/winbindd_ads.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/winbindd_ads.c\t2007-05-06 20:16:12 UTC (rev 22710)\n+++ branches/SAMBA_3_0/source/nsswitch/winbindd_ads.c\t2007-05-06 20:32:36 UTC (rev 22711)\n@@ -461,7 +461,6 @@\n \tchar *sidstr;\n \tuint32 group_rid;\n \tNTSTATUS status = NT_STATUS_UNSUCCESSFUL;\n-\tuint32 user_rid;\n \tNET_USER_INFO_3 *user;\n \n \tDEBUG(3,(\"ads: query_user\\n\"));\n@@ -478,7 +477,7 @@\n \t\tDEBUG(5,(\"query_user: Cache lookup succeeded for %s\\n\", \n \t\t\tsid_string_static(sid)));\n \n-\t\tsid_compose(&info->user_sid, &domain->sid, user_rid);\n+\t\tsid_compose(&info->user_sid, &domain->sid, user->user_rid);\n \t\tsid_compose(&info->group_sid, &domain->sid, user->group_rid);\n \t\t\t\t\n \t\tinfo->acct_name = unistr2_tdup(mem_ctx, &user->uni_user_name);\n\nModified: branches/SAMBA_3_0/source/nsswitch/winbindd_rpc.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/winbindd_rpc.c\t2007-05-06 20:16:12 UTC (rev 22710)\n+++ branches/SAMBA_3_0/source/nsswitch/winbindd_rpc.c\t2007-05-06 20:32:36 UTC (rev 22711)\n@@ -438,7 +438,7 @@\n \t\tDEBUG(5,(\"query_user: Cache lookup succeeded for %s\\n\", \n \t\t\tsid_string_static(user_sid)));\n \n-\t\tsid_compose(&user_info->user_sid, &domain->sid, user_rid);\n+\t\tsid_compose(&user_info->user_sid, &domain->sid, user->user_rid);\n \t\tsid_compose(&user_info->group_sid, &domain->sid,\n \t\t\t    user->group_rid);\n \t\t\t\t\n\nModified: branches/SAMBA_3_0_26/source/nsswitch/winbindd_ads.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/nsswitch/winbindd_ads.c\t2007-05-06 20:16:12 UTC (rev 22710)\n+++ branches/SAMBA_3_0_26/source/nsswitch/winbindd_ads.c\t2007-05-06 20:32:36 UTC (rev 22711)\n@@ -461,7 +461,6 @@\n \tchar *sidstr;\n \tuint32 group_rid;\n \tNTSTATUS status = NT_STATUS_UNSUCCESSFUL;\n-\tuint32 user_rid;\n \tNET_USER_INFO_3 *user;\n \n \tDEBUG(3,(\"ads: query_user\\n\"));\n@@ -478,7 +477,7 @@\n \t\tDEBUG(5,(\"query_user: Cache lookup succeeded for %s\\n\", \n \t\t\tsid_string_static(sid)));\n \n-\t\tsid_compose(&info->user_sid, &domain->sid, user_rid);\n+\t\tsid_compose(&info->user_sid, &domain->sid, user->user_rid);\n \t\tsid_compose(&info->group_sid, &domain->sid, user->group_rid);\n \t\t\t\t\n \t\tinfo->acct_name = unistr2_tdup(mem_ctx, &user->uni_user_name);\n\nModified: branches/SAMBA_3_0_26/source/nsswitch/winbindd_rpc.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/nsswitch/winbindd_rpc.c\t2007-05-06 20:16:12 UTC (rev 22710)\n+++ branches/SAMBA_3_0_26/source/nsswitch/winbindd_rpc.c\t2007-05-06 20:32:36 UTC (rev 22711)\n@@ -438,7 +438,7 @@\n \t\tDEBUG(5,(\"query_user: Cache lookup succeeded for %s\\n\", \n \t\t\tsid_string_static(user_sid)));\n \n-\t\tsid_compose(&user_info->user_sid, &domain->sid, user_rid);\n+\t\tsid_compose(&user_info->user_sid, &domain->sid, user->user_rid);\n \t\tsid_compose(&user_info->group_sid, &domain->sid,\n \t\t\t    user->group_rid);\n \t\t\t\t\n\n"}