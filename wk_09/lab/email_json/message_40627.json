{"category": "ham", "to_address": "\"Alex Chen\" <ychen@insightful.com>", "from_address": "\"Spielas Bates\" <bates@stat.wisc.edu>", "subject": "Re: [R] Calling C routine in anther package in C code\n\t(R_RegisterCCallable)", "body": "It looks like your C++ compiler is mangling the name\nR_RegisterCCallable.  Move the\n\nextern \"C\"\n\nbefore the\n\n#include \n\nOn 6/1/07, Alex Chen  wrote:\n> Hi,\n>\n>\n>\n> I want to make use of some C routines from other packages to write extensions\n> in C.\n>\n>\n>\n> In \"Writing R Extensions\", it says there is an experimental interface to\n> support this in (or from ?) R 2.4.0.\n>\n>\n>\n> I had a dummy library containing src/dummy.cpp and R/zzz.R:\n>\n>\n>\n> ====== src/dummy.cpp ====\n>\n> #include \n>\n> #include \n>\n> #include \n>\n>\n>\n> extern \"C\"\n>\n> {\n>\n>   void dummy(int *a, int *b)\n>\n>   {\n>\n>     printf(\"dummy\\n\");\n>\n>   }\n>\n> }\n>\n>\n>\n> void R_init_dummy(DllInfo *dll)\n>\n> {\n>\n>   R_RegisterCCallable(\"dummy\", \"dummy\", (DL_FUNC)dummy);\n>\n> }\n>\n>\n>\n> ====== R/zzz.R =========\n>\n>\n>\n> .First.lib <- function(lib, pkg) {\n>\n>   library.dynam(\"dummy\", pkg, lib)\n>\n> }\n>\n>\n>\n> ======================\n>\n>\n>\n> I can compile this using R 2.5.0 under Linux.\n>\n>\n>\n> But I got the following error when I tried to load the library\n>\n>\n>\n> >library(dummy):\n>\n> Error in dyn.load(x, as.logical(local), as.logical(now)) :\n>\n>         unable to load shared library\n> '/homes/ychen/Rlibs/dummy/libs/dummy.so':\n>\n>   /homes/ychen/Rlibs/dummy/libs/dummy.so: undefined symbol:\n> _Z19R_RegisterCCallablePcS_PFPvvE\n>\n> Error in library(dummy) : .First.lib failed for 'dummy'\n>\n>\n>\n> Can anyone help me out?\n>\n>\n>\n> Thanks!\n>\n>\n>\n> Alex\n>\n>\n>         [[alternative HTML version deleted]]\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}