{"category": "ham", "to_address": "dieter.menne@menne-biomed.de", "from_address": "Paul Murrell <p.murrell@auckland.ac.nz>", "subject": "Re: [R] Print grid/ggplot to a metafile", "body": "Hi\n\n\nDieter Menne wrote:\n> Dear UseRs called Hadley, or Paul,\n> \n> I am trying to print an edited ggplot2/grid graphics to a metafile. With the\n> commented line below it works, but when I edit the plot by uncommenting the\n> line, it fails, because it's illegal to have 2 graphics in a metafile. It\n> works with pdf, but even then I get two plots, which is a nuisance.\n> \n> I found a workaround by using windows(); savePlot, but it only works in\n> interactive mode, not when called with something like (Windows)\n> \n> rterm --no-save < printit.r\n> \n> Any ideas?\n\n\nYou can capture the ggplot drawing as a grid grob (gTree), edit that (no \ndrawing occurs to this point), and then draw it ...\n\ngridggplot <- grid.grabExpr(print(ggplot(mtcars, aes(x=cyls)) +\n                                   geom_bar()))\nmodgridggplot <- editGrob(gridggplot,\n                           \"xaxis::labels::label.text\",\n                           just=c(\"center\",\"center\"),\n                           grep=TRUE, global=TRUE)\n\nwin.metafile(file=\"bar.emf\")\ngrid.draw(modgridggplot)\ndev.off()\n\nPaul\n\n\n> Dieter\n> \n> #------\n> library(ggplot2)\n> win.metafile(file=\"bar.emf\")\n> mtcars$cyls = factor(mtcars$cyl,\n>   labels=c(\"four\\ncylinders\",\"six\\ncylinders\",\"eight\\ncylinders\"))\n> ggplot(mtcars, aes(x=cyls)) + geom_bar()\n> #grid.gedit(\"xaxis::labels::label.text\",just=c(\"center\",\"center\"))\n> dev.off()\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n-- \nDr Paul Murrell\nDepartment of Statistics\nThe University of Auckland\nPrivate Bag 92019\nAuckland\nNew Zealand\n64 9 3737599 x85392\npaul@stat.auckland.ac.nz\nhttp://www.stat.auckland.ac.nz/~paul/\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}