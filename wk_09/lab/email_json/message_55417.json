{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "francogrex <francogrex@mail.com>", "subject": "[R] GLM, log-binomial likelihood", "body": "\nDear R-help users, I have a question concerning re-writing a function in R:\n\nSuppose I have the data, y is number of successes and N is total number of\ntrials and x is the variable\n (example:)\nx\ty\tN\n1\t10\t150\n0\t1\t100\n \nI want to estimate the risk ratio by determining the coefficients of a\nlog-binomial regression so I use:\n\n> glm(cbind(y, N - y) ~ x, family = binomial(link = \"log\"))\nCoefficients:\n(Intercept)            x  \n     -4.605        1.897 \nUsing  family=binomial(link=\"log\") instead of family=\"binomial\" to specify\nthe log instead of the logit link function, so that the coefficient is the\nlog of the risk ratio.\n\nI know that the equivalent negative log-likelihood\nfunction is:\n\nlogregfun = function(a, b) {\np.pred = exp(a + b * x)\n-sum(dbinom(y, size = N, prob = p.pred, log = TRUE))\n}\n\nBut I am interesting in doing the calculation not using the glm function but\nby optimizing the log-likelihood myself (so that I can play around with it\nlater, add priors etc...): using the above negative-log likelihood and optim\nI can calculate the coefficients.\nBut how can I re-write the log-likelihood function if my data are in a list\n(and not provided as number of successes and total number of trials): such\nas\n\nx\ty\n0\t0\n0\t1\n1\t1\n0\t1\n...\t...\netc until 250 rows (or sometimes more)?\nwhere 0 indicates absence and 1 indicates presence/success\n\nThanks\n-- \nView this message in context: http://www.nabble.com/GLM%2C-log-binomial-likelihood-tf3981349.html#a11302456\nSent from the R help mailing list archive at Nabble.com.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}