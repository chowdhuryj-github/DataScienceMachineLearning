{"category": "ham", "to_address": "beginners@perl.org, perl-beginners@moderators.isc.org", "from_address": "Alma <almatirkey@gmail.com>", "subject": "Re: creation of directory on daily basis and store the files in it", "body": "On May 25, 1:30 pm, \"eish...@googlemail.com\" \nwrote:\n> On May 23, 9:59 am, Alma  wrote:\n>\n>\n>\n> > On May 23, 7:28 am, \"eish...@googlemail.com\" \n> > wrote:\n>\n> > > On May 23, 8:14 am, \"eish...@googlemail.com\" \n> > > wrote:\n>\n> > > > On May 23, 7:47 am, \"eish...@googlemail.com\" \n> > > > wrote:\n>\n> > > > > On May 23, 5:13 am, Alma  wrote:\n>\n> > > > > > Hi All,\n>\n> > > > > >  I have tocreatea script that creates adirectoryon day basis &\n> > > > > > need to store the files uploaded on that particular day to that\n> > > > > >directory.\n>\n> > > > > > Any help regarding it will be appreciated .\n>\n> > > > > > alma\n>\n> > > > > #!/usr/bin/perl -w\n>\n> > > > > use strict;\n> > > > > use File::Find;\n> > > > > use File::Copy;\n> > > > > use Time::Local;\n>\n> > > > > my($day, $mon, $yr) = (localtime)[3, 4, 5];\n> > > > > my $dir = $day . \"_\" . ($mon + 1) . \"_\" . ($yr + 1900); # check epoch\n> > > > > if you are going to use date as dir name (UNIX $yr + 30 i think)\n>\n> > > > > mkdir \"$dir\";\n> > > > > print \"directorycreated: $dir\\n\";\n>\n> > > > > my $start = timelocal(0, 0, 0, $day, $mon, $yr);        # midnight today\n> > > > > my $stop = $start + (24 * 60 * 60 ) - 1;\n>\n> > > > > sub find_uploads_today{\n> > > > >         my $start = shift;\n> > > > >         my $stop = shift;\n> > > > >         my @files;\n>\n> > > > >         return (\n> > > > >                 sub{\n> > > > >                         my $timestamp = (stat $_)[9];\n> > > > >                         push @files, $_ if  $timestamp > $start && $timestamp < $stop && -\n> > > > > f;\n> > > > >                 },\n> > > > >                 sub{\n> > > > >                         return @files;\n> > > > >                 }\n> > > > >         );\n>\n> > > > > }\n>\n> > > > > my($gather, $yield)  = find_uploads_today($start, $stop);\n> > > > > find($gather, \".\");\n> > > > > my @files = $yield->(); # contains only files that are uploaded today\n>\n> > > > > foreach (@files)\n> > > > > {\n> > > > >         if ($_ ne $0){ # ensuring that if script in same dir as uploads it is\n> > > > > not moved to day folder\n> > > > >                 move(\"$_\", \"$dir/$_\") or die \"move failed: $!\"; # 2nd param is\n> > > > > system specific - change if using Windows\n> > > > >         print \"moving $_\\n\";\n> > > > >         }\n>\n> > > > > }\n>\n> > > > you can cut these lines and place them in the sub in place of $start =\n> > > > shift and $stop = shift:\n> > > > my $start = timelocal(0, 0, 0, $day, $mon, $yr);        # midnight\n> > > > today\n> > > > my $stop = $start + (24 * 60 * 60 ) - 1;\n>\n> > > you could also replace the foreach loop at the bottom with:\n>\n> > > grep {\n> > >         if ($_ ne $0){\n> > >                 move(\"$_\", \"$dir/$_\") or die \"$!\";\n> > >                 print \"moving $_\\n\";\n> > >         }\n>\n> > > } @files;\n>\n> > Thanks a lot.\n>\n> > Can i keep the perl scrip to create a directory in cron.daily. so that\n> > it gets created & while storing the files in the date folder. it\n> > checks for the today's date & store it .\n>\n> Do you want all the uploaded files copied to the same main directory\n> (moved_uploads) but separated by date?\n> +some_folder\n> +moved_uploads\n>  |-24_May_2007\n>  |-25_May_2007\n\nyes a sort of i wanted tot keep the main folder as backup.\nfor ex. /home/project/backup/$_today's_dir(Which should be date) &\ndump all the files uploaded today . for tommorow another folder should\nget created in the location\n/home/project/backup/$tommorow_dir ..\n\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}