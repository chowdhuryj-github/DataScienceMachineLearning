{"category": "ham", "to_address": "\"Frank E Harrell Jr\" <f.harrell@vanderbilt.edu>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] Coercing data types for use in model.frame", "body": "You could try to follow the code in the dyn package.  It intercepts\nmodel.frame calls involving time series objects so that it can align\nlagged objects:\n\ne.g.\nz <- ts(seq(10)^2)\nlibrary(dyn)\ndyn$lm(z ~ lag(z, -1))\n\nIt transforms the last line above to:\n\ndyn(lm(dyn(z ~ lag(z, -1)))\n\nand the inner dyn then produces a formula with class c(\"dyn\", \"model.frame\")\nso that model.frame.dyn can intercept the call while the outer dyn adds\n\"dyn\" to the class of the result so that anova.dyn, predict.dyn, etc. can be\nused to intercept the result.\n\nThus for any lm-like function you just preface it with dyn$ as shown and\nyou get automatically alignment of time series or in your case you would\ninterception of the mChoice variables.\n\nOn 4/24/07, Frank E Harrell Jr  wrote:\n> In the Hmisc package there is a new data class 'mChoice' for multiple\n> choice variables.  There are format and as.numeric methods (the latter\n> creates a matrix of dummy variables).  mChoice variables are not allowed\n> by model.frame.  Is there a way to specify a conversion function that\n> model.frame will use automatically?  I would use as.factor here.\n> model.frame does not seem to use as.data.frame.foo for individual variables.\n>\n> Thanks\n> Frank\n> --\n> Frank E Harrell Jr   Professor and Chair           School of Medicine\n>                      Department of Biostatistics   Vanderbilt University\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}