{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "obnox@samba.org", "subject": "svn commit: samba-docs r1127 - in trunk: manpages-3 smbdotconf/misc", "body": "Author: obnox\nDate: 2007-06-22 22:44:13 +0000 (Fri, 22 Jun 2007)\nNew Revision: 1127\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba-docs&rev=1127\n\nLog:\nAdd an initial amount of documentation of registry based\nconfiguration to smb.conf(5). This explains registry shares\nand registry global options and mentions \"net conf\". \n\nThis will be in 3.0.26, but Jerry told me to commit this\nanyways. The plan is to branch the doc for 3.0.25b from r1126 (say).\n\nI could not check the result since I could not get the\nmanpages built correctly on any system I tried. So the\noutput needs to be checked - sorry, I will fix my \nenvironment later...\n\nMichael\n\n\nAdded:\n   trunk/smbdotconf/misc/registryshares.xml\nModified:\n   trunk/manpages-3/smb.conf.5.xml\n   trunk/smbdotconf/misc/include.xml\n\n\nChangeset:\nModified: trunk/manpages-3/smb.conf.5.xml\n===================================================================\n--- trunk/manpages-3/smb.conf.5.xml\t2007-06-19 17:17:37 UTC (rev 1126)\n+++ trunk/manpages-3/smb.conf.5.xml\t2007-06-22 22:44:13 UTC (rev 1127)\n@@ -712,6 +712,84 @@\n \n\n+\tREGISTRY-BASED CONFIGURATION\n+\n+\t\n+\t\tStarting with Samba version 3.0.26, the capability to\n+\t\tstore Samba configuration in the registry is available. \n+\t\tThere are two levels of registry configuration. \n+\t\n+\n+\t\n+\t\tShare definitions stored in registry are used.\n+\t\tThis is triggered by setting the global parameter\n+\t\tregistry shares to\n+\t\tyes in smb.conf.\n+\t\t\n+\t\tNote: Shares defined in smb.conf always take priority over \n+\t\tshares of the same name defined in registry.\n+\t\t\n+\n+\t\tGlobal smb.conf options stored in\n+\t\tregistry are used. This\n+\t\tis triggered by a new special meaning of the\n+\t\tparameter include = registry in\n+\t\tthe [global] section of smb.conf. \n+\t\tThis reads the content of\n+\t\tthe global configuration section from the regsitry\n+\t\tand includes the result with the same priorities as\n+\t\tan include of a text file. Activation of global\n+\t\tregistry options automatically activates registry\n+\t\tshares.\n+\t\t\n+\t\n+\n+\t\t\n+\t\tEven when global registry options are used, the initial source of\n+\t\tconfiguration is still the smb.conf file. \n+\t\tIt is this possible though, to produce a registry-only configuration \n+\t\twith a minimal configuration file like this:\n+\n+\t\n+\tregistry\n+\n+\t\tThis is also currently the only supported configuration with global\n+\t\tregistry options activated. More precisely, it is only supported to \n+\t\tspecify options in smb.conf before the\n+\t\toccurrence of include = registry.\n+\t\n+\n+\t\n+\t\tCaveat: To make registry-based configurations foolprof at least to a\n+\t\tcertain extent, the use of lock directory\n+\t\tand include inside the registry\n+\t\tconfiguration has been disabled. Especially, by changing the\n+\t\tlock directory inside the registry\n+\t\tconfiguration, one would create a broken setup where the daemons\n+\t\tdo not see the configuration they loaded once it is active. This\n+\t\tphenomenon can of course also be triggered by specifying\n+\t\tlock directory after the\n+\t\tinclude = registry directive. This is why\n+\t\tthis type of configuration is classified \"unsupported\" above.\n+\t\n+\n+\t\n+\t\tThe registry configuration can be accessed with\n+\t\ttools like regedit or net rpc\n+\t\tregistry in the key\n+\t\tHKLM\\Software\\Samba\\smbconf.\n+\n+\t\tMore conveniently, the conf subcommand of the\n+\t\tnet \n+\t\t7 utility\n+\t\toffers a dedicated interface to read and write the\n+\t\tregistry based configuration locally, i.e. directly\n+\t\ton the server. \n+\t\n+\n+\n+\n+\nEXPLANATION OF EACH PARAMETER\n\n\nModified: trunk/smbdotconf/misc/include.xml\n===================================================================\n--- trunk/smbdotconf/misc/include.xml\t2007-06-19 17:17:37 UTC (rev 1126)\n+++ trunk/smbdotconf/misc/include.xml\t2007-06-22 22:44:13 UTC (rev 1127)\n@@ -1,6 +1,6 @@\n \n\n@@ -13,6 +13,16 @@\n \tIt takes the standard substitutions, except %u, \n \t%P and %S.\n \t\n+\t\n+\t\n+\tThe parameter include = registry has\n+\ta special meaning: It does not include\n+\ta file named registry from the current working\n+\tdirectory, but instead reads the global configuration options \n+\tfrom the registry. See the section on registry-based\n+\tconfiguration for details. Note that this option\n+\tautomatically activates registry shares.\n+\t\n\n\n\nAdded: trunk/smbdotconf/misc/registryshares.xml\n===================================================================\n--- trunk/smbdotconf/misc/registryshares.xml\t2007-06-19 17:17:37 UTC (rev 1126)\n+++ trunk/smbdotconf/misc/registryshares.xml\t2007-06-22 22:44:13 UTC (rev 1127)\n@@ -0,0 +1,16 @@\n+\n+\n+\t\n+\tThis turns on or off support for share definitions read from\n+\tregistry. Shares in defined in smb.conf take\n+\tprecedence over shares with the same name defined in\n+\tregistry. See the section on registry-based configuration\n+\tfor details. \n+\t\n+\n+/usr/local/samba/lib/smb.conf.%m\n+\n"}