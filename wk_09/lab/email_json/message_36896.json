{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 355: tweak timeouts in http://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 355\nrevision-id: tridge@samba.org-20070526234325-u41a50wc6bnwahl1\nparent: tridge@samba.org-20070526081319-5d45ahkx4n0tgd6d\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Sun 2007-05-27 09:43:25 +1000\nmessage:\n  tweak timeouts\nmodified:\n  common/ctdb_recoverd.c         recoverd.c-20070503213540-bvxuyd9jm1f7ig90-1\n  include/ctdb_private.h         ctdb_private.h-20061117234101-o3qt14umlg9en8z0-13\n=== modified file 'common/ctdb_recoverd.c'\n--- a/common/ctdb_recoverd.c\t2007-05-26 04:01:08 +0000\n+++ b/common/ctdb_recoverd.c\t2007-05-26 23:43:25 +0000\n@@ -36,6 +36,7 @@\n }\n \n #define CONTROL_TIMEOUT() timeval_current_ofs(5, 0)\n+#define MONITOR_TIMEOUT() timeval_current_ofs(1, 0)\n \n static int set_recovery_mode(struct ctdb_context *ctdb, struct ctdb_node_map *nodemap, uint32_t rec_mode)\n {\n@@ -699,7 +700,7 @@\n \n \t/* we only check for recovery once every second */\n \ttimed_out = 0;\n-\tevent_add_timed(ctdb->ev, mem_ctx, CONTROL_TIMEOUT(), timeout_func, ctdb);\n+\tevent_add_timed(ctdb->ev, mem_ctx, MONITOR_TIMEOUT(), timeout_func, ctdb);\n \twhile (!timed_out) {\n \t\tevent_loop_once(ctdb->ev);\n \t}\n\n=== modified file 'include/ctdb_private.h'\n--- a/include/ctdb_private.h\t2007-05-26 04:01:08 +0000\n+++ b/include/ctdb_private.h\t2007-05-26 23:43:25 +0000\n@@ -334,7 +334,7 @@\n #define CTDB_TRAVERSE_TIMEOUT 20\n \n /* timeout between dead-node monitoring events */\n-#define CTDB_MONITORING_TIMEOUT 3\n+#define CTDB_MONITORING_TIMEOUT 2\n \n /* number of monitoring timeouts before a node is considered dead */\n #define CTDB_MONITORING_DEAD_COUNT 2\n\n"}