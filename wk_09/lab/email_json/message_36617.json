{"category": "ham", "to_address": "Heinz Tuechler <tuechler@gmx.at>", "from_address": "Duncan Murdoch <murdoch@stats.uwo.ca>", "subject": "Re: [R] How to check for existence url from within a function?", "body": "On 26/05/2007 7:13 AM, Heinz Tuechler wrote:\n> Dear All,\n> \n> To check if an url exists, I can use try(). This works, as I expected, if I\n> do it directly, as in the first part of the following example, but I could\n> not find a way to do it from within a function, as in the second part.\n> \n> Where could I find information on how to do this?\n> \n> Thanks,\n> Heinz\n> \n> \n> ## set nonexisting url\n> url.string <- 'http://www.google.at/nonexist.html'\n> \n> ## first part\n> 1 # to start with defined .Last.value\n> try(con.url <- url(url.string, open='rb'))\n> class.try.res <- class(.Last.value)\n> try.error <- class.try.res== 'try-error'\n> print(try.error)      # TRUE\n> try(close(con.url))\n> \n> ## try() within a function\n> url.error <- function(url.string) {\n>   1 # to start with defined .Last.value\n>   try(con.url <- url(url.string, open='rb'))\n>   class.try.res <- class(.Last.value)\n>   try.error <- class.try.res== 'try-error'\n\n.Last.value isn't set until your function returns.  You should write this as\n\ncon.url <- try(url(url.string, open='rb'))\ntry.error <- inherits(con.url, \"try-error\")\n\nNotice that I used \"inherits\", rather than testing for equality.  It's \ndocumented that the result of try() will be \"of class 'try-error'\" if an \nerror occurs, but there may be circumstances (in the future?) where \ndifferent types of errors are signalled by using a more complicated class.\n\nDuncan Murdoch\n\n>   print(try.error)\n>   try(close(con.url))\n>   invisible(try.error)\n> }\n> \n> ## call the function\n> url.error(url.string)   # result -> FALSE\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}