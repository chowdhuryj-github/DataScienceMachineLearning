{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Inman, Brant A.   M.D.\" <Inman.Brant@mayo.edu>", "subject": "[R] MITOOLS:   Error in eval(expr, envir,\n\tenclos) : invalid 'envir' argument", "body": "\nR-users & helpers:\n\nI am using Amelia, mitools and cmprsk to fit cumulative incidence curves\nto multiply imputed datasets.  The error message that I get \n\n\"Error in eval(expr, envir, enclos) : invalid 'envir' argument\"\n\noccurs when I try to fit models to the 50 imputed datasets using the\n\"with.imputationList\" function of mitools.  The problem seems to occur\nintermittently, depending on the type of model that I try to fit to the\ndatasets as well as the previous code that has been executed during the\nR session.  I have read the previous postings for similar problems and\nhave tried renaming many of my objects which has not solved the problem.\n\n\nWhat is weird is that I have not been able to reproduce the problem\nusing other standard survival datasets (like pbc). It therefore seems to\nhave something to do with my particular analysis, likely the names of my\nobjects.  I cannot find the source of the problem and would greatly\nappreciate any help.\n\nBrant\n\nBelow is my session information and some code demonstrating the issue\noccuring with coxph.\n\n> sessionInfo()\nR version 2.5.0 (2007-04-23) \ni386-pc-mingw32 \n\nlocale:\nLC_COLLATE=English_United States.1252;LC_CTYPE=English_United \n\nattached base packages:\n[1] \"splines\"   \"grid\"      \"stats\"     \"graphics\"  \"grDevices\" \"utils\"\n\n[7] \"datasets\"  \"methods\"   \"base\"     \n\nother attached packages:\n      cmprsk      mitools       Amelia     survival    RGraphics\nlatticeExtra \n     \"2.1-7\"        \"1.0\"     \"1.1-23\"       \"2.31\"      \"1.0-6\"\n\"0.2-1\" \n     lattice      foreign         MASS \n    \"0.15-8\"     \"0.8-20\"     \"7.2-34\" \n\n\n> str(utt.mi)    # My dataset\n'data.frame':   168 obs. of  25 variables:\n $ age      : num  79.5 67.1 63.7 76.9 69.0 ...\n $ gender   : Factor w/ 2 levels \"0\",\"1\": 1 2 2 2 1 2 2 2 2 2 ...\n $ symptoms : Factor w/ 2 levels \"0\",\"1\": 1 2 1 1 2 1 2 1 1 2 ...\n $ site     : Factor w/ 3 levels \"1\",\"2\",\"3\": 1 1 2 1 2 1 1 2 1 3 ...\n $ multifoc : Factor w/ 2 levels \"0\",\"1\": 1 1 1 1 1 1 1 1 1 2 ...\n $ ctnm     : Factor w/ 2 levels \"1\",\"2\": 1 NA 2 1 2 2 1 NA 1 2 ...\n $ prebca   : Factor w/ 2 levels \"0\",\"1\": 1 1 1 1 2 1 2 1 1 1 ...\n $ precystec: Factor w/ 2 levels \"0\",\"1\": 1 1 1 1 1 1 1 1 1 1 ...\n $ surgery  : Factor w/ 2 levels \"1\",\"2\": 1 1 2 1 2 1 1 1 1 1 ...\n $ ptnm.t   : Factor w/ 5 levels \"0\",\"1\",\"2\",\"3\",..: 3 3 5 1 2 4 2 1 1 5\n...\n $ grade    : Factor w/ 3 levels \"1\",\"2\",\"3\": 2 2 3 2 2 3 2 1 1 3 ...\n $ histol   : Factor w/ 2 levels \"0\",\"1\": 2 2 2 2 2 2 2 2 2 2 ...\n $ postbca  : Factor w/ 2 levels \"0\",\"1\": 2 1 2 2 2 NA 2 1 1 1 ...\n $ postcyst : Factor w/ 2 levels \"0\",\"1\": 1 1 1 2 1 1 1 1 1 1 ...\n $ chemo    : Factor w/ 2 levels \"0\",\"1\": 1 1 2 1 1 2 2 1 1 2 ...\n $ mets     : Factor w/ 2 levels \"0\",\"1\": 1 2 2 1 2 2 2 1 1 2 ...\n $ status   : Factor w/ 4 levels \"1\",\"2\",\"3\",\"4\": 1 3 2 1 3 3 3 1 1 3\n...\n $ futime   : num  10.46  1.15  2.43  2.83  6.82 ...\n $ smk      : Factor w/ 2 levels \"0\",\"1\": 2 2 2 1 2 1 2 1 2 2 ...\n $ surg.yr  : int  88 94 92 93 86 85 95 98 91 85 ...\n $ nodes    : Factor w/ 2 levels \"0\",\"1\": 1 1 2 1 1 2 1 1 1 2 ...\n $ os       : num  0 1 0 0 1 1 1 0 0 1 ...\n $ css      : num  0 1 0 0 1 1 1 0 0 1 ...\n $ rfs      : num  0 1 1 0 1 1 1 0 0 1 ...\n $ comp     : num  0 1 1 0 1 1 1 0 0 1 ...\n\n> set.seed(200)\n> M <- 50 \t\t\t# Number of imputations\n> am.imp <- amelia(utt.mi, m=M, p2s=1, startvals=1, write.out=F,\n+ idvars=c('os','css','rfs','comp'), \n+\nnoms=c('gender','symptoms','site','multifoc','ctnm','prebca','precystec'\n,\n+ 'smk','surgery','ptnm.t','nodes','grade','histol','postbca',\n+ 'postcyst','chemo','mets','status'),\n+ sqrts=c('futime'))\n-- Imputation 1 --\n\n 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 \n21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 \n\n\n\n-- Imputation 50 --\n\n 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 \n21 22 23 24 25 26 \n\n> MIset <- imputationList(am.imp[1:M])\n> mifit <- with(MIset, \n+ coxph(Surv(futime, os) ~ age + symptoms + ctnm + smk))\n\nError in eval(expr, envir, enclos) : invalid 'envir' argument\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}