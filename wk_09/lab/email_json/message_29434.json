{"category": "ham", "to_address": "samba-technical@samba.org, samba@samba.org", "from_address": "\"Gerald (Jerry) Carter\" <jerry@samba.org>", "subject": "[SAMBA-SECURITY] CVE-2007-2444: Local SID/Name Translation Failure\n Can Result in User Privilege Elevation", "body": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1\n\n==========================================================\n==\n== Subject:     Local SID/Name translation bug can result\n==              in user privilege elevation\n== CVE ID#:     CVE-2007-2444\n==\n== Versions:    Samba 3.0.23d - 3.0.25pre2 (inclusive)\n==\n== Summary:     A bug in the local SID/Name translation\n==              routines may potentially result in a user\n==              being able to issue SMB/CIFS protocol\n==              operations as root.\n==\n==========================================================\n\n===========\nDescription\n===========\n\nWhen translating SIDs to/from names using Samba local\nlist of user and group accounts, a logic error in the\nsmbd daemon's internal security stack may result in a\ntransition to the root user id rather than the non-root\nuser.  The user is then able to temporarily issue SMB/CIFS\nprotocol operations as the root user.  This window of\nopportunity may allow the attacker to establish additional\nmeans of gaining root access to the server.\n\n\n==================\nPatch Availability\n==================\n\nA patch against Samba 3.0.23d/3.0.24 has posted at\n\n  http://www.samba.org/samba/security/\n\n\n==========\nWorkaround\n==========\n\nThere is no immediate workaround for this defect that does\nnot involve changing the server code in the smbd daemon.\nThe Samba Team always encourages users to run the latest\nstable release as a defense against attacks.  If this\nis not immediately possible, administrators should read\nthe \"Server Security\" documentation found at\n\n  http://www.samba.org/samba/docs/server_security.html\n\n\n=======\nCredits\n=======\n\nThis vulnerability was reported to Samba developers by Paul\nGriffith  and Andrew Hogue.  Much thanks\nto Paul and Andrew for their cooperation and patience in the\nannouncement of this defect.  Thanks also to Samba developers\nJames Peach and Jeremy Allison for the analysis and resolution\nof this issue.\n\nThe time line is as follows:\n\n* March 20, 2007: Defect first reported to the security@samba.org\n  email alias.\n* March 30, 2007: Initial developer response by Gerald Carter.\n* April 4, 2007: Patch released to bug reporter for testing.\n* April 9, 2007: Fixed confirmed by original reporter.\n* May 3, 2007: Announcement to vendor-sec mailing list\n* May 14, 2007: Public announcement of the security issue.\n\n\n\n==========================================================\n== Our Code, Our Bugs, Our Responsibility.\n== The Samba Team\n==========================================================\n\n\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.6 (GNU/Linux)\nComment: Using GnuPG with Mozilla - http://enigmail.mozdev.org\n\niD8DBQFGR5ZEIR7qMdg1EfYRArriAJ0QPZb9wviwT1nu9FJolpcFZVRYLQCdF8cn\nmfmDyI7/7oPuPL04K4NbLUg=\n=9g1k\n-----END PGP SIGNATURE-----\n\n"}