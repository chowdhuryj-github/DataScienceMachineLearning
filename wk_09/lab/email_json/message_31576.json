{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "ab@samba.org", "subject": "svn commit: samba r22973 - in branches: SAMBA_3_0/source/utils\n\tSAMBA_3_0_25/source/utils SAMBA_3_0_26/source/utils", "body": "Author: ab\nDate: 2007-05-17 13:56:19 +0000 (Thu, 17 May 2007)\nNew Revision: 22973\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22973\n\nLog:\nApparently, 3.0.25 broke smb4k badly ;-)\nsmb4k uses 'net rap server domain' to list servers in domain.\nPreviously we just ignored all arguments in net_rap_server() but now we don't\nas 'net rap server name' has added an explicit check on arguments.\n\nAllow 'net rap server domain' to aid smb4k. Any other arguments will cause help message.\n\nModified:\n   branches/SAMBA_3_0/source/utils/net_rap.c\n   branches/SAMBA_3_0_25/source/utils/net_rap.c\n   branches/SAMBA_3_0_26/source/utils/net_rap.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/utils/net_rap.c\n===================================================================\n--- branches/SAMBA_3_0/source/utils/net_rap.c\t2007-05-17 10:33:40 UTC (rev 22972)\n+++ branches/SAMBA_3_0/source/utils/net_rap.c\t2007-05-17 13:56:19 UTC (rev 22973)\n@@ -435,10 +435,14 @@\n \tint ret;\n \n \tif (argc > 0) {\n-\t\tif (!strequal(argv[0], \"name\")) {\n+\t\tif (strequal(argv[0], \"name\")) {\n+\t\t\treturn net_rap_server_name(argc, argv);\n+\t\t}\n+\t\t/* smb4k uses 'net [rap|rpc] server domain' to query servers in a domain */\n+\t\t/* Fall through for 'domain', any other forms will cause to show usage message */\n+\t\tif (!strequal(argv[0], \"domain\")) {\n \t\t\treturn net_rap_server_usage(argc-1, argv+1);\n \t\t}\n-\t\treturn net_rap_server_name(argc, argv);\n \t}\n \n \tif (!(cli = net_make_ipc_connection(0))) \n\nModified: branches/SAMBA_3_0_25/source/utils/net_rap.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/utils/net_rap.c\t2007-05-17 10:33:40 UTC (rev 22972)\n+++ branches/SAMBA_3_0_25/source/utils/net_rap.c\t2007-05-17 13:56:19 UTC (rev 22973)\n@@ -435,10 +435,14 @@\n \tint ret;\n \n \tif (argc > 0) {\n-\t\tif (!strequal(argv[0], \"name\")) {\n+\t\tif (strequal(argv[0], \"name\")) {\n+\t\t\treturn net_rap_server_name(argc, argv);\n+\t\t}\n+\t\t/* smb4k uses 'net [rap|rpc] server domain' to query servers in a domain */\n+\t\t/* Fall through for 'domain', any other forms will cause to show usage message */\n+\t\tif (!strequal(argv[0], \"domain\")) {\n \t\t\treturn net_rap_server_usage(argc-1, argv+1);\n \t\t}\n-\t\treturn net_rap_server_name(argc, argv);\n \t}\n \n \tif (!(cli = net_make_ipc_connection(0))) \n\nModified: branches/SAMBA_3_0_26/source/utils/net_rap.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/utils/net_rap.c\t2007-05-17 10:33:40 UTC (rev 22972)\n+++ branches/SAMBA_3_0_26/source/utils/net_rap.c\t2007-05-17 13:56:19 UTC (rev 22973)\n@@ -435,10 +435,14 @@\n \tint ret;\n \n \tif (argc > 0) {\n-\t\tif (!strequal(argv[0], \"name\")) {\n+\t\tif (strequal(argv[0], \"name\")) {\n+\t\t\treturn net_rap_server_name(argc, argv);\n+\t\t}\n+\t\t/* smb4k uses 'net [rap|rpc] server domain' to query servers in a domain */\n+\t\t/* Fall through for 'domain', any other forms will cause to show usage message */\n+\t\tif (!strequal(argv[0], \"domain\")) {\n \t\t\treturn net_rap_server_usage(argc-1, argv+1);\n \t\t}\n-\t\treturn net_rap_server_name(argc, argv);\n \t}\n \n \tif (!(cli = net_make_ipc_connection(0))) \n\n"}