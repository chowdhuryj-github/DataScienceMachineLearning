{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "gd@samba.org", "subject": "svn commit: samba r23484 - in branches: SAMBA_3_0/examples/misc\n\tSAMBA_3_0_26/examples/misc", "body": "Author: gd\nDate: 2007-06-14 09:59:07 +0000 (Thu, 14 Jun 2007)\nNew Revision: 23484\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23484\n\nLog:\nWhen chasing AD referrals make sure to honor the base returned from the server.\n\nGuenther\n\nModified:\n   branches/SAMBA_3_0/examples/misc/adssearch.pl\n   branches/SAMBA_3_0_26/examples/misc/adssearch.pl\n\n\nChangeset:\nModified: branches/SAMBA_3_0/examples/misc/adssearch.pl\n===================================================================\n--- branches/SAMBA_3_0/examples/misc/adssearch.pl\t2007-06-14 09:51:13 UTC (rev 23483)\n+++ branches/SAMBA_3_0/examples/misc/adssearch.pl\t2007-06-14 09:59:07 UTC (rev 23484)\n@@ -1781,8 +1781,9 @@\n \t\tif (!$opt_notify && ($async_search->code == LDAP_REFERRAL)) {\n \t\t\tforeach my $ref ($async_search->referrals) {\n \t\t\t\tprint \"\\ngot Referral: [$ref]\\n\";\n+\t\t\t\tmy ($prot, $host, $base) = split(/\\/+/, $ref);\n \t\t\t\t$async_ldap_hd->unbind();\n-\t\t\t\t$async_ldap_hd = get_ldap_hd($ref, 1);\n+\t\t\t\t$async_ldap_hd = get_ldap_hd($host, 1);\n \t\t\t\tif (do_bind($async_ldap_hd, $sasl_bind) == -1) {\n \t\t\t\t\t$async_ldap_hd->unbind();\n \t\t\t\t\tnext;\n\nModified: branches/SAMBA_3_0_26/examples/misc/adssearch.pl\n===================================================================\n--- branches/SAMBA_3_0_26/examples/misc/adssearch.pl\t2007-06-14 09:51:13 UTC (rev 23483)\n+++ branches/SAMBA_3_0_26/examples/misc/adssearch.pl\t2007-06-14 09:59:07 UTC (rev 23484)\n@@ -1781,8 +1781,9 @@\n \t\tif (!$opt_notify && ($async_search->code == LDAP_REFERRAL)) {\n \t\t\tforeach my $ref ($async_search->referrals) {\n \t\t\t\tprint \"\\ngot Referral: [$ref]\\n\";\n+\t\t\t\tmy ($prot, $host, $base) = split(/\\/+/, $ref);\n \t\t\t\t$async_ldap_hd->unbind();\n-\t\t\t\t$async_ldap_hd = get_ldap_hd($ref, 1);\n+\t\t\t\t$async_ldap_hd = get_ldap_hd($host, 1);\n \t\t\t\tif (do_bind($async_ldap_hd, $sasl_bind) == -1) {\n \t\t\t\t\t$async_ldap_hd->unbind();\n \t\t\t\t\tnext;\n\n"}