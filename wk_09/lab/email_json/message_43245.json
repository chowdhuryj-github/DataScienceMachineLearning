{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jra@samba.org", "subject": "svn commit: samba r23358 - in branches: SAMBA_3_0/source/auth\n\tSAMBA_3_0_25/source/auth SAMBA_3_0_26/source/auth", "body": "Author: jra\nDate: 2007-06-05 23:35:39 +0000 (Tue, 05 Jun 2007)\nNew Revision: 23358\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23358\n\nLog:\nFix from Justin Maggard  - ensure we don't\nexpire a password if it's explicitly set as ACB_PWNOTREQ.\nJeremy.\n\nModified:\n   branches/SAMBA_3_0/source/auth/auth_sam.c\n   branches/SAMBA_3_0_25/source/auth/auth_sam.c\n   branches/SAMBA_3_0_26/source/auth/auth_sam.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/auth/auth_sam.c\n===================================================================\n--- branches/SAMBA_3_0/source/auth/auth_sam.c\t2007-06-05 19:17:05 UTC (rev 23357)\n+++ branches/SAMBA_3_0/source/auth/auth_sam.c\t2007-06-05 23:35:39 UTC (rev 23358)\n@@ -163,7 +163,7 @@\n \t\treturn NT_STATUS_ACCOUNT_EXPIRED;\n \t}\n \n-\tif (!(pdb_get_acct_ctrl(sampass) & ACB_PWNOEXP)) {\n+\tif (!(pdb_get_acct_ctrl(sampass) & ACB_PWNOEXP) && !(pdb_get_acct_ctrl(sampass) & ACB_PWNOTREQ)) {\n \t\ttime_t must_change_time = pdb_get_pass_must_change_time(sampass);\n \t\ttime_t last_set_time = pdb_get_pass_last_set_time(sampass);\n \n\nModified: branches/SAMBA_3_0_25/source/auth/auth_sam.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/auth/auth_sam.c\t2007-06-05 19:17:05 UTC (rev 23357)\n+++ branches/SAMBA_3_0_25/source/auth/auth_sam.c\t2007-06-05 23:35:39 UTC (rev 23358)\n@@ -163,7 +163,7 @@\n \t\treturn NT_STATUS_ACCOUNT_EXPIRED;\n \t}\n \n-\tif (!(pdb_get_acct_ctrl(sampass) & ACB_PWNOEXP)) {\n+\tif (!(pdb_get_acct_ctrl(sampass) & ACB_PWNOEXP) && !(pdb_get_acct_ctrl(sampass) & ACB_PWNOTREQ)) {\n \t\ttime_t must_change_time = pdb_get_pass_must_change_time(sampass);\n \t\ttime_t last_set_time = pdb_get_pass_last_set_time(sampass);\n \n\nModified: branches/SAMBA_3_0_26/source/auth/auth_sam.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/auth/auth_sam.c\t2007-06-05 19:17:05 UTC (rev 23357)\n+++ branches/SAMBA_3_0_26/source/auth/auth_sam.c\t2007-06-05 23:35:39 UTC (rev 23358)\n@@ -163,7 +163,7 @@\n \t\treturn NT_STATUS_ACCOUNT_EXPIRED;\n \t}\n \n-\tif (!(pdb_get_acct_ctrl(sampass) & ACB_PWNOEXP)) {\n+\tif (!(pdb_get_acct_ctrl(sampass) & ACB_PWNOEXP) && !(pdb_get_acct_ctrl(sampass) & ACB_PWNOTREQ)) {\n \t\ttime_t must_change_time = pdb_get_pass_must_change_time(sampass);\n \t\ttime_t last_set_time = pdb_get_pass_last_set_time(sampass);\n \n\n"}