{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jerry@samba.org", "subject": "svn commit: samba r22630 - in branches: SAMBA_3_0/source/rpc_parse\n\tSAMBA_3_0_25/source/rpc_parse", "body": "Author: jerry\nDate: 2007-05-01 16:49:00 +0000 (Tue, 01 May 2007)\nNew Revision: 22630\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22630\n\nLog:\nRevert svn r22576 (parse change to enum_aliasmem().  Original code was correct\nModified:\n   branches/SAMBA_3_0/source/rpc_parse/parse_samr.c\n   branches/SAMBA_3_0_25/source/rpc_parse/parse_samr.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/rpc_parse/parse_samr.c\n===================================================================\n--- branches/SAMBA_3_0/source/rpc_parse/parse_samr.c\t2007-05-01 09:55:36 UTC (rev 22629)\n+++ branches/SAMBA_3_0/source/rpc_parse/parse_samr.c\t2007-05-01 16:49:00 UTC (rev 22630)\n@@ -4838,15 +4838,9 @@\n \t\tif(!prs_uint32(\"num_sids1\", ps, depth, &r_u->num_sids1))\n \t\t\treturn False;\n \n-\t\tif (UNMARSHALLING(ps)) {\n-\t\t\tif (r_u->num_sids1) {\n-\t\t\t\tptr_sid = TALLOC_ARRAY(ps->mem_ctx, uint32, r_u->num_sids1);\n-\t\t\t\tif (!ptr_sid) {\n-\t\t\t\t\treturn False;\n-\t\t\t\t}\n-\t\t\t} else {\n-\t\t\t\tptr_sid = NULL;\n-\t\t\t}\n+\t\tptr_sid = TALLOC_ARRAY(ps->mem_ctx, uint32, r_u->num_sids1);\n+\t\tif (!ptr_sid) {\n+\t\t\treturn False;\n \t\t}\n \t\t\n \t\tfor (i = 0; i < r_u->num_sids1; i++) {\n@@ -4856,14 +4850,7 @@\n \t\t}\n \t\t\n \t\tif (UNMARSHALLING(ps)) {\n-\t\t\tif (r_u->num_sids1) {\n-\t\t\t\tr_u->sid = TALLOC_ARRAY(ps->mem_ctx, DOM_SID2, r_u->num_sids1);\n-\t\t\t\tif (!r_u->sid) {\n-\t\t\t\t\treturn False;\n-\t\t\t\t}\n-\t\t\t} else {\n-\t\t\t\tr_u->sid = NULL;\n-\t\t\t}\n+\t\t\tr_u->sid = TALLOC_ARRAY(ps->mem_ctx, DOM_SID2, r_u->num_sids1);\n \t\t}\n \t\t\n \t\tfor (i = 0; i < r_u->num_sids1; i++) {\n\nModified: branches/SAMBA_3_0_25/source/rpc_parse/parse_samr.c\n===================================================================\n--- branches/SAMBA_3_0_25/source/rpc_parse/parse_samr.c\t2007-05-01 09:55:36 UTC (rev 22629)\n+++ branches/SAMBA_3_0_25/source/rpc_parse/parse_samr.c\t2007-05-01 16:49:00 UTC (rev 22630)\n@@ -4768,15 +4768,9 @@\n \t\tif(!prs_uint32(\"num_sids1\", ps, depth, &r_u->num_sids1))\n \t\t\treturn False;\n \n-\t\tif (UNMARSHALLING(ps)) {\n-\t\t\tif (r_u->num_sids1) {\n-\t\t\t\tptr_sid = TALLOC_ARRAY(ps->mem_ctx, uint32, r_u->num_sids1);\n-\t\t\t\tif (!ptr_sid) {\n-\t\t\t\t\treturn False;\n-\t\t\t\t}\n-\t\t\t} else {\n-\t\t\t\tptr_sid = NULL;\n-\t\t\t}\n+\t\tptr_sid = TALLOC_ARRAY(ps->mem_ctx, uint32, r_u->num_sids1);\n+\t\tif (!ptr_sid) {\n+\t\t\treturn False;\n \t\t}\n \t\t\n \t\tfor (i = 0; i < r_u->num_sids1; i++) {\n@@ -4786,14 +4780,7 @@\n \t\t}\n \t\t\n \t\tif (UNMARSHALLING(ps)) {\n-\t\t\tif (r_u->num_sids1) {\n-\t\t\t\tr_u->sid = TALLOC_ARRAY(ps->mem_ctx, DOM_SID2, r_u->num_sids1);\n-\t\t\t\tif (!r_u->sid) {\n-\t\t\t\t\treturn False;\n-\t\t\t\t}\n-\t\t\t} else {\n-\t\t\t\tr_u->sid = NULL;\n-\t\t\t}\n+\t\t\tr_u->sid = TALLOC_ARRAY(ps->mem_ctx, DOM_SID2, r_u->num_sids1);\n \t\t}\n \t\t\n \t\tfor (i = 0; i < r_u->num_sids1; i++) {\n\n"}