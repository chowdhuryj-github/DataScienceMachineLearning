{"category": "ham", "to_address": "\"ivo welch\" <ivowel@gmail.com>", "from_address": "\"Spielas Bates\" <bates@stat.wisc.edu>", "subject": "Re: [R] nlme fixed effects specification", "body": "On 5/3/07, ivo welch  wrote:\n> dear R experts:\n>\n> sorry, I have to ask this again.  I know that the answer is in section\n> 7.2 of \"S Programming,\" but I don't have the book (and I plan to buy\n> the next edition---which I hope will be titled S/R programming ;-) ).\n\n> I believe the following yields a standard fixed-effects estimation:\n\n> fixed.effects = as.factor( as.integer( runif(100)*10 ) )\n> y=rnorm(100); x=rnorm(100);\n> print(summary(lm( Y ~ X + fe)))\n\nWant to try that one again, Ivo?  You have defined objects called\n\"fixed.effects\", \"y\" and \"x\" then used the formula Y ~ X + fe.\n\n> I would like to know how to get the same coefficient on X using nlme.\n\nThe nlme function or the nlme package.  I'm guessing that you are\nreferring to the lme function in the nlme package but it would help if\nyou told us exactly what you mean.\n\nAlso, perhaps you could be a bit more explicit about what you mean by\n\"same coefficient\".  If you fit a model with random effects for a\nfactor then you will get similar but not identical values for the\ncoefficients of the fixed effects term.\n\n> (I cannot use this ordinary lm method in my real application, simply\n> because I have 10,000 fixed effects.)  I tried a variety of arguments\n> to the \"fixed\" nlme parameter (e.g., fixed=list(fmid)), but did not\n> get the syntax right.  could someone please tell me the magic spell?\n\nIf you plan on fitting a linear mixed model then I would suggest\n\nlibrary(lme4)\nlmer(Y ~ X + (1|fact))\n\nwhere fact is the factor specifying the groups in the data.  For example\n\n> set.seed(123454321)\n> fact <- sample(10, 100, repl = TRUE)\n> y <- rnorm(100); x <- rnorm(100)\n> lmer(y ~ x + (1|fact))\nLinear mixed-effects model fit by REML\nFormula: y ~ x + (1 | fact)\n   AIC   BIC logLik MLdeviance REMLdeviance\n 294.5 302.3 -144.3      282.7        288.5\nRandom effects:\n Groups   Name        Variance   Std.Dev.\n fact     (Intercept) 5.0482e-10 2.2468e-05\n Residual             1.0096e+00 1.0048e+00\nnumber of obs: 100, groups: fact, 10\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  0.08536    0.10062  0.8483\nx            0.08725    0.08787  0.9929\n\nCorrelation of Fixed Effects:\n  (Intr)\nx -0.052\nWarning message:\nEstimated variance for factor fact is effectively zero\n\n> may I also suggest that such an example be added to the nlme examples\n> documentation, too, please?\n\nFirst we need to decide what the example is. :-)\n\nRegards,\nSpie\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}