{"category": "ham", "to_address": "\"Vladimir Eremeev\" <wl2776@gmail.com>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] convert text to exprission good for lm arguments", "body": "On 5/3/07, Vladimir Eremeev  wrote:\n>\n>\n> Vadim Ogranovich wrote:\n> >\n> > Hi,\n> >\n> > I ran into a problem of converting a text representation of an expression\n> > into parsed expression to be further evaluated inside lm ().\n> >\n> >> n <- 100\n> >> data <- data.frame(x= rnorm (n), y= rnorm (n))\n> >> data. lm <- lm (y ~ x, data=data)\n> >>\n> >> ## this works\n> >> update(data. lm , subset=x<0)\n> >\n> > Call:\n> > lm (formula = y ~ x, data = data, subset = x < 0)\n> >\n> > Coefficients:\n> > (Intercept) x\n> > -0.07864094193322170023 -0.14596982635007796358\n> >\n> >>\n> >> ## this doesn't work\n> >> ## text representation of subset\n> >> subset <- \"x<0\"\n> >> update(data. lm , subset=parse(text=subset))\n> > Error in `[.data.frame`(list(y = c(-0.601925958140825, -0.111931189071517,\n> > :\n> > invalid subscript type\n> >\n> > What is the correct way to convert \"x<0\" into a valid subset argument?\n> >\n>\n> update(data.lm,subset=eval(parse(text=subset)))\n\nJust wanted to point out one difference.  Using eval\nis not quite the same as using do.call since the\nCall: part does not come out as desired if you use eval but if you\nuse do.call it comes out good enough that you can tell what was\nintended to be subset from the output:\n\n> update(data.lm,subset=eval(parse(text=subset)))\n\nCall:\nlm(formula = y ~ x, data = data, subset = eval(parse(text = subset)))\n\nCoefficients:\n(Intercept)            x\n    -0.1335      -0.1248\n\n\n> do.call(\"update\", list(data.lm, subset = parse(text = subset)))\n\nCall:\nlm(formula = y ~ x, data = data, subset = expression(x < 0))\n\nCoefficients:\n(Intercept)            x\n    -0.1335      -0.1248\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}