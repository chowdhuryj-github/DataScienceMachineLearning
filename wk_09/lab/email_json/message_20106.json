{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "jelmer@samba.org", "subject": "svn commit: samba r22600 - in branches/SAMBA_4_0: . source/lib/ldb\n\tsource/lib/popt source/lib/talloc source/lib/tdb", "body": "Author: jelmer\nDate: 2007-04-30 10:49:42 +0000 (Mon, 30 Apr 2007)\nNew Revision: 22600\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22600\n\nLog:\nUpdate bzr ignores, put right version in .pc files, prepare for support of system versions of tdb, talloc.\nModified:\n   branches/SAMBA_4_0/\n   branches/SAMBA_4_0/.bzrignore\n   branches/SAMBA_4_0/source/lib/ldb/Makefile.in\n   branches/SAMBA_4_0/source/lib/ldb/ldb.pc.in\n   branches/SAMBA_4_0/source/lib/popt/libpopt.m4\n   branches/SAMBA_4_0/source/lib/talloc/Makefile.in\n   branches/SAMBA_4_0/source/lib/talloc/libtalloc.m4\n   branches/SAMBA_4_0/source/lib/talloc/talloc.pc.in\n   branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\n   branches/SAMBA_4_0/source/lib/tdb/Makefile.in\n   branches/SAMBA_4_0/source/lib/tdb/libtdb.m4\n   branches/SAMBA_4_0/source/lib/tdb/tdb.pc.in\n\n\nChangeset:\n\nProperty changes on: branches/SAMBA_4_0\n___________________________________________________________________\nName: bzr:merge\n...skipped...\n\nModified: branches/SAMBA_4_0/.bzrignore\n===================================================================\n--- branches/SAMBA_4_0/.bzrignore\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/.bzrignore\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -171,3 +171,12 @@\n source/bin/modules/*\n source/tests\n source/torture/unix/proto.h\n+source/lib/tdb/bin/tdbtool\n+source/lib/tdb/bin/tdbtorture\n+source/lib/talloc/testsuite\n+source/lib/talloc/talloc.3.html\n+source/lib/ldb/tests/tmp\n+source/lib/ldb/man/*.html\n+source/lib/ldb/lib\n+source/lib/ldb/examples/ldbreader\n+source/lib/ldb/examples/ldifreader\n\nModified: branches/SAMBA_4_0/source/lib/ldb/Makefile.in\n===================================================================\n--- branches/SAMBA_4_0/source/lib/ldb/Makefile.in\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/ldb/Makefile.in\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -20,18 +20,21 @@\n \n TALLOC_LIBS = @TALLOC_LIBS@\n TALLOC_CFLAGS = @TALLOC_CFLAGS@\n+TALLOC_OBJ = @TALLOC_OBJ@\n \n TDB_LIBS = @TDB_LIBS@\n TDB_CFLAGS = @TDB_CFLAGS@\n+TDB_OBJ = @TDB_OBJ@\n \n POPT_LIBS = @POPT_LIBS@\n POPT_CFLAGS = @POPT_CFLAGS@\n+POPT_OBJ = @POPT_OBJ@\n \n CFLAGS=-g -I$(srcdir)/include -Iinclude -I$(srcdir) -I$(srcdir)/.. \\\n        $(POPT_CFLAGS) $(TALLOC_CFLAGS) $(TDB_CFLAGS) \\\n \t-DLIBDIR=\\\"$(libdir)\\\" -DSHLIBEXT=\\\"@SHLIBEXT@\\\" -DUSE_MMAP=1 @CFLAGS@\n \n-LIB_FLAGS=@LDFLAGS@ -Llib -lldb @LIBS@ $(POPT_LIBS)\n+LIB_FLAGS=@LDFLAGS@ -Llib -lldb @LIBS@ $(POPT_LIBS) $(TALLOC_LIBS) $(TDB_LIBS)\n \n LDB_TDB_DIR=ldb_tdb\n LDB_TDB_OBJ=$(LDB_TDB_DIR)/ldb_tdb.o \\\n@@ -54,7 +57,7 @@\n NSS_OBJ= $(NSSDIR)/ldb-nss.o $(NSSDIR)/ldb-pwd.o $(NSSDIR)/ldb-grp.o\n NSS_LIB = lib/libnss_ldb.so.2\n \n-OBJS = $(MODULES_OBJ) $(COMMON_OBJ) $(LDB_TDB_OBJ) @TDBOBJ@ @TALLOCOBJ@ @POPTOBJ@ @LIBREPLACEOBJ@ $(EXTRA_OBJ) \n+OBJS = $(MODULES_OBJ) $(COMMON_OBJ) $(LDB_TDB_OBJ) $(TDB_OBJ) $(TALLOC_OBJ) $(POPT_OBJ) @LIBREPLACEOBJ@ $(EXTRA_OBJ) \n \n LDB_LIB = lib/libldb.a\n \n@@ -92,7 +95,7 @@\n \tar -rv $@ $(OBJS)\n \t@-ranlib $@\n \n-lib/libnss_ldb.so.2: $(NSS_OBJ) $(LIBS)\n+lib/libnss_ldb.so.2: $(NSS_OBJ) $(LIBS) bin/libldb.a\n \t$(CC) -shared -Wl,-soname,libnss_ldb.so.2 -o lib/libnss_ldb.so.2 $(NSS_OBJ) $(OBJS) $(LIB_FLAGS)\n \n bin/ldbadd: tools/ldbadd.o tools/cmdline.o $(LIBS)\n\nModified: branches/SAMBA_4_0/source/lib/ldb/ldb.pc.in\n===================================================================\n--- branches/SAMBA_4_0/source/lib/ldb/ldb.pc.in\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/ldb/ldb.pc.in\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -6,7 +6,7 @@\n \n Name: ldb\n Description: An LDAP-like embedded database\n-Version: 4.0\n+Version: @PACKAGE_VERSION@\n Requires.private: tdb\n Requires: talloc\n Libs: -L${libdir} -lldb\n\nModified: branches/SAMBA_4_0/source/lib/popt/libpopt.m4\n===================================================================\n--- branches/SAMBA_4_0/source/lib/popt/libpopt.m4\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/popt/libpopt.m4\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -37,7 +37,7 @@\n         if test x\"$poptdir\" = \"x\"; then\n \t\tAC_MSG_ERROR([cannot find popt source in $poptpaths])\n \tfi\n-\tPOPTOBJ=\"popt.o findme.o poptconfig.o popthelp.o poptparse.o\"\n-\tAC_SUBST(POPTOBJ)\n+\tPOPT_OBJ=\"popt.o findme.o poptconfig.o popthelp.o poptparse.o\"\n+\tAC_SUBST(POPT_OBJ)\n \tAC_CHECK_HEADERS([float.h alloca.h])\n fi\n\nModified: branches/SAMBA_4_0/source/lib/talloc/Makefile.in\n===================================================================\n--- branches/SAMBA_4_0/source/lib/talloc/Makefile.in\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/talloc/Makefile.in\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -17,7 +17,7 @@\n \n .SUFFIXES: .c .o .3 .3.xml .xml .html\n \n-LIBOBJ = @TALLOCOBJ@ @LIBREPLACEOBJ@\n+LIBOBJ = @TALLOC_OBJ@ @LIBREPLACEOBJ@\n \n all: showflags libtalloc.a testsuite $(EXTRA_TARGETS)\n \n@@ -34,13 +34,13 @@\n \t@-ranlib $@\n \n install: all \n-\t${INSTALLCMD} -d $(DESTDIR)${libdir}\n-\t${INSTALLCMD} -d $(DESTDIR)${libdir}/pkgconfig\n+\t${INSTALLCMD} -d $(DESTDIR)$(libdir)\n+\t${INSTALLCMD} -d $(DESTDIR)$(libdir)/pkgconfig\n \t${INSTALLCMD} -m 755 libtalloc.a $(DESTDIR)$(libdir)\n \t${INSTALLCMD} -d $(DESTDIR)${includedir}\n \t${INSTALLCMD} -m 644 $(srcdir)/talloc.h $(DESTDIR)$(includedir)\n \t${INSTALLCMD} -m 644 talloc.pc $(DESTDIR)$(libdir)/pkgconfig\n-\tif [ -f talloc.3 ];then ${INSTALLCMD} -d $(DESTDIR)${mandir}/man3; fi\n+\tif [ -f talloc.3 ];then ${INSTALLCMD} -d $(DESTDIR)$(mandir)/man3; fi\n \tif [ -f talloc.3 ];then ${INSTALLCMD} -m 644 talloc.3 $(DESTDIR)$(mandir)/man3; fi\n \n doc: talloc.3 talloc.3.html\n\nModified: branches/SAMBA_4_0/source/lib/talloc/libtalloc.m4\n===================================================================\n--- branches/SAMBA_4_0/source/lib/talloc/libtalloc.m4\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/talloc/libtalloc.m4\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -12,12 +12,15 @@\n if test x\"$tallocdir\" = \"x\"; then\n    AC_MSG_ERROR([cannot find talloc source in $tallocpaths])\n fi\n-TALLOCOBJ=\"talloc.o\"\n-AC_SUBST(TALLOCOBJ)\n+TALLOC_OBJ=\"talloc.o\"\n+AC_SUBST(TALLOC_OBJ)\n \n TALLOC_CFLAGS=\"-I$tallocdir\"\n AC_SUBST(TALLOC_CFLAGS)\n \n+TALLOC_LIBS=\"\"\n+AC_SUBST(TALLOC_LIBS)\n+\n AC_CHECK_SIZEOF(size_t,cross)\n AC_CHECK_SIZEOF(void *,cross)\n \n\nModified: branches/SAMBA_4_0/source/lib/talloc/talloc.pc.in\n===================================================================\n--- branches/SAMBA_4_0/source/lib/talloc/talloc.pc.in\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/talloc/talloc.pc.in\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -5,7 +5,7 @@\n \n Name: talloc \n Description: A hierarchical pool based memory system with destructors\n-Version: 4.0\n+Version: @PACKAGE_VERSION@\n Libs: -L${libdir} -ltalloc\n Cflags: -I${includedir} \n URL: http://talloc.samba.org/\n\nModified: branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\n===================================================================\n--- branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/talloc/talloc_guide.txt\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -12,7 +12,7 @@\n Samba4 talloc has been ported back to Samba3, so this guide applies to both.\n \n The new talloc is a hierarchical, reference counted memory pool system\n-with destructors. Quite a mounthful really, but not too bad once you\n+with destructors. Quite a mouthful really, but not too bad once you\n get used to it.\n \n Perhaps the biggest change from Samba3 is that there is no distinction\n\nModified: branches/SAMBA_4_0/source/lib/tdb/Makefile.in\n===================================================================\n--- branches/SAMBA_4_0/source/lib/tdb/Makefile.in\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/tdb/Makefile.in\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -23,7 +23,7 @@\n PROGS_NOINSTALL = bin/tdbtest$(EXEEXT) bin/tdbdump$(EXEEXT) bin/tdbbackup$(EXEEXT)\n ALL_PROGS = $(PROGS) $(PROGS_NOINSTALL)\n \n-TDB_OBJ = @TDBOBJ@ @LIBREPLACEOBJ@\n+TDB_OBJ = @TDB_OBJ@ @LIBREPLACEOBJ@\n \n DIRS = bin common tools\n \n\nModified: branches/SAMBA_4_0/source/lib/tdb/libtdb.m4\n===================================================================\n--- branches/SAMBA_4_0/source/lib/tdb/libtdb.m4\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/tdb/libtdb.m4\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -12,11 +12,14 @@\n if test x\"$tdbdir\" = \"x\"; then\n    AC_MSG_ERROR([cannot find tdb source in $tdbpaths])\n fi\n-TDBOBJ=\"common/tdb.o common/dump.o common/transaction.o common/error.o common/traverse.o\"\n-TDBOBJ=\"$TDBOBJ common/freelist.o common/freelistcheck.o common/io.o common/lock.o common/open.o\"\n-AC_SUBST(TDBOBJ)\n+TDB_OBJ=\"common/tdb.o common/dump.o common/transaction.o common/error.o common/traverse.o\"\n+TDB_OBJ=\"$TDB_OBJ common/freelist.o common/freelistcheck.o common/io.o common/lock.o common/open.o\"\n+AC_SUBST(TDB_OBJ)\n AC_SUBST(LIBREPLACEOBJ)\n \n+TDB_LIBS=\"\"\n+AC_SUBST(TDB_LIBS)\n+\n TDB_CFLAGS=\"-I$tdbdir/include\"\n AC_SUBST(TDB_CFLAGS)\n \n\nModified: branches/SAMBA_4_0/source/lib/tdb/tdb.pc.in\n===================================================================\n--- branches/SAMBA_4_0/source/lib/tdb/tdb.pc.in\t2007-04-30 10:23:20 UTC (rev 22599)\n+++ branches/SAMBA_4_0/source/lib/tdb/tdb.pc.in\t2007-04-30 10:49:42 UTC (rev 22600)\n@@ -5,6 +5,6 @@\n \n Name: tdb\n Description: A trivial database\n-Version: 4.0\n+Version: @PACKAGE_VERSION@\n Libs: -L${libdir} -ltdb\n Cflags: -I${includedir} \n\n"}