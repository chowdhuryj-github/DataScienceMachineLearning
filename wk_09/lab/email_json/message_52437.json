{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Karl Knoblick <karlknoblich@yahoo.de>", "subject": "[R] Result depends on order of factors in unbalanced designs (lme,\n\tanova)?", "body": "Dear R-Community!\n\nFor example I have a study with 4 treatment groups (10 subjects per group) and 4 visits. Additionally, the gender is taken into account. I think - and hope this is a goog idea (!) - this data can be analysed using lme as below.\n\nIn a balanced design everything is fine, but in an unbalanced design there are differences depending on fitting y~visit*treat*gender or y~gender*visit*treat - at least with anova (see example). Does this make sense? Which ordering might be the correct one?\n\nHere the example script:\nlibrary(nlme)\nset.seed(123)\n# Random generation of data:\nNSubj<-40 # No. of subjects\nset.seed(1234)\nid<-factor(rep(c(1:NSubj),4)) # ID of subjects\ntreat<-factor(rep(rep(1:4,each=5),4)) # Treatment 4 Levels\ngender<-factor(rep(rep(1:2, each=20),4))\nvisit<-factor(rep(1:4, each=NSubj))\ny<-runif(4*NSubj) # Results\n# Add effects\ny<-y+0.01*as.integer(visit)\ny<-y+0.02*as.integer(gender)\ny<-y+0.024*as.integer(treat)\ndf<-data.frame(id, treat, gender, visit, y)\n# groupedData object for lme\ngdat<-groupedData(y ~ visit|id, data=df)\n# fits - different ordering of factors\nfit1<-lme(y ~ visit*treat*gender, data=gdat, random = ~visit|id)\nanova(fit1)\nfit2<-lme(y ~ gender*treat*visit, data=gdat, random = ~visit|id)\nanova(fit2)\n# Result: identical (balanced design so far), ok\n# Now change gender of subject 1\ngdat$gender[c(1,41,81,121)]<-2\n# onece more fits with different ordering of factors\nfit1<-lme(y ~ visit*treat*gender, data=gdat, random = ~visit|id)\nanova(fit1)\nfit2<-lme(y ~ gender*treat*visit, data=gdat, random = ~visit|id)\nanova(fit2)\n# Result: There are differences!!\n\nHope anybody can help or give me advice how to interpret these results correctly or how to avoid this problem! Is there a better possibility to analyse these data than lme?\n\nThanks!\nKarl\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}