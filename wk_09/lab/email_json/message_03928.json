{"category": "ham", "to_address": "Brendan Connors <bconnors@sfu.ca>", "from_address": "Andrew Robinson <A.Robinson@ms.unimelb.edu.au>", "subject": "Re: [R] GLM with random effects", "body": "Hello Brendan,\n\ndo you have any particular objection to\n\nlmer(nor.tot.lep ~ In.Out + (1|Replicate), data=coho, family=poisson)\n\n?\n\nAndrew\n\nOn Thu, Apr 12, 2007 at 02:58:07PM -0700, Brendan Connors wrote:\n> Hi R-Users,\n> \n> I have 3 replicates ('Replicate) of counts of parasites ('nor.tot.lep') \n> before and after an experiment ('In.Out'). I am trying to treat the \n> three replicates as a random effect in order to determine if the main \n> effect (In.Out) significantly influences my dependent variable \n> (nor.tot.lep) after the variance explained by the replicates is \n> accounted for. I have tried:\n> \n>  >lmer(nor.tot.lep ~ In.Out + (In.Out|Replicate),data=coho, family=poisson)\n> Generalized linear mixed model fit using PQL\n> Formula: nor.tot.lep ~ In.Out + (In.Out | Replicate)\n> Data: coho\n> Family: Poisson\n> AIC BIC logLik deviance\n> 849.2 867.4 -419.6 839.2\n> Random effects:\n> Groups Name Variance Std.Dev. Corr\n> Replicate (Intercept) 0.78861 0.88804\n> In.Out 0.67232 0.81995 -1.000\n> Residual 2.96308 1.72136\n> number of obs: 279, groups: Replicate, 3\n> \n> Fixed effects:\n> Estimate Std. Error t value\n> (Intercept) -0.2431 0.6619 -0.3672\n> In.Out 1.6004 0.5645 2.8349\n> \n> Correlation of Fixed Effects:\n> (Intr)\n> In.Out -0.975\n> There were 30 warnings (use warnings() to see them)\n> \n>  > warnings()\n> Warning messages:\n> 1: Estimated variance-covariance for factor ?Replicate? is singular\n> in: LMEopt(x = mer, value = cv)\n> 2: nlminb returned message false convergence (8)\n> in: LMEopt(x = mer, value = cv)\n> \n> but as Mr. Bates pointed out, this is inappropriate b/c I am trying to \n> use 3 distinct replicates to estimate 3 variance-covariance\n> parameters. \"It won't work. Notice that the estimated correlation is\n> -1.000. Your estimated variance-covariance matrix is singular\"\n> \n> I have also tried:\n> \n>  >glmmPQL(nor.tot.lep ~ In.Out, random = (In.Out|Replicate), family = \n> poisson, data = coho)\n> \n> Error in glmmPQL(nor.tot.lep ~ In.Out, random = (In.Out | Replicate), :\n> object \"In.Out\" not found\n> \n> and R cannot find \"In.Out\"\n> \n> If anyone has any suggestions they would be extremely appreciated!\n> \n> Cheers,\n> \n> Brendan\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n\n-- \nAndrew Robinson  \nDepartment of Mathematics and Statistics            Tel: +61-3-8344-9763\nUniversity of Melbourne, VIC 3010 Australia         Fax: +61-3-8344-4599\nhttp://www.ms.unimelb.edu.au/~andrewpr\nhttp://blogs.mbs.edu/fishing-in-the-bay/\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}