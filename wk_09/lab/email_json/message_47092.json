{"category": "ham", "to_address": "<r-help@stat.math.ethz.ch>", "from_address": "\"Patnaik, Tirthankar \" <tirthankar.patnaik@citi.com>", "subject": "[R] Confusion with sapply", "body": "Hi,\n I have some confusion in applying a function over a column.\n\nHere's my function. I just need to shift non-March month-ends to March\nmonth-ends. Initially I tried seq.dates, but one cannot give a negative\nincrement (decrement) here.\n\nreturn(as.Date(seq.dates(format(xdate,\"%m/%d/%Y\"),by=\"months\",len=4)[4])\n)\n\nHence this simple function:\n\n> mydate <- as.Date(\"2006-01-01\")\n> \n> # Function to shift non-March company-reporting dates to March.\n> Set2March <- function(xdate){\n+ # Combines non-March months into March months:\n+ # Dec2006 -> Mar2007\n+ # Mar2006 -> Mar2006\n+ # Jun2006 -> Mar2006\n+ # Sep2006 -> Mar2006\n+ # VERY Specific code.\n+     Month <- format(xdate,\"%m\")\n+     wDate <- month.day.year(julian(xdate))\n+     if (Month==\"12\"){\n+         wDate$year <- wDate$year + 1\n+         wDate$month <- 3\n+     }else\n+     if (Month==\"06\"){\n+         wDate$month <- 3\n+     }else\n+     if (Month==\"09\"){\n+         wDate$month <- 3\n+         wDate$day <- wDate$day + 1\n+     }else warning (\"No Changes made to the month, since month is not\none of (6,9,12)\")\n+     cDate <- chron(paste(wDate$month,wDate$day,wDate$year,sep=\"/\"))\n+     return(as.Date(as.yearmon(as.Date(cDate,\"%m/%d/%y\")),frac=1))\n+ }\n> Set2March(as.Date(\"2006-06-30\"))\n[1] \"2006-03-31\"\n> Set2March(mydate)\n[1] \"2006-01-31\"\nWarning message:\nNo Changes made to the month, since month is not one of (6,9,12) in:\nSet2March(mydate) \n> \n\nWorks well when I use it on a single date. Then I try it on a vector:\n\n\n> dc <- seq(as.Date(\"2006-01-01\"),len=10, by=\"month\")\n> dc\n [1] \"2006-01-01\" \"2006-02-01\" \"2006-03-01\" \"2006-04-01\" \"2006-05-01\"\n\"2006-06-01\" \"2006-07-01\" \"2006-08-01\"\n [9] \"2006-09-01\" \"2006-10-01\"\n\n\n> sapply(as.vector(dc),Set2March)\nError in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3,\n: \n        unimplemented type 'character' in 'asLogical'\n> \n\nWhat am I missing here? Shouldn't the function work with the sapply\nworking on each entry?\n\n\nTIA and best,\n-Tir\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}