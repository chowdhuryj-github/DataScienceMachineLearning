{"category": "ham", "to_address": "\"Sarti Maurizio\" <sarti.m@irea.cnr.it>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] help about 2 way anova and tukey test", "body": "The form of your data is termed \"wide\" and you want to reshape it to\n\"long\" form and use aov with that.  This uses the reshape command\nto produce the long form.  Alternately you could use cast and melt\nin the reshape package to do that:\n\n# read data\nLines <- \"subj    therapy t0      t1      t2\n1       a       80.5    82.2    54.23\n2       a       84.9    85.6    56.83\n3       a       81.5    81.4    54.30\n1       b       83.8    95.2    59.67\n2       b       83.3    94.3    59.20\n3       b       86      91.5    59.17\n1       c       80.7    80.2    53.63\n2       c       89.4    80.1    56.50\n3       c       91.8    86.4    59.40\n\"\nDF <- read.table(textConnection(Lines), header = TRUE)\n\n# reshape to long form\nnm <- names(DF)[3:5]\nlong <- reshape(DF, dir = \"long\", varying = list(nm), times = nm,\n  v.names = \"value\")\nlong$time <- factor(long$time)\n\n# calculate\naov(value ~ therapy * time, data = long)\n\n# ...etc\n\nOn 5/24/07, Sarti Maurizio  wrote:\n> Dears members of R list,\n> I have a technical question about conducting 2 way analysis of the variance\n> (ANOVA) for repeated measures followed tukey test using R.\n> my data are:\n> There were 3 subj in all and 3 repeated measures for every time and therapy\n> therapy = a,b,c\n> time    = t1,t2,t3\n> subj    = 1,2,3\n>\n> subj    therapy t0      t1      t2\n> 1       a       80.5    82.2    54.23\n> 2       a       84.9    85.6    56.83\n> 3       a       81.5    81.4    54.30\n> 1       b       83.8    95.2    59.67\n> 2       b       83.3    94.3    59.20\n> 3       b       86      91.5    59.17\n> 1       c       80.7    80.2    53.63\n> 2       c       89.4    80.1    56.50\n> 3       c       91.8    86.4    59.40\n>\n> the code that I use is:\n>\n> rm(list=ls(all=TRUE))\n> dati<- read.table(\"dati.txt\", T)\n> attach(dati)\n> subj<- c( 1: 9, 1: 9,1:9)\n> therapy<- factor( c( rep(\" a\", 3), rep(\" b\", 3), rep(\" c\", 3),\n>                     rep(\" a\", 3), rep(\" b\", 3), rep(\" c\", 3),\n>                     rep(\" a\",3), rep(\" b\", 3), rep(\" c\", 3)))\n>\n> time<- factor( c( rep(\" t0\", 9), rep(\" t1\", 9),rep(\" t2\", 9)))\n> weight<- c( t0,t1,t2)\n>\n> time <- factor( time)\n> therapy <- factor( therapy)\n> subj <- factor( subj)\n> summary( fm1<-aov( weight~time*therapy))\n> fm1Tukey=TukeyHSD(fm1,\"therapy\",ordered = TRUE) ; fm1Tukey\n> fm1Tukey=TukeyHSD(fm1,\"time\",ordered = TRUE) ; fm1Tukey\n> fm1Tukey=TukeyHSD(fm1,\"time:therapy\",ordered = TRUE) ; fm1Tukey\n>\n> My question is - is that the correct way to do it??\n> Very much obliged for your kind response\n> Maurizio\n>\n> ******************************************************************************\n> Maurizio Sarti, PhD\n> IREA - CNR\n> via Diocleziano,328 I-80124 Napoli (Italy)\n> tel:+39-(0)81-5707999-(0)81-5704945  fax:+39-(0)81-5705734\n> cell:+39-3204397891\n> ******************************************************************************\n> e-mail: sarti.m@irea.cnr.it website: http://www.irea.cnr.it\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}