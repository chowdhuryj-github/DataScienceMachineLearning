{"category": "ham", "to_address": "samba-technical@samba.org", "from_address": "Johann Hanne <jhml@gmx.net>", "subject": "\"valid users = domain_user\" without specifying domain", "body": "Hi,\n\nI've got a long time configuration wish where I was never sure if it's \nactually doable. Maybe somebody can give me some hint...\n\nMy samba configuration is rather simple: It's a Windows ADS domain member with \na www share that's mainly accessed by Windows users:\n---\n[global]\n\nnetbios name = MYSERVER\nworkgroup = MYDOMAIN\nrealm = MYDOMAIN.DE\nsecurity = ADS\n\nidmap domains = MYDOMAIN\n\nidmap config MYDOMAIN:default = yes\nidmap config MYDOMAIN:backend = ad\nidmap config MYDOMAIN:range = 500 - 999\nidmap config MYDOMAIN:schema_mode = rfc2307\n\nwinbind uid = 500 - 999\nwinbind gid = 500 - 999\nwinbind use default domain = yes\n--\n\nSo far, everything is working fine, but the share configuration is not how I'd \nlike:\n--\n[www]\n  comment = Web\n  path = /var/www\n  valid users = MYDOMAIN/user1 MYDOMAIN/user2 MYDOMAIN/user3\n  ; does NOT work:\n  ;valid users = user1 user2 user3\n  ; what I'd like to put in is:\n  ;valid users = +apache\n--\n\nMy problem is that I have to specify the domain (\"MYDOMAIN/\") in front of each \nuser, otherwise it won't work (Permission denied). It's not that I hate the \nextra typing in front of each user, it's that I already have a Unix group \nin /etc/group listing the authorized users:\n--\napache::81:user1,user2,user3\n--\nSo actually I'd like to use \"valid users = +apache\" in smb.conf, but this does \nnot work either, probably because it's also missing the domain name \ninformation.\n\nI also don't want to make apache a domain group, as I want to keep it separate \non each web server.\n\nShouldn't this be a configuration that works? user1, user2 and user3 are \nactually winbind/nss mapped users, so why do I have to specify the domain \nname here?\n\nIf somebody can give me hint which part in the source code must be modified, \nI'd also give it a try myself...\n\nCheers, Johann\n\n"}