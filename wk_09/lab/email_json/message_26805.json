{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r22775 - in branches: SAMBA_3_0/source\n\tSAMBA_3_0/source/include SAMBA_3_0/source/lib\n\tSAMBA_3_0_26/source SAMBA_3_0_26/source/include\n\tSAMBA_3_0_26/source/lib", "body": "Author: vlendec\nDate: 2007-05-10 10:42:13 +0000 (Thu, 10 May 2007)\nNew Revision: 22775\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22775\n\nLog:\nFor the cluster code I've developed a wrapper around tdb to put different\ndatabase backends in place dynamically.\n\nThe main abstractions are db_context and db_record, it should be mainly\nself-describing, see include/dbwrap.h.  You open the db just as you would open\na tdb, this time with db_open(). If you want to fetch a record, just do the\ndb->fetch() call, if you want to do operations on it, you need to get it with\nfetch_locked().\n\nI added dbwrap_file.c (not heavily tested lately) as an example for what can\nbe done with that abstraction, uses a file per key. So if anybody is willing\nto shape that up, we might have a chance on reiserfs again.... :-)\n\nThis abstraction works fine for brlock.tdb, locking.tdb, connections.tdb and\nsessionid.tdb. It should work fine for the others as well, I just did not yet\nget around to convert them.\n\nIf nobody loudly screams NO, then I will import the code that uses this soon.\n\nVolker\n\nAdded:\n   branches/SAMBA_3_0/source/include/dbwrap.h\n   branches/SAMBA_3_0/source/lib/dbwrap.c\n   branches/SAMBA_3_0/source/lib/dbwrap_file.c\n   branches/SAMBA_3_0/source/lib/dbwrap_tdb.c\n   branches/SAMBA_3_0_26/source/include/dbwrap.h\n   branches/SAMBA_3_0_26/source/lib/dbwrap.c\n   branches/SAMBA_3_0_26/source/lib/dbwrap_file.c\n   branches/SAMBA_3_0_26/source/lib/dbwrap_tdb.c\nModified:\n   branches/SAMBA_3_0/source/Makefile.in\n   branches/SAMBA_3_0/source/include/includes.h\n   branches/SAMBA_3_0_26/source/Makefile.in\n   branches/SAMBA_3_0_26/source/include/includes.h\n\n\nChangeset:\nSorry, the patch is too large (1607 lines) to include; please use WebSVN to see it!\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22775\n\n"}