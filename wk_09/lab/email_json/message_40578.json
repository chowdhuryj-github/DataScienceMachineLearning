{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r23297 - in branches: SAMBA_3_0/source/nsswitch\n\tSAMBA_3_0_26/source/nsswitch", "body": "Author: vlendec\nDate: 2007-06-01 18:39:50 +0000 (Fri, 01 Jun 2007)\nNew Revision: 23297\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=23297\n\nLog:\nThis introduces the winbind:ads parameter which defaults to True. Setting it\nto False makes winbind use RPC and not LDAP methods to connect to the DCs,\neven when it figured out they are AD.\nModified:\n   branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\n   branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\n===================================================================\n--- branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\t2007-06-01 18:36:55 UTC (rev 23296)\n+++ branches/SAMBA_3_0/source/nsswitch/winbindd_cache.c\t2007-06-01 18:39:50 UTC (rev 23297)\n@@ -169,7 +169,9 @@\n \t\tif ( !domain->primary )\n \t\t\tour_domain = find_our_domain();\n \n-\t\tif ( (our_domain->active_directory || IS_DC) && domain->active_directory ) {\n+\t\tif ((our_domain->active_directory || IS_DC)\n+\t\t    && domain->active_directory\n+\t\t    && lp_parm_bool(-1, \"winbind\", \"ads\", True)) {\n \t\t\tDEBUG(5,(\"get_cache: Setting ADS methods for domain %s\\n\", domain->name));\n \t\t\tdomain->backend = &ads_methods;\n \t\t} else {\n\nModified: branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\n===================================================================\n--- branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-06-01 18:36:55 UTC (rev 23296)\n+++ branches/SAMBA_3_0_26/source/nsswitch/winbindd_cache.c\t2007-06-01 18:39:50 UTC (rev 23297)\n@@ -169,7 +169,9 @@\n \t\tif ( !domain->primary )\n \t\t\tour_domain = find_our_domain();\n \n-\t\tif ( (our_domain->active_directory || IS_DC) && domain->active_directory ) {\n+\t\tif ((our_domain->active_directory || IS_DC)\n+\t\t    && domain->active_directory\n+\t\t    && lp_parm_bool(-1, \"winbind\", \"ads\", True)) {\n \t\t\tDEBUG(5,(\"get_cache: Setting ADS methods for domain %s\\n\", domain->name));\n \t\t\tdomain->backend = &ads_methods;\n \t\t} else {\n\n"}