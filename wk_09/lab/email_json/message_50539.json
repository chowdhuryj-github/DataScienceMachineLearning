{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "Michael Adam <ma@sernet.de>", "subject": "Rev 5381: merge from upstream - now in sync again! in\n\thttp://samba.sernet.de/ma/bzr/SAMBA_3_0-registry.bzr/", "body": "At http://samba.sernet.de/ma/bzr/SAMBA_3_0-registry.bzr/\n\n------------------------------------------------------------\nrevno: 5381\nrevision-id: ma@sernet.de-20070619095401-4h1nq927seojlqmt\nparent: ma@sernet.de-20070613122003-hev6619nf14cwgsl\nparent: jpeach@samba.org-20070618161516-tu4uk4na2br24sq0\ncommitter: Michael Adam \nbranch nick: SAMBA_3_0-registry.bzr\ntimestamp: Tue 2007-06-19 11:54:01 +0200\nmessage:\n  merge from upstream - now in sync again!\nadded:\n  source/include/reg_db.h        reg_db.h-20070615214610-cezf0v33opod19n3-1\n  source/lib/privileges_basic.c  privileges_basic.c-20070614113052-vss4ipzfefw4ou23-1\n  source/lib/util_nttoken.c      util_nttoken.c-20070614113053-yunl01g6q5iqk4rv-1\n  source/lib/util_reg_api.c      util_reg_api.c-20070614113053-250c4n739wu542wo-1\n  source/lib/util_reg_smbconf.c  util_reg_smbconf.c-20070614113054-hsmgsndbevshz5tg-1\nrenamed:\n  source/lib/privileges_basic.c => source/lib/privileges_basic.c.moved privileges_basic.c-20070412140750-pro2zmd8rfupsdup-1\n  source/lib/util_nttoken.c => source/lib/util_nttoken.c.moved util_nttoken.c-20070412121956-apjs5s3igy1ydc2e-1\nmodified:\n  REVISION                       REVISION-20060530022625-68239662668b41c3\n  examples/misc/adssearch.pl     adssearch.pl-20060530052222-0e15313921c49cc3\n  source/Makefile.in             Makefile.in-20060530022626-b16dac2328ebe703\n  source/auth/auth_util.c        auth_util.c-20060530022627-f9a3e5940d409fe9\n  source/client/smbspool.c       smbspool.c-20060530022627-037d79e85d505b8b\n  source/configure.in            configure.in-20060530022626-07e74bc1e326c82d\n  source/groupdb/mapping.c       mapping.c-20060530022627-0d4c0d27ca093883\n  source/include/includes.h      includes.h-20060530022627-d1a059a99c05e8be\n  source/include/smb_macros.h    smb_macros.h-20060530022627-412e2056512de943\n  source/lib/charcnv.c           charcnv.c-20060530022627-e157371a538fdeb6\n  source/lib/data_blob.c         data_blob.c-20060530022627-6dbdabdd0ae85f7f\n  source/lib/select.c            select.c-20060530022627-0a8a8f371f75ead5\n  source/lib/smbldap.c           smbldap.c-20060530022627-2d88240b15c77135\n  source/lib/system.c            system.c-20060530022627-3f01435a4e07a714\n  source/lib/system_smbd.c       system_smbd.c-20060530022627-e97a2e558e6fd98c\n  source/lib/util.c              util.c-20060530022627-d569af0e687a4dd3\n  source/lib/util_pw.c           util_pw.c-20060530022627-912c52afc587540f\n  source/lib/util_reg.c          util_reg.c-20060711181331-c2d45d0e1f4a8648\n  source/lib/util_str.c          util_str.c-20060530022627-0ba87cda5eaacc2e\n  source/lib/util_tdb.c          util_tdb.c-20061021025435-o3vr4t381qf9lv7e-1\n  source/libads/kerberos_verify.c kerberos_verify.c-20060530022627-7ce45c38ec645075\n  source/libads/ldap.c           ldap.c-20060530022627-07f10a20cc50f671\n  source/libsmb/cliquota.c       cliquota.c-20060530022627-6a0c6af7c7a1799b\n  source/locking/brlock.c        brlock.c-20060530022627-3b8aec140997e136\n  source/locking/locking.c       locking.c-20060530022627-4f229d47402340bb\n  source/locking/posix.c         posix.c-20060530022627-997d33ad43f0bd3e\n  source/nmbd/nmbd.c             nmbd.c-20060530022627-f3b08abf8f3e3c36\n  source/nsswitch/idmap_rid.c    idmap_rid.c-20061212152807-oje7ib8mg9u2kxxg-1\n  source/nsswitch/winbind_nss.h  winbind_nss.h-20060530022627-d0c8a4c069df06f6\n  source/nsswitch/winbind_nss_linux.h winbind_nss_linux.h-20060530022627-000f66c6b04b919e\n  source/nsswitch/winbindd.c     winbindd.c-20060530022627-8bb76c46bd1253ec\n  source/nsswitch/winbindd_ads.c winbindd_ads.c-20060530022627-7c5e13eefe48f902\n  source/nsswitch/winbindd_cm.c  winbindd_cm.c-20060530022627-54b91b1c8940d29e\n  source/nsswitch/winbindd_group.c winbindd_group.c-20060530022627-9288f9a998ed2fbe\n  source/nsswitch/winbindd_pam.c winbindd_pam.c-20060530022627-6b827f2f7ba30f85\n  source/nsswitch/winbindd_util.c winbindd_util.c-20060530022627-e014c9e53147dffe\n  source/param/loadparm.c        loadparm.c-20060530022627-1efa1edb3eb0e897\n  source/passdb/machine_sid.c    machine_sid.c-20060530022627-0ae56984d090a020\n  source/passdb/pdb_tdb.c        pdb_tdb.c-20060530022627-b60f9dcd220e2886\n  source/registry/reg_db.c       reg_db.c-20060530022627-e9a827257fb89131\n  source/rpc_parse/parse_misc.c  parse_misc.c-20060530022627-2f2bf5c0060cbd6c\n  source/rpc_server/srv_lsa.c    srv_lsa.c-20060530022627-81cfe5eecd61a4f2\n  source/script/tests/test_local_s3.sh test_local_s3.sh-20060901130329-d2423dc033e3ea57\n  source/script/tests/test_posix_s3.sh test_posix_s3.sh-20060530100742-bf4d8804f7ab56c6\n  source/smbd/aio.c              aio.c-20060530065353-839ba30629e9be61\n  source/smbd/blocking.c         blocking.c-20060530022627-b43dcc35e2ddb440\n  source/smbd/fileio.c           fileio.c-20060530022627-1404925b99a776aa\n  source/smbd/files.c            files.c-20060530022627-8e2ca5e2d798cd9b\n  source/smbd/msdfs.c            msdfs.c-20060530024146-252992a3c60c990c\n  source/smbd/negprot.c          negprot.c-20060530022627-a352553cf95f9931\n  source/smbd/notify.c           notify.c-20060530022627-f5b19ce2772c47a0\n  source/smbd/nttrans.c          nttrans.c-20060530022627-b483806ef6e0e97d\n  source/smbd/password.c         password.c-20060530022627-9a5472626c6d94bc\n  source/smbd/reply.c            reply.c-20060530022627-92de20342694c043\n  source/smbd/sec_ctx.c          sec_ctx.c-20060530022627-5357c503c5244050\n  source/smbd/server.c           server.c-20060530022627-212a418ec1144979\n  source/smbd/sesssetup.c        sesssetup.c-20060530022627-0a6efae905e1529e\n  source/smbd/share_access.c     share_access.c-20060530090225-6be2f147403f83a8\n  source/smbd/trans2.c           trans2.c-20060530022627-7ce34cd85c3f02f5\n  source/tests/summary.c         summary.c-20060530022627-e17f995a58207da2\n  source/utils/ntlm_auth.c       ntlm_auth.c-20060530022628-e481af6280ebed07\n    ------------------------------------------------------------\n    revno: 5275.1.894\n    merged: jpeach@samba.org-20070618161516-tu4uk4na2br24sq0\n    parent: kai@samba.org-20070618140030-9bctt4bj05xc6azr\n    committer: jpeach@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Mon 2007-06-18 11:15:16 -0500\n    message:\n      jpeach@samba.org (r23541)  2007-06-18 11:10:00 -0500 (Mon, 18 Jun 2007)\n          \n          Linking the LSA pipe module only once is probably enough.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.893\n    merged: kai@samba.org-20070618140030-9bctt4bj05xc6azr\n    parent: vlendec@samba.org-20070618123058-nv1ac832jg69ofup\n    committer: kai@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Mon 2007-06-18 09:00:30 -0500\n    message:\n      kai@samba.org (r23539)  2007-06-18 08:59:09 -0500 (Mon, 18 Jun 2007)\n          \n          Remove code duplication and unify behaviour of winbind_nss_*.h files\n          \n    ------------------------------------------------------------\n    revno: 5275.1.892\n    merged: vlendec@samba.org-20070618123058-nv1ac832jg69ofup\n    parent: vlendec@samba.org-20070618093102-hatq6r284z95nyan\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Mon 2007-06-18 07:30:58 -0500\n    message:\n      vlendec@samba.org (r23538)  2007-06-18 07:22:42 -0500 (Mon, 18 Jun 2007)\n          \n          Fix for wild-card rename: We can't return directly on error, we need to\n          CloseDir.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.891\n    merged: vlendec@samba.org-20070618093102-hatq6r284z95nyan\n    parent: obnox@samba.org-20070617231545-fyw5rtise91o9w7j\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Mon 2007-06-18 04:31:02 -0500\n    message:\n      vlendec@samba.org (r23537)  2007-06-18 04:25:31 -0500 (Mon, 18 Jun 2007)\n          \n          Revert the inbuf/outbuf part of r23528: This caused the Solaris CC make test\n          to break. The Solaris CC put the static char InBuffer[TOTAL_BUFFER_SIZE] on an\n          odd address, the malloc'ed one is always aligned. The problem showed up in\n          pull_ucs2, ucs2_align uses the address of InBuffer as an indication whether to\n          bump up the src of the string by one. Unfortunately in the trans calls the\n          data portion is malloced and thus has different alignment guarantees than a\n          static variable. This one is bigger....\n          \n          Volker\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.890\n    merged: obnox@samba.org-20070617231545-fyw5rtise91o9w7j\n    parent: jra@samba.org-20070617193120-3hiw591y6rg16ezc\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sun 2007-06-17 18:15:45 -0500\n    message:\n      obnox@samba.org (r23536)  2007-06-17 18:13:32 -0500 (Sun, 17 Jun 2007)\n          \n          Fix a typo. James: Please check!\n          \n          Michael\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.889\n    merged: jra@samba.org-20070617193120-3hiw591y6rg16ezc\n    parent: vlendec@samba.org-20070617053037-rog8u2t4r8ihbve9\n    committer: jra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sun 2007-06-17 14:31:20 -0500\n    message:\n      jra@samba.org (r23530)  2007-06-17 14:23:32 -0500 (Sun, 17 Jun 2007)\n          \n          Fix bugs #4678 and #4697 which had the same root cause.\n          In make_server_info_pw() we assign a user SID in our\n          authoritative SAM, even though this may be from a\n          pure \"Unix User\" that doesn't exist in the SAM.\n          This causes lookups on \"[in]valid users\" to fail as they\n          will lookup this name as a \"Unix User\" SID to check against\n          the user token. Fix this by adding the \"Unix User\"\\unix_username\n          SID to the sid array. The correct fix should probably be\n          changing the server_info->sam_account user SID to be a\n          S-1-22 Unix SID, but this might break old configs where\n          plaintext passwords were used with no SAM backend.\n          Jeremy\n          \n    ------------------------------------------------------------\n    revno: 5275.1.888\n    merged: vlendec@samba.org-20070617053037-rog8u2t4r8ihbve9\n    parent: idra@samba.org-20070616230108-ky9af5ghbqc3hk7c\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sun 2007-06-17 00:30:37 -0500\n    message:\n      vlendec@samba.org (r23528)  2007-06-17 00:19:30 -0500 (Sun, 17 Jun 2007)\n          \n          Two changes to make the valgrind massif (heap profiler) output readable:\n          \n          Remove the allocated inbuf/output. In async I/O we copy the buffers\n          explicitly now, so NewInBuffer is called exactly once. This does not\n          reduce memory footprint, but removes one of the larger chunks that\n          clobber the rest of the massif output\n          \n          In getgroups_unix_user on Linux 2.6 we allocated 64k groups x 4 bytes\n          per group x 2 (once in the routine itself and once in libc) = 512k just\n          to throw it away directly again. This reduces it do a more typical limit\n          of 32 groups per user. We certainly cope with overflow fine if 32 is not\n          enough. Not 100% sure about this one, a DEVELOPER only thing?\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.887\n    merged: idra@samba.org-20070616230108-ky9af5ghbqc3hk7c\n    parent: idra@samba.org-20070616190112-1c9pblcrus6l86l6\n    committer: idra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sat 2007-06-16 18:01:08 -0500\n    message:\n      idra@samba.org (r23527)  2007-06-16 17:52:51 -0500 (Sat, 16 Jun 2007)\n          \n          \n          Use existing escaping function pointed by James\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.886\n    merged: idra@samba.org-20070616190112-1c9pblcrus6l86l6\n    parent: idra@samba.org-20070616190108-f72c70pmzsevijz6\n    committer: idra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sat 2007-06-16 14:01:12 -0500\n    message:\n      idra@samba.org (r23525)  2007-06-16 13:59:02 -0500 (Sat, 16 Jun 2007)\n          \n          \n          I believe this patch is ok, got no reply of it being not ok.\n          This closes #4624 for me.\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.885\n    merged: idra@samba.org-20070616190108-f72c70pmzsevijz6\n    parent: vlendec@samba.org-20070616183017-3e9zxs90o5rrgxb2\n    committer: idra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sat 2007-06-16 14:01:08 -0500\n    message:\n      idra@samba.org (r23524)  2007-06-16 13:54:13 -0500 (Sat, 16 Jun 2007)\n          \n          \n          Fix bug 2319.\n          Got report this is all ok form a tester. Close a loong\n          standing bug preventing people to freely use any character\n          in their password when printing via cups were involved.\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.884\n    merged: vlendec@samba.org-20070616183017-3e9zxs90o5rrgxb2\n    parent: vlendec@samba.org-20070616181557-04268opiz301ebna\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sat 2007-06-16 13:30:17 -0500\n    message:\n      vlendec@samba.org (r23523)  2007-06-16 13:19:42 -0500 (Sat, 16 Jun 2007)\n          \n          Gaa -- had renamed \"name\" to \"path\" and apparently not compiled after\n          that.... \n          \n          Volker\n          \n    ------------------------------------------------------------\n    revno: 5275.1.883\n    merged: vlendec@samba.org-20070616181557-04268opiz301ebna\n    parent: vlendec@samba.org-20070616120139-7vern8aey2xxzbe6\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sat 2007-06-16 13:15:57 -0500\n    message:\n      vlendec@samba.org (r23522)  2007-06-16 13:07:44 -0500 (Sat, 16 Jun 2007)\n          \n          Save us a kilobyte stack space in a hot code path: I can't see a reason\n          why check_path_syntax should not be able to run in-line. The destination\n          pointer either walks side by side with the source pointer or is\n          decremented. So as far as I can see s>=d is true throughout the whole\n          routine.\n          \n          Jeremy, I'm checking this only into 3_0 for now. Please review and ack\n          or directly merge this to 3_0_26.\n          \n          Thanks,\n          \n          Volker\n          \n    ------------------------------------------------------------\n    revno: 5275.1.882\n    merged: vlendec@samba.org-20070616120139-7vern8aey2xxzbe6\n    parent: vlendec@samba.org-20070616101600-pt2eawjuqrdgzd2g\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sat 2007-06-16 07:01:39 -0500\n    message:\n      vlendec@samba.org (r23518)  2007-06-16 06:48:11 -0500 (Sat, 16 Jun 2007)\n          \n          Remove the silly assumption that string_replace requires a pstring.\n          \n          Jeremy, I am always very confused about the different length arguments\n          in convert_string and friends. Can you take a look at the change in\n          string_replace and verify it's ok? Thanks!\n          \n          While at it, remove the pstring limit for strhasupper and strhaslower.\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.881\n    merged: vlendec@samba.org-20070616101600-pt2eawjuqrdgzd2g\n    parent: jra@samba.org-20070616011712-fapbx3ft47xxcfu2\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Sat 2007-06-16 05:16:00 -0500\n    message:\n      vlendec@samba.org (r23517)  2007-06-16 05:02:51 -0500 (Sat, 16 Jun 2007)\n          \n          After Jeremy has given is ack on irc:\n          \n          Change rename_internals to open the file/directory and then call\n          rename_internals_fsp. Two reasons: Remove code duplication and remove a\n          race condition. The race condition was due to the fact that in\n          can_rename the share mode check closed the file and then after that did\n          the rename.\n          \n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.880\n    merged: jra@samba.org-20070616011712-fapbx3ft47xxcfu2\n    parent: jra@samba.org-20070616010115-1dxkpzvowsabr5xt\n    committer: jra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 20:17:12 -0500\n    message:\n      jra@samba.org (r23516)  2007-06-15 20:04:22 -0500 (Fri, 15 Jun 2007)\n          \n          Fix bug found & fixed by Spie Rudoff (spie_rudoff@isilon.com)\n          - when cleaning up invalid locks make sure we mark the lck\n          struct as modified so it'll get saved back correctly (that\n          was the original intent).\n          Jeremy.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.879\n    merged: jra@samba.org-20070616010115-1dxkpzvowsabr5xt\n    parent: jra@samba.org-20070616004547-3vzzbs14ar0uft2r\n    committer: jra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 20:01:15 -0500\n    message:\n      jra@samba.org (r23515)  2007-06-15 19:54:58 -0500 (Fri, 15 Jun 2007)\n          \n          Ensure status isn't used uninitialized.\n          Jeremy.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.878\n    merged: jra@samba.org-20070616004547-3vzzbs14ar0uft2r\n    parent: jra@samba.org-20070616000155-wjkecm4oty8nv7qr\n    committer: jra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 19:45:47 -0500\n    message:\n      jra@samba.org (r23514)  2007-06-15 19:39:52 -0500 (Fri, 15 Jun 2007)\n          \n          Remove unused function ads_get_dn_from_extended_dn().\n          Jeremy.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.877\n    merged: jra@samba.org-20070616000155-wjkecm4oty8nv7qr\n    parent: jra@samba.org-20070616000150-m6n9sutdpuodroi0\n    committer: jra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 19:01:55 -0500\n    message:\n      jra@samba.org (r23513)  2007-06-15 18:52:01 -0500 (Fri, 15 Jun 2007)\n          \n          Fix one more use of VALUE_PREFIX.\n          Jeremy.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.876\n    merged: jra@samba.org-20070616000150-m6n9sutdpuodroi0\n    parent: jpeach@samba.org-20070615220054-9caccgvycl73bptb\n    committer: jra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 19:01:50 -0500\n    message:\n      jra@samba.org (r23512)  2007-06-15 18:47:40 -0500 (Fri, 15 Jun 2007)\n          \n          Fix conflict in #define for SECDESC_PREFIX. Ensure all\n          reg #defines use \"REG_\" prefix. Michael - please check\n          gcc warnings on compiles.\n          Jeremy.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.875\n    merged: jpeach@samba.org-20070615220054-9caccgvycl73bptb\n    parent: obnox@samba.org-20070615214612-ydoi6x4145yzf54a\n    committer: jpeach@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 17:00:54 -0500\n    message:\n      jpeach@samba.org (r23510)  2007-06-15 16:58:49 -0500 (Fri, 15 Jun 2007)\n          \n          Tidy calls to smb_panic by removing trailing newlines. Print the\n          failed expression in SMB_ASSERT.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.874\n    merged: obnox@samba.org-20070615214612-ydoi6x4145yzf54a\n    parent: jra@samba.org-20070615193149-dp5vube4ht3dswlh\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 16:46:12 -0500\n    message:\n      obnox@samba.org (r23509)  2007-06-15 16:38:10 -0500 (Fri, 15 Jun 2007)\n          \n          This activates the global options from the registry in loadparm. \n          The global options are stored as values in the subkey \"global\"\n          of the SMBCONF registry key. \n          \n          The activation is accomplished in smb.conf though a new special \n          semantic of the \"include\" parameter: \"include = registry\" triggers\n          the processing of the registry global options exactly at the\n          position of the include statement. Options read from the registry\n          take the same precedence as parameters loaded from a file via\n          include. Need to reload the registry globals is detected by\n          watching the tdb sequence number. \n          \n          Registry shares are automatically activated when the registry\n          globals are processed.\n          \n          So a \"registry only\" configuration can be realized by an\n          smb.conf that looks as follows:\n          \n          ================================\n          [global]\n          include = registry\n          ================================\n          \n          The global options and registry shares can be conveniently\n          edited with the \"net conf\" utility.\n          \n          \n          Caveat:\n          \n          A possible pitfall consists in using \"include = registry\"\n          together with the \"lock directory\" directive in the registry.\n          This problem will be addressed in the next time.\n          \n          \n          Note on the code:\n          \n          Processing of the registry options is accomplished by a function\n          process_registry_globals() in loadparm.c The current version is\n          only an interim solution: It is handcoded instead of using the\n          infrastructure of reg_api.c. The reason for this is that using \n          reg_api still has too large linker dependencies, bloating virtually\n          all targets by PASSDB_OBJ, SMBLDAP_OBJ, GROUPDB_OBJ and LDB stuff.\n          A version of process_registry_globals that uses reg_api is \n          included but commented out. The goal is to eventually refactor\n          and restructure the registry code so that one can use the reg_api\n          to access only the registry tdb and not link all the dynamic\n          backends with all their linking implications.\n          \n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.873\n    merged: jra@samba.org-20070615193149-dp5vube4ht3dswlh\n    parent: obnox@samba.org-20070615160130-5zp589uv286rwh7a\n    committer: jra@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 14:31:49 -0500\n    message:\n      jra@samba.org (r23508)  2007-06-15 14:24:04 -0500 (Fri, 15 Jun 2007)\n          \n          Fix sync_file() to return NTSTATUS and return this\n          on failure in the write path.\n          Jeremy.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.872\n    merged: obnox@samba.org-20070615160130-5zp589uv286rwh7a\n    parent: obnox@samba.org-20070615104638-d4w30r295x8m4rqh\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 11:01:30 -0500\n    message:\n      obnox@samba.org (r23507)  2007-06-15 10:51:45 -0500 (Fri, 15 Jun 2007)\n          \n          Split one general function normalize_dbkey from reg_db.c into util_reg.c\n          (To be used in other place in subsequent commit.)\n          \n          Michael\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.871\n    merged: obnox@samba.org-20070615104638-d4w30r295x8m4rqh\n    parent: jpeach@samba.org-20070614190023-3pcje3oqg11s1a6i\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Fri 2007-06-15 05:46:38 -0500\n    message:\n      obnox@samba.org (r23504)  2007-06-15 05:40:36 -0500 (Fri, 15 Jun 2007)\n          \n          Use tdb_wrap_open (instead of usual tdb_open) in reg_db.\n          This eliminates the need of maintaining reg_db's own \n          reference counter for the tdb. Maybe as a next step...\n          \n          Michael\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.870\n    merged: jpeach@samba.org-20070614190023-3pcje3oqg11s1a6i\n    parent: vlendec@samba.org-20070614160053-tkasaprivhbnud3h\n    committer: jpeach@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 14:00:23 -0500\n    message:\n      jpeach@samba.org (r23502)  2007-06-14 13:48:51 -0500 (Thu, 14 Jun 2007)\n          \n          Restore exit-on-idle.  Small refactoring for clarity. Exit if\n          we are idle and we timed out waiting for something to do.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.869\n    merged: vlendec@samba.org-20070614160053-tkasaprivhbnud3h\n    parent: vlendec@samba.org-20070614150123-k8obgxrl3irxs8wh\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 11:00:53 -0500\n    message:\n      vlendec@samba.org (r23501)  2007-06-14 10:50:47 -0500 (Thu, 14 Jun 2007)\n          \n          Move notify_rename before rename_internals_fsp and call it from there.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.868\n    merged: vlendec@samba.org-20070614150123-k8obgxrl3irxs8wh\n    parent: jerry@samba.org-20070614144600-ncf3y1qttr0ezzio\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 10:01:23 -0500\n    message:\n      vlendec@samba.org (r23500)  2007-06-14 09:45:37 -0500 (Thu, 14 Jun 2007)\n          \n          Two changes to survive the now activated test for rename_internals_fsp:\n          With the target being open we have to return NT_STATUS_ACCESS_DENIED and\n          root_fid != 0 leads to NT_STATUS_INVALID_PARAMETER\n          \n    ------------------------------------------------------------\n    revno: 5275.1.867\n    merged: jerry@samba.org-20070614144600-ncf3y1qttr0ezzio\n    parent: jerry@samba.org-20070614141539-r8asv3s8g8q52ezm\n    committer: jerry@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 09:46:00 -0500\n    message:\n      jerry@samba.org (r23497)  2007-06-14 09:35:29 -0500 (Thu, 14 Jun 2007)\n          \n          Disable building of libaddns (no defined API) and \n          libmsrpc (unmaintained).\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.866\n    merged: jerry@samba.org-20070614141539-r8asv3s8g8q52ezm\n    parent: obnox@samba.org-20070614133057-gk385tmyiqoqhl9t\n    committer: jerry@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 09:15:39 -0500\n    message:\n      jerry@samba.org (r23496)  2007-06-14 09:12:53 -0500 (Thu, 14 Jun 2007)\n          \n          Fix logic error in getgrnam_recv() that broke\n          getgrnam() for machine and domain local groups.\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.865\n    merged: obnox@samba.org-20070614133057-gk385tmyiqoqhl9t\n    parent: obnox@samba.org-20070614131541-iaz6xdj1mkqfo7pg\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 08:30:57 -0500\n    message:\n      obnox@samba.org (r23495)  2007-06-14 08:26:31 -0500 (Thu, 14 Jun 2007)\n          \n          Replace literal occurrences of libsmb/errormap.o by $(ERRORMAP_OBJ).\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.864\n    merged: obnox@samba.org-20070614131541-iaz6xdj1mkqfo7pg\n    parent: obnox@samba.org-20070614123054-y1i79i43vsjqi2ey\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 08:15:41 -0500\n    message:\n      obnox@samba.org (r23494)  2007-06-14 08:12:32 -0500 (Thu, 14 Jun 2007)\n          \n          Further reduce the diff between 3_0 and 3_0_26 by some reformatting\n          and rearrangements.\n          \n          Michael\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.863\n    merged: obnox@samba.org-20070614123054-y1i79i43vsjqi2ey\n    parent: vlendec@samba.org-20070614121543-df0uoenxvu27plxy\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 07:30:54 -0500\n    message:\n      obnox@samba.org (r23489)  2007-06-14 07:29:04 -0500 (Thu, 14 Jun 2007)\n          \n          (Re-)Add tdbtorture as a build target to 3_0_26.\n          Add the tdbtorture test to the test script in 3_0 and 3_0_26.\n          \n          Michael\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.862\n    merged: vlendec@samba.org-20070614121543-df0uoenxvu27plxy\n    parent: obnox@samba.org-20070614113056-xuuojmavfg7p3r7e\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 07:15:43 -0500\n    message:\n      vlendec@samba.org (r23486)  2007-06-14 07:03:46 -0500 (Thu, 14 Jun 2007)\n          \n          Ok, this time with a hopefully successful make test in the right place:\n          Remove two local variables\n          \n    ------------------------------------------------------------\n    revno: 5275.1.861\n    merged: obnox@samba.org-20070614113056-xuuojmavfg7p3r7e\n    parent: gd@samba.org-20070614100107-3hfommejcrxfdwk4\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 06:30:56 -0500\n    message:\n      obnox@samba.org (r23485)  2007-06-14 06:29:35 -0500 (Thu, 14 Jun 2007)\n          \n          This checkin consists mostly of refactorings in preparation of the\n          activation of global registry options in loadparm.c, mainly to\n          extract functionality from net_conf.c to be made availabel elsewhere\n          and to minimize linker dependencies. \n          \n          In detail:\n          \n          * move functions registry_push/pull_value from lib/util_reg.c to new file \n          lib/util_reg_api.c\n          \n          * create a fake user token consisting of builtin administrators sid and\n          se_disk_operators privilege by hand instead of using get_root_nt_token()\n          to minimize linker deps for bin/net.\n          \n          + new function registry_create_admin_token() in new lib/util_reg_smbconf.c\n          + move dup_nt_token from auth/token_util.c to new file lib/util_nttoken.c\n          + adapt net_conf.c and Makefile.in accordingly. \n          \n          * split lib/profiles.c into two parts: new file lib/profiles_basic.c\n          takes all the low level mask manipulation and format conversion functions\n          (se_priv, privset, luid). the privs array is completely hidden from\n          profiles.c by adding some access-functions. some mask-functions are not \n          static anymore.\n          \n          Generally, SID- and LUID-related stuff that has more dependencies \n          is kept in lib/profiles.c\n          \n          * Move initialization of regdb from net_conf.c into a function \n          registry_init_regdb() in lib/util_reg_smbconf.c.\n          \n          Michael\n          \n          \n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.860\n    merged: gd@samba.org-20070614100107-3hfommejcrxfdwk4\n    parent: vlendec@samba.org-20070614100102-2uzmflpxk7yyu6j4\n    committer: gd@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 05:01:07 -0500\n    message:\n      gd@samba.org (r23484)  2007-06-14 04:59:07 -0500 (Thu, 14 Jun 2007)\n          \n          When chasing AD referrals make sure to honor the base returned from the server.\n          \n          Guenther\n          \n    ------------------------------------------------------------\n    revno: 5275.1.859\n    merged: vlendec@samba.org-20070614100102-2uzmflpxk7yyu6j4\n    parent: vlendec@samba.org-20070614100056-7lhn3ej5elyahyra\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 05:01:02 -0500\n    message:\n      vlendec@samba.org (r23483)  2007-06-14 04:51:13 -0500 (Thu, 14 Jun 2007)\n          \n          Revert 23482, I must have run 'make test' in the wrong subdir.\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.858\n    merged: vlendec@samba.org-20070614100056-7lhn3ej5elyahyra\n    parent: jpeach@samba.org-20070614041525-vsotsuodiqww6v0h\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Thu 2007-06-14 05:00:56 -0500\n    message:\n      vlendec@samba.org (r23482)  2007-06-14 04:45:39 -0500 (Thu, 14 Jun 2007)\n          \n          Slightly simplify the rename code: Remove two local variables that are\n          not really needed.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.857\n    merged: jpeach@samba.org-20070614041525-vsotsuodiqww6v0h\n    parent: jpeach@samba.org-20070614034527-e5ly2yvhdvhthinn\n    committer: jpeach@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 23:15:25 -0500\n    message:\n      jpeach@samba.org (r23480)  2007-06-13 23:00:35 -0500 (Wed, 13 Jun 2007)\n          \n          Fix DEVELOPER_CFLAGS quoting.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.856\n    merged: jpeach@samba.org-20070614034527-e5ly2yvhdvhthinn\n    parent: jerry@samba.org-20070613220056-2dowi5h53clx02fd\n    committer: jpeach@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 22:45:27 -0500\n    message:\n      jpeach@samba.org (r23478)  2007-06-13 22:38:43 -0500 (Wed, 13 Jun 2007)\n          \n          Change the handling of the developer CFLAGS so that they are always\n          \n          emited to the Makefile in the DEVELOPER_CFLAGS variable. This makes\n          it easy to turn developer mode on and off without waiting for\n          configure to run. The developer flags are only added to CFLAGS for\n          the --enable-developer and --enable-krb5developer cases.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.855\n    merged: jerry@samba.org-20070613220056-2dowi5h53clx02fd\n    parent: jpeach@samba.org-20070613214516-0emd3svmvhew49x2\n    committer: jerry@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 17:00:56 -0500\n    message:\n      jerry@samba.org (r23477)  2007-06-13 16:59:39 -0500 (Wed, 13 Jun 2007)\n          \n          Build farm fix: Use int rather than MIT's krb5_int32 when setting context flags.\n          \n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.854\n    merged: jpeach@samba.org-20070613214516-0emd3svmvhew49x2\n    parent: jerry@samba.org-20070613210101-97xbtmal50a282wo\n    committer: jpeach@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 16:45:16 -0500\n    message:\n      jpeach@samba.org (r23475)  2007-06-13 16:42:31 -0500 (Wed, 13 Jun 2007)\n          \n          Fix the prototype for sys_broken_setgroups and log *BSD group list\n          truncation a bit more verbosely.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.853\n    merged: jerry@samba.org-20070613210101-97xbtmal50a282wo\n    parent: jerry@samba.org-20070613204552-3qq2n35fy214a13k\n    committer: jerry@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 16:01:01 -0500\n    message:\n      jerry@samba.org (r23474)  2007-06-13 15:49:20 -0500 (Wed, 13 Jun 2007)\n          \n          Here's a small patch that disables the libkrb5.so replay cache \n          when verifying a ticket from winbindd_pam.c.\n          \n          I've found during multiple, fast, automated SSH logins (such\n          as from a cron script) that the replay cache in MIT's krb5\n          lib will occasionally fail the krb5_rd_req() as a replay attack.\n          \n          There seems to be a small window during which the MIT krb5\n          libs could reproduce identical time stamps for ctime and cusec\n          in the authenticator since Unix systems only give back\n          milli-seconds rather than the micro-seconds needed by the\n          authenticator.  Checked against MIT 1.5.1.  Have not\n          researched how Heimdal does it.\n          \n          My thinking is that if someone can spoof the KDC and TDS\n          services we are pretty hopeless anyways.\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.852\n    merged: jerry@samba.org-20070613204552-3qq2n35fy214a13k\n    parent: jerry@samba.org-20070613204547-g7klj1e3c6kae7z8\n    committer: jerry@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 15:45:52 -0500\n    message:\n      jerry@samba.org (r23472)  2007-06-13 15:43:49 -0500 (Wed, 13 Jun 2007)\n          \n          add missing default setting for 'winbind nss info' (merge from  3.0.26)\n    ------------------------------------------------------------\n    revno: 5275.1.851\n    merged: jerry@samba.org-20070613204547-g7klj1e3c6kae7z8\n    parent: jpeach@samba.org-20070613204542-t9ugrtpd5wl4xe8b\n    committer: jerry@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 15:45:47 -0500\n    message:\n      jerry@samba.org (r23471)  2007-06-13 15:40:54 -0500 (Wed, 13 Jun 2007)\n          \n          Here's a rough patch for expanding domain group membership\n          in the winbindd_getgrnam() call.  Couple of comments:\n          \n          * Adds \"winbind expand groups\" parameter which defines the\n          max depth winbindd will expand group members.  The default\n          is the current behavior of one level of expansion.\n          * The entire getrgnam() interface should be async.  I\n          haven't done that.\n          * Refactors the domain users hack in fill_grent_mem() into\n          its own function.\n          \n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.850\n    merged: jpeach@samba.org-20070613204542-t9ugrtpd5wl4xe8b\n    parent: vlendec@samba.org-20070613191538-614xo2hfgk0lhhvc\n    committer: jpeach@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 15:45:42 -0500\n    message:\n      jpeach@samba.org (r23470)  2007-06-13 15:40:50 -0500 (Wed, 13 Jun 2007)\n          \n          Fix supplementary group list truncation for *BSD. We need to pass\n          the correct group list length and only truncate to NGROUPS_MAX if\n          it is too long.\n          \n    ------------------------------------------------------------\n    revno: 5275.1.849\n    merged: vlendec@samba.org-20070613191538-614xo2hfgk0lhhvc\n    parent: obnox@samba.org-20070613133036-en2rebdb3pegu95q\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 14:15:38 -0500\n    message:\n      vlendec@samba.org (r23469)  2007-06-13 14:01:41 -0500 (Wed, 13 Jun 2007)\n          \n          Fix a comment\n          \n    ------------------------------------------------------------\n    revno: 5275.1.848\n    merged: obnox@samba.org-20070613133036-en2rebdb3pegu95q\n    parent: vlendec@samba.org-20070613130042-9yubicg5fj6majul\n    committer: obnox@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 08:30:36 -0500\n    message:\n      obnox@samba.org (r23468)  2007-06-13 08:15:16 -0500 (Wed, 13 Jun 2007)\n          \n          Open registry.tdb with sequence number.\n          Add a function to retrieve the registry db sequence number.\n          \n          This is in preparation of loadparm integration of registry global\n          smb.conf options: this will allow to detect changes in order to trigger reload.\n          \n          Michael\n          \n          \n    ------------------------------------------------------------\n    revno: 5275.1.847\n    merged: vlendec@samba.org-20070613130042-9yubicg5fj6majul\n    parent: vlendec@samba.org-20070613114544-55r66emhea667s7v\n    committer: vlendec@samba.org\n    branch nick: SAMBA_3_0.bzr\n    timestamp: Wed 2007-06-13 08:00:42 -0500\n    message:\n      vlendec@samba.org (r23467)  2007-06-13 07:52:36 -0500 (Wed, 13 Jun 2007)\n          \n          Next little simplification: In rename_internals it's a bit pointless to\n          first ask for existence of a file when we do the open_file_ntcreate in\n          can_rename later on anyway. That also gets us the right error message in\n          case the file is not there automatically.\n          \n\nDiff too large for email (6019 lines, the limit is 1000).\n\n"}