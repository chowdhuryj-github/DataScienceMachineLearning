{"category": "ham", "to_address": "Alma <almatirkey@gmail.com>, beginners@perl.org", "from_address": "Andrew Curry <andrew.curry@pa-sport.com>", "subject": "RE: Database connection using cfg file", "body": "One thing could be\n\n $dbname=@arr[0];\n       $usr = @arr[1];\n       $pwd ||= @arr[2];\n\nThey should be $arr[n..]\n\nIf you turn on strict you can get rid of these as it wont compile until you\ndo. \n\nIf you take your readcfg.\n\nreadcfg($cfgpath,\\%cfgvalues);\n\nsub readcfg {\n                my($cfgpath,$cfgvalues) = @_;\nmy($line,$key,$value);\n                open(FH,\") {\n                        chomp $line;\n                         next if ($line =~ /^\\s*#/);\n                         next if ($line =~ /^\\s*$/);\n\t\t\t       ($key,$value)=split('=',$line);\n\t\t\t\t $cfgpatch->{$key}=$value;    \n          }\n\n}\n\nYou can then access your values by $cfgpath{'database'} etc...\n\n $dbname=$cfgpath{'database'};\nEtc...\n\nNone of this has been run by the way so bound to be syntax errors.\n\n-----Original Message-----\nFrom: Alma [mailto:almatirkey@gmail.com] \nSent: 22 June 2007 11:28\nTo: beginners@perl.org\nSubject: Database connection using cfg file\n\nHi All,\n\nI wanted to make a database connection using the values provided in .cfg\nfile\n\nmy.cfg\n***********\n\ndbname=xyz\nuser=abc\npasswd=abc123\n\n***********\n\nmy perl package which need to read the my.cfg file & make the connection\n\nmypackage\n************\nsub new(){\nmy @arr=();\n\n        readcfg();\n\n        #foreach  (@arr) {\n        #print \"$_ \\n\";\n        #print \"for loop\";\n        #}\n\n       $dbname=@arr[0];\n       $usr = @arr[1];\n       $pwd ||= @arr[2];\n#       ($self) = {};\n#       bless($self);\n       $databasehandle = DBI->connect(\"DBI:Pg:dbname=$dbname\",$usr,\n$pwd,{PrintError =>1});\n\n       if (!$databasehandle){\n               print \"Database connection is not estabilished\";\n               exit;\n       }\n\n\n\n        sub readcfg {\n\n               # $cfgpath = shift;\n                open(FH,\") {\n                        chomp $line;\n                         next if ($line =~ /^\\s*#/);\n                         next if ($line =~ /^\\s*$/);\n                        $line =~ s/#.*$//;\n                }\n\n($Key,$Val) = ($line =~ /^\\s*(\\S+)\\s*=\\s*(.*\\S)\\s*$/);\n                 push @arr,$Val;\n                return @arr;\n}\n\nreturn($self);\n}\n\n\n---------\n\nI am getting an error\n\n(DBI:connect ' ' ) failed .Fatal database 'root' doesn't exist.\n\nCan any one suggest me how can we read the values from conf file & get the\ndatabase connection .\n& i need to call the database handle to call the subroutine.\n\nThanks in advance.\n\n\n--\nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org For additional\ncommands, e-mail: beginners-help@perl.org http://learn.perl.org/\n\n\n\nThis e-mail is from the PA Group.  For more information, see\nwww.thepagroup.com.\n\nThis e-mail may contain confidential information.  Only the addressee is\npermitted to read, copy, distribute or otherwise use this email or any\nattachments.  If you have received it in error, please contact the sender\nimmediately.  Any opinion expressed in this e-mail is personal to the sender\nand may not reflect the opinion of the PA Group.\n\nAny e-mail reply to this address may be subject to interception or\nmonitoring for operational reasons or for lawful business practices.\n\n\n\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}