{"category": "ham", "to_address": "Karl Knoblick <karlknoblich@yahoo.de>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] aov and lme differ with interaction in oats example of MASS?", "body": "On Thu, 28 Jun 2007, Karl Knoblick wrote:\n\n> Dear R-Community!\n>\n> The example \"oats\" in MASS (2nd edition, 10.3, p.309) is calculated for aov and lme without interaction term and the results are the same.\n> But I have problems to reproduce the example aov with interaction in MASS (10.2, p.301) with lme. Here the script:\n>\n> library(MASS)\n> library(nlme)\n> options(contrasts = c(\"contr.treatment\", \"contr.poly\"))\n\nThat is the problem.  You need true contrasts, so use contr.helmert.  When \nI did so I got the same results from lme and aov for the anovas.\n\nThe question of what a 'marginal' AoV means without orthogonality is moot.\nThe sequential version is fine here.\n\n> # aov: Y ~ N + V\n> oats.aov <- aov(Y ~ N + V + Error(B/V), data = oats, qr = T)\n> summary(oats.aov)\n> # now lme\n> oats.lme<-lme(Y ~ N + V, random = ~1 | B/V, data = oats)\n> anova(oats.lme, type=\"m\") # Ok!\n> # aov:Y ~ N * V + Error(B/V)\n> oats.aov2 <- aov(Y ~ N * V + Error(B/V), data = oats, qr = T)\n> summary(oats.aov2)\n> # now lme - my trial!\n> oats.lme2<-lme(Y ~ N * V, random = ~1 | B/V, data = oats)\n> anova(oats.lme2, type=\"m\")\n> # differences!!! (except of interaction term)\n>\n> My questions:\n> 1) Is there a possibility to reproduce the result of aov with interaction using lme?\n> 2) If not, which result of the above is the correct one for the oats example?\n>\n> Thanks a lot!\n> Karl\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}