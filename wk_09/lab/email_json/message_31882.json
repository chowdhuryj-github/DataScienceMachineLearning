{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "sfrench@samba.org", "subject": "svn commit: samba r22982 - in branches/SAMBA_3_0/source/client: .", "body": "Author: sfrench\nDate: 2007-05-17 22:40:48 +0000 (Thu, 17 May 2007)\nNew Revision: 22982\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22982\n\nLog:\nDo not prompt for password on sec=none for mount.cifs (and allow guest\noption to pass to kernel code so it can know when to retry)\n\n\nModified:\n   branches/SAMBA_3_0/source/client/mount.cifs.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/client/mount.cifs.c\n===================================================================\n--- branches/SAMBA_3_0/source/client/mount.cifs.c\t2007-05-17 22:36:08 UTC (rev 22981)\n+++ branches/SAMBA_3_0/source/client/mount.cifs.c\t2007-05-17 22:40:48 UTC (rev 22982)\n@@ -419,6 +419,11 @@\n \t\t\t\tprintf(\"password too long\\n\");\n \t\t\t\treturn 1;\n \t\t\t}\n+\t\t} else if (strncmp(data, \"sec\", 3) == 0) {\n+\t\t\tif (value) {\n+\t\t\t\tif (!strcmp(value, \"none\"))\n+\t\t\t\t\tgot_password = 1;\n+\t\t\t}\n \t\t} else if (strncmp(data, \"ip\", 2) == 0) {\n \t\t\tif (!value || !*value) {\n \t\t\t\tprintf(\"target ip address argument missing\");\n@@ -567,8 +572,6 @@\n \t\t\t*filesys_flags &= ~MS_NOEXEC;\n \t\t} else if (strncmp(data, \"guest\", 5) == 0) {\n \t\t\tgot_password=1;\n-                        /* remove the parm since it would otherwise be logged by kern */\n-\t\t\tgoto nocopy;\n \t\t} else if (strncmp(data, \"ro\", 2) == 0) {\n \t\t\t*filesys_flags |= MS_RDONLY;\n \t\t} else if (strncmp(data, \"rw\", 2) == 0) {\n\n"}