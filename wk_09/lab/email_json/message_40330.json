{"category": "ham", "to_address": "\"Alfonso Sammassimo\" <cincinattikid@bigpond.com>", "from_address": "\"Gabor Grothendieck\" <ggrothendieck@gmail.com>", "subject": "Re: [R] aggregate in zoo", "body": "On 6/1/07, Alfonso Sammassimo  wrote:\n> Hi R-experts,\n>\n> Thanks very much to Jim Holtman and Gabor on my previous question.\n>\n> I am having another problem with data manipulation in zoo. The following is\n> data (Z) for first business day of every month in zoo format. I am trying to\n> get mean of \"open\" for each year. I subset Z <- Z[,2] then\n>\n> > sapply(split(Z, format(index(Z), \"%Y\")),mean)\n>\n> I get error message:\n>\n> >2000 2001 2002 2003 2004 2005 2006 2007\n>  NA   NA   NA   NA   NA   NA   NA   NA\n> Warning messages:\n> 1: argument is not numeric or logical: returning NA in: mean.default(X[[1]],\n> ...)\n> 2: argument is not numeric or logical: returning NA in: mean.default(X[[2]],\n> ...)\n> etc...................\n>\n> Any help on what I'm missing would be appreciated. I am particularly\n> confused by the fact that the command used works fine on the original data\n> file (i.e. before subsetting by first day of month). Sorry if I have\n> overlooked something very simple.\n>\n>                  dayofmonth    open\n> 2000-02-01 01        1636.10\n> 2000-03-01 01        1596.75\n> 2000-04-03 03        1737.70\n> 2000-05-01 01        1695.65\n> 2000-06-01 01        1651.90\n> 2000-07-03 03        1669.20\n> 2000-08-01 01        1628.35\n> 2000-09-01 01        1717.35\n> 2000-10-02 02        1614.55\n> 2000-11-01 01        1587.10\n> 2000-12-01 01        1475.60\n> 2001-01-02 02        1450.65\n> 2001-02-01 01        1503.60\n> 2001-03-01 01        1351.95\n> 2001-04-02 02        1268.10\n> 2001-05-01 01        1369.20\n> 2001-06-01 01        1362.75\n> 2001-07-02 02        1331.55\n> 2001-08-01 01        1309.70\n> 2001-09-04 04        1235.55\n> 2001-10-01 01        1109.20\n> 2001-11-01 01        1155.55\n> 2001-12-03 03        1207.30\n\n\n\nCan't tell what your Z really looks like,\ntry posting dput(Z) or explain how to create\nZ from scratch, but at any rate your code has two\nproblems:\n\n1. the result is not a zoo object (that may or may not be a problem)\n2. your are combining the two columns altogether\nand then taking the mean of that\n\nTry copying and pasting this into your\nsession:\n\nLines <- \"date dayofmonth    open\n2000-02-01 01        1636.10\n2000-03-01 01        1596.75\n2000-04-03 03        1737.70\n2000-05-01 01        1695.65\n2000-06-01 01        1651.90\n2000-07-03 03        1669.20\n2000-08-01 01        1628.35\n2000-09-01 01        1717.35\n2000-10-02 02        1614.55\n2000-11-01 01        1587.10\n2000-12-01 01        1475.60\n2001-01-02 02        1450.65\n2001-02-01 01        1503.60\n2001-03-01 01        1351.95\n2001-04-02 02        1268.10\n2001-05-01 01        1369.20\n2001-06-01 01        1362.75\n2001-07-02 02        1331.55\n2001-08-01 01        1309.70\n2001-09-04 04        1235.55\n2001-10-01 01        1109.20\n2001-11-01 01        1155.55\n2001-12-03 03        1207.30\n\"\nlibrary(zoo)\nz <- read.zoo(textConnection(Lines), header = TRUE)\nyear <- function(x) as.numeric(format(x, \"%Y\"))\n\nsapply(split(z[,2], year(index(z))), mean)\n\n# last line could be replaced with just this\naggregate(z[,2], year, mean)\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}