{"category": "ham", "to_address": "\"R R-help\" <r-help@stat.math.ethz.ch>", "from_address": "\"Nordlund, Dan (DSHS/RDA)\" <NordlDJ@dshs.wa.gov>", "subject": "Re: [R] Function call within a function.", "body": "> -----Original Message-----\n> From: r-help-bounces@stat.math.ethz.ch \n> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of John Kane\n> Sent: Thursday, June 28, 2007 12:04 PM\n> To: R R-help\n> Subject: [R] Function call within a function.\n> \n> I am trying to call a funtion within another function\n> and I clearly am misunderstanding what I should do. \n> Below is a simple example.\n> I know lstfun works on its own but I cannot seem to\n> figure out how to get it to work within ukn. Basically\n> I need to create the variable \"nts\". I have probably\n> missed something simple in the Intro or FAQ.\n> \n> Any help would be much appreciated.\n> \n> EXAMPLE\n> --------------------------------------------------------------\n> -----------------\n> # create data.frame\n> cata <- c( 1,1,6,1,1,4)\n> catb <- c( 1,2,3,4,5,6)\n> id <- c('a', 'b', 'b', 'a', 'a', 'b')\n> dd1  <-  data.frame(id, cata,catb)\n> \n> # function to create list from data.frame\n> lstfun  <- function(file, alpha , beta ) {\n> cda  <-  subset(file, file[,1] == alpha)\n> cdb  <-  subset (file, file[,1]== beta)\n> list1 <- list(cda,cdb)\n> }\n> \n> # funtion to operate on list\n> ukn  <-  function(file, alpha, beta, nam1){\n> aa  <- alpha\n> bb  <- beta\n> myfile  <- file\n> nts <- lstfun(myfile, aa, bb)\n> mysum <- nam1[,3]*5\n> return(mysum)\n> }\n> \n> results <- ukn(dd1, \"a\", \"b\", nts$cda)\n\nJohn,\n\nThe first problem I see is one of scope.  nts$cda refers to an object called nts which does not exist in the calling environment (it is local to the function ukn).  So trying to call ukn() with nts results in an error.  Second, even if you pass the name of the object, you will not be able to use it in ukn() in the manner that you are trying.  Your ukn() function definition also requires that it know the inner workings of function lstfun().  Functions generally shouldn't require knowing how other functions work, they should only rely on what value is returned.\n\nYou can get what you want by redefining ukn in the following way\n\n# funtion to operate on list\nukn  <-  function(file, alpha, beta, nam1){\naa  <- alpha\nbb  <- beta\nmyfile  <- file\nnts <- lstfun(myfile, aa, bb)\nmysum <- nts[[nam1]][,3]*5\nreturn(mysum)\n}\n\nAnd change the function call to\n\nresults <- ukn(dd1, \"a\", \"b\", 1) \n\nThis still leaves the functions coupled in a way that I don't like, but I'm not a good enough R programmer to solve that problem at the moment.  Maybe someone else will come along with a better solution.\n\nHope this is helpful,\n\nDan\n\nDaniel J. Nordlund\nResearch and Data Analysis\nWashington State Department of Social and Health Services\nOlympia, WA  98504-5204\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}