{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "\"Chris Myers\" <chris.myers.314159@gmail.com>", "subject": "[R] nlme trouble", "body": "I am not certain how nlme works so I followed an example from the web (\nhttp://www.menne-biomed.de/gastempt/gastempt1.html). I was able to\nsuccessfully reproduce the example. However, when I modified my the example\nto use my data and with my formula, I get a set of errors having to do with\nthe log() function. I get 10 of them (all exactly the same) and there are 10\nlevels in my factor variable. This seems significant to me.\n\nBelow is a list of the code I modified with comments that should help\nunderstand what I am trying to do. If you enter the code in order from top\nto bottom you will recreate what I did. If you think that the data is at\nfault and want to see it, I can provide it. Also, under the code is the\nerrors that I get when I run the nlsList function.\n\nAlso, can nlme handle more than one independent at a time?\nAnd I was wondering what the \"model=as.character(mCall[[1]])\" line in the\ncode did. Removing it does not seem to change the error that I receive.\n\nMy OS is WinXP.\n\nThank You in advance,\nChris\n\n\n\n###########List of the code that I modified with comments##########\n\nlibrary(nlme)\n\nBiLinInit0= function(mCall,LHS,data)\n{\n  model=as.character(mCall[[1]])        #I don't know what this does\n\n  a <- tan(pi/4)                # 45 degree angle (rising slope)\n  b <- -tan(pi/4)                # 45 degree angle (desending slope)\n  c <- 0                    # intercept\n  nu <- 0.434\n  xy <- sortedXyData(mCall[[\"x\"]], LHS, data)\n  x <- xy[[\"x\"]]\n  x0 <- (min(x)+max(x))/2 + nu*((log(a, exp(1)) - log(b, exp(1))))/(a+b)\n #log defaults to base e\n\n  value = c(nu,a,b,c,x0)\n  names(value)=mCall[c(\"nu\",\"a\",\"b\",\"c\",\"x0\")]\n  value\n}\n\nSSBiLin=selfStart(~-nu*log(exp(-a*(x-x0)/nu)+exp(b*(x-x0))/nu, exp(1))+c,\n  initial=BiLinInit0, parameters= c(\"nu\",\"a\",\"b\",\"c\",\"x0\"))            #log\ndefaults to base e, but I used exp(1) just to be sure (tried with just\nlog(x) as well)\n\nge = read.table(\"G:\\\\SSNon-Linear\\\\BINDING DATA fixed DESCRIPTORS\nONLY.csv\",sep=\",\",header=TRUE)\n #Load in my data set\n\nge$study = as.factor(ge$study)                            #Force study to be\na factor variable\n\ngelist = nlsList(RBA~SSBiLin(Molecular.Volume,nu,a,b,c,x0)|study,data=ge)\n #This is where I get the error\n\ncontr = nlmeControl(pnlsTol=0.3)\nge0.nlme=nlme(gelist,control=contr,verbose=F)\n\n\n##########Errors#######################\n\n> gelist = nlsList(RBA~SSBiLin(Molecular.Volume,nu,a,b,c,x0)|study,data=ge)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\nError in qr(attr(rhs, \"gradient\")) : NA/NaN/Inf in foreign function call\n(arg 1)\nIn addition: Warning message:\nNaNs produced in: log(x, base)\n>\n\n\t[[alternative HTML version deleted]]\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}