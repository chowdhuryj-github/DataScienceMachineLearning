{"category": "ham", "to_address": "R Help <R-help@stat.math.ethz.ch>", "from_address": "(Ted Harding) <ted.harding@nessie.mcc.ac.uk>", "subject": "Re: [R] source a specific function", "body": "On 18-Jun-07 18:53:50, Duncan Murdoch wrote:\n> \n> The exact syntax you list there won't work, but in any case, changing \n> the environment of a function in a package is a bad idea -- it may need\n> to reference things from the namespace of the package.\n\nWell, as I said before, \"(assuming that you know about\ninterdependencies)\"!\n\nI tried Gabor's suggested syntax as follows, bearing in mind that\nmvrnorm in MASS is pure R code calling only \"base\" functions:\n\nlibrary(MASS)\nenvironment(mvrnorm) <- .GlobalEnv\nmu=c(0,0)\nV<-matrix(c(1.0,0.5,0.5,1.0),ncol=2)\ndetach()\nls()\n[1] \"%.+%\"    \"%+.%\"    \"mu\"      \"mvrnorm\" \"V\"      \n\nmvrnorm(10,mu,V)\n             [,1]       [,2]\n [1,] -1.80466069 -1.8229928\n [2,]  0.05565147 -1.6279434\n [3,] -0.28505572 -0.8927696\n [4,] -0.48919795  0.0750501\n [5,] -0.08437832  0.1349296\n [6,]  2.17399713  1.2881640\n [7,]  1.59934824  1.3784665\n [8,]  0.30555420  0.3835743\n [9,]  0.11120527 -0.7287910\n[10,] -0.77281783 -1.2265502\n\nso that one seems to have worked.\n\nHowever, I'm not sure about the space used by MASS \"going away\"\nafter detach():\n\nStarting R from scratch:\n\nType 'q()' to quit R.\n\n> gc()\n         used (Mb) gc trigger (Mb)\nNcells 412589 11.1     597831   16\nVcells 102417  0.8     786432    6\n\n> library(MASS)\n> gc()\n         used (Mb) gc trigger (Mb)\nNcells 459471 12.3     667722 17.9\nVcells 111187  0.9     786432  6.0\n\n> environment(mvrnorm) <- .GlobalEnv\n> detach()\n> gc()\n         used (Mb) gc trigger (Mb)\nNcells 459297 12.3     741108 19.8\nVcells 111105  0.9     786432  6.0\n> gc()\n         used (Mb) gc trigger (Mb)\nNcells 459304 12.3     818163 21.9\nVcells 111118  0.9     786432  6.0\n\nso only about 170KB of the 2.2MB used by MASS has been recovered\nafter detach(). Or am I looking at the wrong indicator of space used?\n\nOn the other hand, if I first extract the code 9f mvrnorm()\nwhich is a few lines of pure R, I get:\n\n1. Start R from scratch:\ngc()\n         used (Mb) gc trigger (Mb)\nNcells 412589 11.1     597831   16\nVcells 102417  0.8     786432    6\n\n2. Paste in the code for mvrnorm, and then:\ngc()\n         used (Mb) gc trigger (Mb)\nNcells 412844 11.1     667722 17.9\nVcells 102591  0.8     786432  6.0\n\nso mrvnorm on its own is only taking up about\n\n (412844-412589) + (102591-102417) = 429KB\n\nHence I wonder whether the space first occupied by MASS (2.2MB)\napart from mvrnorm gets freed up at all?\n\nThanks for the comments.\nTed.\n\n--------------------------------------------------------------------\nE-Mail: (Ted Harding) \nFax-to-email: +44 (0)870 094 0861\nDate: 18-Jun-07                                       Time: 22:00:33\n------------------------------ XFMail ------------------------------\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}