{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 235: enabled built in popt if system doesn't have it in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 235\nrevision-id: tridge@samba.org-20070502192114-f33n5eur6vzyi8xt\nparent: tridge@samba.org-20070502051111-kol2q81ec0oz8o1k\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Thu 2007-05-03 05:21:14 +1000\nmessage:\n  enabled built in popt if system doesn't have it\nmodified:\n  Makefile.in                    makefile.in-20061117234101-o3qt14umlg9en8z0-1\n  configure.ac                   configure.ac-20061117234101-o3qt14umlg9en8z0-10\n  lib/popt/libpopt.m4            libpopt.m4-20070125040942-nz1rv4zkr26q77uw-7\n  lib/popt/samba.m4              samba.m4-20070125040942-nz1rv4zkr26q77uw-14\n=== modified file 'Makefile.in'\n--- a/Makefile.in\t2007-05-02 03:25:45 +0000\n+++ b/Makefile.in\t2007-05-02 19:21:14 +0000\n@@ -8,16 +8,20 @@\n libdir = @libdir@\n bindir = @bindir@\n localstatedir = @localstatedir@\n-VPATH = @srcdir@:@tdbdir@:@tallocdir@:@libreplacedir@\n+VPATH = @srcdir@:@tdbdir@:@tallocdir@:@libreplacedir@:@poptdir@\n srcdir = @srcdir@\n builddir = @builddir@\n EXTRA_OBJ=@EXTRA_OBJ@\n \n+POPT_LIBS = @POPT_LIBS@\n+POPT_CFLAGS = @POPT_CFLAGS@\n+POPT_OBJ = @POPT_OBJ@\n+\n CFLAGS=-g -I$(srcdir)/include -Iinclude -Ilib -Ilib/util -I$(srcdir) \\\n        -I@tallocdir@ -I@tdbdir@/include -I@libreplacedir@ \\\n-\t-DVARDIR=\\\"$(localstatedir)\\\" -DUSE_MMAP=1 @CFLAGS@\n+\t-DVARDIR=\\\"$(localstatedir)\\\" -DUSE_MMAP=1 @CFLAGS@ $(POPT_CFLAGS)\n \n-LIB_FLAGS=@LDFLAGS@ -Llib @LIBS@ -lpopt @INFINIBAND_LIBS@\n+LIB_FLAGS=@LDFLAGS@ -Llib @LIBS@ $(POPT_LIBS) @INFINIBAND_LIBS@\n \n EVENTS_OBJ = lib/events/events.o lib/events/events_standard.o \\\n \tlib/events/events_signal.o lib/events/events_timed.o\n@@ -32,7 +36,7 @@\n \n CTDB_TCP_OBJ = tcp/tcp_connect.o tcp/tcp_io.o tcp/tcp_init.o\n \n-CTDB_OBJ = $(CTDB_COMMON_OBJ) $(CTDB_TCP_OBJ)\n+CTDB_OBJ = $(CTDB_COMMON_OBJ) $(CTDB_TCP_OBJ) $(POPT_OBJ)\n \n OBJS = @TDB_OBJ@ @TALLOC_OBJ@ @LIBREPLACEOBJ@ @INFINIBAND_WRAPPER_OBJ@ $(EXTRA_OBJ) $(EVENTS_OBJ) $(CTDB_OBJ) $(UTIL_OBJ)\n \n\n=== modified file 'configure.ac'\n--- a/configure.ac\t2007-04-10 02:51:54 +0000\n+++ b/configure.ac\t2007-05-02 19:21:14 +0000\n@@ -24,6 +24,7 @@\n \n EXTRA_OBJ=\"\"\n \n+m4_include(libpopt.m4)\n m4_include(libtalloc.m4)\n m4_include(libtdb.m4)\n m4_include(ib/config.m4)\n\n=== modified file 'lib/popt/libpopt.m4'\n--- a/lib/popt/libpopt.m4\t2007-01-25 04:10:40 +0000\n+++ b/lib/popt/libpopt.m4\t2007-05-02 19:21:14 +0000\n@@ -37,7 +37,7 @@\n         if test x\"$poptdir\" = \"x\"; then\n \t\tAC_MSG_ERROR([cannot find popt source in $poptpaths])\n \tfi\n-\tPOPTOBJ=\"popt.o findme.o poptconfig.o popthelp.o poptparse.o\"\n-\tAC_SUBST(POPTOBJ)\n+\tPOPT_OBJ=\"popt.o findme.o poptconfig.o popthelp.o poptparse.o\"\n+\tAC_SUBST(POPT_OBJ)\n \tAC_CHECK_HEADERS([float.h alloca.h])\n fi\n\n=== modified file 'lib/popt/samba.m4'\n--- a/lib/popt/samba.m4\t2007-01-25 04:10:40 +0000\n+++ b/lib/popt/samba.m4\t2007-05-02 19:21:14 +0000\n@@ -1,6 +1,6 @@\n m4_include(lib/popt/libpopt.m4)\n \n-if test x\"$POPTOBJ\" = \"x\"; then\n+if test x\"$POPT_OBJ\" = \"x\"; then\n \tSMB_EXT_LIB(LIBPOPT, [${POPT_LIBS}])\n \tSMB_ENABLE(LIBPOPT,YES)\n else\n\n"}