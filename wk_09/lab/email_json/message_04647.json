{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Michael Stevens <mstevens1107@yahoo.com>", "subject": "[R] replicates in repeated ANOVA", "body": "Hi, \nI have sort of a newbie question. I've seriously put a lot of effort into how to handle simple replicates in a repeated ANOVA design, but haven't had much luck. \nI really liked reading \"Notes on the use of R for psychology experiments and questionnaires\", by Jonathan Baron and Yuelin Li ( http://www.psych.upenn.edu/~baron/rpsych/rpsych.html ) but still didn't run across an example using simple replicates.\nSo, I made up the data below semi-borrowing the idea of a reaction time experiment involving noise from Maxwell, S. E. & Delaney, H. D. (1990) Designing Experiments and Analyzing Data: A model comparison perspective. Pacific Grove, CA: Brooks/Cole., which was referenced in the Baron and Li link above.\n\nThe experimental concept I'm trying to envision is 2 groups of subjects (Treat and Control), 3 subjects in each.  In one session, all 6 patients from both groups are tested for reaction time by making 3 replicate tests on some hypothetical RT test (I call this the \"pre\" testing phase below or one could call this baseline ).  In a second session (the \"post\" phase), the subjects in the \"Treat\" Group are subjected to noise (or any treatment), while the other 3 \"Control\" subjects are not, (i.e. the Control subjects are basically tested exactly like they were in the \"pre\" testing session).\n\nI'm trying to set up the correct model for this experimental design to simply understand whether \"noise\" (or treatment) has an effect on reaction time.  Can someone tell this newbie the proper name of this experimental design?\n\nBy setting up the design this way, I'm hoping one could see if there was a \"pre\" session to \"post\" session effect (using the Control group) and then take into account any possible pre->post effect when deciding whether there was a Treatment (noise) effect.  \n\nUnfortunately, whenever, I put the Group factor in the Error term (to take into account subj:Group as a random effect), I get a singular result: (see the data entry section below)\n\n        > rt.aov <- aov(rt ~ Group*prepost + Error(subj/(prepost*Group)), data=rt.df)\n        Warning message:\n        Error() model is singular in: aov(rt ~ Group * prepost + Error(subj/(prepost * Group)), data = rt.df) \n\nplus, I'm not sure how to include the replicate factor (\"rep\") in my Error() term -- should it be something like \n...+Error(subj*rep/(Group*prepost))?            \n(this still gives the above error if Group is in the error term, but I'm pretty sure it should be there since all interactions given the individual subject are random effects, aren't they?)\nIn my hypothetical experiment, I'm assuming the replicates are independent samples of reaction time -- although, admittedly, there could be a trend that should be looked for if one assumes that the subject \"gets better\" with each replicate.\n\nSuggestions on aov() model welcome!\nThanks,\nMichael\n\n-----------------------------------------------------------------\nCreating the hypothetical dataset...\n\n> data <- c( \n+ 287,283,261,298,302,280, \n+ 211,272,222,285,253,252, \n+ 266,252,287,266,255,269, \n+ 299,310,285,296,310,301, \n+ 288,265,273,285,252,259, \n+ 295,299,285,288,281,303) \n\n> rt.df <- data.frame(rt=data, \n+ rep = factor(rep(paste(\"rep\",1:3, sep=\"\"),12)), \n+ prepost = factor(rep(c(rep(\"pre\",3),rep(\"post\",3)),6)), \n+ subj = factor(rep(paste(\"subj\",1:6,sep=\"\"),c(6,6,6,6,6,6))), \n+ Group = factor(c(rep(\"Treat\",18),rep(\"Control\",18)))) \n> rt.df \nrt rep prepost subj Group \n1 287 rep1 pre subj1 Treat \n2 283 rep2 pre subj1 Treat \n3 261 rep3 pre subj1 Treat \n4 298 rep1 post subj1 Treat \n5 302 rep2 post subj1 Treat \n6 280 rep3 post subj1 Treat \n7 211 rep1 pre subj2 Treat \n8 272 rep2 pre subj2 Treat \n9 222 rep3 pre subj2 Treat \n10 285 rep1 post subj2 Treat \n11 253 rep2 post subj2 Treat \n12 252 rep3 post subj2 Treat \n13 266 rep1 pre subj3 Treat \n14 252 rep2 pre subj3 Treat \n15 287 rep3 pre subj3 Treat \n16 266 rep1 post subj3 Treat \n17 255 rep2 post subj3 Treat \n18 269 rep3 post subj3 Treat \n19 299 rep1 pre subj4 Control \n20 310 rep2 pre subj4 Control \n21 285 rep3 pre subj4 Control \n22 296 rep1 post subj4 Control \n23 310 rep2 post subj4 Control \n24 301 rep3 post subj4 Control \n25 288 rep1 pre subj5 Control \n26 265 rep2 pre subj5 Control \n27 273 rep3 pre subj5 Control \n28 285 rep1 post subj5 Control \n29 252 rep2 post subj5 Control \n30 259 rep3 post subj5 Control \n31 295 rep1 pre subj6 Control \n32 299 rep2 pre subj6 Control \n33 285 rep3 pre subj6 Control \n34 288 rep1 post subj6 Control \n35 281 rep2 post subj6 Control \n36 303 rep3 post subj6 Control\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}