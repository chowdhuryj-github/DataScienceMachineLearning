{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "vlendec@samba.org", "subject": "svn commit: samba r22533 - in branches/SAMBA_3_0/source/smbd: .", "body": "Author: vlendec\nDate: 2007-04-27 14:00:27 +0000 (Fri, 27 Apr 2007)\nNew Revision: 22533\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22533\n\nLog:\nUse lib functions where we have them\n\nModified:\n   branches/SAMBA_3_0/source/smbd/server.c\n\n\nChangeset:\nModified: branches/SAMBA_3_0/source/smbd/server.c\n===================================================================\n--- branches/SAMBA_3_0/source/smbd/server.c\t2007-04-27 13:12:44 UTC (rev 22532)\n+++ branches/SAMBA_3_0/source/smbd/server.c\t2007-04-27 14:00:27 UTC (rev 22533)\n@@ -309,7 +309,7 @@\n \tint s;\n \tint maxfd = 0;\n \tint i;\n-\tstruct timeval idle_timeout = {0, 0};\n+\tstruct timeval idle_timeout = timeval_zero();\n \n \tif (server_mode == SERVER_MODE_INETD) {\n \t\treturn open_sockets_inetd();\n@@ -383,7 +383,8 @@\n \t\t       sizeof(listen_set));\n \n \t\tnum = sys_select(maxfd+1,&lfds,NULL,NULL,\n-\t\t\tidle_timeout.tv_sec ? &idle_timeout : NULL);\n+\t\t\t\t timeval_is_zero(&idle_timeout) ?\n+\t\t\t\t NULL : &idle_timeout);\n \t\t\n \t\tif (num == -1 && errno == EINTR) {\n \t\t\tif (got_sig_term) {\n\n"}