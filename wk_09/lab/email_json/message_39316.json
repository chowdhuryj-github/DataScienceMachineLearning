{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 408: if there is no node available to take an IP,\n\tdon't consider that an error in http://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 408\nrevision-id: tridge@samba.org-20070531012243-kwca52t2ep7tkln8\nparent: tridge@samba.org-20070531011407-fpaex23wc8bfm773\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Thu 2007-05-31 11:22:43 +1000\nmessage:\n  if there is no node available to take an IP, don't consider that an error\nmodified:\n  takeover/ctdb_takeover.c       ctdb_takeover.c-20070525071636-a5n1ihghjtppy08r-2\n=== modified file 'takeover/ctdb_takeover.c'\n--- a/takeover/ctdb_takeover.c\t2007-05-30 06:37:39 +0000\n+++ b/takeover/ctdb_takeover.c\t2007-05-31 01:22:43 +0000\n@@ -361,6 +361,10 @@\n \n \t/* tell all nodes to get their own IPs */\n \tfor (i=0;inum;i++) {\n+\t\tif (ctdb->nodes[i]->takeover_vnn == -1) {\n+\t\t\t/* this IP won't be taken over */\n+\t\t\tcontinue;\n+\t\t}\n \t\tret = ctdb_ctrl_takeover_ip(ctdb, TAKEOVER_TIMEOUT(), \n \t\t\t\t\t    ctdb->nodes[i]->takeover_vnn, \n \t\t\t\t\t    ctdb->nodes[i]->public_address);\n\n"}