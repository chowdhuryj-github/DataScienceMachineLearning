{"category": "ham", "to_address": "Felix Wave <felix-wave@vr-web.de>, r-help@stat.math.ethz.ch", "from_address": "Stephen Tucker <brown_emu@yahoo.com>", "subject": "Re: [R] Using \"mean\"  if two values are identical", "body": "## making data up\n# make matrix with some equal values\n> mat <- cbind(x=rnorm(10),y=rnorm(10),z=rnorm(10))\n> mat[c(8,9),\"y\"] <- mat[c(1,7),\"x\"]\n> mat\n                x          y           z\n [1,]  0.26116849  0.5823529 -0.96924020\n [2,] -0.21415406  0.1085396  2.00542549\n [3,]  0.56890081 -1.2526322  0.08539552\n [4,] -1.09096693 -1.9369088  0.03079587\n [5,] -1.31749886 -1.1437411 -0.29125624\n [6,] -0.45941172  0.2997472  0.10329381\n [7,]  0.39586456 -0.2587432 -1.29788184\n [8,] -0.05066363  0.2611685 -0.47942195\n [9,] -0.87602919  0.3958646 -0.53205231\n[10,]  0.30059621 -1.9531231  0.22398194\n> \n\n## find the index of y which corresponds to equivalent value of\n## x and find mean. the following function will give search\n## through for each x the matching values of y and return\n## the value of x, the index of y, and the mean value\n> t(apply(mat[,c(\"x\",\"z\")], MARGIN=1, FUN=function(v,w) {\n+   yindex <- which(abs(v[\"x\"]-w[,\"y\"]) < .Machine$double.eps^0.5)\n+   if(length(yindex) > 0) {\n+     c(xVal=v[\"x\"],indexOfy=yindex,meanVal=mean(c(v[\"z\"],w[yindex,\"z\"])))\n+   } else {\n+     c(xVal=v[\"x\"],indexOfy=NA,meanVal=NA)\n+   }\n+ },w=mat[,c(\"y\",\"z\")]))\n                x indexOfy   meanVal\n [1,]  0.26116849        8 -0.724331\n [2,] -0.21415406       NA        NA\n [3,]  0.56890081       NA        NA\n [4,] -1.09096693       NA        NA\n [5,] -1.31749886       NA        NA\n [6,] -0.45941172       NA        NA\n [7,]  0.39586456        9 -0.914967\n [8,] -0.05066363       NA        NA\n [9,] -0.87602919       NA        NA\n[10,]  0.30059621       NA        NA\n\nHope this helps.\n\n--- Felix Wave  wrote:\n\n> Hello,\n> I have got a question. \n> I've got a matrix (mail end) with the colnames x, y, z. In this matrix\n> are different measurements. x and y are risign coordinates.\n> \n> My question. Always, if the \"x\" AND \"y\" coordinates are the same, I want to\n> \n> get the mean of their z values.\n> \n> \n> e.q. \"\n> x\" AND \"y\" in line1 and line8 are identical: \n> 29 4.5 --> mean of 1.505713 and 1.495148\n> \n> \n> Thank's a lot.\n> Felix\n> \n> \n> \n> \n> ###############\n> ## My R Code ##\n> ###############\n> INPUT           <- readLines(dat.dat)\n> INPUT           <- gsub(\"^ \", \"\", INPUT)\n> INPUT           <- t( sapply( strsplit(INPUT, split=\" \"), as.numeric ) )\n> colnames(INPUT) <- c(\"x\", \"y\", \"z\" )\n> \n> \n> # HERE START's my PROBLEM #\n> if (duplicated(INPUT[,1] & INPUT[,2] ))\n>   zMEAN   <- mean(INPUT[,3] )\n> \n> # MATRIX with the mean-z values #\n> zMATRIX <- matrix(c(INPUT[,1], INPUT[,2], INPUT[,3] ), ncol=3, byrow=FALSE)\n> \n> \n> \n> \n> #############\n> ## dat.dat ##\n> #############\n> 29 4.5 1.505713\n> 29 4.6 1.580402\n> 29 4.7 1.656875\n> 29 4.8 1.735054\n> 30 0 0\n> 30 0.1 0.00096108\n> 30 0.2 0.00323831\n> 29 4.5 1.495148\n> 29 4.6 1.568961\n> 29 4.7 1.644467\n> 30 0 0\n> 30 0.1 0.00093699\n> 30 0.2 0.00319411\n> 30 0.3 0.00676619\"\n> \n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide\n> http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}