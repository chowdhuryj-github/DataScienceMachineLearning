{"category": "ham", "to_address": "Volker.Lendecke@SerNet.DE", "from_address": "simo <idra@samba.org>", "subject": "Re: Code duplication is bad :/", "body": "On Tue, 2007-05-29 at 07:44 +0200, Volker Lendecke wrote:\n> On Mon, May 28, 2007 at 08:35:38PM -0400, simo wrote:\n> > I just found that we open winbindd_idmap.tdb independently in\n> > tdbsam_new_rid() in pdb_tdb.c\n> > With the new idmap code which can have different providers for the\n> > allocation backend this is probably wrong.\n> > \n> > I would like to change it to ask winbindd for a RID.\n> > Is there a reason why this was not done before and instead we were\n> > opening the file directly and fiddling with another subsystem data?\n> \n> Why would winbind have to allocate a RID? This is a generic\n> task of the SAM, and if I'm right the SAM is inside smbd.\n> winbind is there to allocate UID/GIDs. I had gone through\n> some pain in the past to separate this cleanly.\n\nThe problem is the use of winbindd_idmap.tdb from smbd.\nIf we change something in the future we may forget again there is\npdb_tdb.c that expects something there.You should have used passdb.tdb\nIMO.\nBy moving everything to a common function at least we keep all access to\nthe same tdb in one place so future changes will less likely break\nsomething.\n\nSimo.\n\n-- \nSimo Sorce\nSamba Team GPL Compliance Officer\nemail: idra@samba.org\nhttp://samba.org\n\n"}