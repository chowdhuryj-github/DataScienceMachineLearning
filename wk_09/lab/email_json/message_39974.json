{"category": "ham", "to_address": "beginners@perl.org, perl-beginners@moderators.isc.org", "from_address": "kenTk <ken@shail.co.uk>", "subject": "Re: IO::Socket::INET client hangs on no server on windoze", "body": "On May 29, 7:55 pm, k...@shail.co.uk (kenTk) wrote:\n> On May 29, 2:40 pm, zent...@highstream.net (Zentara) wrote:\n>\n> > On 28 May 2007 08:28:35 -0700, k...@shail.co.uk (kenTk) wrote:\n>\n> > >If there is no server or no connection this hangs for about 20 seconds\n> > >and then crashes with the following error message.\n> > >The Timeout seems to make no difference and the 'warn' does not occur.\n> > >If works file with a good connection to a server.\n> > >Using 5.8.8 active perl.\n> > >Anyone got any suggestions for making it return undef in an orderly\n> > >fashion?\n> > >(I have tested it on Linux and it seems to work fine both ways)\n>\n> > >use strict;\n> > >use warnings;\n> > >use IO::Socket::INET;\n>\n> > >sub testSocket\n> > >{\n> > >  my $sock;\n> > >  my $ok=0;\n> > >  unless( $sock=IO::Socket::INET->new(192.168.5.41,\n> > >                                 PeerPort => '21',\n> > >                                 Proto    => 'tcp',\n> > >                                 Timeout  =>'3'))\n>\n> > are you sure that '21' and  '3' should be quoted?\n> > Maybe Perl figures it's context and does the right thing on linux?\n>\n> > >  {  warn 'Cant connect'; }\n> > >  else\n> > >  { $sock->close;  $ok=1; }\n> > > return $ok;\n> > >}\n>\n> > I don't use win32, but have seen these somewhat related posts:http://perlmonks.org?node_id=567912\n>\n> >http://perlmonks.org?node_id=529812\n>\n> > zentara\n>\n> I tried removing the quotes around 21 and 3 but with no success.\n> I have already tried the ioctl fix for non-blocking on windoze but to\n> no avail. I believe that only applies to a new socket object after it\n> has been created. In this case that creation process fails with a\n> crash and doesnt return in an orderly fashion. I wish that I didn't\n> have to use windoze but ..............\n\nI have now found that this behaves correctly a couple of other windoze\nwin32 machines. There must be something bust deep down on this\nmachine. Strange because I have never seen it on any other application\non this machine.\n\n\n-- \nTo unsubscribe, e-mail: beginners-unsubscribe@perl.org\nFor additional commands, e-mail: beginners-help@perl.org\nhttp://learn.perl.org/\n\n\n"}