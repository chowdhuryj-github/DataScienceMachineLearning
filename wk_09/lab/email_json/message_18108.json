{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "(Ted Harding) <ted.harding@nessie.mcc.ac.uk>", "subject": "[R] Restructuring Hadley CET data", "body": "Hi Folks,\nI have a nasty data restructuring problem!\n\nI can think of one or two really clumsy ways of doing it\nwith 'for' loops and the like, but I can't think of a\n*neat* way of doing it in R.\n\nThe data are the Hadley Centre \"Central England Temperature\"\nseries, daily from 01/01/1772 to 31/03/2007, and can be\nviewed/downloaded at\n\n  http://hadobs.metoffice.com/hadcet/cetdl1772on.dat\n\nand the structure is as follows:\n\nYear DoM Jan  Feb Mar  Apr May  Jun Jul Aug  Sep Oct  Nov Dec\n-------------------------------------------------------------\n1772  1   32  -15  18   25  87  128 187 177  105 111   78 112\n1772  2   20    7  28   38  77  138 154 158  143 150   85  62\n1772  3   27   15  36   33  84  170 139 153  113 124   83  60\n1772  4   27  -25  61   58  96   90 151 160  173 114   60  47\n1772  5   15   -5  68   69 133  146 179 170  173 116   83  50\n1772  6   22  -45  51   77 113  105 175 198  160 134  134  42\n.................................\n.................................\n1772 27    0   46  66   74  77  198 156 144   76 104   45   5\n1772 28   15   77  86   64 116  167 151 155   66  84   60  10\n1772 29  -33   56  83   50 113  131 170 182  135 140   63  12\n1772 30  -10 -999  66   77 121  122 179 163  143 143   55  15\n1772 31   -8 -999  46 -999 108 -999 168 144 -999 145 -999  22\n1773  1   20    0  79   13  93  174 104 151  171 131   68  55\n1773  2   10   17  71   25  65  109 128 184  164  91   34  75\n1773  3    5  -28  94   70  41   79 135 192  149 101   78  85\n1773  4    5  -23  99  107  49  107 144 173  144  98   86  83\n1773  5  -28  -30  76   65  83  128 144 182  116  98   66  38\n.................................\n\n\"DoM\" is Day of Month, 1-31 for each month (\"short\" months\nget entries -999 on missing days).\n\nSo each year is a block of 31 lines and 14 columns, pf\nwhich the last 12 are Temperature (in 10ths of a degreeC),\neach column a month, running down each column for the\n31 days of the month in that year.\n\nWhat I want to do is convert this into a 4-column format:\n\n  Year, Month, DoM, Temp\n\nwith a separate row for each consecutive day from 01/01/1772\nto 31/02/2007, and omitting days which have a \"-999\" entry\n(OK I still have to check that \"-999\" is only used for DoMs\nwhich don't exist, and don't also indicate that a Temperature\nmay be missing for some other reason; but I believe the series\nto be complete).\n\nWhat it boils down to is stacking the 12 31-day Temperature\ncolumns on top of each other in each year, filling in the\nYear, Month, DoM, and stacking the results for consecutive\nyears on top of each other (after which one can strike out\nthe \"-999\"s). Hence, really clunky for-loops!\n\nAny really *neat* ideas for this?\n\nWith thanks,\nTed.\n\n--------------------------------------------------------------------\nE-Mail: (Ted Harding) \nFax-to-email: +44 (0)870 094 0861\nDate: 27-Apr-07                                       Time: 22:24:51\n------------------------------ XFMail ------------------------------\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}