{"category": "ham", "to_address": "R-help@stat.math.ethz.ch", "from_address": "(Ted Harding) <ted.harding@nessie.mcc.ac.uk>", "subject": "Re: [R] Help with pexp( )", "body": "On 11-Apr-07 15:59:09, Jeann S wrote:\n> Dear all,\n> \n> Sorry for bringing up an old issue:\n> \n>     >pexp(50, 0.5)\n>     [1] 1\n> \n> In some cases, pexp()  gives CDF=1. I read some discussion\n> in 2002 saying it has been patched. However it's not working\n> in \"R2.4.1Patched\". Could anyone help me out?\n> \n> Thanks a lot,\n> \n> Jeann\n\nSince pexp(x,a) = 1 - exp(-a*x), you can use this expression\ninstead of pexp(), or exp(-a*x) instead of 1 - pexp(a*x).\n\nComparison of the two forms (on an older version of R but\npresumably the results are the same as you are referring to):\n\nx <- 5*(1:12); y <- pexp(x,1); z <- 1 - exp(-1*x)\n\n-log(1-y)\n    [1]  5.00000 10.00000 15.00000 20.00000 25.00000 29.99983 34.94504   \n    [8]      Inf      Inf      Inf      Inf      Inf\n\n-log(1-z)\n    [1]  5.00000 10.00000 15.00000 20.00000 25.00000 29.99983 34.94504   \n    [8]      Inf      Inf      Inf      Inf      Inf\n\nso, looked at in this way, there is no difference.\n\nHowever:\n\nx <- 5*(1:12); y <- pexp(x,1,lower.tail=FALSE); z <- 1 - exp(-1*x)\n\n-log(y)\n    [1]  5 10 15 20 25 30 35 40 45 50 55 60\n\n-log(1-z)\n      [1]  5.00000 10.00000 15.00000 20.00000 25.00000 29.99983 34.94504 \n      [8]      Inf      Inf      Inf      Inf      Inf\n\nAnd:\n\nx <- 5*(1:12); y <- pexp(x,1,lower.tail=FALSE); z <- exp(-1*x)\n\n-log(y)\n   [1]  5 10 15 20 25 30 35 40 45 50 55 60\n\n-log(z)\n   [1]  5 10 15 20 25 30 35 40 45 50 55 60\n\n\nso clearly exactly the same problem arises with -log(1 - exp(-x))\nwhen x is large, as arises with pexp(x) when x is large, and I\nwould put it down to the fact that 1 - exp(-x) is not very precise\n(in \"significant figure\" terms).\n\nAnother way of looking at it:\n\npexp(x,lower.tail=FALSE)\n    [1] 6.737947e-03 4.539993e-05 3.059023e-07 2.061154e-09\n    [5] 1.388794e-11 9.357623e-14 6.305117e-16 4.248354e-18\n    [9] 2.862519e-20 1.928750e-22 1.299581e-24 8.756511e-27\n\n1-(1-pexp(x,lower.tail=FALSE))\n    [1] 6.737947e-03 4.539993e-05 3.059023e-07 2.061154e-09\n    [5] 1.388789e-11 9.359180e-14 6.661338e-16 0.000000e+00\n    [9] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00\n\nHowever, the quesiton arises: Why do you need the precision\n(about exp(-37) = 1e-16) in pexp(x) for large x? If you're\ninterested in the difference from 1, then use \"lower.tail=FALSE\"\nin the first place, I would have thought?\n\nBest wishes,\nTed.\n\n--------------------------------------------------------------------\nE-Mail: (Ted Harding) \nFax-to-email: +44 (0)870 094 0861\nDate: 11-Apr-07                                       Time: 20:36:45\n------------------------------ XFMail ------------------------------\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}