{"category": "ham", "to_address": "samba-technical@lists.samba.org", "from_address": "James Peach <jpeach@samba.org>", "subject": "Re: svn commit: samba r22318 - in branches: SAMBA_3_0/source/lib\n\tSAMBA_3_0_25/source/lib", "body": "On 17/04/2007, at 10:17 AM, lmuelle@samba.org wrote:\n\n> Author: lmuelle\n> Date: 2007-04-17 17:17:19 +0000 (Tue, 17 Apr 2007)\n> New Revision: 22318\n>\n> WebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22318\n>\n> Log:\n> If we're running as non root we might not be able to dump the core  \n> file\n> to the corepath.\n>\n> Even the chdir() will fail if the LOGFILEBASE path is set 0700.\n>\n> If the currrent user doesn't have the permission to create the core  \n> file\n> we end with:\n>   unable to change to \n>   refusing to dump core\n>\n> The alternative would be to change the permissions of the directory.\n> But taht would not ensure core dumps are working out of the box.\n>\n> Modified:\n>   branches/SAMBA_3_0/source/lib/fault.c\n>   branches/SAMBA_3_0_25/source/lib/fault.c\n>\n>\n> Changeset:\n> Modified: branches/SAMBA_3_0/source/lib/fault.c\n> ===================================================================\n> --- branches/SAMBA_3_0/source/lib/fault.c\t2007-04-17 17:07:14 UTC  \n> (rev 22317)\n> +++ branches/SAMBA_3_0/source/lib/fault.c\t2007-04-17 17:17:19 UTC  \n> (rev 22318)\n> @@ -161,6 +161,13 @@\n> \t}\n>\n> #if DUMP_CORE\n> +\t/* If we're running as non root we might not be able to dump the  \n> core\n> +\t * file to the corepath.  There must not be an unbecome_root()  \n> before\n> +\t * we call abort(). */\n> +\tif (getuid() != 0) {\n\nDo you need to check geteuid() here?\n\n--\nJames Peach | jpeach@samba.org\n\n"}