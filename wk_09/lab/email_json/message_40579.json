{"category": "ham", "to_address": "\"Strickland, Matthew (CDC/CCHP/NCBDDD) (CTR)\" <cro6@CDC.GOV>", "from_address": "\"Charles C. Berry\" <cberry@tajo.ucsd.edu>", "subject": "Re: [R] Conditional logistic regression for \"events/trials\" format", "body": "On Thu, 31 May 2007, Strickland, Matthew (CDC/CCHP/NCBDDD) (CTR) wrote:\n\n> Thanks for your reply Charles. I do indeed have other variables. I\n> apologize for being vague, here is my study in more detail:\n>\n> I have a cohort of births. My outcome is a dichotomous variable for\n> presence/absence of a birth defect. For each cohort member I estimate\n> the date of conception, and assign a pollution level during the relevant\n> period of gestation. All cohort members conceived on the same day are\n> assigned the same pollution level. These cohort members also have a\n> covariate, t, which indicates the day of follow-up. For example, if the\n> first day of my study is Jan 1, 1987, the data would look like:\n>\n> Date\t\t\tt\tConceptions\t\tCases\n> Pollution\tStratum\n> Jan 1, 1987\t\t1\t100\t\t\t1\n> 10\t\t1\n> Jan 2, 1987\t\t2\t105\t\t\t0\n> 8\t\t2\n> Jan 3, 1987\t\t3\t101\t\t\t1\n> 11\t\t3\n> .\n> .\n> Jan 1, 1988\t\t366\t109\t\t\t1\n> 13\t\t1\n> Jan 2, 1988\t\t367\t111\t\t\t2\n> 19\t\t2\n> Jan 3, 1988\t\t368\t103\t\t\t0\n> 14\t\t3\n> .\n> .\n> .\n>\n> I make matched pairs of days (Strata) to control for the influence of\n> season. I also want to account for long-term trends, eg increasing birth\n> defects ascertainment and decreasing pollution levels over time, so I\n> want to fit a cubic spline using the variable t.\n>\n\nRather than matching, you might control for season by fitting a periodic \nspline of your 'Stratum' variable. If you do that, then a generalized \nadditive logistic regression model could be used.\n\n\nSomething like\n\nfit <- gam( cbind( Cases, Conceptions - Cases ) ~ te( Stratum, bs=\"cc\" ) +\n \t\tte( t, bs=\"cs\" ) + Pollution, your.data.frame,\n \t\tfamily=binomial )\n\nsee ?gam, ?te\n\n\n\n> I have already analyzed this data as a time series (I don't use the\n> Stratum variable in the time-series analyses), but now I am exploring\n> some alternatives. My full dataset has 3,115 strata.\n>\n> So my final model would look like: clogit(Cases/Conceptions ~ Pollution\n> + f(t) + strata(Stratum)).\n>\n> So, just to reiterate, my goal is to make this model without having to\n> bring in the individual-level data. I would be just as happy to do a\n> conditional Poisson as I would be to do a conditional logistic\n> regression - either would seem to be appropriate here - if that opens up\n> some other options.\n>\n> Thanks very much for your time and interest,\n> Matt Strickland\n> Epidemiologist\n> Birth Defects Branch\n> U.S. Centers for Disease Control and Prevention\n>\n>\n>\n> -----Original Message-----\n> From: Charles C. Berry [mailto:cberry@tajo.ucsd.edu]\n> Sent: Thursday, May 31, 2007 1:12 PM\n> To: Strickland, Matthew (CDC/CCHP/NCBDDD) (CTR)\n> Cc: r-help@stat.math.ethz.ch; tlumley@u.washington.edu\n> Subject: Re: [R] Conditional logistic regression for \"events/trials\"\n> format\n>\n> On Thu, 31 May 2007, Strickland, Matthew (CDC/CCHP/NCBDDD) (CTR) wrote:\n>\n>> Dear R users,\n>>\n>> I have a large individual-level dataset (~700,000 records) which I am\n>> performing a conditional logistic regression on. Key variables include\n>\n>> the dichotomous outcome, dichotomous exposure, and the stratum to\n>> which each person belongs.\n>>\n>> Using this individual-level dataset I can successfully use clogit to\n>> create the model I want. However reading this large .csv file into R\n>> and running the models takes a fair amount of time.\n>>\n>> Alternatively, I could choose to \"collapse\" the dataset so that each\n>> row has the number of events, number of individuals, and the exposure\n>> and stratum. In SAS they call this the \"events/trials\" format. This\n>> would make my dataset much smaller and presumably speed things up.\n>>\n>\n> I think you have described the data for forming a 2 by 2 by K table of\n> counts.\n>\n> In which case, loglin(), loglm(), mantelhaen.test(), and - if K is not\n> too large - glm(... , family=poisson)  would be suitable.\n>\n> But you say 'models' above suggesting that there are some other\n> variables. If so, you need to be a bit more specific in describing your\n> setup.\n>\n>\n>> So my question is: can I use clogit (or possibly another function) to\n>> perform a conditional logistic regression when the data is in this\n>> \"events/trials\" format? I am using R version 2.5.0.\n>>\n>> Thank you very much,\n>> Matt Strickland\n>> Birth Defects Branch\n>> U.S. Centers for Disease Control\n>>\n>> ______________________________________________\n>> R-help@stat.math.ethz.ch mailing list\n>> https://stat.ethz.ch/mailman/listinfo/r-help\n>> PLEASE do read the posting guide\n>> http://www.R-project.org/posting-guide.html\n>> and provide commented, minimal, self-contained, reproducible code.\n>>\n>\n> Charles C. Berry                        (858) 534-2098\n>                                          Dept of Family/Preventive\n> Medicine\n> E mailto:cberry@tajo.ucsd.edu\t         UC San Diego\n> http://biostat.ucsd.edu/~cberry/         La Jolla, San Diego 92093-0901\n>\n> ______________________________________________\n> R-help@stat.math.ethz.ch mailing list\n> https://stat.ethz.ch/mailman/listinfo/r-help\n> PLEASE do read the posting guide http://www.R-project.org/posting-guide.html\n> and provide commented, minimal, self-contained, reproducible code.\n>\n\nCharles C. Berry                        (858) 534-2098\n                                          Dept of Family/Preventive Medicine\nE mailto:cberry@tajo.ucsd.edu\t         UC San Diego\nhttp://biostat.ucsd.edu/~cberry/         La Jolla, San Diego 92093-0901\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}