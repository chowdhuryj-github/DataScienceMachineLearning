{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "Rev 416: convert ctdbd.sh tests to use an event script in\n\thttp://samba.org/~tridge/ctdb", "body": "------------------------------------------------------------\nrevno: 416\nrevision-id: tridge@samba.org-20070601090451-j8awt4re8c546udf\nparent: tridge@samba.org-20070601071619-cmxuezizcypnfhx7\ncommitter: Andrew Tridgell \nbranch nick: tridge\ntimestamp: Fri 2007-06-01 19:04:51 +1000\nmessage:\n  convert ctdbd.sh tests to use an event script\nmodified:\n  tests/ctdbd.sh                 ctdbd.sh-20070411085038-phusiewluwzyqjpc-2\n=== modified file 'tests/ctdbd.sh'\n--- a/tests/ctdbd.sh\t2007-05-29 02:16:59 +0000\n+++ b/tests/ctdbd.sh\t2007-06-01 09:04:51 +0000\n@@ -3,8 +3,10 @@\n killall -q ctdbd\n \n echo \"Starting 2 ctdb daemons\"\n-$VALGRIND bin/ctdbd --nlist direct/nodes.txt\n-$VALGRIND bin/ctdbd --nlist direct/nodes.txt\n+$VALGRIND bin/ctdbd --nlist direct/nodes.txt --event-script=tests/events --logfile=-\n+$VALGRIND bin/ctdbd --nlist direct/nodes.txt --event-script=tests/events --logfile=-\n+\n+sleep 2\n \n echo \"Testing ping\"\n $VALGRIND bin/ctdb ping || exit 1\n@@ -19,7 +21,7 @@\n $VALGRIND bin/ctdb -n all statisticsreset || exit 1\n \n echo \"Testing debug\"\n-$VALGRIND bin/ctdb -n all setdebug 5 || exit 1\n+$VALGRIND bin/ctdb -n all setdebug 3 || exit 1\n $VALGRIND bin/ctdb -n all getdebug || exit 1\n $VALGRIND bin/ctdb -n all setdebug 0 || exit 1\n $VALGRIND bin/ctdb -n all getdebug || exit 1\n@@ -31,6 +33,15 @@\n echo \"Testing getdbmap\"\n $VALGRIND bin/ctdb getdbmap || exit 1\n \n+echo \"Testing status\"\n+$VALGRIND bin/ctdb status || exit 1\n+\n+sleep 1\n+\n+echo \"Testing shutdown\"\n+$VALGRIND bin/ctdb shutdown -n all || exit 1\n+\n+sleep 1\n+\n echo \"All done\"\n-\n killall -q ctdbd\n\n"}