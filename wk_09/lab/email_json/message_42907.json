{"category": "ham", "to_address": "John Fox <jfox@mcmaster.ca>", "from_address": "Prof Brian Ripley <ripley@stats.ox.ac.uk>", "subject": "Re: [R] Refactor all factors in a data frame", "body": "On Tue, 5 Jun 2007, John Fox wrote:\n\n> Dear Hilmar,\n>\n> You could use something like\n>\n> DF <- as.data.frame(lapply(DF, function (x) if (is.factor(x)) factor(x) else\n> x))\n>\n> Where DF is the data frame.\n\nI think DF[] <- lapply(DF, \"[\", drop=TRUE) is more likely to be what is \nwanted.  That drops factor levels without reordering the remaining \nlevels, and would appear to be harmless for other variables.  But if one \nprefers\n\nind <- sapply(DF, is.factor)\nDF[ind] <- lapply(DF[ind], \"[\", drop=TRUE)\n\nNote the use of DF[] <- to preserve other attributes of DF, notably row \nnames.\n\n>\n> I hope this helps,\n> John\n>\n> --------------------------------\n> John Fox, Professor\n> Department of Sociology\n> McMaster University\n> Hamilton, Ontario\n> Canada L8S 4M4\n> 905-525-9140x23604\n> http://socserv.mcmaster.ca/jfox\n> --------------------------------\n>\n>> -----Original Message-----\n>> From: r-help-bounces@stat.math.ethz.ch\n>> [mailto:r-help-bounces@stat.math.ethz.ch] On Behalf Of Hilmar Berger\n>> Sent: Tuesday, June 05, 2007 8:20 AM\n>> To: r-help@stat.math.ethz.ch\n>> Subject: [R] Refactor all factors in a data frame\n>>\n>> Hi all,\n>>\n>> Assume I have a data frame with numerical and factor\n>> variables that I got through merging various other data\n>> frames and subsetting the resulting data frame afterwards.\n>> The number levels of the factors seem to be the same as in\n>> the original data frames, probably because subset() calls\n>> [.factor without drop = TRUE (that's what I gather from\n>> scanning the mailing lists).\n>>\n>> I wonder if there is a easy way to refactor all factors in\n>> the data frame at once. I noted that fix(data_frame) does the\n>> trick, however, this needs user interaction, which I'd like\n>> to avoid. Subsequent write.table / read.table would be\n>> another option but I'm not sure if R can guess the\n>> factor/char/numeric-type correctly when reading the table.\n>>\n>> So, is there any way in drop the unused factor levels from\n>> *all* factors of a data frame without import/export ?\n\n-- \nBrian D. Ripley,                  ripley@stats.ox.ac.uk\nProfessor of Applied Statistics,  http://www.stats.ox.ac.uk/~ripley/\nUniversity of Oxford,             Tel:  +44 1865 272861 (self)\n1 South Parks Road,                     +44 1865 272866 (PA)\nOxford OX1 3TG, UK                Fax:  +44 1865 272595\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}