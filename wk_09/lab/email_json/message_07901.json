{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "metze@samba.org", "subject": "svn commit: samba r22312 - in branches/SAMBA_4_0/source: . script", "body": "Author: metze\nDate: 2007-04-17 15:55:08 +0000 (Tue, 17 Apr 2007)\nNew Revision: 22312\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22312\n\nLog:\navoid the need of typing 'run' into each gdb xterm\n\nif someone knows how to tell gdb to only exit\nif 'run' exists clean via the if/else logic\nplease tell me!\n\nsee http://davis.lbl.gov/Manuals/GDB/gdb_20.html#SEC194)\nbut there's no useful example :-(\n\nmetze\nAdded:\n   branches/SAMBA_4_0/source/script/gdb_run\nModified:\n   branches/SAMBA_4_0/source/main.mk\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/main.mk\n===================================================================\n--- branches/SAMBA_4_0/source/main.mk\t2007-04-17 15:33:50 UTC (rev 22311)\n+++ branches/SAMBA_4_0/source/main.mk\t2007-04-17 15:55:08 UTC (rev 22312)\n@@ -330,15 +330,15 @@\n gdbtest: gdbtest-quick\n \n gdbtest-quick: all\n-\tSMBD_VALGRIND=\"xterm -n smbd -e gdb --args \" \\\n+\tSMBD_VALGRIND=\"xterm -n smbd -e $(srcdir)/script/gdb_run \" \\\n \t$(SELFTEST) --immediate --quick --socket-wrapper\n \n gdbtest-all: everything\n-\tSMBD_VALGRIND=\"xterm -n smbd -e gdb --args \" \\\n+\tSMBD_VALGRIND=\"xterm -n smbd -e $(srcdir)/script/gdb_run \" \\\n \t$(SELFTEST) --immediate --socket-wrapper\n \n gdbtest-env: everything\n-\tSMBD_VALGRIND=\"xterm -n smbd -e gdb --args \" \\\n+\tSMBD_VALGRIND=\"xterm -n smbd -e $(srcdir)/script/gdb_run \" \\\n \t$(SELFTEST) --socket-wrapper --testenv\n \n wintest: all\n\nAdded: branches/SAMBA_4_0/source/script/gdb_run\n===================================================================\n--- branches/SAMBA_4_0/source/script/gdb_run\t2007-04-17 15:33:50 UTC (rev 22311)\n+++ branches/SAMBA_4_0/source/script/gdb_run\t2007-04-17 15:55:08 UTC (rev 22312)\n@@ -0,0 +1,17 @@\n+#!/bin/sh\n+\n+if test -z \"$TMPDIR\"; then\n+\tTMPDIR=\"/tmp\"\n+fi\n+\n+TMPFILE=$TMPDIR/gdb_run.$$\n+cat << EOF  > $TMPFILE\n+run\n+bt\n+quit\n+EOF\n+\n+trap \"/bin/rm -f $TMPFILE\" EXIT\n+CMD=\"gdb -x $TMPFILE --args $@\"\n+echo $CMD\n+eval \"$CMD\"\n\n\nProperty changes on: branches/SAMBA_4_0/source/script/gdb_run\n___________________________________________________________________\nName: svn:executable\n   + *\n\n"}