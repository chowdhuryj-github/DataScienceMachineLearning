{"category": "ham", "to_address": "r-help@stat.math.ethz.ch", "from_address": "Raymond Wan <rwan@kuicr.kyoto-u.ac.jp>", "subject": "[R] R's Spearman", "body": "\nHi all,\n\nI am trying to figure out the formula used by R's Spearman rho (using \ncor(method=\"spearman\")) because I can't seem to get the same value as by \ncalculating \"by hand\".  Perhaps I'm using \"cor\" wrong, but I don't know \nwhere.  Basically, I am running these commands:\n\n > y=read.table(file=\"tmp\",header=TRUE,sep=\"\\t\")\n > y\n   IQ Hours\n1 106     7\n2  86     0\n3  97    20\n4 113    12\n5 120    12\n6 110    17\n > cor(y[1],y[2],method=\"spearman\")\n       Hours\nIQ 0.2319084\n\n[it's an abbreviated example of one I took from Wikipedia].  I \ncalculated by hand (apologies if the table looks strange when pasted \ninto e-mail):\n\n      IQ    Hours    rank(IQ)  rank(hours)    diff    diff^2\n1    106    7        3         2                 1    1\n2     86    0        1         1                 0    0\n3     97    20       2         6                -4    16\n4    113    12       5         3.5             1.5    2.25\n5    120    12       6         3.5             2.5    6.25\n6    110    17       4         5                -1    1\n                                                      26.5\n                           \n                                              rho=    0.242857\n\nwhere rho = (1 - ((6 * 26.5) / 6 * (6^2 - 1))).  I kept modifying the \ntable and realized that the difference in result comes from ties.  i.e., \nif I remove the tie in rows 4 and 5, I get the same result from both cor \nand calculating by hand.  Perhaps I'm handling ties wrong...does anyone \nknow how R does it or perhaps I need to change how I'm using it?\n\nThank you!\n\nRay\n\n______________________________________________\nR-help@stat.math.ethz.ch mailing list\nhttps://stat.ethz.ch/mailman/listinfo/r-help\nPLEASE do read the posting guide http://www.R-project.org/posting-guide.html\nand provide commented, minimal, self-contained, reproducible code.\n\n"}