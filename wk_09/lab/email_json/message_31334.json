{"category": "ham", "to_address": "samba-cvs@samba.org", "from_address": "tridge@samba.org", "subject": "svn commit: samba r22964 - in branches/SAMBA_4_0/source/lib/events:\n\t.", "body": "Author: tridge\nDate: 2007-05-17 02:42:14 +0000 (Thu, 17 May 2007)\nNew Revision: 22964\n\nWebSVN: http://websvn.samba.org/cgi-bin/viewcvs.cgi?view=rev&root=samba&rev=22964\n\nLog:\n\nlog an error on epoll_create failing on reopen\n\nModified:\n   branches/SAMBA_4_0/source/lib/events/events_aio.c\n   branches/SAMBA_4_0/source/lib/events/events_epoll.c\n   branches/SAMBA_4_0/source/lib/events/events_standard.c\n\n\nChangeset:\nModified: branches/SAMBA_4_0/source/lib/events/events_aio.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/events/events_aio.c\t2007-05-17 02:38:07 UTC (rev 22963)\n+++ branches/SAMBA_4_0/source/lib/events/events_aio.c\t2007-05-17 02:42:14 UTC (rev 22964)\n@@ -108,8 +108,9 @@\n \tstruct fd_event *fde;\n \n \tclose(aio_ev->epoll_fd);\n-\taio_ev->epoll_fd = epoll_create(64);\n+\taio_ev->epoll_fd = epoll_create(MAX_AIO_QUEUE_DEPTH);\n \tif (aio_ev->epoll_fd == -1) {\n+\t\tDEBUG(0,(\"Failed to recreate epoll handle after fork\\n\"));\n \t\treturn;\n \t}\n \taio_ev->pid = getpid();\n\nModified: branches/SAMBA_4_0/source/lib/events/events_epoll.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/events/events_epoll.c\t2007-05-17 02:38:07 UTC (rev 22963)\n+++ branches/SAMBA_4_0/source/lib/events/events_epoll.c\t2007-05-17 02:42:14 UTC (rev 22964)\n@@ -109,6 +109,7 @@\n \tclose(epoll_ev->epoll_fd);\n \tepoll_ev->epoll_fd = epoll_create(64);\n \tif (epoll_ev->epoll_fd == -1) {\n+\t\tDEBUG(0,(\"Failed to recreate epoll handle after fork\\n\"));\n \t\treturn;\n \t}\n \tepoll_ev->pid = getpid();\n\nModified: branches/SAMBA_4_0/source/lib/events/events_standard.c\n===================================================================\n--- branches/SAMBA_4_0/source/lib/events/events_standard.c\t2007-05-17 02:38:07 UTC (rev 22963)\n+++ branches/SAMBA_4_0/source/lib/events/events_standard.c\t2007-05-17 02:42:14 UTC (rev 22964)\n@@ -126,6 +126,7 @@\n \tclose(std_ev->epoll_fd);\n \tstd_ev->epoll_fd = epoll_create(64);\n \tif (std_ev->epoll_fd == -1) {\n+\t\tDEBUG(0,(\"Failed to recreate epoll handle after fork\\n\"));\n \t\treturn;\n \t}\n \tstd_ev->pid = getpid();\n\n"}